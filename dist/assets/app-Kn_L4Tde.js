var Ma=Object.defineProperty;var Oa=(i,s,u)=>s in i?Ma(i,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):i[s]=u;var ut=(i,s,u)=>Oa(i,typeof s!="symbol"?s+"":s,u);import{m as ot,c as q,o as L,a as _,d as ye,u as mn,r as h,b as Me,w as be,e as t,n as pe,f as $e,g as Ve,h as Te,i as J,_ as kt,j as e,k as st,l as me,p as Ce,q as n,N as Ct,s as $,t as d,F as Pe,v as it,B as Fe,x as je,y as vn,T as Tt,z as ze,A as Ae,C as Ie,D as $t,E as at,L as Ua,G as Ra,H as le,I as lt,J as Ba,K as Na,M as hn,O as Zt,P as yn,Q as Ht,R as Se,S as ja,U as Bt,V as et,W as Za,X as Ha,Y as Ge,Z as Vt,$ as ct,a0 as qe,a1 as _n,a2 as Ke,a3 as wn,a4 as pt,a5 as Ft,a6 as dt,a7 as At,a8 as Va,a9 as nt,aa as Wa,ab as Jt,ac as en,ad as bn,ae as qa,af as Et,ag as Ga,ah as Ka,ai as kn,aj as Qa,ak as tn,al as ft,am as Ya,an as zn,ao as Xa,ap as Pt,aq as Ja,ar as el,as as tl,at as Nt,au as Sn,av as nl,aw as Cn,ax as Tn,ay as ol,az as al,aA as ll,aB as Wt,aC as An,aD as sl,aE as xn,aF as In,aG as qt,aH as il,aI as Ln,aJ as rl,aK as ul,aL as vt,aM as ht,aN as cl,aO as dl,aP as pl,aQ as fl,aR as gl,aS as ml,aT as nn,aU as vl,aV as hl,aW as yl,aX as _l,aY as wl,aZ as bl,a_ as kl,a$ as zl,b0 as Sl,b1 as Cl,b2 as Tl,b3 as Al,b4 as xl}from"./vendor-D3o1LRaX.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function u(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(o){if(o.ep)return;o.ep=!0;const a=u(o);fetch(o.href,a)}})();const Il={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ll(i,s){return L(),q("svg",Il,s[0]||(s[0]=[_("path",{fill:"currentColor",d:"m12 13.4l-4.9 4.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.9-4.9l-4.9-4.9q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l4.9 4.9l4.9-4.9q.275-.275.7-.275t.7.275t.275.7t-.275.7L13.4 12l4.9 4.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275z"},null,-1)]))}const $l=ot({name:"material-symbols-close-rounded",render:Ll}),Fl=["width","height"],El={key:1,class:"error"},Pl=["height"],Dl=ye({__name:"canvas-thumbnail",props:{source:{},width:{},height:{},fit:{}},setup(i,{expose:s,emit:u}){const l=i;s({}),mn();const o=typeof window.createImageBitmap=="function",a=h(!1),r=h(),c=h(100),f=h(100);let w,k;Me(()=>{o?w=r.value.getContext("bitmaprenderer"):k=r.value.getContext("2d"),be(()=>l.source,T=>{a.value=!1,o?z(T):g(T)},{immediate:!0})});async function z(T){try{let p,E,y;T instanceof Blob?(y=await createImageBitmap(T,{resizeWidth:Math.max(200,l.width),resizeQuality:"pixelated"}),{width:p,height:E}=y,T=y):T instanceof VideoFrame?(p=T.displayWidth,E=T.displayHeight):{width:p,height:E}=T;const{tw:m,th:A,cropx:v,cropy:x,cropw:B,croph:P}=S(p,E,l.width,l.height),R=await createImageBitmap(T,v,x,B,P,{resizeWidth:m,resizeHeight:A,resizeQuality:"pixelated"});c.value=m,f.value=A,r.value.style.width=m+"px",r.value.style.height=A+"px",w.transferFromImageBitmap(R),y&&y.close()}catch{a.value=!0}}async function g(T){if(T instanceof Blob){const P=URL.createObjectURL(T),R=new Image;if(await new Promise(ee=>{R.onload=R.onerror=ee,R.src=P,setTimeout(ee,1e4)}),!R.complete){a.value=!0;return}T=R,URL.revokeObjectURL(P)}else if(T instanceof ImageData||T instanceof VideoFrame||T instanceof SVGElement)return;const{width:p,height:E}=T,{tw:y,th:m,sx:A,sy:v,sw:x,sh:B}=S(p,E,l.width,l.height);r.value.width=y,r.value.height=m,r.value.style.width=y+"px",r.value.style.height=m+"px",k.drawImage(T,A,v,x,B)}function S(T,p,E,y){const m=T/p,A=E/y;let v,x,B=0,P=0,R=T,ee=p,Q=0,O=0,C=0,ae=0;return m>A?(x=y,v=x*m,B=(v-E)/2*(T/v),R=E*(T/v),ae=y,C=y*m,Q=-(C-E)/2):(v=E,x=v/m,P=(x-y)/2*(p/x),ee=y*(p/x),C=E,ae=E/m,O=-(ae-y)/2),{tw:E,th:y,cropx:B,cropy:P,cropw:R,croph:ee,sx:Q,sy:O,sw:C,sh:ae}}return(T,p)=>t(a)?(L(),q("div",El,[(L(),q("svg",{xmlns:"http://www.w3.org/2000/svg",style:pe({width:Math.min(T.width,T.height)+"px"}),height:Math.min(T.width,T.height),viewBox:"0 0 32 32"},p[0]||(p[0]=[_("path",{fill:"currentColor",d:"M2 16A14 14 0 1 0 16 2A14 14 0 0 0 2 16m23.15 7.75L8.25 6.85a12 12 0 0 1 16.9 16.9M8.24 25.16a12 12 0 0 1-1.4-16.89l16.89 16.89a12 12 0 0 1-15.49 0"},null,-1)]),12,Pl))])):(L(),q("canvas",{key:0,ref_key:"canvas",ref:r,width:t(c),height:t(f)},null,8,Fl))}}),Oe=(i,s)=>{const u=i.__vccOpts||i;for(const[l,o]of s)u[l]=o;return u},Ml=Oe(Dl,[["__scopeId","data-v-10914d6b"]]);function He(i,s=2){const u=Math.sign(i);i=Math.abs(i);const l=["Bytes","KB","MB","GB"],o=i?Math.floor(Math.log(i)/Math.log(1024)):0;return`${(i/Math.pow(1024,o)*u).toFixed(s)}${l[o]}`}function $n(i,s=100,u=!1){s=typeof s=="number"?{width:s,height:s}:s;const{width:l,height:o}=s;let{width:a,height:r}=i;const c=a/r,f=l/o;return c>=f?(a=u?Math.min(l,a):l,r=a/c|0):(r=u?Math.min(o,r):o,a=r*c|0),{width:a,height:r}}class Ol{constructor(){ut(this,"_currentFileCount",0);ut(this,"_currentZipIndex",0);ut(this,"_totalFileCount",0);ut(this,"_zipLengthSumList",[]);ut(this,"_pathBank",{})}increase(s){return s&&(this._pathBank[s]=[this._zipLengthSumList.length,this._currentFileCount]),this._currentFileCount++,this._totalFileCount++}split(){this._zipLengthSumList.push(this._totalFileCount),this._currentZipIndex++,this._currentFileCount=0}get(s){if(typeof s=="number"){let u=this._zipLengthSumList.findIndex((a,r)=>s<a);u===-1&&(u=this._zipLengthSumList.length);const l=this._zipLengthSumList[u-1]||0,o=s-l;return[u,o]}else{const u=this._pathBank[String(s)];if(u)return u}return null}getZipIndex(){return this._currentZipIndex}getIndex(){return this._totalFileCount}}function Ul(i){return new Promise(s=>setTimeout(s,i))}function Rl(i,s=0,u,l){i.value=u;const o=setTimeout(()=>{i.value=!0},s);return()=>clearTimeout(o)}function Bl(i,s=0){const u=h(i);return be(u,l=>{l!==void 0&&$e(()=>{setTimeout(()=>u.value=void 0,s)})},{immediate:!0}),u}const Fn=ye({__name:"prompt-on-dup",props:Ve({preset:{default:"dialog"},title:{},content:{},type:{},show:{type:Boolean},buttons:{},defaultButtons:{},closable:{type:Boolean},draggable:{type:Boolean},closeOnEsc:{type:Boolean},maskClosable:{type:Boolean},showApplyAll:{type:Boolean},labelApplyAll:{default:"Apply this action to all"}},{applyAllChecked:{type:Boolean},applyAllCheckedModifiers:{}}),emits:Ve(["start","close","applyAllChange"],["update:applyAllChecked"]),setup(i,{expose:s,emit:u}){const l=i,o=Te(i,"applyAllChecked"),a=u;s({start:g,click:E,close:S,isApplyAllChecked:A});const r=mn(),c={overwrite:"Overwrite",skip:"Skip",rename:"Rename",cancel:"Cancel"},f=h(),w=h(!1);let k,z;be(()=>l.show,(v,x)=>{v?g():S()},{immediate:l.show});function g(){f.value=T(),w.value=!0,z=void 0,o.value=!1;const v=new Promise(x=>{k=x});return a("start",v),v}function S(){w.value=!1;const v=z;return setTimeout(()=>{k(v),a("close",v)},50),z}function T(){const v=[];if(l.buttons)for(const x of l.buttons){let B,P;if(typeof x=="string"?B=P=x:x instanceof Array?([P,B]=x,typeof B>"u"&&(B=P)):x&&({key:B,label:P}=x),!B||!P)throw new Error("unexpected button item");v.push([P,B])}else(l.defaultButtons||["overwrite","skip","cancel"]).forEach(B=>{if(!(B in c))throw new Error(`${B} doen't exist in DEF_LABELS`);v.push([c[B],B])});return v}function p(v){return typeof v=="function"?v():v}function E(v){z=v,S()}function y(){z="close",S()}function m(v){a("applyAllChange",v)}function A(){return o.value}return(v,x)=>{const B=Fe,P=Ct,R=Ce,ee=kt;return L(),J(ee,{show:t(w),closable:v.closable,draggable:v.draggable,preset:v.preset,title:v.title,content:v.content,type:v.type,onClose:x[1]||(x[1]=Q=>v.closable&&y()),onEsc:x[2]||(x[2]=Q=>v.closeOnEsc&&y()),onMaskClick:x[3]||(x[3]=Q=>v.maskClosable&&y())},{action:e(()=>[r.action?st(v.$slots,"action",{key:0}):(L(!0),q(Pe,{key:1},it(t(f),Q=>(L(),J(B,{onClick:O=>E(typeof Q[1]<"u"?Q[1]:Q[0])},{default:e(()=>[$(d(p(Q[0])),1)]),_:2},1032,["onClick"]))),256))]),default:e(()=>[st(v.$slots,"default"),v.showApplyAll?(L(),J(R,{key:0,justify:"end",style:{padding:"1em","font-size":"0.8em"}},{default:e(()=>[n(P,{checked:o.value,"onUpdate:checked":x[0]||(x[0]=Q=>o.value=Q),onUpdateChecked:m},{default:e(()=>[$(d(v.labelApplyAll),1)]),_:1},8,["checked"])]),_:1})):me("",!0)]),header:e(()=>[st(v.$slots,"header")]),icon:e(()=>[st(v.$slots,"icon")]),close:e(()=>[st(v.$slots,"close")]),_:3},8,["show","closable","draggable","preset","title","content","type"])}}}),Nl={class:"list-label"},jl={class:"sum"},Zl={class:"size"},Hl={class:"files"},Vl={class:"path"},Wl=3,ql=ye({__name:"file-list",props:Ve({additionalFiles:{}},{"file-list":{required:!0},"file-listModifiers":{}}),emits:["update:file-list"],setup(i){const{t:s}=je(),u=i,l=Te(i,"file-list"),o=h([]),a=h(""),r=h(0),c=h(),f=h(!1),w=h(""),k=h([[()=>s("dupAction_replace"),"overwrite"],[()=>s("dupAction_skip"),"skip"],[()=>s("cancel"),"cancel"]]);Me(()=>{be(()=>u.additionalFiles,async g=>{const S=new Map(l.value.map(E=>[E.webkitRelativePath||E.name,E]));let T=!1,p="";for(const E of g){const y=E.webkitRelativePath||E.name;if(S.has(y)){w.value=y;const m=p||await c.value.start();switch(!p&&f.value&&(p=m),m){case"overwrite":T=!0;break;case"cancel":return;case"skip":default:continue}}S.delete(y),S.set(y,E)}(S.size>l.value.length||T)&&(l.value=[...S.values()])}),be(()=>l.value[l.value.length-1],()=>{const g=l.value.slice(-3);for(const T of g){const p=T.name;o.value.push({file:T,name:p})}const S=Math.min(Wl,l.value.length);o.value.length>S&&(o.value=o.value.slice(-S)),a.value=He(l.value.reduce((T,p)=>T+p.size,0))})});function z(){l.value.length=0,o.value.length=0}return(g,S)=>{const T=vn,p=Ce,E=$l,y=Ae,m=Fe,A=ze;return L(),q("div",null,[n(p,{class:"container",justify:"stretch",align:"stretch",wrap:!1,size:1},{default:e(()=>[n(p,{class:"list-box",wrap:!1,size:0},{default:e(()=>[_("span",Nl,d(g.$t("SourceImageList")),1),n(p,{class:"list-status",vertical:"",size:4,align:"end",justify:"end"},{default:e(()=>[_("div",jl,d(g.$t("status.total")),1),_("div",Zl,d(t(a)),1),_("div",Hl,[n(T,{active:!0,duration:1e3,"show-separator":"",to:l.value.length,from:t(r),onFinish:S[0]||(S[0]=v=>r.value=l.value.length)},null,8,["to","from"]),$(" "+d(g.$t("files",l.value.length)),1)])]),_:1}),n(Tt,{name:"list"},{default:e(()=>[(L(!0),q(Pe,null,it(t(o),(v,x)=>(L(),J(Ml,{key:v.file._id,source:v.file,width:67,height:100,class:"image-item"},null,8,["source"]))),128))]),_:1})]),_:1}),n(p,{class:"button-box",align:"center",justify:"center"},{default:e(()=>[n(A,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,delay:100},{trigger:e(()=>[n(m,{class:"close-button",bordered:!1,color:"gray",ghost:"",size:"tiny",onClick:S[1]||(S[1]=v=>z())},{default:e(()=>[n(p,{vertical:"",align:"center"},{default:e(()=>[n(y,{size:"1.6em"},{default:e(()=>[n(E)]),_:1}),_("span",null,d(g.$t("reset")),1)]),_:1})]),_:1})]),default:e(()=>[$(d(g.$t("resetListButtonTooltip")),1)]),_:1})]),_:1})]),_:1}),n(Fn,{ref_key:"promptdup",ref:c,closable:"",buttons:t(k),"close-on-esc":"","show-apply-all":"","label-apply-all":g.$t("confirmApplyAllLabel"),"apply-all-checked":t(f),"onUpdate:applyAllChecked":S[2]||(S[2]=v=>Ie(f)?f.value=v:null)},{header:e(()=>[$(d(g.$t("confirmListOverwrite")),1)]),default:e(()=>[_("div",null,d(g.$t("confirmListOverwriteMsg")),1),_("p",Vl,d(t(w)),1)]),_:1},8,["buttons","label-apply-all","apply-all-checked"])])}}}),Gl=Oe(ql,[["__scopeId","data-v-3209b149"]]),Kl=10,Be=h(navigator.hardwareConcurrency?Math.min(navigator.hardwareConcurrency,Kl):0),yt={threadCount:{min:2,max:Math.max(2,Be.value)}},Ql={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:Be.value,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1,changeLogCheckedDate:0,lang:"",autoStartConversion:!1,outputMethod:"zip",actionOnDuplicate:"prompt"},Yl=["outputMethod","actionOnDuplicate"],V=$t(En({}));function Xl(){En(V)}function En(i){return Object.assign(i,Ql)}const Pn="avif2jpeg",Dt=JSON.parse(localStorage.getItem(Pn)||"{}");for(const i in V)if(Dt.hasOwnProperty(i)&&Dt[i]!==void 0){let s=Dt[i];yt.hasOwnProperty(i)&&(yt[i].min>s&&(s=yt[i].min),yt[i].max<s&&(s=yt[i].max)),V[i]=s}function Dn(){const i={};for(const s in V)Yl.includes(s)||(i[s]=V[s]);localStorage.setItem(Pn,JSON.stringify(i))}window.addEventListener("beforeunload",Dn);function Jl(){localStorage.clear(),window.removeEventListener("beforeunload",Dn)}const es={href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-weight":"bolder"}},ts=ye({__name:"github",setup(i){const s=at(Qe);return(u,l)=>{const o=Ae,a=Ce,r=ze;return L(),J(r,{to:!1,"display-directive":"show",show:t(s).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:e(()=>[_("a",es,[n(a,{align:"center",size:0},{default:e(()=>[n(o,{size:"1.2em"},{default:e(()=>[n(t(Ua))]),_:1}),l[0]||(l[0]=$("GitHub "))]),_:1,__:[0]})])]),default:e(()=>[$(" "+d(u.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),ns=["href"],os=ye({__name:"licenses",setup(i){const s=h(!1),u={Vue:"https://github.com/vuejs/core/blob/main/LICENSE",Vite:"https://github.com/vitejs/vite/blob/main/LICENSE","Vite SSG":"https://github.com/antfu/vite-ssg/blob/main/LICENSE","Naive UI":"https://github.com/TuSimple/naive-ui/blob/main/LICENSE",Ionicons:"https://github.com/ionic-team/ionicons/blob/main/LICENSE"};return(l,o)=>{const a=Fe;return L(),q(Pe,null,[n(a,{text:"",onClick:o[0]||(o[0]=r=>s.value=!0),style:{color:"black","font-size":"small"}},{default:e(()=>o[2]||(o[2]=[$("Licenses")])),_:1,__:[2]}),n(t(kt),{preset:"dialog",ref:"dialog",show:s.value,"onUpdate:show":o[1]||(o[1]=r=>s.value=r),"positive-text":"OK",title:"Licenses"},{default:e(()=>[o[3]||(o[3]=_("h3",null,"Frameworks and Libraries",-1)),_("ul",null,[(L(),q(Pe,null,it(u,(r,c)=>_("li",null,[_("a",{href:r},d(c),9,ns)])),64))]),o[4]||(o[4]=_("h3",null,"App icon",-1)),o[5]||(o[5]=_("div",null,[$(" The app icon is derived from "),_("a",{href:"https://aomediacodec.github.io/av1-avif/"},"AVIF logo"),$(". ")],-1))]),_:1,__:[3,4,5]},8,["show"])],64)}}}),as=1,ls=12,ss=2,is="",zt={major:as,minor:ls,build:ss,tag:is},rs={style:{"font-size":"x-small","user-select":"none"}},us=ye({__name:"version",setup(i){const s=["0.0.118"],u=`${zt.major}.${zt.minor}.${zt.build}${zt.tag}`,l=s.map(c=>({label:`v${c}`,key:c,value:c}));function o(c){const{key:f,label:w}=c,k=r(f),z=le("a",{href:k},w),g=le("div",null,z);return le("div",null,g)}function a(c){location.href=r(c)}function r(c){return`/avif2jpeg/old/${c}/`}return(c,f)=>{const w=Ra;return L(),J(w,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:t(l),"render-label":o,"onUpdate:value":a},{header:e(()=>[_("span",rs,d(c.$t("previousVersion")),1)]),default:e(()=>[_("span",{style:{cursor:"pointer"}},"v"+d(u))]),_:1},8,["options"])}}}),cs={key:0,style:{color:"red"}},ds=["innerHTML"],ps=ye({__name:"changelog",props:{url:{}},setup(i){const s=i,u=h("fetching..."),l=h(!1);Me(()=>a(s.url));let o=0;async function a(c){const f=await fetch(c,{headers:{Accept:"application/vnd.github.v3+json"}}).then(w=>w.ok?w.text():null);u.value="",f&&(u.value=f.replace(/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2}) \+\d+$/mg,(w,k)=>{const z=new Date(w),g=z.getTime(),S=z.toLocaleString();let T="";return g>V.changeLogCheckedDate&&(l.value=!0,g>o&&(o=g),T="update"),`<span class="date ${T}">${S}</span>`}))}function r(){o>V.changeLogCheckedDate&&(V.changeLogCheckedDate=o),l.value=!1}return(c,f)=>{const w=Ae,k=Ce,z=lt;return L(),J(z,{trigger:"click",placement:"bottom","arrow-point-to-center":"","onUpdate:show":r,style:{"margin-left":"-1em","max-width":"80%","white-space":"initial"}},{trigger:e(()=>[n(k,{align:"center",size:1,style:{cursor:"pointer"}},{default:e(()=>[n(w,{component:t(Ba),size:"1.5em",color:t(l)?"blue":"silver",style:{transition:"color 0.5s"}},null,8,["component","color"]),$(" "+d(c.$t("changelog")),1)]),_:1})]),default:e(()=>[t(u)?(L(),q("pre",{key:1,innerHTML:t(u),class:"commits"},null,8,ds)):(L(),q("div",cs," connection error "))]),_:1})}}}),fs="modulepreload",gs=function(i){return"/avif2jpeg/dist/"+i},on={},xe=function(s,u,l){let o=Promise.resolve();if(u&&u.length>0){let r=function(w){return Promise.all(w.map(k=>Promise.resolve(k).then(z=>({status:"fulfilled",value:z}),z=>({status:"rejected",reason:z}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));o=r(u.map(w=>{if(w=gs(w),w in on)return;on[w]=!0;const k=w.endsWith(".css"),z=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${w}"]${z}`))return;const g=document.createElement("link");if(g.rel=k?"stylesheet":fs,k||(g.as="script"),g.crossOrigin="",g.href=w,f&&g.setAttribute("nonce",f),document.head.appendChild(g),k)return new Promise((S,T)=>{g.addEventListener("load",S),g.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${w}`)))})}))}function a(r){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=r,window.dispatchEvent(c),!c.defaultPrevented)throw r}return o.then(r=>{for(const c of r||[])c.status==="rejected"&&a(c.reason);return s().catch(a)})},Mn="English",On="🇬🇧",Un='AVIF to JPEG "Offline" Batch Converter',Rn="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",Bn=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.',"Use this app at your own risk."],Nn="Select your language",jn="Choose Target File Extentions",Zn={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},Hn="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",Vn="Select your images from a dialog window.<br>*Multiple selection allowed.",Wn=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,qn="Converting images",Gn="Aborted",Kn="Some files failed to convert",Qn="Completed",Yn="Currently Busy",Xn="No files with the extentions were found.",Jn="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",eo="Cancel",to="Save",no="Close",oo="Open",ao="Re-convert",lo="Convert previous selected {n} @:files again",so="File | Files",io="thread | threads",ro="You have not saved the converted images yet.",uo="Data have not been saved",co="Open Source",po="Open the converted image",fo="Copied to clipboard",go="The converted image was copied to your clipboard as DataURL.",mo="Copy the converted image as DataURL",vo="Convert Again",ho={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",showOnlyErrors:"Show only errors",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files",Shrinked:"Shrinked",Shrinking:"Shrinking",saveAll:"Save All",progressRetries:"Retrying files",success:"success",started:"started",total:"total",files:"files",failure:"failure",all:"all",filterLogSelect:"filter",showOnlySuccess:"Only successes",showOnlyError:"Only errors",showAll:"Show all",Progress:"Progress",PreviewImage:"Preview Images",Log:"Log",log:"Log",Output:"Output Results",expandLog:"expand log size",autoScroll:"auto-scroll",sortByStatus:"status",sort:"Sort list by",sortByName:"name",sortBySize:"size",sortByOutputSize:"size(output)",sortByStart:"starting order",sortByCompletion:"output order",outputToDir:"Export to Folder",numberOfFilesWrittenToDir:"Number of files written to the folder"},yo={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file",useFileSystemAPI:"Directly write output files to the local folder",autoStartConversion:"Automatically start conversion after loading images",outputFolderDenied:"Output folder selection was canceled",saveAsZIP:"Save as a ZIP File",changeSaveMethod:"Change Save Method",chooseOutputFolder:"Choose an output folder",saveToSpecifiedFolder:"Write to Selected Folder Directly",actionOnDuplicate:"Action on Duplicate",autoStartConversionTooltip:"Conversion will start automatically after images are loaded. The list is reset each time you load images.",chooseOutputFolderTooltip:"No output folder selected."},_o="Disabled",wo="Download",bo="Reset",ko="Back",zo="Failed",So="Success",Co="Previous version",To=`
Height`,Ao="Width",xo="Don't show this message again",Io="About the warning when selecting a folder",Lo="OK",$o={},Fo="You must press the “Upload” button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",Eo="Continue",Po="Cancel",Do="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",Mo="This page may be an outdated version. Please reload the page.",Oo="Reload",Uo='If the conversion process frequently fails and an “Out of Memory” message appears, try reducing or disabling the number of "multi-threads" in the "Advanced Settings".',Ro="Next",Bo="Previous",No="or",jo="Source Image Extensions",Zo="Changelog",Ho="Choose source image extensions",Vo="Drag & Drop AVIF Images to Convert",Wo="Or just drag & drop",qo="Install as App",Go='Installing allows you to launch this web app directly from desktop icons or other shortcuts. The security level is the same as a regular web page, so it remains safe. For more details, please see <a href="https://support.google.com/chrome/answer/9658361">Google’s support page</a>.',Ko="Use the browser’s language setting",Qo="Installed as an app",Yo="A new version of the page is available. Click the Reload button to update.",Xo="Start Conversion",Jo="Default",ea="Add Images",ta="Add Entire Folder",na="Source Image List",oa="Clear the current list of source images",aa="Click here to start conversion",la="experimental",sa="Show confirmation dialog",ia="Overwrite",ra="Skip",ua="Confirm List Overwrite",ca="This path already exists in the list.",da="Replace",pa="Output folder not specified.",fa="Apply this action to all",ga="A {type} with the same name already exists.",ma="file",va="folder",ha="Overwrite Confirmation",ya="Load source images first",_a="Converted images will be saved to the folder below.",wa="This feature is experimental. Continue only if it is acceptable to lose data in the output folder.",ba="Images will be written directly to folder",ka="Restore all settings to default",za={lang:Mn,flags:On,title:Un,metaDescription:Rn,descriptions:Bn,selectLanguage:Nn,fileTypeRadioTitle:jn,fileTypeRadioOptions:Zn,editAcceptTypes:Hn,loadbuttontooltip:Vn,loadfoldertooltip:Wn,processing:qn,aborted:Gn,incomplete:Kn,completed:Qn,interfered:Yn,noimage:Xn,avifUnsupported:Jn,cancel:eo,save:to,close:no,open:oo,reconvert:ao,reconvertTip:lo,files:so,threads:io,confirmCloseDialog:ro,confirmCloseDialogTitle:uo,githubOpenSource:co,convertedImageUrlTooltip:po,copiedDataURLDialogTitle:fo,copiedDataURLMessage:go,convertedImageDataUrlTooltip:mo,convertAgain:vo,status:ho,settings:yo,disabled:_o,Download:wo,reset:bo,back:ko,failed:zo,success:So,previousVersion:Co,height:To,width:Ao,checkboxTextDontShowThis:xo,loadfolderNotifyingTitle:Io,OK:Lo,loadfolderNotifyingMessage:$o,loadfolderNotifyingMessageTerm2:Fo,Continue:Eo,Cancel:Po,loadfolderNotifyingMessageTerm1:Do,errMsgWorkerLoadError:Mo,Reload:Oo,annotationOutOfMemory:Uo,Next:Ro,Prev:Bo,or:No,TargetFileTypeExt:jo,changelog:Zo,TargetFileTypeExtTooltip:Ho,droptargetTooltip:Vo,droptargetLabel:Wo,installAsApp:qo,PWAinstallAsAppTooltip:Go,selectLangCloseTooltip:Ko,PWAInstalledTooltip:Qo,PWAUpdateMessage:Yo,StartConversion:Xo,Default:Jo,loadbutton:ea,loadfolderbutton:ta,SourceImageList:na,resetListButtonTooltip:oa,convertTooltip:aa,experimental:la,dupAction_prompt:sa,dupAction_overwrite:ia,dupAction_skip:ra,confirmListOverwrite:ua,confirmListOverwriteMsg:ca,dupAction_replace:da,errMsgOutputDirNotFound:pa,confirmApplyAllLabel:fa,confirmFileOverwriteMsg:ga,file:ma,folder:va,confirmFileOverwriteTitle:ha,convertUnpreparedTooltip:ya,warnAboutFileSysBeforeConversion1:_a,warnAboutFileSysBeforeConversion2:wa,warnAboutFileSysTitle:ba,warnAboutResetMsg:ka},ms=Object.freeze(Object.defineProperty({__proto__:null,Cancel:Po,Continue:Eo,Default:Jo,Download:wo,Next:Ro,OK:Lo,PWAInstalledTooltip:Qo,PWAUpdateMessage:Yo,PWAinstallAsAppTooltip:Go,Prev:Bo,Reload:Oo,SourceImageList:na,StartConversion:Xo,TargetFileTypeExt:jo,TargetFileTypeExtTooltip:Ho,aborted:Gn,annotationOutOfMemory:Uo,avifUnsupported:Jn,back:ko,cancel:eo,changelog:Zo,checkboxTextDontShowThis:xo,close:no,completed:Qn,confirmApplyAllLabel:fa,confirmCloseDialog:ro,confirmCloseDialogTitle:uo,confirmFileOverwriteMsg:ga,confirmFileOverwriteTitle:ha,confirmListOverwrite:ua,confirmListOverwriteMsg:ca,convertAgain:vo,convertTooltip:aa,convertUnpreparedTooltip:ya,convertedImageDataUrlTooltip:mo,convertedImageUrlTooltip:po,copiedDataURLDialogTitle:fo,copiedDataURLMessage:go,default:za,descriptions:Bn,disabled:_o,droptargetLabel:Wo,droptargetTooltip:Vo,dupAction_overwrite:ia,dupAction_prompt:sa,dupAction_replace:da,dupAction_skip:ra,editAcceptTypes:Hn,errMsgOutputDirNotFound:pa,errMsgWorkerLoadError:Mo,experimental:la,failed:zo,file:ma,fileTypeRadioOptions:Zn,fileTypeRadioTitle:jn,files:so,flags:On,folder:va,githubOpenSource:co,height:To,incomplete:Kn,installAsApp:qo,interfered:Yn,lang:Mn,loadbutton:ea,loadbuttontooltip:Vn,loadfolderNotifyingMessage:$o,loadfolderNotifyingMessageTerm1:Do,loadfolderNotifyingMessageTerm2:Fo,loadfolderNotifyingTitle:Io,loadfolderbutton:ta,loadfoldertooltip:Wn,metaDescription:Rn,noimage:Xn,open:oo,or:No,previousVersion:Co,processing:qn,reconvert:ao,reconvertTip:lo,reset:bo,resetListButtonTooltip:oa,save:to,selectLangCloseTooltip:Ko,selectLanguage:Nn,settings:yo,status:ho,success:So,threads:io,title:Un,warnAboutFileSysBeforeConversion1:_a,warnAboutFileSysBeforeConversion2:wa,warnAboutFileSysTitle:ba,warnAboutResetMsg:ka,width:Ao},Symbol.toStringTag,{value:"Module"})),vs="Arabic",hs="German",ys="English",_s="Spanish",ws="Finnish",bs="French",ks="Hindi",zs="Indonesian",Ss="Italian",Cs="Japanese",Ts="Korean",As="Dutch",xs="Polish",Is="Portuguese",Ls="Russian",$s="Turkish",Fs="Ukrainian",Es="Chinese",Ps={ar:vs,de:hs,en:ys,es:_s,fi:ws,fr:bs,hi:ks,id:zs,it:Ss,ja:Cs,ko:Ts,nl:As,pl:xs,pt:Is,ru:Ls,tr:$s,uk:Fs,"zh-hant":"Chinese(hant)",zh:Es},_t=[],Sa={en:za},Gt={},an=Object.assign({"./locales/ar.json":()=>xe(()=>import("./ar-Cq3xFD0d.js"),[]),"./locales/de.json":()=>xe(()=>import("./de-BYyL2Q8a.js"),[]),"./locales/en.json":()=>xe(()=>Promise.resolve().then(()=>ms),void 0),"./locales/es.json":()=>xe(()=>import("./es-y3kENsfK.js"),[]),"./locales/fi.json":()=>xe(()=>import("./fi-BOOsWj3A.js"),[]),"./locales/fr.json":()=>xe(()=>import("./fr-DBPGR-AH.js"),[]),"./locales/hi.json":()=>xe(()=>import("./hi-C0yXRgeK.js"),[]),"./locales/id.json":()=>xe(()=>import("./id-BKh816kV.js"),[]),"./locales/it.json":()=>xe(()=>import("./it-BZjU0Iw8.js"),[]),"./locales/ja.json":()=>xe(()=>import("./ja-DWhNn72H.js"),[]),"./locales/ko.json":()=>xe(()=>import("./ko-DcgjgIJ8.js"),[]),"./locales/nl.json":()=>xe(()=>import("./nl-C0-dxknq.js"),[]),"./locales/pl.json":()=>xe(()=>import("./pl-BT6NOQ9_.js"),[]),"./locales/pt.json":()=>xe(()=>import("./pt-CpN3z_92.js"),[]),"./locales/ru.json":()=>xe(()=>import("./ru-GLKsqtkO.js"),[]),"./locales/tr.json":()=>xe(()=>import("./tr-jnx2eT_g.js"),[]),"./locales/uk.json":()=>xe(()=>import("./uk-q8xUtVmg.js"),[]),"./locales/zh-hant.json":()=>xe(()=>import("./zh-hant-DrVla1ow.js"),[]),"./locales/zh.json":()=>xe(()=>import("./zh-CbAaPGeL.js"),[])});var gn;for(const i in an){const s=(gn=i.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:gn[1];s&&(_t.push(s),!(s in Sa)&&(Gt[s]=an[i]))}let jt=Ms();jt in Gt||(jt="en");const xt=Na({legacy:!1,globalInjection:!0,locale:jt,fallbackLocale:"en",messages:Sa,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Ds(i){if(xt.global.availableLocales.indexOf(i)>=0)return!0;const s=await Gt[i]().catch(u=>{});return s?(xt.global.setLocaleMessage(i,s),await $e(),!0):!1}function Ms(){const i=location.pathname;return String(i.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Os=ye({__name:"header",setup(i){const s=hn(),{locale:u}=je();return(l,o)=>{const a=Zt("router-link"),r=Ce,c=yn;return L(),J(r,{vertical:"",justify:"start"},{default:e(()=>[n(r,{justify:"space-between",align:"center",wrap:!1},{default:e(()=>[n(r,{align:"center"},{default:e(()=>[n(ts),n(us),n(ps,{url:"/avif2jpeg/dist/commits.txt"}),n(os),n(r,{style:{"font-size":"1em"}},{default:e(()=>[t(s).path!=="/"?(L(),J(a,{key:0,to:"/",style:{color:"black"}},{default:e(()=>o[0]||(o[0]=[$("HOME")])),_:1,__:[0]})):me("",!0)]),_:1})]),_:1}),n(r,{align:"end",id:"langtarget"},{default:e(()=>[st(l.$slots,"lang-switch")]),_:3})]),_:3}),n(c,{style:{margin:"0px"}})]),_:3})}}}),Us="/avif2jpeg/dist/pwa-64x64.png",Rs={class:"title"},Bs=ye({__name:"title",setup(i){const s=Ht();return Se(()=>{const u=s.currentRoute.value.path||"";return!String(u.match(new RegExp("(?<=^\\/)[^/]+"))||"")}),(u,l)=>{const o=Ce;return L(),J(o,{vertical:"",align:"center",justify:"center",style:{margin:"0px"},size:1},{default:e(()=>[_("h1",Rs,[l[0]||(l[0]=_("img",{src:Us,style:{height:"1em","vertical-align":"middle"}},null,-1)),$(" "+d(u.$t("title")),1)])]),_:1})}}}),Ns=Oe(Bs,[["__scopeId","data-v-0b61dfe0"]]),js={viewBox:"0 0 15 16",width:"1.13em",height:"1.2em"};function Zs(i,s){return L(),q("svg",js,s[0]||(s[0]=[ja('<path fill="currentColor" d="m6.22 8.14l-3.17 4.28c-.18.24 0 .58.29.58h6.32c.3 0 .47-.34.29-.58L6.8 8.14c-.14-.2-.44-.2-.58 0"></path><path fill="currentColor" d="m9.72 10.09l-1.9 2.57c-.11.14 0 .35.17.35h3.79c.18 0 .28-.2.17-.35l-1.89-2.57a.215.215 0 0 0-.35 0Z"></path><circle cx="10" cy="8" r="1" fill="currentColor"></circle><path fill="currentColor" d="M12.5 16h-10c-.83 0-1.5-.67-1.5-1.5v-13C1 .67 1.67 0 2.5 0h7.09c.4 0 .78.16 1.06.44l2.91 2.91c.28.28.44.66.44 1.06V14.5c0 .83-.67 1.5-1.5 1.5M2.5 1c-.28 0-.5.22-.5.5v13c0 .28.22.5.5.5h10c.28 0 .5-.22.5-.5V4.41a.47.47 0 0 0-.15-.35L9.94 1.15A.5.5 0 0 0 9.59 1z"></path><path fill="currentColor" d="M13.38 5h-2.91C9.66 5 9 4.34 9 3.53V.62c0-.28.22-.5.5-.5s.5.22.5.5v2.91c0 .26.21.47.47.47h2.91c.28 0 .5.22.5.5s-.22.5-.5.5"></path>',5)]))}const Hs=ot({name:"formkit-fileimage",render:Zs}),Vs={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ws(i,s){return L(),q("svg",Vs,s[0]||(s[0]=[_("path",{fill:"currentColor",d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm0-2h16V8h-8.825l-2-2H4zm0 0V6z"},null,-1)]))}const Ca=ot({name:"material-symbols-folder-outline",render:Ws}),qs={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Gs(i,s){return L(),q("svg",qs,s[0]||(s[0]=[_("path",{fill:"currentColor",d:"M12 .037C5.373.037 0 5.394 0 12s5.373 11.963 12 11.963c6.628 0 12-5.357 12-11.963S18.627.037 12 .037m-.541 4.8c1.91-.13 3.876.395 5.432 1.934c1.426 1.437 2.51 3.44 2.488 5.317h2.133l-4.444 4.963l-4.445-4.963h2.313c-.001-1.724-.427-2.742-1.78-4.076c-1.325-1.336-2.667-2.11-4.978-2.303a9.2 9.2 0 0 1 3.281-.871zM6.934 6.95l4.445 4.963H9.066c0 1.724.426 2.742 1.778 4.076c1.326 1.336 2.667 2.112 4.978 2.305c-2.684 1.268-6.22 1.398-8.71-1.064c-1.427-1.437-2.512-3.44-2.489-5.317H2.488z"},null,-1)]))}const Ks=ot({name:"simple-icons-convertio",render:Gs}),ln=new Set,Qs=new Set,Ys=new Set,It=new Map;function Xs(i){const s=It.get(i);s&&(It.delete(i),s(),St==null||St(),St=null)}function Js(){for(const i of It.keys())Xs(i)}let St=null;function Ta(){Js();for(const i of ln)i.onmessage=null,i.terminate();ln.clear(),Qs.clear(),Ys.clear(),It.clear()}function ei(i){return new Worker("/avif2jpeg/dist/assets/worker.zip-Bt_6u_43.js",{name:i==null?void 0:i.name})}function ti(i){return new Worker("/avif2jpeg/dist/assets/worker.loader-S4gdDaLf.js",{name:i==null?void 0:i.name})}function ni(){return typeof window.showDirectoryPicker=="function"}async function oi(){let i,s;try{s=await window.showDirectoryPicker(),s&&(i=await s.quryPermission({mode:"readwrite"}),i!=="granted"&&(i=await s.requestPermission({mode:"readwrite"})))}catch{}if(i!=="granted")try{i=await s.requestPermission({mode:"readwrite"})}catch{return null}return i==="granted"?s:null}async function ai(i,s,u){const l=s.split("/"),o=l.pop();let a=i;for(const c of l)a=await a.getDirectoryHandle(c);const r=await a.getFileHandle(o);return u?r.getFile():r}async function li(i,s){const u=s.split("/"),l=u.pop();let o=i;for(const a of u)o=await o.getDirectoryHandle(a);return await o.getDirectoryHandle(l)}async function si(i,s,u,l,o){const r=await(await i.getFileHandle(s,{create:!0})).createWritable();return await r.write(u),await r.close(),!0}async function ii(i,s,u,l){const o=u===!0;let a;try{if(a=await i.getDirectoryHandle(s,{create:o}),o)return a;!u||typeof u=="function"&&await u(i,s,l)}catch(r){if(r.name==="NotFoundError")a=await i.getDirectoryHandle(s,{create:!0});else throw r}return a}const sn=new Map;async function ri(i,s,u,l){let o=sn.get(i);o||(o={},sn.set(i,o));const a=[];let r=i,c;const f=typeof s=="string"?s.split("/"):s;c=f.join("/");do{if(o[c]){r=o[c],c+="/";break}a.unshift(f.pop()),c=f.join("/")}while(f.length);for(const w of a){if(!w)throw new Error("folderName is empty");if(r=await ii(r,w,u,c),!r)return null;o[c+w]=r,c+=w+"/"}return r}async function ui(i,s,u,l){const o=s.split("/"),a=o.pop();if(!a)throw new Error("fileName is empty");const r=o.length?await ri(i,o,l):i;return r?await si(r,a,u,l,o.length?o.join("/")+"/":""):!1}function ci(i){const s=new Set;for(const u of i){const o=u.webkitRelativePath.split("/");do{o.pop();const a=o.join("/");if(s.has(a))break;s.add(a)}while(o.length>=2)}return s}async function di(i,s){const l=[...ci(s)].sort(),o=new Set;let a,r="";for(let c of l){let f=c;r&&c.startsWith(r+"/")?f=f.slice(r.length+1):a=i;try{a=await li(a,f),o.add(c),r=c}catch{r=""}}return o}const pi=1e3*10;let tt;const Ne=new Map,bt=new Map,Lt=new Map;let j;function Mt(i){tt=null,Ne.clear(),bt.clear(),Lt.clear(),bt.clear(),Lt.clear(),j={...i}}async function fi(i){Mt(i),j.completedFileIdSet.clear(),j.completedFileDat.length=0;let s;try{s=await gi()}catch{return Mt(),{exception:new Error("worker-load-error"),callbackToClearConverter:new Function,callbackToGenerateFailedZips:new Function}}const[u,l]=s;tt=l;const o=new Promise(g=>{l.onmessage=S=>{const T=S.data,{action:p}=T;switch(p){case"squeeze-zip":case"zip-squeeze-error":g(void 0);break}}}),a=new Promise(g=>{u.onmessage=S=>{const{data:{action:T}}=S;T==="close-loader"&&g()}}),r=j.files.map(g=>[g._id,g.webkitRelativePath]);j.files.forEach(g=>bt.set(g._id,g));const c=be(j.canceled,g=>{if(!g)return;c();const S={action:"cancel-convert"};u.postMessage(S)}),f={action:"start-convert",list:j.files,extraPropsForList:r,outputQuality:j.quality,outputType:j.format,keepExt:j.props.retainExtension,outputExt:j.outputExt,fsysDirHandler:j.fsysDirHandler,existingFolders:j.existingFolders,threads:j.props.threads,maxSize:V.shrinkImage?{width:V.maxWidth,height:V.maxHeight}:null};u.postMessage(f),await a,l.postMessage({action:"squeeze"}),await o,c();const w=()=>{Ta(),l.onmessage=null,l.terminate(),u.onmessage=null,u.terminate(),Mt()};let k=!1;return{callbackToClearConverter:w,callbackToGenerateFailedZips:async g=>{k||(k=!0,await Si(g,l,{},j.ConvStats))}}}async function gi(){Ta();const i=new ti,s=new ei,u=new Promise((r,c)=>{const f=S=>{s.removeEventListener("message",z),i.removeEventListener("message",z),clearTimeout(g),S?r(S):c(S)};let w=!1,k=!1;const z=S=>{S.target===s&&(w=!0),S.target===i&&(k=!0),w&&k&&f(!0)};let g=0;s.addEventListener("message",z),i.addEventListener("message",z),g=window.setTimeout(()=>f(!1),pi)}),{port1:l,port2:o}=new MessageChannel,a={action:"set-zip-port"};return s.postMessage({action:"set-port-loader"},[l]),i.postMessage(a,[o]),await u,s.postMessage({action:"set-config",zipSize:j.props.maxZipSizeMB*1024*1024,keepExt:j.props.retainExtension,outputExt:j.outputExt,imageType:j.imageType}),i.addEventListener("message",vi),s.addEventListener("message",mi),[i,s]}const mi=i=>{const s=i.data,{action:u}=s;switch(u){case"add-zip-completed":{const{fileId:r,entireIndex:c,storedPath:f}=s;return}case"respond-image":{const{url:r,index:c,path:f,size:w,fileId:k}=s;j.ConvStats.convertedImageUrl=r,j.ConvStats.convertedImageSize=w,j.ConvStats.convertedImageIndex=c,j.ConvStats.convertedImageName=f;let z="",g=0,S="";const T=Ne.get(k);if(k>=0){const p=bt.get(k);z=URL.createObjectURL(p),g=p.size,S=p.webkitRelativePath||p.name}j.ConvStats.convertedImageOrgUrl=z,j.ConvStats.convertedImageOrgSize=g,j.ConvStats.convertedImageOrgName=S,j.ConvStats.convertedImageShrinked=T==null?void 0:T.shrinked;return}case"respond-delete":{const{index:r,success:c,fileId:f}=s;Ne.get(f).command="❌deleted",Ne.get(f).completed=!1;return}}switch(u){case"error-push-filelist-zip":const{path:r}=s;j.ConvStats.failedZipDone=!0,j.message.error(`an error occurred "${r}"`,{duration:3e3});return}const{size:l,count:o}=s,a="url"in i.data?i.data.url:"";switch(u){case"push-zip":j.ConvStats.zips.push({url:a,size:l,count:o}),j.ConvStats.zippedTotalCount+=o,j.ConvStats.zippedTotalSize+=l;break;case"squeeze-zip":o>0&&(j.ConvStats.zips.push({url:a,size:l,count:o}),j.ConvStats.zippedTotalCount+=o,j.ConvStats.zippedTotalSize+=l);break;case"push-filelist":j.ConvStats.failedFileZippedCount++;break;case"squeeze-filelist-zip":j.ConvStats.failedZipDone=!0;case"push-filelist-zip":j.ConvStats.failedZips.push({url:a,size:l,count:o});break;case"zip-error":case"zip-squeeze-error":j.ConvStats.zippingErrorCount+=o;break}},vi=async i=>{const s=i.target,{data:u}=i,{action:l}=u;switch(l){case"list-start":break;case"list-end":break;case"file-start":{const{index:o,path:a,fileId:r}=u;yi(o,a,r);break}case"file-load":{const{thumbnail:o,width:a,height:r,fileId:c,workerId:f,inputsize:w}=u,k=Ne.get(c);k.core=f,k.command="🖼️loaded",k.width=a,k.height=r,k.size=w,o&&(j.ConvStats.thumbnail=o);break}case"file-converted":{const{index:o,path:a,fileId:r,shrinked:c,outputWidth:f,outputHeight:w,outputsize:k,convertedImageBlob:z}=u,g=Ne.get(r);g.command="🔃converted",g.shrinked=g.shrinked==null?c:g.shrinked,g.outputWidth=f,g.outputHeight=w,g.outputSize=k,j.ConvStats.converted++;break}case"file-sys-completed":case"file-completed":{const{inputsize:o,outputsize:a,fileId:r,storedPath:c}=u,f=Ne.get(r);if(f&&(f.command="✅completed",f.completed=!0,f.fileId=r),j.ConvStats.inputTotalSize+=o,j.ConvStats.outputTotalSize+=a,j.ConvStats.done++,j.ConvStats.success++,j.completedFileIdSet.add(r),l==="file-sys-completed"&&(f.zippedIndex=j.completedFileDat.length,j.completedFileDat.push({path:c,id:r})),l==="file-completed"){const{entireIndex:w}=u;f.zippedIndex=w,j.ConvStats.ziplogs[w]={fileId:r,storedPath:c}}break}case"file-retry":{const{index:o,path:a,fileId:r}=u;_i(o,a,r);break}case"file-error":{const{index:o,path:a,fileId:r}=u;wi(o,a,r);break}case"file-canceled":{const{fileId:o,path:a}=u;bi(o);break}case"file-skip":{const{fileId:o,path:a}=u;ki(o);break}case"confirm-overwrite":{const{target:o,type:a,path:r,fileId:c,workerId:f}=u,w=await new Promise(k=>j.enqueueOverwriteConfirmation(k,o,a,r));s.postMessage({action:"respond-overwrite",command:w,target:o,path:r,fileId:c,workerId:f});break}}};let hi=0;function yi(i,s,u){const l={key:hi++,core:-1,index:i,path:s,command:"➡️started"};Ne.set(u,l),j.ConvStats.logs.push(l),Lt.has(u)||j.canceled.value||j.ConvStats.startedCount++}function _i(i,s,u){const l=Ne.get(u);l.command="⚠️retry",l.error=!0,j.ConvStats.retried++,Lt.set(u,1)}function wi(i,s,u){const l=Ne.get(u);j.ConvStats.done++,j.ConvStats.failure++,l.command="❗failed",l.error=!0}function bi(i){const s=Ne.get(i);j.ConvStats.done++,j.ConvStats.failure++,s.command="❗canceled",s.error=!0}function ki(i){const s=Ne.get(i);j.ConvStats.done++,j.ConvStats.failure++,s.command="⚠skipped",s.error=!0}async function zi(i){if(j.fsysDirHandler){const s=j.completedFileDat[i];if(!s)return;const u=s.id;let l="",o=0,a="";if(Ne.get(u),u>=0){const w=bt.get(u);l=URL.createObjectURL(w),o=w.size,a=w.webkitRelativePath||w.name}j.ConvStats.convertedImageOrgUrl=l,j.ConvStats.convertedImageOrgSize=o,j.ConvStats.convertedImageOrgName=a;const r=s.path,c=await ai(j.fsysDirHandler,r,!0),f=URL.createObjectURL(c);j.ConvStats.convertedImageUrl=f,j.ConvStats.convertedImageSize=c.size,j.ConvStats.convertedImageIndex=i,j.ConvStats.convertedImageName=s.path}else tt==null||tt.postMessage({action:"request-image",index:i})}function Ot(i){tt==null||tt.postMessage({action:"delete-image",index:i})}async function Si(i,s,u,l){let o=0;for(const a of i){const r=(a.webkitRelativePath||a.name).replace(/^\//,"");if(l.failedZipDone)break;if(u.value)return;o-l.failedFileZippedCount>20&&await new Promise(c=>setTimeout(c,10)),s.postMessage({action:"add-filelist",file:a,path:r}),o++}if(l.failedZipDone){j.message.error("Zipping error files was aborted",{duration:5e3});return}s.postMessage({action:"squeeze-filelist"})}let wt;async function Ci(i,s,u,l,o){let a="";const r=document.createElement("canvas"),c=r.getContext("2d");let f=new Bt;const w=[f],k=new Ol,z=u.format,g=u.quality/100,S=[...z.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),T=i.length,p=u.maxZipSizeMB*1024*1024;let E=0,y=null,m="",A="",v=0,x=0,B=0,P=0,R=0,ee=!1;wt=Y=>{const[Z,H]=k.get(Y),N=w[Z],ie=N.get(H,z);o.convertedImageIndex=Y,o.convertedImageName=N.getPathByIndex(H),o.convertedImageUrl=URL.createObjectURL(ie),o.convertedImageSize=ie.size;let se="",ue=0,_e="";const K=Q[Y];se=URL.createObjectURL(K),ue=K.size,_e=K.webkitRelativePath||K.name,o.convertedImageOrgUrl=se,o.convertedImageOrgSize=ue,o.convertedImageOrgName=_e};const Q=[];for(const Y of i){if(l.value)break;const Z=Y.name;let H="";const N=Y.size,ie=(Y.webkitRelativePath||Y.relativePath||Z).replace(/^\//,""),se=document.createElement("img"),ue={key:B++,core:-1,index:E++,path:ie,command:"➡️start"};o.startedCount=E,o.logs.push(ue),o.logs.length-1,a&&(URL.revokeObjectURL(a),a=""),a=URL.createObjectURL(Y),A=a,v=Y.size,se.src=a;const _e=await Aa(se).then(()=>!0).catch(()=>!1);if(!se.complete||!_e||l.value){o.done++,o.failure++,ue.command="❗failed";continue}const K=se.width,Ee=se.height;r.width=K,r.height=Ee,c.drawImage(se,0,0,K,Ee,0,0,K,Ee),ue.command="🖼️imgload",ue.width=K,ue.height=Ee,ue.size=Y.size,o.thumbnail=se;const de=await new Promise(we=>{const Ue=Re=>{y=Re,we(Re)};r.toBlob(Ue,z,g)});if(l.value)break;if(!de){o.failure++;continue}x=de.size,o.converted++,ue.outputSize=x;let ke="";if(R+x>=p){try{await f.wait(),ke=await f.url()}catch{ee=!0,alert("memory problem occurred");break}o.zips.push({url:ke,size:R,count:P}),o.zippedTotalCount+=P,o.zippedTotalSize+=R,R=0,P=0,k.split(),f=new Bt,w.push(f)}R+=x;const ce=ie||Z;for(let we=1;we<255&&(H=ce.replace(u.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(we>1?`(${we})`:"")+"."+S,!!f.has(H));we++);o.done++;try{P++,f.add(H,de)}catch{continue}k.increase(),Q.push(Y),o.inputTotalSize+=N,o.outputTotalSize+=x,o.ziplogs.push({fileId:Y._id,storedPath:H}),m=H,ue.zippedIndex=o.success,o.success++,ue.command="✅completed",ue.completed=!0,ue.fileId=Y._id,s.add(Y._id)}if(o.success>0)if(T===1)y&&(o.convertedImageIndex=0,o.convertedImageName=m.replace(/^.*\/(?=[^/]+$)/,"").replace(u.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+S,o.convertedImageUrl=URL.createObjectURL(y),o.convertedImageOrgUrl=A,o.convertedImageOrgSize=v);else try{if(ee)throw new Error("terminated zipping process for memory problems");await f.wait();const Y=await f.url();o.zips.push({url:Y,count:P,size:R}),o.zippedTotalCount+=P,o.zippedTotalSize+=R}catch{}const O={value:!1},C=()=>{O.value=!0,w.forEach(Y=>Y.clear()),w.length=0,Q.length=0,wt=null};let ae=!1;return{callbackToClearConverter:C,callbackToGenerateFailedZips:async Y=>{ae||(ae=!0,Ai(Y,p,o,O))}}}function Ti(i){wt==null||wt(i)}async function Ai(i,s,u,l){let o=0,a=0,r=new Bt;for(let c=0;c<i.length;c++){const f=i[c],w=(f.webkitRelativePath||f.name).replace(/^\//,"");if(l.value)return;try{await r.add(w,f)}catch{alert(`an error occurred during access to "${w}"`);break}if(a+=f.size,o++,u.failedFileZippedCount++,a>=s||c===i.length-1){await r.zip();const k=await r.url();u.failedZips.push({url:k,size:a,count:o}),r.clear(),a=0,o=0}}u.failedZipDone=!0}function Aa(i){if(typeof i.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((s,u)=>{i.onload=s,i.onerror=u})}const xi=["href","download","title"],Ii='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',Li=ye({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean},hidden:{type:Boolean}},emits:["load","error","next","prev"],setup(i,{expose:s,emit:u}){const{t:l}=je(),o=i,a=u,r=h();h();const c=h(!0),f=h(""),w=h(o.width||100),k=h(o.height||100),z=h(!1),g=$t({width:w.value+"px",height:k.value+"px",minWidth:"50px",minHeight:"50px"});et(()=>{var A,v,x;(v=(A=r.value)==null?void 0:A.previewInstRef)==null||v.setPreviewSrc(Ii),URL.revokeObjectURL((((x=r.value)==null?void 0:x.imageRef)||{}).src),r.value=null});const S=h(!0);Za(()=>{S.value=!1}),Ha(()=>{S.value=!0}),be(o,(A,v)=>{g.width=(o.width||100)+"px",g.height=(o.height||100)+"px"}),be(()=>o.src,(A,v)=>{S.value&&E(A)},{immediate:!0}),s({download:y,openPreview:m,active:S});async function T(A){const v=A.target,x=v.naturalWidth,B=v.naturalHeight,{width:P,height:R}=$n({width:x,height:B},{width:o.maxWidth||100,height:o.maxHeight||100},o.expand);w.value=P,k.value=R,a("load",{src:v.src,width:x,height:B}),c.value=!1,await new Promise(ee=>setTimeout(ee,100)),!c.value&&(z.value=!0)}function p(A){const v=A.target;a("error",v.src)}async function E(A){c.value=!0,z.value=!1,f.value=A}function y(){const A=document.createElement("a");A.href=f.value,A.download=o.fileName,A.click()}function m(){var A;(A=r.value)==null||A.click()}return(A,v)=>{const x=_n,B=wn,P=Ce,R=Vt;return Ge((L(),q("div",null,[n(t(ze),null,{trigger:e(()=>[n(R,{show:t(c)||o.loading},{default:e(()=>[n(P,{justify:"center",align:"center",style:pe([t(g),{"line-height":"0px"}])},{default:e(()=>[Ge(_("a",{href:t(f),onClick:v[0]||(v[0]=ct(()=>{},["left","prevent"])),target:"_blank",download:o.fileName,title:o.fileName},[n(qe,{mode:"in-out"},{default:e(()=>[Ge(n(x,{ref_key:"nImageRef",ref:r,"show-toolbar-tooltip":"",onLoad:T,onError:p,src:t(f),width:t(w),height:t(k),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[Ke,t(z)]])]),_:1})],8,xi),[[Ke,!(t(c)||o.loading)]]),Ge(n(B,null,null,512),[[Ke,t(c)||o.loading]])]),_:1},8,["style"])]),_:1},8,["show"])]),default:e(()=>[$(" "+d(o.fileName),1)]),_:1})],512)),[[Ke,!A.hidden]])}}}),rn=Oe(Li,[["__scopeId","data-v-a62add3a"]]),$i=["href","download","title"],Fi={class:"left-num"},Ei={class:"right-num"},Pi=["href","download","title"],Di={class:"left-num"},Mi={class:"right-num"},Oi=["href","download"],Ui=ye({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean},variousInfo:{}},emits:["demand-image","delete-image","close"],setup(i,{expose:s,emit:u}){const l=at(Qe),o=i,a=u;s({download:Ee,cleanup:re,openPreview:W,isPreviewing(){return P.value},changeIndex(U){S.value=U}});const r=pt(),{t:c}=je();Ft();const f=h(),w=h(),k=h(),z=dt("viewerItemContainer"),g=h(!0),S=h(Math.max(o.index,0)+1),T=h(1),p=h(1),E=h(""),y=h(""),m=h(1),A=h(1),v=h(!1),x=h(!1),B=h(!1),P=Se(()=>{var U,D;return(D=(U=k.value)==null?void 0:U.previewInstRef)==null?void 0:D.displayed}),R=Se(()=>{var U,D;return((D=(U=k==null?void 0:k.value)==null?void 0:U.previewInstRef)==null?void 0:D.previewSrc)===E.value}),ee=Se(()=>S.value<o.length),Q=Se(()=>S.value>1),O=h("viewer-item-init"),C=h(0),ae=h(!0);h({width:"auto",height:"auto"});const fe=h(!1);Me(()=>{document.body.addEventListener("keydown",ue),document.body.addEventListener("keydown",se),N(S.value-1),ie()}),et(()=>{clearTimeout(Y),document.body.removeEventListener("keydown",ue),document.body.removeEventListener("keydown",se),fe.value=!0}),At(()=>{URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl)});let Y=-1;be(S,(U,D)=>{S.value<1||S.value>o.length||U===D||(clearTimeout(Y),U>D?O.value="viewer-item-next":O.value="viewer-item-prev",Y=setTimeout(()=>{o.index!==S.value-1&&(C.value=g.value?C.value:~C.value,ae.value=!1,N(S.value-1))},50))});let Z="",H="";be(()=>o.url,()=>{var b,F;let U="";o.index===0&&g.value?(g.value=!1,S.value=1,U=o.url):o.index===S.value-1?(g.value=!1,v.value=!1,U=o.url):(URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl));const D=Z,te=H;if(URL.revokeObjectURL(D),URL.revokeObjectURL(te),Z=o.url,H=o.originalUrl,U){try{if((F=(b=k.value)==null?void 0:b.previewInstRef)!=null&&F.displayed){R.value?k.value.previewInstRef.setPreviewSrc(U):k.value.previewInstRef.setPreviewSrc(o.originalUrl);try{const X=k.value.previewInstRef.displayed;k.value.previewInstRef.handleAfterLeave(),k.value.previewInstRef.displayed=X}catch{}}}catch{}E.value=U,y.value=o.originalUrl}},{immediate:!0});function N(U){v.value=!0,x.value=!1,B.value=!1,$e(()=>a("demand-image",U))}function ie(){if(!l.IS_SP)return;let U=z.value.$el,D=0,te=0,b=0,F=0,X=0;const he=ne=>{D=ne.touches[0].pageX,te=ne.touches[0].pageY,X=Date.now()};U.addEventListener("touchstart",he);const M=ne=>{b=ne.touches[0].pageX,F=ne.touches[0].pageY,G()};window.addEventListener("touchmove",M);const I=()=>{G();const ne=b-D,oe=Math.abs(ne),ve=F-te,ge=Math.abs(ve);oe<ge||oe<30||ke(ne>0?-1:1)};window.addEventListener("touchend",I);const G=()=>{const ne=Date.now();ne-X>500&&(D=b,te=F),X=ne};et(()=>{U.removeEventListener("touchstart",he),window.removeEventListener("touchmove",M),window.removeEventListener("touchend",I),U=null})}function se(U){var D,te,b,F;if(U.key==="Escape")try{(te=(D=k.value)==null?void 0:D.previewInstRef)!=null&&te.displayed&&(U.stopPropagation(),(F=(b=k.value)==null?void 0:b.previewInstRef)==null||F.toggleShow(!1))}catch{}}function ue(U){switch(U.code){case"ArrowRight":ke(1);break;case"ArrowLeft":ke(-1);break;case"Home":S.value=1;break;case"End":S.value=o.length;break;case"Space":case"Enter":case"NumpadEnter":if(!P.value)return;we();break;case"ArrowUp":case"ArrowDown":default:return}U.stopPropagation(),U.preventDefault()}function _e({width:U,height:D}){T.value=U,p.value=D,x.value=!0}function K({width:U,height:D}){m.value=U,A.value=D,B.value=!0}function Ee(){R.value?f.value.download():w.value.download()}async function de(U){try{const D=await fetch(U).then(te=>te.blob()).then(te=>new Promise(b=>{const F=new FileReader;F.onload=b,F.readAsDataURL(te)})).then(te=>te.target.result);navigator.clipboard.writeText(D),r.info({title:c("copiedDataURLDialogTitle"),content:()=>le("div",[le("div",c("copiedDataURLMessage"))]),positiveText:"OK"})}catch{r.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function ke(U){U>0?S.value=Math.min(o.length,S.value+U)|0:U<0&&(S.value=Math.max(1,S.value+U)|0)}let ce="";const we=()=>{var D,te,b,F;ce=(b=window.getComputedStyle((te=(D=k==null?void 0:k.value)==null?void 0:D.previewInstRef)==null?void 0:te.previewRef))==null?void 0:b.transform;const U=R.value;(F=k==null?void 0:k.value)==null||F.next(),$e(()=>{var X;R.value===U&&((X=k==null?void 0:k.value)==null||X.next())})};function Ue(){try{$e(()=>k.value.previewInstRef.previewRef.style.transform=ce)}catch{}}function Re({nodes:U}){const D=le(kn,{color:R.value?"green":"gray",offset:[-20,-12],value:R.value?c("status.Converted"):c("status.Original")},()=>le(Fe,{round:!0,onClick(){we()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>le(R.value?Ga:Ka)}));U.next=le(Fe,{onClick(){ke(1)},disabled:!ee.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>le(en)}),U.prev=le(Fe,{onClick(){ke(-1)},disabled:!Q.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>le(Qa)});try{const te=U.download.children;te.default=()=>c("save");const b=te.trigger();b.props.onClick=Ee,te.trigger=()=>b}catch{}return We(),[D,...Object.values(U)]}const Ye="#pathbox-"+String(Math.random()).substring(2);let De;function We(){var U,D,te;try{if(De=(te=(D=(U=k.value)==null?void 0:U.previewInstRef)==null?void 0:D.previewWrapperRef)==null?void 0:te.parentNode,!De||De.querySelector(Ye))return;let b=le("div",{id:Ye,onMousedown:F=>{F.stopPropagation()},className:"__preview-injected-pathbox"+(R.value?" converted":"")},[le("div",`${String(S.value).padStart(String(o.length).length,"0")}/${String(o.length).padStart(String(o.length).length,"0")}`),le("div",He(R.value?o.size:o.originalSize,0)),le("div",R.value?o.name:o.originalName)]);tn(b,De),b=null}catch{}}et(()=>{De&&(tn(null,De),De=null)});function W(){f.value.openPreview()}function re(){}return(U,D)=>{const te=Ae,b=Ce,F=bn,X=lt,he=Et,M=Va;return L(),J(b,{justify:"center",align:"stretch",vertical:"",style:pe([{visibility:g.value?"hidden":"visible"},{overflow:"visible"}]),class:"body",ref:"body"},{default:e(()=>[n(M,{ref_key:"nImageGroupRef",ref:k,"show-toolbar-tooltip":"","render-toolbar":Re,onPreviewNext:Ue},{default:e(()=>[n(b,{wrap:!1,align:"center",justify:"space-between",style:{overflow:"visible"}},{default:e(()=>[n(t(Fe),{onClick:D[0]||(D[0]=I=>ke(-1)),bordered:!1,disabled:!t(Q),class:nt({"thumb-arrow":!0,pale:!t(Q)}),title:U.$t("Prev")},{icon:e(()=>[n(te,{size:"30"},{default:e(()=>[n(t(Wa))]),_:1})]),_:1},8,["disabled","class","title"]),n(b,{justify:"center",ref_key:"viewerItemContainer",ref:z,class:"viewer-item-container",style:{width:"100%"}},{default:e(()=>[n(qe,{name:O.value},{default:e(()=>[(L(),J(b,{vertical:"",key:C.value},{default:e(()=>[n(b,{align:"center",wrap:!1},{default:e(()=>[n(b,{vertical:""},{default:e(()=>[n(b,{align:"center",justify:"center",wrap:!1},{default:e(()=>[n(b,{align:"center",justify:"center",vertical:"",class:"original-thumb"},{default:e(()=>[_("a",{href:U.originalUrl,onClick:D[4]||(D[4]=ct(I=>{w.value.openPreview()},["prevent"])),download:U.originalName,title:U.originalName,class:"imglink"},[n(b,{align:"center",justify:"center",wrap:!1},{default:e(()=>[n(rn,{ref:I=>{I!=null&&I.active&&(w.value=I)},src:y.value,width:1,"max-width":1,"max-height":1,loading:v.value,"file-name":U.originalName,"allow-next":S.value<o.length,"allow-prev":S.value>1,onLoad:K,onNext:D[1]||(D[1]=I=>ke(1)),onPrev:D[2]||(D[2]=I=>ke(-1)),hidden:!0},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(b,{vertical:"",align:"center"},{default:e(()=>[n(b,{class:"imglink-label"},{default:e(()=>[$(d(t(c)("status.Original")),1)]),_:1}),n(b,{justify:"center",class:"img-size",wrap:!1,size:2},{default:e(()=>[_("span",Fi,d(B.value?m.value:"?"),1),D[11]||(D[11]=$(" × ")),_("span",Ei,d(B.value?A.value:"?"),1)]),_:1,__:[11]}),n(b,{justify:"center"},{default:e(()=>[D[3]||(Jt(-1,!0),(D[3]=n(b,null,{default:e(()=>[$(d(B.value?t(He)(o.originalSize,0):"?"),1)]),_:1})).cacheIndex=3,Jt(1),D[3])]),_:1})]),_:1})]),_:1})],8,$i)]),_:1}),n(b,{vertical:"",align:"center",class:"original-thumb"},{default:e(()=>[n(te,{size:"20",color:"silver",component:t(en)},null,8,["component"])]),_:1}),_("a",{href:E.value,onClick:D[5]||(D[5]=ct(I=>W(),["prevent"])),download:o.name,title:o.name,class:"imglink"},[n(b,{vertical:"",align:"center",justify:"center"},{default:e(()=>[n(b,{class:"imglink-label"},{default:e(()=>[$(d(t(c)("status.Converted")),1)]),_:1}),n(b,{vertical:"",align:"center",justify:"center",size:0},{default:e(()=>[n(b,{justify:"center"},{default:e(()=>{var I;return[n(b,{wrap:!1,style:pe((I=o.variousInfo)!=null&&I.shrinked?{color:"blue"}:{}),class:"img-size",size:2},{default:e(()=>[_("span",Di,d(x.value?T.value:"?"),1),D[12]||(D[12]=$(" × ")),_("span",Mi,d(x.value?p.value:"?"),1)]),_:1,__:[12]},8,["style"])]}),_:1})]),_:1}),n(b,{justify:"center"},{default:e(()=>[$(d(x.value?t(He)(o.size,0):"?"),1)]),_:1})]),_:1})],8,Pi)]),_:1}),n(b,{ref:"fileNameContainer",justify:"center",align:"center",class:"pathbox",title:o.name,style:{overflow:"hidden"}},{default:e(()=>[n(F,{"x-scrollable":!0,trigger:"hover",style:{"text-align":"center","font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:e(()=>[$(d(x.value?o.name:"?"),1)]),_:1})]),_:1},8,["title"])]),_:1}),n(b,{vertical:"",style:{overflow:"visible"}},{default:e(()=>[n(rn,{ref:I=>{I!=null&&I.active&&(f.value=I)},src:E.value,width:142,"max-width":140,"max-height":100,loading:v.value,"file-name":o.name,"allow-next":S.value<o.length,"allow-prev":S.value>1,onLoad:_e,onNext:D[6]||(D[6]=I=>ke(1)),onPrev:D[7]||(D[7]=I=>ke(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(b,{justify:"center",align:"center",wrap:!1},{default:e(()=>[n(X,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:e(()=>[_("a",{href:o.url,ref:"saveImg",target:"_blank",download:o.name,style:{"line-height":"1em"}},[n(t(Fe),{disabled:!x.value,round:"",size:"tiny"},{default:e(()=>[$(d(U.$t("save")),1)]),_:1},8,["disabled"])],8,Oi)]),default:e(()=>[$(" "+d(U.$t("save")),1)]),_:1}),n(X,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:e(()=>[n(t(Fe),{disabled:!x.value,onClick:D[8]||(D[8]=I=>de(o.url)),round:"",size:"tiny"},{default:e(()=>D[13]||(D[13]=[$("DataURL")])),_:1,__:[13]},8,["disabled"])]),default:e(()=>[$(" "+d(U.$t("convertedImageDataUrlTooltip")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["name"])]),_:1},512),n(t(Fe),{bordered:!1,onClick:D[9]||(D[9]=I=>ke(1)),disabled:!t(ee),class:nt({"thumb-arrow":!0,next:!0,pale:!t(ee)}),title:U.$t("Next")},{icon:e(()=>[n(te,{size:"30"},{default:e(()=>[n(t(qa))]),_:1})]),_:1},8,["disabled","class","title"])]),_:1}),U.isSingle?me("",!0):(L(),J(b,{key:0,justify:"center",align:"center",wrap:!1,size:4},{default:e(()=>[n(he,{value:S.value,"onUpdate:value":D[10]||(D[10]=I=>S.value=I),tooltip:!1,step:1,min:1,max:o.length,keyboard:!1,class:"index-slider"},null,8,["value","max"]),n(b,{class:"index",align:"center",justify:"center",wrap:!1,size:3},{default:e(()=>[n(b,null,{default:e(()=>[$(d(t(c)("status.index"))+":",1)]),_:1}),n(b,{justify:"end",align:"center",class:"counter"},{default:e(()=>[$(d(S.value),1)]),_:1}),n(b,null,{default:e(()=>D[14]||(D[14]=[$("/")])),_:1,__:[14]}),n(b,{justify:"start",align:"center",class:"counter"},{default:e(()=>[$(d(o.length),1)]),_:1})]),_:1})]),_:1}))]),_:1},512)]),_:1},8,["style"])}}}),Ri=Oe(Ui,[["__scopeId","data-v-493984f3"]]),Bi={key:0},Ni={style:{}},ji={key:1},Zi={key:2,style:{color:"red"}},Hi={key:1,style:{width:"106px",height:"80px",opacity:"0.15",border:"1px solid gray"}},Vi=ye({__name:"status.progress",props:{processing:{type:Boolean},successPerc:{},elapsedTime:{},threads:{},fileType:{},shrink:{},zipSize:{},outputToDir:{type:Boolean},inputTotalSize:{},outputTotalSize:{},rateColor:{},difColor:{},totalSizeDifStr:{},thumbnail:{},opened:{type:Boolean}},setup(i){const s=i,u=h(null),l={W:110,H:80};let o;return be(()=>[s.thumbnail,s.opened],()=>{if(!s.thumbnail||!s.opened||s.thumbnail===o||!u.value)return;const{width:a,height:r}=$n(s.thumbnail,{width:l.W,height:l.H});u.value.width=a,u.value.height=r,u.value.style.width=a+"px",u.value.style.height=r+"px",s.thumbnail instanceof HTMLImageElement?u.value.getContext("2d").drawImage(s.thumbnail,0,0,a,r):(u.value.getContext("bitmaprenderer").transferFromImageBitmap(s.thumbnail),o=s.thumbnail,s.thumbnail.close())}),(a,r)=>{const c=Ce,f=Ya,w=ft;return L(),J(w,{name:"progress",style:{"white-space":"nowrap"}},{header:e(({collapsed:k})=>[n(c,{align:"center"},{default:e(()=>[$(d(a.$t("status.Progress"))+" ",1),k?(L(),q(Pe,{key:0},[$(" ("+d(a.successPerc|0)+"%) ",1)],64)):me("",!0)]),_:2},1024)]),default:e(()=>[n(c,{justify:"center",align:"center",size:0,wrap:!1,style:{"white-space":"nowrap","margin-top":"-1em","padding-bottom":"5px"}},{default:e(()=>[r[0]||(r[0]=_("div",{class:"grow"},null,-1)),n(c,{justify:"center",class:"grow",wrap:!1,style:{"z-index":"1"}},{default:e(()=>[n(c,{vertical:"",justify:"center",class:"left-column"},{default:e(()=>[n(f,{"tabular-nums":"",label:a.$t("status.elapsedTime")},{default:e(()=>[n(c,null,{default:e(()=>[$(d(a.elapsedTime),1)]),_:1})]),_:1},8,["label"]),n(f,{"tabular-nums":"",label:a.$t("status.multiThreading")},{default:e(()=>[n(c,{style:pe({color:a.threads?"":"red",fontSize:"0.7rem"})},{default:e(()=>[$(d(a.threads?a.$rt("{n} @:threads",a.threads):a.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(f,{"tabular-nums":"",label:a.$t("status.outputSettings")},{default:e(()=>[n(c,{vertical:"",justify:"end",style:{"font-size":"0.6rem","line-height":"0.6rem"}},{default:e(()=>[_("div",null,d(a.$t("settings.imageType"))+": "+d(a.fileType),1),a.shrink?(L(),q("div",Bi,[$(d(a.$t("status.Shrinking"))+": ",1),_("span",Ni,d(a.shrink[0])+"×"+d(a.shrink[1]),1)])):me("",!0),a.outputToDir?(L(),q("div",Zi,d(a.$t("status.outputToDir")),1)):(L(),q("div",ji,"Zip: "+d(a.zipSize)+"MB",1))]),_:1})]),_:1},8,["label"])]),_:1}),st(a.$slots,"center",{},void 0,!0),n(c,{vertical:"",style:{height:"100%"},justify:"center",class:"right-column"},{default:e(()=>[n(f,{"tabular-nums":"",label:a.$t("status.inputSize")},{default:e(()=>[n(c,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:e(()=>[$(d((a.inputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(f,{"tabular-nums":"",label:a.$t("status.outputSize")},{default:e(()=>[n(c,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:e(()=>[$(d((a.outputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(f,{"tabular-nums":"",label:a.$t("status.outInRate")},{default:e(()=>[n(c,{vertical:"",align:"end",justify:"start",style:{"font-size":"0.8em","font-family":"v-mono","line-height":"50%"}},{default:e(()=>[_("span",{style:pe({color:a.rateColor,fontSize:"larger"})},"× "+d((a.outputTotalSize/a.inputTotalSize||1).toFixed(2)),5),_("span",{style:pe({color:a.difColor})},"("+d(a.totalSizeDifStr)+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:3}),n(c,{class:"thumb-container",align:"center",style:{position:"relative"}},{default:e(()=>[n(c,{justify:"center",align:"center",class:"grow thumbnail",style:pe({width:l.W+"px",height:l.H+"px"})},{default:e(()=>[n(qe,{name:"fade",mode:"out-in"},{default:e(()=>[a.processing?(L(),q("canvas",{key:0,ref_key:"thumbcanvas",ref:u,width:"106",height:"80",class:"thumb-canvas"},null,512)):(L(),q("div",Hi))]),_:1})]),_:1},8,["style"])]),_:1})]),_:3,__:[0]})]),_:3})}}}),Wi=Oe(Vi,[["__scopeId","data-v-51e086be"]]),qi={class:"status-table"},Gi={class:"started"},Ki={class:"mini-counter"},Qi={class:"failure"},Yi={class:"mini-counter"},Xi={colspan:"2"},Ji={class:"completed"},er={class:"main-counter"},tr={class:"total"},nr={class:"main-counter"},or=ye({__name:"status.progress-center",props:{processing:{type:Boolean},interval:{},statusColor:{},success:{},successTo:{},successFrom:{},index:{},length:{},failure:{},retried:{},successPercTo:{},successPercFrom:{}},setup(i){const s=i,u=Ft(),l=h(u.value.successColor),o=h(!1);return be(()=>s.processing,a=>{a||(s.success===s.length?o.value=!0:l.value=u.value.errorColor)}),(a,r)=>{const c=lt,f=Ae,w=vn,k=Ce,z=zn;return L(),J(z,{type:"multiple-circle","stroke-width":2,percentage:[a.successTo/a.length*100|0,a.index/a.length*100|0],color:[t(u).successColor,a.statusColor],"rail-style":[{stroke:t(l),opacity:.3}],style:{width:"12em"}},{default:e(()=>[n(k,{vertical:"",align:"center",justify:"center",size:0,style:{"white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:e(()=>[_("table",qi,[_("tbody",null,[_("tr",Gi,[_("td",null,d(a.$t("status.started"))+":",1),_("td",Ki,[n(c,{trigger:"hover",style:pe({color:t(u).infoColor}),placement:"left"},{trigger:e(()=>[_("span",{style:pe({color:t(u).infoColor})},d(a.index.toLocaleString("en-us")),5)]),default:e(()=>[$(" "+d(a.$t("status.progressStarted"))+" ("+d(a.index.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),_("tr",Qi,[_("td",null,d(a.$t("status.failure"))+":",1),_("td",Yi,[n(c,{trigger:"hover",style:pe({color:t(u).errorColor}),placement:"left"},{trigger:e(()=>[_("span",{style:pe({color:t(u).errorColor})},d(a.failure.toLocaleString("en-us")),5)]),default:e(()=>[$(" "+d(a.$t("status.progressErrors"))+" ("+d(a.failure.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"]),a.retried>0?(L(),J(c,{key:0,trigger:"hover",style:pe({color:t(u).warningColor}),placement:"left"},{trigger:e(()=>[_("span",{style:pe({color:t(u).warningColor})}," ("+d(a.retried.toLocaleString("en-us"))+") ",5)]),default:e(()=>[$(" "+d(a.$t("status.progressRetries"))+" ("+d(a.retried.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):me("",!0)])]),_("tr",null,[_("td",Xi,[n(k,{size:0,align:"center",justify:"center",style:pe({color:a.processing?a.statusColor:t(l)}),wrap:!1,class:"percent"},{default:e(()=>[t(o)?(L(),J(f,{key:0,component:t(Xa)},null,8,["component"])):me("",!0),n(w,{duration:a.interval*3|0,from:a.successPercFrom|0,to:a.successPercTo|0,active:!0},null,8,["duration","from","to"]),r[0]||(r[0]=$("% "))]),_:1,__:[0]},8,["style"])])]),_("tr",Ji,[_("td",null,d(a.$t("status.success"))+":",1),_("td",er,[n(c,{trigger:"hover",duration:0,delay:0,style:pe({color:t(u).successColor}),placement:"bottom"},{trigger:e(()=>[_("span",{style:pe({color:t(u).successColor})},[n(w,{duration:a.interval*3|0,from:a.successFrom,to:a.successTo,active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:e(()=>[$(" "+d(a.$t("status.progressSuccess"))+" ("+d(a.successTo.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),_("tr",tr,[_("td",null,d(a.$t("status.all"))+":",1),_("td",nr,[n(c,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:e(()=>[$(d(a.length.toLocaleString("en-us")),1)]),default:e(()=>[$(" "+d(a.$t("status.progressTotal"))+" ("+d(a.length.toLocaleString("en-us"))+") ",1)]),_:1})])])])])]),_:1})]),_:1},8,["percentage","color","rail-style"])}}}),ar={key:0,class:"log-table",ref:"table"},lr={class:"log-tr label"},sr=["title"],ir={style:{"min-width":"7em"},class:"log-th"},rr={style:{"padding-left":"2em"},class:"log-th"},ur=["data-index-loglist"],cr={class:"log-td"},dr={class:"log-td"},pr={class:"log-td"},fr={class:"log-td"},gr={key:0,class:"log-td log-extra",style:{"padding-left":"0.5em"}},mr={key:0},vr={key:1,style:{color:"blue"}},hr={key:1},un=2,cn=3e3,Ut=80,yr=100,_r=ye({__name:"status.log",props:Ve({processing:{type:Boolean},opened:{type:Boolean},previewCollapsed:{type:Boolean},logs:{},imageIndex:{}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},"auto-scroll":{type:Boolean,required:!1},"auto-scrollModifiers":{},order:{required:!1,default:"processed"},orderModifiers:{}}),emits:Ve(["open-preview","change-index"],["update:expanded","update:auto-scroll","update:order"]),setup(i,{emit:s}){const{t:u}=je(),l=i,o=Te(i,"expanded"),a=Te(i,"auto-scroll"),r=s;dt("table");const c=dt("tbody"),f=h(),w=h(null),k=h(40),z=Se(()=>o.value?k.value:Ut),g=h(Ut),S=Se(()=>{let b=l.logs;switch(A.value){case"success":b=b.filter(F=>F.completed);break;case"error":b=b.filter(F=>!F.completed);break}return b}),T=Bl(!1),E=h([{type:"group",label:()=>u("status.sort"),key:"sort",children:[{label:()=>u("status.sortByStart"),value:"processed"},{label:()=>u("status.sortByCompletion"),value:"zipped"},{label:()=>u("status.sortByName"),value:"name"},{label:()=>u("status.sortBySize"),value:"size"},{label:()=>u("status.sortByOutputSize"),value:"outputsize"},{label:()=>u("status.sortByStatus"),value:"status"}]}]),y=Te(i,"order");be(y,()=>{Re()});const m=[{label:()=>u("status.showAll"),value:""},{label:()=>u("status.showOnlySuccess"),value:"success"},{label:()=>u("status.showOnlyError"),value:"error"}],A=h(m[0].value);let v;Me(()=>{v=tl(),Q(),window.addEventListener("resize",()=>Q());const b=new ResizeObserver(()=>Q());b.observe(v.parent.parent.vnode.el),et(()=>{window.removeEventListener("resize",()=>Q()),b.disconnect()})}),et(()=>{clearTimeout(P),clearTimeout(ue),clearTimeout(C)});let x=0;be(()=>l.imageIndex,b=>B(b));async function B(b){var I;const F=b||l.imageIndex;let X=S.value.findIndex(G=>G.zippedIndex===F);X===-1&&(X=F);const he=X<=H.value,M=X>H.value+N.value;if(he||M){const G=X*ie.value-(M?z.value:0);(I=f.value)==null||I.scrollTo({behavior:"instant",top:G,left:W}),await $e(),de(!0),await $e()}$e(()=>{var ne,oe;let G=w.value;G&&(x>X&&(G=G.previousSibling||G,G instanceof HTMLElement||((ne=f.value)==null||ne.scrollTo(W,0),G=null)),(oe=G==null?void 0:G.scrollIntoView)==null||oe.call(G,{behavior:"instant",block:"nearest"}),x=X)})}be(()=>l.opened,b=>{$e(()=>{b&&(B(),de())})});let P;const R=h(document.documentElement.clientHeight),ee=h(100);function Q(){clearTimeout(P),P=setTimeout(()=>{if(!l.opened||!f.value)return;const b=f.value.$parent.$el.offsetHeight,F=window.innerHeight-v.parent.parent.parent.parent.parent.vnode.el.offsetHeight-8,X=Math.min(ie.value*Math.max(5,l.logs.length+2),Math.max(200,b+F));R.value=document.documentElement.clientHeight,ee.value=Math.min(ie.value*Math.max(5,l.logs.length),Math.max(Ut,X)),l.opened&&(k.value=Math.max(X,g.value))},100)}function O(){fe(!0),Q(),T.value=!0}let C=0,ae=!1;function fe(b=!1){if(!ae){if(C){ae=!0;return}$e(()=>{!b&&!a.value||(f.value.scrollTo({behavior:"instant",top:l.logs.length*50,left:W}),C=window.setTimeout(()=>{C=0,ae&&(ae=!1,fe())},yr))})}}const Y=h({height:"0px"}),Z=h({height:"0px"}),H=h(0),N=Se(()=>z.value/ie.value+un*2|0),ie=h(15);let se=0,ue=0,_e=0,K=-999,Ee=-1;function de(b){const F=Date.now();if(b!==!0){if(ue)return;if(F-_e<30){ue=window.setTimeout(()=>{ue=0,de()},30-(F-_e));return}}_e=F,!se&&l.logs.length&&(se=c.value.rows[1].offsetHeight,ie.value=se);const X=S.value.length,M=f.value.scrollbarInstRef.containerRef.scrollTop;if(!b&&X===Ee&&Math.abs(M-K)<ie.value*.5)return;K=M,Ee=X;const I=Math.max(0,(M/ie.value|0)-un);H.value=I,Y.value.height=I*ie.value+"px",Z.value.height=Math.max(0,X-(I+N.value))*ie.value+"px"}function ke(){var b;(b=f.value)==null||b.scrollTo(0,0),de()}be(()=>l.logs,()=>{l.opened&&($e(de),a.value&&fe(),Ue())});let ce=0,we=0;function Ue(){if(y.value==="processed"||!y.value)return;const b=Date.now();if(b-we<cn){if(ce)return;ce=window.setTimeout(Ue,cn-(b-we));return}ce=0,we=b,Re()}function Re(){switch(y.value){case"zipped":l.logs.sort((b,F)=>b.zippedIndex-F.zippedIndex);break;case"status":l.logs.sort((b,F)=>b.command>F.command?1:-1);break;case"name":l.logs.sort((b,F)=>b.path>F.path?1:-1);break;case"size":l.logs.sort((b,F)=>b.size-F.size);break;case"outputsize":l.logs.sort((b,F)=>b.outputSize-F.outputSize);break;case"processed":default:l.logs.sort((b,F)=>b.index-F.index);break}}function Ye(b){const F=l.logs,X=F.findIndex(oe=>oe.zippedIndex===l.imageIndex);let he=0,M=1;switch(b.code){case"ArrowUp":he=-1;break;case"ArrowDown":he=1;break;case"PageUp":he=-1,M=z.value/ie.value-1|0;break;case"PageDown":he=1,M=z.value/ie.value-1|0;break;case"Enter":case"NumpadEnter":if(X>=0&&l.previewCollapsed){$e(()=>r("open-preview")),b.stopPropagation(),b.preventDefault();return}break;default:return}let I=X,G=-1;const ne=F.length;do{if(I+=he,I<0||I>ne-1||I===X)break;if(F[I].completed){if(G=I,--M>0)continue;break}}while(!0);if(G>=0){const oe=F[G];r("change-index",!0,oe.path,oe.fileId,oe.zippedIndex),b.preventDefault()}}let De=-1,We=-1,W=0,re=!1;function U(b){var he,M;if(de(),re){re=!1;return}const{scrollLeft:F=0,scrollTop:X=0}=(M=(he=f.value)==null?void 0:he.scrollbarInstRef)==null?void 0:M.containerRef;(F!==De||De<0)&&(X===We||We<0)&&(W=F),De=F,We=X,$e(()=>{var G,ne;re=!0;const I=(ne=(G=f.value)==null?void 0:G.scrollbarInstRef)==null?void 0:ne.containerRef;I&&(I.scrollLeft=W)})}function D(b){a.value=!1}function te(b,F){var oe,ve;const he=(ve=(oe=b.target.closest("tr"))==null?void 0:oe.dataset)==null?void 0:ve.indexLoglist;if(!/^\d+$/.test(he))return;const{completed:M,path:I,fileId:G,zippedIndex:ne}=S.value[he];M&&(l.imageIndex!==ne&&r("change-index",M,I,G,ne),F&&r("open-preview"))}return(b,F)=>{const X=Ce,he=Ae,M=Pt,I=Ct,G=ze,ne=Et,oe=lt,ve=ft;return L(),J(ve,{name:"log",style:{"white-space":"nowrap"}},{header:e(()=>[n(X,{align:"center",wrap:!1},{default:e(()=>[$(d(b.$t("status.Log")),1)]),_:1})]),"header-extra":e(()=>[l.opened?(L(),J(X,{key:0,align:"center",justify:"end",wrap:!0,style:{"margin-top":"0.2em","margin-left":"0.5em"}},{default:e(()=>[n(M,{value:y.value,"onUpdate:value":[F[0]||(F[0]=ge=>y.value=ge),Re],options:t(E),style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1,size:"tiny"},{arrow:e(()=>[n(he,{component:t(Ja)},null,8,["component"])]),_:1},8,["value","options"]),n(M,{value:t(A),"onUpdate:value":[F[1]||(F[1]=ge=>Ie(A)?A.value=ge:null),F[2]||(F[2]=ge=>ke())],options:m,placeholder:b.$t("status.filterLogSelect"),size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1},{arrow:e(()=>[n(he,{component:t(el)},null,8,["component"])]),_:1},8,["value","placeholder"]),n(I,{key:"b",checked:a.value,"onUpdate:checked":[F[3]||(F[3]=ge=>a.value=ge),F[4]||(F[4]=ge=>ge&&fe(!0))],size:"small",style:{"font-size":"0.9em"}},{default:e(()=>[$(d(b.$t("status.autoScroll")),1)]),_:1},8,["checked"]),n(oe,{trigger:"hover",show:t(T),disabled:!o.value,placement:"top",delay:0,duration:1e3},{trigger:e(()=>[n(G,{style:{"max-width":"30em"},disabled:!0},{trigger:e(()=>[n(I,{size:"small",checked:o.value,"onUpdate:checked":[F[5]||(F[5]=ge=>o.value=ge),O],style:{"font-size":"0.9em"}},{default:e(()=>[$(d(b.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:e(()=>[$(d(b.$t("status.expandLog")),1)]),_:1})]),default:e(()=>[n(X,{wrap:!1,align:"center",style:{"font-size":"0.8em"}},{default:e(()=>[n(ne,{value:t(g),"onUpdate:value":F[6]||(F[6]=ge=>Ie(g)?g.value=ge:null),onUpdateValue:F[7]||(F[7]=ge=>Q()),disabled:!o.value,"format-tooltip":ge=>`Log size: ${ge}`,tooltip:!0,step:1,min:t(ee),max:t(R),style:{"z-index":"3",width:"100px"}},null,8,["value","disabled","format-tooltip","min","max"])]),_:1})]),_:1},8,["show","disabled"])]),_:1})):me("",!0)]),default:e(()=>[n(X,{wrap:!1,align:"stretch",class:nt({"log-container":1,"expand-log":o.value}),style:pe({height:t(z)+"px"}),onKeydown:Ye,tabindex:"-1"},{default:e(()=>[n(t(bn),{ref_key:"scrollref",ref:f,distance:10,"x-scrollable":!0,onMousedownCapture:D,onWheel:F[9]||(F[9]=ge=>a.value=!1),onScroll:U,load:"handleLogLoad",trigger:"none",style:pe([{"z-index":"2","padding-right":"10px",height:"100%"},{height:t(z)+"px"}]),size:50},{default:e(()=>[l.opened?(L(),q("table",ar,[_("thead",null,[_("tr",lr,[_("th",{class:"log-th",title:b.$t("status.table.core")},"th",8,sr),F[10]||(F[10]=_("th",{class:"log-th"},"no.",-1)),_("th",ir,d(b.$t("status.table.status")),1),_("th",rr,d(b.$t("status.table.details")),1),F[11]||(F[11]=_("th",{class:"log-th"},"size",-1))])]),_("tbody",{ref:"tbody",onClick:te,onDblclick:F[8]||(F[8]=ge=>te(ge,!0))},[_("tr",{style:pe(t(Y))},null,4),(L(!0),q(Pe,null,it(t(S).slice(t(H),t(H)+t(N)),({index:ge,key:Ze,command:Xe,path:gt,core:Le,zippedIndex:rt,completed:mt,fileId:Je,shrinked:La,width:Qt,height:$a,outputWidth:Fa,outputHeight:Ea,size:Pa,outputSize:Yt},Xt)=>(L(),q("tr",{key:Ze,class:nt({"log-tr":1,completed:mt,selected:b.imageIndex===rt,stripe:(t(H)+Xt)%2}),ref_for:!0,ref:Da=>{b.imageIndex===rt&&(w.value=Da)},"data-index-loglist":t(H)+Xt},[_("td",cr,d(Le>=0?Le+1:"-"),1),_("td",dr,d(ge+1),1),_("td",pr,d(Xe),1),_("td",fr,d(gt),1),Qt?(L(),q("td",gr,[$(d(`[${Qt}×${$a}] (${t(He)(Pa,0)})`)+" ",1),Yt?(L(),q("span",mr,[F[12]||(F[12]=$(" → ")),_("span",null," ("+d(t(He)(Yt,0))+") ",1)])):me("",!0),La?(L(),q("span",vr,d(` [${Fa}×${Ea}]`),1)):me("",!0)])):(L(),q("td",hr))],10,ur))),128)),_("tr",{style:pe(t(Z))},null,4)],544)],512)):me("",!0),F[13]||(F[13]=_("div",{style:{height:"1em"}},null,-1))]),_:1,__:[13]},8,["style"])]),_:1},8,["class","style"])]),_:1})}}}),wr={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function br(i,s){return L(),q("svg",wr,s[0]||(s[0]=[_("path",{fill:"currentColor",d:"M4 18h8.13L11 19.13V20H4a2 2 0 0 1-2-2V6c0-1.11.89-2 2-2h6l2 2h8a2 2 0 0 1 2 2v2.15c-.26-.09-.54-.15-.83-.15c-.42 0-.81.11-1.17.3V8H4zm18.85-4.53l-1.32-1.32c-.2-.2-.53-.2-.72 0l-.98.98l2.04 2.04l.98-.98c.2-.19.2-.52 0-.72M13 19.96V22h2.04l6.13-6.12l-2.04-2.05z"},null,-1)]))}const xa=ot({name:"mdi-folder-edit-outline",render:br}),kr={class:"container"},zr={__name:"zipicon",setup(i){return(s,u)=>(L(),q("span",kr,[n(t(Ae),null,{default:e(()=>[n(t(Nt))]),_:1}),u[0]||(u[0]=_("span",{class:"text"},"ZIP",-1))]))}},Sr=Oe(zr,[["__scopeId","data-v-8b8df2f0"]]),Cr=["innerHTML"],Tr={style:{margin:"1px"}},Ar=["href","download","onClick"],xr={key:0,style:{position:"relative"}},Ir=["href","download"],Lr=["href","download"],$r={style:{"margin-left":"0.5em"}},Fr={key:0,style:{margin:"1px"}},Er=["href","download","onClick"],Pr=ye({__name:"status.result",props:{processing:{type:Boolean},listLength:{},zippingFlag:{type:Boolean},converted:{},success:{},zippedTotalCount:{},zippedTotalSize:{},baseZipName:{},zips:{},unconvertedListText:{},unconvertedFileCount:{},unconvertedTotalSize:{},failedZips:{},failedZipDone:{type:Boolean},failedToCreateFailedZip:{type:Boolean},failedFileZippedCount:{},imgUrl:{},imgName:{},type:{},outputToDir:{type:Boolean},outputDirName:{}},emits:["all-zips-clicked","demand-zip-errors"],setup(i,{emit:s}){const u=pt(),{t:l}=je(),o=Ft(),a=i,r=s,c=h(!1),f=h([]),w=h([]),k=h(void 0),z=Se(()=>[{key:"open",label:l("status.openFailedList"),icon:()=>le(Ae,()=>le(Sn)),onSelect(){T()}},{key:"download",label:l("status.saveFailedList"),icon:()=>le(Ae,()=>le(nl)),onSelect(){T(!0)}},{key:"zip",label:`${l("status.zipFailedList")}`+(a.failedZipDone?`(✔${l("status.done")})`:""),icon:()=>le(Vt,{show:c.value&&!a.failedZipDone,size:"small"},()=>le(Ae,()=>le(Nt))),disabled:c.value,onSelect(p){return c.value=!0,r("demand-zip-errors"),!1}}]);be([()=>a.zips.length,()=>a.failedZips.length],()=>{{f.value.length>a.zips.length&&(f.value.length=0);let p=0;const E=a.zips.length===1&&a.zippedTotalCount===a.listLength;for(let y=f.value.length;y<a.zips.length;y++){const m=a.zips[y],A=a.baseZipName+(E?"":"-"+String(y+1).padStart(2,"0"))+".zip";p+=m.size,f.value[y]={url:m.url,size:m.size,number:E?0:y+1,sizeByUnit:He(m.size),name:A,count:m.count,clicked:!1}}}{w.value.length>a.failedZips.length&&(w.value.length=0);let p=0;const E=a.failedZipDone&&a.failedZips.length===1;for(let y=w.value.length;y<a.failedZips.length;y++){const m=a.failedZips[y],A=a.baseZipName+"-error"+(E?"":"-"+String(y+1).padStart(2,"0"))+".zip";p+=m.size,w.value[y]={url:m.url,size:m.size,number:E?0:y+1,sizeByUnit:He(m.size),name:A,count:m.count,clicked:!1}}}});function g(p,E=!1){const{url:y,name:m}=p;if(E){const A=document.createElement("a");A.href=y,A.download=m,A.click()}p.clicked||(p.clicked=!0,a.processing||f.value.every(A=>A.clicked)&&r("all-zips-clicked"))}async function S(p){if(a.zippingFlag){if(f.value.length>=2&&!await new Promise((m,A)=>u.warning({title:l("Download"),content:l("status.confirmDownloadMessage",[f.value.length]),positiveText:"OK",negativeText:l("cancel"),onPositiveClick:()=>m(!0),onNegativeClick:()=>A()})))return;const E=f.value;for(const y of E)g(y,!0)}}function T(p=!1){const E=new Blob([a.unconvertedListText],{type:"text/plain;charset=utf8"}),y=URL.createObjectURL(E),m=document.createElement("a");m.href=y,m.target="_blank",p&&(m.download=a.baseZipName+"-error.txt"),m.click()}return(p,E)=>{const y=zn,m=lt,A=Fe,v=Ce,x=Sr,B=kn,P=xa,R=Tn,ee=ol,Q=ft;return L(),J(Q,{name:"output",style:{"white-space":"nowrap"},disabled:""},{header:e(()=>[_("span",{style:{color:"black"},innerHTML:p.$t("status.Output")},null,8,Cr)]),default:e(()=>[n(v,{wrap:!1,vertical:"",style:{"margin-top":"-1.3em"}},{default:e(()=>[p.outputToDir?me("",!0):(L(),J(v,{key:0,justify:"center"},{default:e(()=>[Ge(n(v,{vertical:"",align:"center"},{default:e(()=>[n(m,{placement:"left"},{trigger:e(()=>[n(y,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":a.zippedTotalCount===p.listLength?"white":"green",processing:a.processing,percentage:a.zippedTotalCount/p.listLength*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:e(()=>[_("span",Tr,d(a.zippedTotalCount/p.listLength*100|0)+"% "+d(p.$t("status.zippingProgress"))+" ("+d(a.zippedTotalCount)+"/"+d(a.converted)+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:e(()=>[$(" "+d(p.$t("status.zippingProgress"))+" ("+d(a.zippedTotalCount/a.listLength*100|0)+"%) ",1)]),_:1}),t(f).length>=2||a.processing?(L(),J(Tt,{key:0,name:"zips",class:"zip-buttons-parent",tag:"div"},{default:e(()=>[(L(!0),q(Pe,null,it(t(f),(O,C)=>(L(),q("span",{key:C},[n(m,{trigger:"hover",duration:0,delay:0},{trigger:e(()=>[_("a",{href:O.url,download:O.name,class:"in-button-anchor",onClick:ae=>g(O)},[n(A,{class:"zip-button",size:"tiny",color:O.clicked?"#050":"lime","text-color":O.clicked?"gray":"white",onClick:ct(ae=>g(O),["stop"]),round:""},{default:e(()=>[n(t(Ae),{size:"tiny"},{default:e(()=>[n(t(Nt))]),_:1}),$("ZIP"+d(O.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Ar)]),default:e(()=>[_("div",{style:pe({color:t(o).successColor})},[_("div",null,"ZIP "+d(O.number||"")+" ("+d(p.$t("success"))+")",1),_("div",null,d(O.name),1),_("div",null,d(O.sizeByUnit),1),_("div",null,d(p.$rt("{n} @:files",O.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):me("",!0)]),_:1},512),[[Ke,p.zippingFlag]])]),_:1})),n(qe,null,{default:e(()=>[Ge(n(v,{justify:"center",align:"center"},{default:e(()=>[p.outputToDir?(L(),J(m,{key:1,trigger:"hover",duration:0,delay:0,placement:"left",style:pe({color:"white",backgroundColor:t(o).successColor}),"arrow-style":{backgroundColor:t(o).successColor}},{trigger:e(()=>[n(v,{align:"center",size:1,style:pe(`border: 1px solid ${t(o).successColor}; border-radius:4px; padding:0.3em;`)},{default:e(()=>[n(P,{style:{"vertical-align":"middle"}}),n(R,{style:{"font-size":"smaller","max-width":"25em"}},{default:e(()=>[$(d(p.outputDirName),1)]),_:1}),_("span",$r,[_("span",{style:pe({color:t(o).successColor})},d(p.success),5),$(" "+d(t(l)("files",p.success)),1)])]),_:1},8,["style"])]),default:e(()=>[$(d(p.$t("status.numberOfFilesWrittenToDir")),1)]),_:1},8,["style","arrow-style"])):(L(),J(m,{key:0,trigger:"hover",duration:0,delay:0,placement:"left",style:pe({color:"white",backgroundColor:t(o).successColor}),"arrow-style":{backgroundColor:t(o).successColor}},{trigger:e(()=>[n(qe,{name:"save"},{default:e(()=>[p.success>0?(L(),q("span",xr,[n(B,{value:p.zippingFlag?a.zippedTotalCount.toLocaleString("en-us"):a.type.replace(/\(.+\)/,""),color:t(o).successColorHover,offset:[-20,-3]},{default:e(()=>[p.zippingFlag?(L(),J(A,{key:0,size:"medium",onClick:S,color:t(o).successColor,round:""},{default:e(()=>[t(f).length?(L(),q("a",{key:0,href:t(f)[0].url,download:t(f)[0].name,class:"in-button-anchor",onClick:E[0]||(E[0]=ct(()=>{},["prevent"]))},[n(x),$(" × "+d(t(f).length)+" "+d(p.$t("status.saveAll")),1)],8,Ir)):me("",!0)]),_:1},8,["color"])):(L(),q("a",{key:1,href:a.imgUrl,download:a.imgName,class:"in-button-anchor"},[n(A,{size:"medium",color:t(o).successColor,round:""},{default:e(()=>[n(t(Ae),{size:"tiny",component:t(Cn)},null,8,["component"]),$(" "+d(p.$t("save")),1)]),_:1},8,["color"])],8,Lr))]),_:1},8,["value","color"])])):me("",!0)]),_:1})]),default:e(()=>[a.listLength>=2?(L(),q(Pe,{key:0},[_("div",null,d(t(l)("success"))+": "+d(p.zippedTotalCount.toLocaleString()),1),_("div",null,d(t(l)("status.totalSize"))+": "+d(t(He)(a.zippedTotalSize)),1),_("div",null,"ZIP × "+d(t(f).length),1),_("div",null,d(t(l)("status.saveAllZipsTooltip")),1)],64)):(L(),q(Pe,{key:1},[$(d(p.$t("status.downloadConvertedImage",t(f).length)),1)],64))]),_:1},8,["style","arrow-style"])),!a.processing&&a.success!==p.listLength?(L(),J(ee,{key:2,options:t(z),onSelect:E[1]||(E[1]=(O,C)=>{var ae;return(ae=t(z).find(({key:fe})=>O===fe))==null?void 0:ae.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:e(()=>[n(m,{show:t(k),duration:0,delay:0,placement:"right",style:pe({color:"white",backgroundColor:t(o).errorColor}),"arrow-style":{backgroundColor:t(o).errorColor}},{trigger:e(()=>[n(B,{value:a.unconvertedFileCount.toLocaleString(),color:t(o).errorColorHover,offset:[-0,-3]},{default:e(()=>[n(A,{size:"small",color:t(o).errorColor},{default:e(()=>[n(t(Ae),{size:"medium",style:{"vertical-align":"middle"},component:t(al)},null,8,["component"])]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:e(()=>[_("div",null,[_("div",null,d(t(l)("failed"))+": "+d(a.unconvertedFileCount.toLocaleString()),1),_("div",null,d(t(l)("status.totalSize"))+": "+d(t(He)(a.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])):me("",!0)]),_:1},512),[[Ke,!a.processing||p.outputToDir]])]),_:1}),n(qe,{name:"zipcontainer"},{default:e(()=>[Ge(n(v,{vertical:"",align:"center"},{default:e(()=>[n(m,{placement:"left"},{trigger:e(()=>[n(y,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":a.failedFileZippedCount===a.unconvertedFileCount?"white":"#500",processing:t(c)&&!a.failedZipDone&&!a.failedToCreateFailedZip,percentage:a.failedFileZippedCount/a.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:e(()=>[a.failedToCreateFailedZip?(L(),q("div",{key:1,style:pe({color:t(o).errorColor})},d(p.$t("status.failureZippingFailedFiles")),5)):(L(),q("span",Fr,d(a.failedFileZippedCount/a.unconvertedFileCount*100|0)+"% "+d(p.$t("status.zipped"))+" ("+d(a.failedFileZippedCount)+"/"+d(a.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:e(()=>[$(" "+d(p.$t("status.zippingProgress"))+" ("+d(a.failedFileZippedCount/a.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(Tt,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:e(()=>[(L(!0),q(Pe,null,it(t(w),(O,C)=>(L(),q("span",{key:C},[n(m,{trigger:"hover",duration:0,delay:0},{trigger:e(()=>[_("a",{href:O.url,download:O.name,class:"in-button-anchor",onClick:ae=>g(O)},[n(A,{class:"zip-button",size:"tiny",color:O.clicked?"#551122":"#F00","text-color":O.clicked?"gray":"white",onClick:ct(ae=>g(O),["stop"]),round:""},{default:e(()=>[n(t(Ae),{size:"tiny",component:t(ll)},null,8,["component"]),$("ZIP"+d(O.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Er)]),default:e(()=>[_("div",{style:pe({color:t(o).errorColor})},[_("div",null,"ZIP "+d(O.number||"")+" ("+d(p.$t("failed"))+")",1),_("div",null,d(O.name),1),_("div",null,d(O.sizeByUnit),1),_("div",null,d(p.$rt("{n} @:files",O.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1},512),[[Ke,t(c)]])]),_:1})]),_:1})]),_:1})}}}),Dr=Oe(Pr,[["__scopeId","data-v-1aee218a"]]),Mr=ye({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image","delete-image"],setup(i,{expose:s,emit:u}){const l={itemMargin:"1px",titlePadding:"2px",titleFontSize:"0.8rem"},{t:o}=je(),a=Ft(),r=i,c=u;s({cleanup:We});const f=h(!1),w=h([]),k=h(!1),z=h(!1),g=h([0,0]),S=h([0,0]),T=h([0,0]),p=h([0,0]),E=h([0,0]),y=h([0,0]),m=h(0),A=h(0),v=h([0,0]),x=h(0),B=h(a.value.infoColor),P=h("#000000"),R=h("#000000"),ee=h(0),Q=h(0),O=h(""),C=h("00:00:00"),ae=h(null),fe=h(["progress","log","output"]),Y=W=>fe.value.includes(W),Z=W=>fe.value.push(W),H=W=>{const re=fe.value.findIndex(U=>U===W);re>=0&&fe.value.splice(re,1)},N=Se(()=>fe.value.includes("log")),ie=Se(()=>fe.value.includes("progress")),se=h(!1),ue=h(!0),_e=h("processed"),K=$t({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:0,various:{shrinked:!1}}),Ee=dt("body"),de=dt("imageViewer");Me(()=>{be(r.status,()=>Ue(),{deep:!1});let W=0;const re=()=>{if(W)return;const U=Date.now();C.value="00:00:00",W=window.setInterval(()=>{const D=(Date.now()-U)/1e3;C.value=`${String(D/3600|0).padStart(2,"0")}:${String(D/60%60|0).padStart(2,"0")}:${String(D%60|0).padStart(2,"0")}`},300)};re(),z.value=!0,be(()=>r.processing,(U,D)=>{U||Re(),U?(re(),w.value.length=0,f.value=!1,k.value=!1):(clearInterval(W),W=0)}),et(()=>{clearInterval(W),clearTimeout(we)}),At(()=>clearInterval(W))}),et(()=>{We()}),At(()=>{clearTimeout(we)});const ke=r.interval||100;let ce=!1,we=0;function Ue(){if(ce)return;if(we){ce=!0;return}we=window.setTimeout(()=>{we=0,ce&&(ce=!1,Ue())},ke);const W=r.status;f.value=W.length>=2,S.value[1]=S.value[0],S.value[0]=W.startedCount,T.value[1]=T.value[0],T.value[0]=W.success,p.value[1]=p.value[0],p.value[0]=W.failure,E.value[1]=E.value[0],E.value[0]=W.done,y.value[1]=y.value[0],y.value[0]=W.converted,m.value=W.retried,A.value=W.length,v.value[1]=v.value[0],v.value[0]=W.zippedTotalCount,ee.value=W.inputTotalSize,Q.value=W.outputTotalSize,x.value=W.failedFileZippedCount;const re=Q.value-ee.value;O.value=(re>=0?"+ ":"")+He(re);const U=Q.value/ee.value,D=(256|Math.min(255,Math.max(0,U-1.5)*255|0)).toString(16).substring(1);P.value="#"+D+"0000";const te=1024*1024,b=(256|Math.min(255,Math.max(0,re/1024/te)*255|0)).toString(16).substring(1);R.value="#"+b+"0000",g.value[1]=g.value[0],g.value[0]=T.value[0]/A.value*100,(N.value||!r.processing)&&(w.value=w.value.concat(W.logs),W.logs.length=0),ae.value=W.thumbnail,r.processing?B.value=p.value[0]?a.value.errorColor:m.value?a.value.warningColor:a.value.infoColor:z.value=!1,W.convertedImageUrl!==K.url&&(K.url=W.convertedImageUrl,K.name=W.convertedImageName,K.dataUrl=W.convertedImageDataUrl,K.size=W.convertedImageSize||W.outputTotalSize,K.originalSize=W.convertedImageOrgSize,K.originalName=W.convertedImageOrgName,K.index=W.convertedImageIndex,K.originalUrl=W.convertedImageOrgUrl,K.various={shrinked:W.convertedImageShrinked})}function Re(){const W=r.status;B.value=r.status.success===r.status.length?a.value.successColor:a.value.errorColor,_e.value==="processed"&&(_e.value="zipped"),W.success>0&&(ue.value&&(H("log"),se.value=!0),Z("preview"))}async function Ye(W,re,U,D){var b;if(!W)return;const te=D;Y("preview")||(Z("preview"),await $e()),(b=de.value)==null||b.changeIndex(te+1),await $e(()=>{var F;try{(F=de.value)==null||F.$el.scrollIntoView({behavior:"instant",block:"nearest"})}catch{}})}const De=h(!1);function We(){De.value=!0,URL.revokeObjectURL(K.url),URL.revokeObjectURL(K.originalName),K.originalUrl="",K.url="",K.index=0,r.status.logs.length=0,w.value.length=0}return(W,re)=>{const U=Ce,D=ft,te=Wt;return L(),J(U,{ref_key:"body",ref:Ee,vertical:"",justify:"center"},{default:e(()=>[n(te,{"display-directive":"show","trigger-areas":["arrow","main"],"expanded-names":t(fe),"onUpdate:expandedNames":re[7]||(re[7]=b=>Ie(fe)?fe.value=b:null),"theme-overrides":l},{default:e(()=>[n(Wi,{processing:t(z),"elapsed-time":t(C),"success-perc":t(g)[0],"input-total-size":t(ee),"output-total-size":t(Q),"file-type":r.status.type,shrink:r.status.shrink,threads:r.status.threads,"zip-size":r.status.zipSize,"output-to-dir":r.status.outputToDir,"rate-color":t(P),"dif-color":t(R),"total-size-dif-str":t(O),thumbnail:t(ae),opened:t(ie)},{center:e(()=>[t(De)?me("",!0):(L(),J(or,{key:0,index:t(S)[0],success:t(T)[0],length:W.status.length,"success-to":t(T)[0],"success-from":t(T)[1],failure:t(p)[0],"success-perc-to":t(g)[0],"success-perc-from":t(g)[1],retried:t(m),processing:t(z),interval:t(ke),"status-color":t(B),class:"center-column"},null,8,["index","success","length","success-to","success-from","failure","success-perc-to","success-perc-from","retried","processing","interval","status-color"]))]),_:1},8,["processing","elapsed-time","success-perc","input-total-size","output-total-size","file-type","shrink","threads","zip-size","output-to-dir","rate-color","dif-color","total-size-dif-str","thumbnail","opened"]),n(_r,{processing:t(z),"image-index":t(K).index,opened:t(N),"preview-collapsed":Y("preview"),logs:t(w),expanded:t(se),"onUpdate:expanded":re[0]||(re[0]=b=>Ie(se)?se.value=b:null),"auto-scroll":t(ue),"onUpdate:autoScroll":re[1]||(re[1]=b=>Ie(ue)?ue.value=b:null),order:t(_e),onChangeIndex:Ye,onOpenPreview:re[2]||(re[2]=b=>{var F;return(F=t(de))==null?void 0:F.openPreview()}),name:"log",style:{"white-space":"nowrap"}},null,8,["processing","image-index","opened","preview-collapsed","logs","expanded","auto-scroll","order"]),n(D,{title:W.$t("status.PreviewImage"),name:"preview",style:{"white-space":"nowrap"},disabled:!(t(T)[0]>0)},{default:e(()=>[n(U,{justify:"center",align:"center",vertical:"",style:{"margin-top":"-1em"}},{default:e(()=>[n(Ri,{"_v-else-if":"imageViewerStarted && status.success > 0 /*&& (props.status.threads || !zippingFlag)*/ && !cleaningUp",ref_key:"imageViewer",ref:de,url:t(K).url,size:t(K).size,"original-url":t(K).originalUrl,"original-size":t(K).originalSize,name:t(K).name,originalName:t(K).originalName,length:t(T)[0],index:t(K).index,"various-info":t(K).various,"is-single":!t(f),onDemandImage:re[3]||(re[3]=b=>c("demand-image",b)),on_deleteImage:re[4]||(re[4]=b=>c("delete-image",b)),_close:"imageViewerStarted=false"},null,8,["url","size","original-url","original-size","name","originalName","length","index","various-info","is-single"])]),_:1})]),_:1},8,["title","disabled"]),n(Dr,{processing:t(z),"list-length":t(A),zippingFlag:t(f),zips:r.status.zips,"img-url":t(K).url,"img-name":t(K).name,success:t(T)[0],failure:t(p)[0],done:t(E)[0],converted:t(y)[0],retried:t(m),"zipped-total-count":t(v)[0],"zipped-total-size":r.status.zippedTotalSize,"base-zip-name":r.status.baseZipName,"failed-file-zipped-count":t(x),"failed-to-create-failed-zip":r.status.failedToCreateFailedZip,"failed-zip-done":r.status.failedZipDone,"failed-zips":r.status.failedZips,"unconverted-file-count":r.status.unconvertedFileCount,"unconverted-list-text":r.status.unconvertedListText,"unconverted-total-size":r.status.unconvertedTotalSize,"output-to-dir":W.status.outputToDir,"output-dir-name":W.status.outputDirName,type:r.status.type,onAllZipsClicked:re[5]||(re[5]=b=>c("all-zips-clicked")),onDemandZipErrors:re[6]||(re[6]=b=>c("demand-zip-errors"))},null,8,["processing","list-length","zippingFlag","zips","img-url","img-name","success","failure","done","converted","retried","zipped-total-count","zipped-total-size","base-zip-name","failed-file-zipped-count","failed-to-create-failed-zip","failed-zip-done","failed-zips","unconverted-file-count","unconverted-list-text","unconverted-total-size","output-to-dir","output-dir-name","type"])]),_:1},8,["expanded-names"])]),_:1},512)}}}),Or=Oe(Mr,[["__scopeId","data-v-a067ea79"]]),Ur=["innerHTML"],Rr={style:{color:"red"}},Br=ye({__name:"converter",props:Ve({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},autoStart:{type:Boolean},threads:{},outputToDir:{type:Boolean},outputDirHandle:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:Ve(["start","end"],["update:showNote"]),setup(i,{expose:s,emit:u}){at(Qe);const{t:l}=je(),o=pt(),a=An(),r=10,c=navigator.hardwareConcurrency,f=typeof OffscreenCanvas=="function",w=100,k=h([[()=>l("dupAction_overwrite"),"overwrite"],[()=>l("dupAction_skip"),"skip"],[()=>l("cancel"),"cancel"]]),z=i,g=Te(i,"showNote"),S=u;s({beginConversion:ce});const T=h(!1),p=h(!1),E=h(!1),y=h(!1),m=h(!1),A=h(()=>"initializing"),v=h("info"),x=$t(Ue()),B=dt("stat"),P=h(0),R=Se(()=>{var M;return(M=z.input)==null?void 0:M.length}),ee=h(),Q=h(""),O=h(!1),C=h(!0),ae=h(!1);let fe=()=>{};const Y=h(!1);let Z=!1,H=!1,N,ie=()=>{},se,ue=0,_e=!1;be(()=>z.input.length,(M,I)=>{M>=I&&z.autoStart&&ce()}),be(y,M=>{document.body.style.overflowY=M?"hidden":"auto"}),Me(async()=>{await W(),re()});async function K(){let M=!0;if(ue>r*1e3&&!z.outputToDir&&!_e&&x.success>0&&(M=!1,await new Promise(I=>{o.warning({title:l("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:l("close"),negativeText:l("back"),onPositiveClick:()=>M=!0,onAfterLeave:I,content:l("confirmCloseDialog")})})),!M)return!1;a.destroyAll(),y.value=!1,g.value=!1}function Ee(M){se==null||se(M)}function de(M){Ot==null||Ot(M)}function ke(){!p.value&&T.value?p.value=!0:K()}async function ce(){var M;if(!((M=z.input)!=null&&M.length)||T.value){o.error({title:"error",positiveText:"OK",content:"An unexpected error occurred."});return}if(z.outputToDir&&!z.outputDirHandle){o.error({title:"error",positiveText:"OK",content:l("errMsgOutputDirNotFound")});return}if(T.value){o.error({title:"Busy",positiveText:"OK",content:l("interfered")});return}if(z.outputToDir&&!Y.value&&(await new Promise(I=>{ae.value=!0,Z=!1,fe=I}),!Z)){Y.value=!1;return}Ye(z.input)}let we=h(()=>{});function Ue(M){const I={logs:[],ziplogs:[],startedCount:0,converted:0,success:0,failure:0,retried:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",convertedImageOrgUrl:"",convertedImageIndex:-1,convertedImageShrinked:!1,zipSize:z.maxZipSizeMB,shrink:V.multithread&&V.shrinkImage?[V.maxWidth,V.maxHeight]:void 0,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1,outputToDir:z.outputToDir,outputDirName:z.outputDirHandle?z.outputDirHandle.name:""};return Object.assign(M||{},I)}function Re(){m.value=!1,URL.revokeObjectURL(x.convertedImageUrl),URL.revokeObjectURL(x.convertedImageOrgUrl);for(const M of x.zips)URL.revokeObjectURL(M.url);x.zips.length=0;for(const M of x.failedZips)URL.revokeObjectURL(M.url);x.failedZips.length=0,Ue(x),ie(),ie=()=>{},se=null,_e=!1,E.value=!1,p.value=!1,D=!1,te.length=0,N=void 0,F.clear(),X.clear()}async function Ye(M){y.value&&(P.value^=1);let I=M.concat();Ue(x),Re(),y.value=!0,m.value=!0,T.value=!0,x.processing=!0,v.value="info",A.value=()=>l("processing");const G=new Set,ne=[],oe=z.format,ve=z.quality,ge=[...oe.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),Ze=We(oe,ve,I[0].webkitRelativePath);let Xe=new Set;z.outputDirHandle&&(Xe=await di(z.outputDirHandle,I)),x.length=I.length,x.baseZipName=Ze,x.type=oe.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(oe)?" ("+ve+")":""),x.threads=H?0:z.threads;const gt=Date.now();S("start");let Le,rt,mt;if(!H&&z.threads>=2?(se=zi,mt=await fi({files:I,completedFileIdSet:G,completedFileDat:ne,ConvStats:x,canceled:p,props:z,imageType:oe,quality:ve,outputExt:ge,format:oe,message:a,fsysDirHandler:z.outputDirHandle,writeUsingFileSystem:U,enqueueOverwriteConfirmation:b,existingFolders:Xe})):(se=Ti,mt=await Ci(I,G,z,p,x)),{exception:rt,callbackToGenerateFailedZips:Le,callbackToClearConverter:ie}=mt,rt){let Je;switch(rt.message){case"worker-load-error":Je=l("errMsgWorkerLoadError");break;default:Je="unexpected error"}o.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:()=>le("div",[le("p",Je),le(Fe,{onClick(){location.reload()}},l("Reload"))])})}if(x.success===x.length?(v.value="success",A.value=()=>l("completed")):(v.value="error",A.value=()=>p.value?l("aborted"):l("incomplete")),G.size!==I.length){const Je=De(M,G);we.value=()=>{!Je||!Je.length||Le(Je)}}T.value=!1,x.processing=!1,E.value=!0,I.length=0,ue=Date.now()-gt,S("end")}function De(M,I){const G=[],ne=[];let oe=0;for(const ve of M)I.has(ve._id)||(G.push(ve),ne.push(ve.webkitRelativePath||ve.relativePath||ve.name),oe+=ve.size);return ne.length&&(x.unconvertedListText=ne.join(`
`),x.unconvertedFileCount=G.length,x.unconvertedTotalSize=oe),G}function We(M,I,G){var Ze;const ne=new Date;M=M.replace(/^image\//,"").toLowerCase();const oe=V.useFolderNameForZip&&((Ze=String(G).match(/^\/?([^/]+)\//))==null?void 0:Ze[1])||"avif2jpg",ve=`
    ${ne.getFullYear().toString().substring(2)}
    ${String((ne.getMonth()+1)*100+ne.getDate()).padStart(4,"0")}
    ${String(ne.getHours()*1e4+ne.getMinutes()*100+ne.getSeconds()).padStart(6,"0")}
    -
    ${M+(/jpe?g|webp/i.test(M)?I:"")}
  `.replace(/\s/g,"");return`${oe}-${ve}`.replace(/\s+/g," ")}async function W(){const M="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",I=document.createElement("img"),G=Aa(I).then(()=>!0,()=>!1);I.src=M,await G||o.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:l("avifUnsupported")})}function re(){(!f||c<2||!Promise.any)&&(H=!0),H&&(Be.value=0)}async function U(M,I){const G=z.outputDirHandle;if(!G)throw new Error("Directory Handle is empty");await ui(G,M,I,!0)}let D=!1;const te=[];async function b(M,I,G,ne){D?te.push({resolver:M,target:I,type:G,path:ne}):(D=!0,he(M,I,G))}const F=new Set,X=new Set;async function he(M,I,G,ne){let oe="";if(p.value?oe="cancel":F.has(I)?oe="overwrite":X.has(I)?oe="skip":(Q.value=I,C.value=G==="folder",oe=N||await ee.value.start(),oe.startsWith("cancel")&&(p.value=!0),oe==="overwrite"&&F.add(I),oe==="skip"&&X.add(I),oe==="close"&&(O.value=!1),await $e(),!N&&O.value&&(oe+="-all",N=oe)),M(oe),te.length){const{resolver:ve,target:ge,type:Ze,path:Xe}=te.shift();he(ve,ge,Ze)}else D=!1}return(M,I)=>{const G=Ks,ne=Ae,oe=ze,ve=Ce,ge=Vt,Ze=kt,Xe=Ca,gt=Hs;return L(),q(Pe,null,[t(T)?me("",!0):(L(),J(ve,{key:0,justify:"center",align:"center",style:{"margin-top":"0.4em"}},{default:e(()=>[n(oe,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:e(()=>[n(qe,null,{default:e(()=>[n(t(Fe),{disabled:!t(R),onClick:ce,round:"",size:"large",style:{"font-size":"1.5em",padding:"1em"},type:t(R)?"success":void 0,"_:class":"{'button-ready': isReadyToConvert}"},{icon:e(()=>[n(ne,{size:"1.2em"},{default:e(()=>[n(G)]),_:1})]),default:e(()=>[$(" "+d(t(l)("StartConversion")),1)]),_:1},8,["disabled","type"])]),_:1})]),default:e(()=>[_("div",{innerHTML:t(R)?t(l)("convertTooltip"):t(l)("convertUnpreparedTooltip")},null,8,Ur)]),_:1})]),_:1})),n(Ze,{ref:"processingModal","display-directive":"show",show:t(y),"onUpdate:show":I[2]||(I[2]=Le=>Ie(y)?y.value=Le:null),closable:t(E),"close-on-esc":!1,preset:"dialog",onClick:I[3]||(I[3]=Le=>{t(a).destroyAll()}),onMaskClick:I[4]||(I[4]=Le=>{t(a).destroyAll()}),onClose:K,onEsc:ke,title:t(A),type:t(v),"mask-closable":!1,onAfterLeave:Re,onBeforeLeave:I[5]||(I[5]=Le=>{t(B).cleanup()}),class:"processing-dialog"},{default:e(()=>[n(ve,{vertical:"",style:{"flex-grow":"1"}},{default:e(()=>[t(m)?(L(),J(Or,{ref_key:"stat",ref:B,key:t(P),processing:t(T),status:t(x),interval:w,onAllZipsClicked:I[0]||(I[0]=Le=>Ie(_e)?_e.value=!0:_e=!0),onDemandZipErrors:t(we),onDemandImage:Ee,onDeleteImage:de},null,8,["processing","status","onDemandZipErrors"])):me("",!0),n(ve,{justify:"end",align:"center",wrap:!1},{default:e(()=>[t(T)?(L(),J(t(Fe),{key:0,disabled:t(p),ref:"cancelbutton",round:"",size:"large",onClick:I[1]||(I[1]=Le=>p.value=!0)},{default:e(()=>[n(ge,{show:t(p)&&!t(E),size:"small"},{default:e(()=>[$(d(t(l)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):t(E)?(L(),J(t(Fe),{key:1,onClick:K,round:"",size:"large"},{default:e(()=>[$(d(t(l)("close")),1)]),_:1})):me("",!0)]),_:1})]),_:1})]),_:1},8,["show","closable","title","type"]),n(Fn,{ref_key:"promptref",ref:ee,closable:"",draggable:"",type:"warning","close-on-esc":"",buttons:t(k),"show-apply-all":"","label-apply-all":M.$t("confirmApplyAllLabel"),"apply-all-checked":t(O),"onUpdate:applyAllChecked":I[6]||(I[6]=Le=>Ie(O)?O.value=Le:null)},{header:e(()=>[$(d(M.$t("confirmFileOverwriteTitle",{type:t(C)?M.$t("folder"):M.$t("file")})),1)]),default:e(()=>[_("div",null,d(M.$t("confirmFileOverwriteMsg",{type:t(C)?M.$t("folder"):M.$t("file")})),1),n(ve,{class:"path",align:"center",size:1,wrap:!1},{default:e(()=>[t(C)?(L(),J(Xe,{key:0})):(L(),J(gt,{key:1})),$(" "+d(t(Q)),1)]),_:1})]),_:1},8,["buttons","label-apply-all","apply-all-checked"]),n(Ze,{preset:"dialog",type:"warning",show:t(ae),"onUpdate:show":I[7]||(I[7]=Le=>Ie(ae)?ae.value=Le:null),title:M.$t("warnAboutFileSysTitle"),onAfterLeave:I[8]||(I[8]=Le=>t(fe)()),"positive-text":M.$t("Continue"),"negative-text":M.$t("cancel"),onPositiveClick:I[9]||(I[9]=Le=>void(Ie(Z)?Z.value=!0:Z=!0)),onNegativeClick:I[10]||(I[10]=Le=>void(Ie(Z)?Z.value=!1:Z=!1))},{default:e(()=>[_("p",null,d(M.$t("warnAboutFileSysBeforeConversion1")),1),n(ve,{class:"path",align:"center",size:1,wrap:!1},{default:e(()=>[n(Xe),$(" "+d(M.outputDirHandle.name),1)]),_:1}),_("p",Rr,d(M.$t("warnAboutFileSysBeforeConversion2")),1)]),_:1},8,["show","title","positive-text","negative-text"])],64)}}}),Nr={class:"container-1"},jr={style:{color:"gray",padding:"0.2em","font-size":"smaller","text-align":"center"}},Zr=["innerHTML"],Hr={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},Vr=ye({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(i,{emit:s}){at(Qe);const u=i,l=s,o=sl(),a=h(!1),r=h(0),c=h("");Me(()=>{f(u.dropTarget||document)});function f(k){document.ondragstart=z=>z.preventDefault(),document.ondragover=z=>z.preventDefault(),k.ondrop=async z=>{var S;if(z.preventDefault(),a.value||u.forbidden)return;a.value=!0,r.value=0,c.value="";let g;try{const T=[...z.dataTransfer.items].map(p=>p.webkitGetAsEntry());o.start(),g=await w(T),o.finish()}catch{g=[...((S=z.dataTransfer)==null?void 0:S.files)??[]],o.error()}a.value&&(a.value=!1,l("drop",g))}}async function w(k,z){z=z||[];for(const g of k)if(g.isFile){const S=await new Promise(T=>g.file(p=>T(p)));Object.defineProperty(S,"webkitRelativePath",{value:g.fullPath.replace(/^\//,"")}),z.push(S),r.value++}else if(g.isDirectory){c.value=g.fullPath;const S=g.createReader();do{const T=await new Promise(p=>S.readEntries(E=>p(E)));if(!T.length)break;await w(T,z)}while(!0)}return z}return(k,z)=>{const g=ze,S=Ce,T=kt;return L(),q("div",Nr,[n(g,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:e(()=>[_("div",jr," ("+d(k.$t("droptargetLabel"))+") ",1)]),default:e(()=>[_("h3",{innerHTML:k.$t("droptargetTooltip"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,Zr)]),_:1}),n(T,{show:t(a),"onUpdate:show":z[0]||(z[0]=p=>Ie(a)?a.value=p:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":k.$t("cancel")},{default:e(()=>[n(S,{vertical:"",align:"center"},{default:e(()=>[_("div",Hr,d(t(c)),1),_("div",null,"found "+d(t(r))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])])}}}),Wr=Oe(Vr,[["__scopeId","data-v-bf1cf34d"]]),qr={class:"container-1"},Gr={class:"container-2"},Kr=["innerHTML"],Qr=["innerHTML"],Yr={style:{"white-space":"nowrap","font-size":"smaller"}},Xr={style:{"padding-left":"1em"}},Jr=["innerHTML"],eu=["accept"],tu=ye({__name:"file-selector",props:Ve({target:{},userExtensions:{},forbidden:{type:Boolean}},{"auto-start-opt":{type:Boolean,required:!0},"auto-start-optModifiers":{},expanded:{type:Boolean,required:!1},expandedModifiers:{},disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:Ve(["input","click","cancel","on-change-accept","update:target","update:userExtensions"],["update:auto-start-opt","update:expanded","update:disableNotifyingFolderSelect"]),setup(i,{emit:s}){const u=pt(),{t:l}=je(),o=at(Qe),a=["avif_only","all_images","all_files","edit_type"],r=[];for(const Z of a)r.push({label:()=>l("fileTypeRadioOptions."+Z),value:Z});const c=({node:Z,option:H})=>le(ze,{placement:"right"},{trigger:()=>Z,default:()=>O(H.value).replace(/,/g,", ")}),f=i,w=Te(i,"auto-start-opt"),k=s,z=h(0),g=h(!1),S=h(!1),T=Se(()=>O(y.value)),p=Se(()=>m.value.split(",").every(H=>/^\s*(\.[\w\-]+)*\s*$/.test(H))?"success":"error"),E=Se(()=>!f.forbidden&&!S.value);Te(i,"expanded");const y=Se({get:()=>a.indexOf(f.target)>=0?f.target:a[0],set:Z=>{k("update:target",Z)}}),m=Se({get:()=>f.userExtensions,set:Z=>{k("update:userExtensions",Z)}}),A=Te(i,"disableNotifyingFolderSelect"),v=h(null),x=h(null),B=h(Q());be(y,Z=>{k("on-change-accept",T.value)}),Me(()=>{});async function P(Z){if(k("click"),Z===x.value&&!A.value){let H=!1;if(await new Promise(N=>{u.info({title:l("loadfolderNotifyingTitle"),positiveText:l("Continue"),negativeText:l("Cancel"),onAfterLeave:()=>N(H),onPositiveClick:()=>H=!0,content:()=>le("div",[le("p",{},l("loadfolderNotifyingMessageTerm1")),le("div",[le(_n,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/dist//notification-folder.png"})]),le("p",{},l("loadfolderNotifyingMessageTerm2")),le("p",[le(Ct,{onUpdateChecked:ie=>A.value=ie,checked:A.value},()=>l("checkboxTextDontShowThis"))])])})}),!H){A.value=!1,k("cancel");return}}Z.click()}function R(){k("cancel")}function ee(Z){const N=[...Z.target.files];v.value.value="",x.value.value="",ae(N)}function Q(){return"webkitdirectory"in document.createElement("input")}function O(Z){switch(Z){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico, .svg";case"edit_type":return m.value;case"all_files":default:return".*"}}async function C(Z){const H=String(T.value).toLowerCase().replace(/\s+/g,"");if(H&&T.value!==".*"){const N=H.split(",");Z=Z.filter(ie=>N.includes(ie.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),Z.length||(await new Promise(ie=>{u.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:ie,content:()=>le("div",[le(wn,{description:"NO IMAGES"}),`${l("noimage")}`,le("br"),T.value])})}),R())}return Z}async function ae(Z){S.value=!0,Z=await C(Z),z.value=Z.length,Z.length>0&&k("input",Y(Z)),S.value=!1}let fe=0;function Y(Z){const H=[];for(const N of Z)N.hasOwnProperty("_id")||Object.defineProperty(N,"_id",{value:fe++}),H.push(N);return H}return(Z,H)=>{const N=Ae,ie=Fe,se=Ce,ue=Pt,_e=il,K=qt,Ee=lt;return L(),q(Pe,null,[_("div",qr,[_("div",Gr,[n(se,{vertical:"",align:"center",justify:"center",inline:"",size:"large"},{default:e(()=>[n(se,{align:"center",justify:"space-around",class:"main-buttons"},{default:e(()=>[n(se,{vertical:"",align:"stretch",justify:"center"},{default:e(()=>[n(t(ze),null,{trigger:e(()=>[n(t(Ct),{checked:w.value,"onUpdate:checked":H[0]||(H[0]=de=>w.value=de),size:"small",style:{"font-size":"smaller"}},{default:e(()=>[$(d(Z.$t("settings.autoStartConversion")),1)]),_:1},8,["checked"])]),default:e(()=>[$(d(Z.$t("settings.autoStartConversionTooltip")),1)]),_:1}),n(t(ze),{to:!1,"display-directive":"show",show:t(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:"top",duration:0,delay:0,"z-index":10},{trigger:e(()=>[n(ie,{disabled:!t(E),size:"large",onClick:H[1]||(H[1]=de=>P(t(v))),round:"",style:{width:"100%","background-color":"white","font-size":"1.3em"}},{icon:e(()=>[n(N,{size:"large",color:"gray"},{default:e(()=>[n(t(xn))]),_:1})]),default:e(()=>[$(" "+d(Z.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:e(()=>[_("div",{innerHTML:Z.$t("loadbuttontooltip")},null,8,Kr)]),_:1},8,["show"]),t(B)||t(o).SSR?(L(),q(Pe,{key:0},[n(t(ze),{to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:t(o).showTooltipsBeforeMounted.value},{trigger:e(()=>[n(ie,{disabled:!t(E),size:"large",onClick:H[2]||(H[2]=de=>P(t(x))),round:"",style:{width:"100%","background-color":"white","font-size":"1.3em"}},{icon:e(()=>[n(N,{size:"large",color:"gray"},{default:e(()=>[n(t(In))]),_:1})]),default:e(()=>[$(" "+d(Z.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:e(()=>[_("div",{innerHTML:Z.$t("loadfoldertooltip")},null,8,Qr)]),_:1},8,["show"]),t(o).IS_SP?me("",!0):(L(),J(Wr,{key:0,onDrop:ae,forbidden:!t(E),_class:"drop-target"},null,8,["forbidden"]))],64)):me("",!0)]),_:1})]),_:1}),n(se,{vertical:""},{default:e(()=>[n(se,{wrap:t(o).IS_SP,align:"center",justify:"stretch"},{default:e(()=>[n(t(ze),{to:!1,"display-directive":"show",trigger:"hover","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:t(o).showTooltipsBeforeMounted.value},{trigger:e(()=>[_("span",Yr,d(Z.$t("TargetFileTypeExt"))+": ",1)]),default:e(()=>[$(d(Z.$t("TargetFileTypeExtTooltip")),1)]),_:1},8,["show"]),n(t(ze),{"keep-alive-on-hover":!1,placement:"right",style:{"max-width":"200px"},duration:0,delay:0},{trigger:e(()=>[n(ue,{trigger:"click",width:"trigger",size:"tiny",value:t(y),"onUpdate:value":H[3]||(H[3]=de=>Ie(y)?y.value=de:null),options:r,"render-option":c,"consistent-menu-width":!1},null,8,["value"])]),default:e(()=>[$(" "+d(O(t(y)).replace(/,/g,", ")),1)]),_:1})]),_:1},8,["wrap"]),t(y)==="edit_type"?(L(),J(t(ze),{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:t(g),duration:0,delay:0},{trigger:e(()=>[_("div",Xr,[n(Ee,{trigger:"manual",placement:"right-end",show:t(y)==="edit_type"&&t(p)!=="success"&&!!t(g)},{trigger:e(()=>[n(_e,{value:t(m),"onUpdate:value":H[4]||(H[4]=de=>Ie(m)?m.value=de:null),status:t(p),disabled:t(y)!=="edit_type",onFocus:H[5]||(H[5]=de=>g.value=!0),onBlur:H[6]||(H[6]=de=>g.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:e(()=>[n(K,{type:"error","show-icon":!0,title:"Validation error"},{default:e(()=>H[7]||(H[7]=[$(" Please correct the extension list."),_("br",null,null,-1),_("ul",null,[_("li",null,"Each extension must begin with a period. "),_("li",null,"Separate each extension with a comma. "),_("li",null,"Use alphameric characters.")],-1)])),_:1,__:[7]})]),_:1},8,["show"])])]),default:e(()=>[_("span",{innerHTML:Z.$t("editAcceptTypes")},null,8,Jr)]),_:1},8,["show"])):me("",!0)]),_:1})]),_:1})])]),_("input",{ref_key:"fileinput",ref:v,onInput:ee,onCancel:R,type:"file",multiple:"",accept:t(T),style:{display:"none"}},null,40,eu),_("input",{ref_key:"folderinput",ref:x,webkitdirectory:"",directory:"",onInput:ee,onCancel:R,type:"file",style:{display:"none"}},null,544)],64)}}}),nu=Oe(tu,[["__scopeId","data-v-6f706eda"]]),ou={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function au(i,s){return L(),q("svg",ou,s[0]||(s[0]=[_("path",{fill:"currentColor","fill-rule":"evenodd",d:"M9.293 7.293a1 1 0 0 1 1.414 0L15.414 12l-4.707 4.707a1 1 0 0 1-1.414-1.414L12.586 12L9.293 8.707a1 1 0 0 1 0-1.414","clip-rule":"evenodd"},null,-1)]))}const lu=ot({name:"stash-chevron-right-duotone",render:au}),su={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function iu(i,s){return L(),q("svg",su,s[0]||(s[0]=[_("path",{fill:"currentColor",d:"M5 21q-1.275 0-1.812-1.137t.262-2.113L9 11V5H8q-.425 0-.712-.288T7 4t.288-.712T8 3h8q.425 0 .713.288T17 4t-.288.713T16 5h-1v6l5.55 6.75q.8.975.263 2.113T19 21zm2-3h10l-3.4-4h-3.2zm-2 1h14l-6-7.3V5h-2v6.7zm7-7"},null,-1)]))}const ru=ot({name:"material-symbols-experiment-outline",render:iu}),uu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function cu(i,s){return L(),q("svg",uu,s[0]||(s[0]=[_("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"},[_("path",{d:"M19.5 11c0-.818 0-1.57-.152-1.937s-.441-.657-1.02-1.235l-4.736-4.736c-.499-.499-.748-.748-1.058-.896a2 2 0 0 0-.197-.082C12.014 2 11.661 2 10.956 2c-3.245 0-4.868 0-5.967.886a4 4 0 0 0-.603.603C3.5 4.59 3.5 6.211 3.5 9.456V14c0 3.771 0 5.657 1.172 6.828S7.729 22 11.5 22h8m-7-19.5V3c0 2.828 0 4.243.879 5.121C14.257 9 15.672 9 18.5 9h.5"}),_("path",{d:"M14.5 13.999v5M12 19H9l3-5H9m8 3v-3h2a1.5 1.5 0 0 1 0 3zm0 0v2"})],-1)]))}const du=ot({name:"hugeicons-zip02",render:cu}),pu={style:{"white-space":"nowrap"}},fu=ye({__name:"settings-output",props:Ve({quality:{},format:{},isMultithreadEnabled:{type:Boolean}},{method:{required:!0},methodModifiers:{},"target-folder-handle":{},"target-folder-handleModifiers":{},"action-on-duplicate":{default:"prompt"},"action-on-duplicateModifiers":{}}),emits:Ve(["update:format","update:quality"],["update:method","update:target-folder-handle","update:action-on-duplicate"]),setup(i,{emit:s}){const u=i,l=Te(i,"method"),o=Te(i,"target-folder-handle");Te(i,"action-on-duplicate");const a=s,{t:r}=je(),c=pt();An();const f=at(Qe),w=h([]),k=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],z=Se({get:()=>u.format,set:P=>{P=m(P),a("update:format",P)}}),g=Se({get:()=>u.quality,set:P=>{a("update:quality",P)}}),S=Se(()=>/png|bmp/i.test(z.value)),T=h(null),p=h(!1),E=Se(()=>l.value==="fs"&&!o.value);be(()=>u.isMultithreadEnabled,P=>{P||(l.value="zip")});const y=ni();Me(()=>{A(),!y&&l.value==="fs"&&(l.value="zip")});function m(P){return w.value.indexOf(P)<0&&(P=w.value[0]),P}function A(){for(const P of k)T.value.toDataURL(P).indexOf(P)>=0&&w.value.push(P);w.value.length===0&&w.value.push(k[0])}function v(){return o.value.name}function x(){l.value="fs",Rl(p,200,!1)}async function B(){const P=await oi();if(!P){if(await c.warning({title:"Rejected",positiveText:"OK",maskClosable:!0,content:r("settings.outputFolderDenied")}),o.value)return;l.value="zip"}o.value=P}return(P,R)=>{const ee=Ae,Q=Pt,O=Ce,C=ze,ae=Et,fe=Ln,Y=du,Z=rl,H=xa,N=ru,ie=lu,se=Ca,ue=Tn,_e=Fe,K=qt,Ee=lt,de=ft,ke=Wt;return L(),q(Pe,null,[n(O,{vertical:"",justify:"center",class:"body"},{default:e(()=>[n(O,{vertical:""},{default:e(()=>[n(C,{to:!1,"display-directive":"show",show:t(f).showTooltipsBeforeMounted.value,trigger:"hover",placement:t(f).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(O,{align:"center",wrap:!1},{default:e(()=>[n(ee,null,{default:e(()=>[n(t(xn))]),_:1}),$(d(t(r)("settings.imageType"))+": ",1),n(Q,{value:z.value,"onUpdate:value":R[0]||(R[0]=ce=>z.value=ce),options:w.value.map(ce=>({value:ce,label:ce})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:e(()=>[$(" "+d(t(r)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(C,{to:!1,"display-directive":"show",show:t(f).showTooltipsBeforeMounted.value,trigger:"hover",placement:t(f).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(O,{align:"center"},{default:e(()=>[n(O,{align:"start",wrap:!1},{default:e(()=>[n(ee,null,{default:e(()=>[n(t(Cn))]),_:1}),_("span",pu,d(t(r)("settings.quality"))+":",1),n(O,{align:"center",justify:"space-between"},{default:e(()=>[n(ae,{tooltip:!1,value:g.value,"onUpdate:value":R[1]||(R[1]=ce=>g.value=ce),step:1,style:{width:"120px"},disabled:S.value},null,8,["value","disabled"]),n(fe,{onBlur:R[2]||(R[2]=ce=>g.value=g.value==null?0:g.value),value:g.value,"onUpdate:value":R[3]||(R[3]=ce=>g.value=ce),step:"1",min:"0",max:"100",disabled:S.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:e(()=>[$(" "+d(t(r)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1}),n(ke,{"trigger-areas":["arrow","main"]},{default:e(()=>[n(de,{disabled:l.value==="fs"},{header:e(()=>[$(d(P.$t("settings.changeSaveMethod")),1)]),default:e(()=>[n(O,{vertical:"",align:"stretch",class:"method-box",size:1},{default:e(()=>[n(Z,{checked:l.value==="zip","onUpdate:checked":R[4]||(R[4]=ce=>ce&&(l.value="zip"))},{default:e(()=>[n(O,{align:"center",size:2,class:nt(l.value==="zip"?"method-active":"method-inactive")},{default:e(()=>[n(ee,{size:"1.5em"},{default:e(()=>[n(Y)]),_:1}),_("span",null,d(P.$t("settings.saveAsZIP"))+" ("+d(P.$t("Default"))+") ",1)]),_:1},8,["class"])]),_:1},8,["checked"]),n(Z,{disabled:!t(y)||!P.isMultithreadEnabled,checked:l.value==="fs","onUpdate:checked":R[5]||(R[5]=ce=>ce&&t(y)&&x())},{default:e(()=>[n(O,{align:"center",size:2,class:nt(l.value==="fs"?"method-active":"method-inactive")},{default:e(()=>[n(ee,{size:"1.5em"},{default:e(()=>[n(H)]),_:1}),n(O,{align:"center",size:1},{default:e(()=>[$(d(P.$t("settings.saveToSpecifiedFolder"))+" (",1),n(N),$(d(P.$t("experimental"))+") ",1)]),_:1})]),_:1},8,["class"])]),_:1},8,["disabled","checked"]),n(qe,null,{default:e(()=>[l.value==="fs"?(L(),J(O,{key:0,vertical:"",justify:"center",style:{"margin-left":"2em"}},{default:e(()=>[n(Ee,{trigger:"manual",placement:"right-start",show:p.value&&E.value,"keep-alive-on-hover":!0},{trigger:e(()=>[n(_e,{onClick:R[6]||(R[6]=ce=>B()),size:"small",style:{"justify-content":"start"},ghost:"",color:o.value?"green":"red"},{icon:e(()=>[n(ie)]),default:e(()=>[o.value?(L(),J(O,{key:0,wrap:!1,size:2,align:"center"},{default:e(()=>[n(se),n(ue,{style:{"max-width":"15em"}},{default:e(()=>[$(d(v()),1)]),_:1})]),_:1})):(L(),J(O,{key:1,wrap:!1,size:2,align:"center"},{default:e(()=>[$(d(P.$t("settings.chooseOutputFolder")),1)]),_:1}))]),_:1},8,["color"])]),default:e(()=>[n(K,{type:"error","show-icon":!0,title:P.$t("settings.chooseOutputFolderTooltip")},null,8,["title"])]),_:1},8,["show"])]),_:1})):me("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1}),_("canvas",{ref_key:"canvas",ref:T,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),gu=Oe(fu,[["__scopeId","data-v-0b7a23ab"]]),mu={style:{"font-size":"1.1em"}},vu={style:{"font-size":"1.1em"}},hu={style:{width:"4em","text-align":"left"}},yu={style:{width:"4em","text-align":"left"}},Rt=100,dn=2e3,pn=4096,fn=4096,_u=100,wu=100,bu=ye({__name:"settings-adv",props:{expanded:{type:Boolean,required:!1},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}},emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(i){const s=at(Qe),u={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},l=Te(i,"expanded"),o=Te(i,"multithread"),a=Te(i,"threadCount"),r=Te(i,"maxZipSize"),c=Te(i,"retainExt"),f=Te(i,"useFolderNameForZip"),w=Te(i,"shrinkImage"),k=Te(i,"maxWidth"),z=Te(i,"maxHeight");be(Be,y=>{y>1||(o.value=!1),a.value>y&&(a.value=y)},{immediate:!0});const g=h(!1);let S=!1,T=()=>{};const p=Se(()=>o.value&&Be.value>1);Me(()=>{Be.value>1&&typeof a.value>"u"&&(a.value=Math.max(Be.value,2))});async function E(){S=!1,await new Promise(y=>{g.value=!0,T=y}),S&&Xl()}return(y,m)=>{const A=Ae,v=Fe,x=dl,B=Ce,P=Et,R=Ln,ee=ft,Q=Wt,O=kt;return L(),q(Pe,null,[n(B,{justify:"center"},{default:e(()=>[n(Q,{"display-directive":"show","default-expanded-names":l.value?["collapitem"]:"","on-update:expanded-names":C=>l.value=!!String(C),"trigger-areas":["arrow","main"],class:nt(["settings-body",l.value?"expand-adv-settings":""])},ul({arrow:e(()=>[_("span",mu,[n(A,{style:pe(l.value&&{top:"8px"})},{default:e(()=>[n(t(gl))]),_:1},8,["style"]),n(A,null,{default:e(()=>[n(t(ml))]),_:1})])]),default:e(()=>[n(ee,{name:"collapitem"},{header:e(()=>[_("span",vu,d(y.$t("settings.advancedSettings")),1)]),default:e(()=>[n(B,{vertical:"",style:{"padding-left":"2em"}},{default:e(()=>[n(t(ze),vt(ht(u)),{trigger:e(()=>[n(B,{vertical:""},{default:e(()=>[n(B,{wrap:!1,align:"center"},{default:e(()=>[n(v,{text:"",disabled:!t(Be),style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:m[2]||(m[2]=C=>o.value=!o.value)},{icon:e(()=>[n(A,null,{default:e(()=>[n(t(cl))]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(x,{value:o.value,"onUpdate:value":m[3]||(m[3]=C=>o.value=C),disabled:!t(Be),size:"small"},null,8,["value","disabled"])]),_:1}),n(B,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(P,{value:a.value,"onUpdate:value":m[4]||(m[4]=C=>a.value=C),disabled:!t(Be)||!o.value,step:1,min:2,max:t(Be),style:{width:"120px"}},null,8,["value","disabled","max"]),n(R,{onBlur:m[5]||(m[5]=C=>a.value=a.value==null?2:a.value),size:"tiny",value:a.value,"onUpdate:value":m[6]||(m[6]=C=>a.value=C),disabled:!t(Be)||!o.value,step:1,min:2,max:t(Be),style:{width:"10em"}},{suffix:e(()=>[$(d(y.$t("threads",a.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(t(ze),vt(ht(u)),{trigger:e(()=>[n(B,{vertical:""},{default:e(()=>[n(B,{wrap:!1,align:"center"},{default:e(()=>[n(v,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:e(()=>[n(A,{style:{"vertical-align":"middle"}},{default:e(()=>[n(t(pl))]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(B,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(P,{tooltip:!1,value:r.value,"onUpdate:value":m[7]||(m[7]=C=>r.value=C),step:1,min:Rt,max:dn,style:{width:"120px"}},null,8,["value"]),n(R,{onBlur:m[8]||(m[8]=C=>r.value=r.value==null?Rt:r.value),size:"tiny",value:r.value,"onUpdate:value":m[9]||(m[9]=C=>r.value=C),step:"1",min:Rt,max:dn,style:{width:"10em"}},{suffix:e(()=>m[25]||(m[25]=[$("(MB)")])),_:1},8,["value"])]),_:1})]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(t(ze),vt(ht(u)),{trigger:e(()=>[n(B,{wrap:!1,align:"center"},{default:e(()=>[n(v,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:m[10]||(m[10]=C=>f.value=!f.value)},{icon:e(()=>[n(A,null,{default:e(()=>[n(t(In))]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.useFolderNameForZip")),1)]),_:1}),n(x,{value:f.value,"onUpdate:value":m[11]||(m[11]=C=>f.value=C),size:"small"},null,8,["value"])]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(t(ze),vt(ht(u)),{trigger:e(()=>[n(B,{wrap:!1,align:"center"},{default:e(()=>[n(v,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:m[12]||(m[12]=C=>c.value=!c.value)},{icon:e(()=>[n(A,null,{default:e(()=>[n(t(Sn))]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.retainOriginalExtension")),1)]),_:1}),n(x,{value:c.value,"onUpdate:value":m[13]||(m[13]=C=>c.value=C),size:"small"},null,8,["value"])]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.retainExtTooltip")),1)]),_:1},16),n(t(ze),vt(ht(u)),{trigger:e(()=>[n(B,{vertical:""},{default:e(()=>[n(B,{wrap:!1,align:"center"},{default:e(()=>[n(v,{disabled:!p.value,text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:m[14]||(m[14]=C=>w.value=!w.value)},{icon:e(()=>[n(A,null,{default:e(()=>[n(t(fl))]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(x,{disabled:!p.value,value:w.value,"onUpdate:value":m[15]||(m[15]=C=>w.value=C),size:"small"},null,8,["disabled","value"])]),_:1}),n(B,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(P,{value:k.value,"onUpdate:value":m[16]||(m[16]=C=>k.value=C),disabled:!w.value||!p.value,step:1,min:_u,max:pn,style:{width:"120px"}},null,8,["value","disabled"]),n(R,{size:"tiny",onBlur:m[17]||(m[17]=C=>k.value=k.value==null?8:k.value),value:k.value,"onUpdate:value":m[18]||(m[18]=C=>k.value=C),disabled:!w.value||!p.value,step:1,min:8,max:pn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:e(()=>[_("span",hu,d(y.$t("width")),1)]),suffix:e(()=>m[26]||(m[26]=[$("px")])),_:1},8,["value","disabled","max"])]),_:1}),n(B,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(P,{value:z.value,"onUpdate:value":m[19]||(m[19]=C=>z.value=C),disabled:!w.value||!p.value,step:1,min:wu,max:fn,style:{width:"120px"}},null,8,["value","disabled"]),n(R,{size:"tiny",onBlur:m[20]||(m[20]=C=>z.value=z.value==null?8:z.value),value:z.value,"onUpdate:value":m[21]||(m[21]=C=>z.value=C),disabled:!w.value||!p.value,step:1,min:8,max:fn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:e(()=>[_("span",yu,d(y.$t("height")),1)]),suffix:e(()=>m[27]||(m[27]=[$("px")])),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1})]),_:2},[l.value?{name:"header-extra",fn:e(()=>[n(t(ze),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(v,{onClick:m[0]||(m[0]=C=>E()),size:"tiny",style:{"font-size":"xx-small"}},{default:e(()=>[$(d(y.$t("reset")),1)]),_:1})]),default:e(()=>[$(" "+d(y.$t("settings.resetButtonTooltip")),1)]),_:1}),t(s).IS_DEV?(L(),q("button",{key:0,onClick:m[1]||(m[1]=C=>t(Jl)())},"delcfg")):me("",!0)]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1}),n(O,{preset:"confirm",type:"info",show:t(g),"onUpdate:show":m[22]||(m[22]=C=>Ie(g)?g.value=C:null),title:y.$t("reset"),"positive-text":y.$t("OK"),"negative-text":y.$t("cancel"),onPositiveClick:m[23]||(m[23]=C=>Ie(S)?S.value=!0:S=!0),onAfterLeave:m[24]||(m[24]=C=>t(T)())},{default:e(()=>[$(d(y.$t("warnAboutResetMsg")),1)]),_:1},8,["show","title","positive-text","negative-text"])],64)}}}),ku=Oe(bu,[["__scopeId","data-v-c3ff20ca"]]),zu={},Su={style:{color:"gray","padding-left":"20px"}},Cu=["innerHTML"];function Tu(i,s){const u=yn,l=Ce;return L(),J(l,{vertical:"",justify:"end"},{default:e(()=>[n(u,{style:{margin:"0px"}}),n(l,{justify:"center"},{default:e(()=>[_("ul",Su,[(L(!0),q(Pe,null,it(i.$tm("descriptions"),o=>(L(),q("li",{key:o,style:{"text-align":"left"},innerHTML:o},null,8,Cu))),128))])]),_:1})]),_:1})}const Au=Oe(zu,[["render",Tu]]);function xu(i={}){const{immediate:s=!1,onNeedRefresh:u,onOfflineReady:l,onRegistered:o,onRegisteredSW:a,onRegisterError:r}=i;let c,f,w;const k=async(g=!0)=>{await f,w==null||w()};async function z(){if("serviceWorker"in navigator){if(c=await xe(async()=>{const{Workbox:g}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:g}},[]).then(({Workbox:g})=>new g("/avif2jpeg/dist/sw.js",{scope:"/avif2jpeg/dist/",type:"classic"})).catch(g=>{r==null||r(g)}),!c)return;w=()=>{c==null||c.messageSkipWaiting()};{let g=!1;const S=()=>{g=!0,c==null||c.addEventListener("controlling",T=>{T.isUpdate&&window.location.reload()}),u==null||u()};c.addEventListener("installed",T=>{typeof T.isUpdate>"u"?typeof T.isExternal<"u"&&T.isExternal?S():!g&&(l==null||l()):T.isUpdate||l==null||l()}),c.addEventListener("waiting",S)}c.register({immediate:s}).then(g=>{a?a("/avif2jpeg/dist/sw.js",g):o==null||o(g)}).catch(g=>{r==null||r(g)})}}return f=z(),k}function Iu(i={}){const{immediate:s=!0,onNeedRefresh:u,onOfflineReady:l,onRegistered:o,onRegisteredSW:a,onRegisterError:r}=i,c=h(!1),f=h(!1);return{updateServiceWorker:xu({immediate:s,onNeedRefresh(){c.value=!0,u==null||u()},onOfflineReady(){f.value=!0,l==null||l()},onRegistered:o,onRegisteredSW:a,onRegisterError:r}),offlineReady:f,needRefresh:c}}const Lu={style:{"line-height":"0px"}},$u=["innerHTML"],Fu=ye({__name:"PWAPrompt",setup(i){const s=h(null),u=h(!1),l=h(void 0),o=h(!1),a=h("unknown");window.addEventListener("beforeinstallprompt",p=>{p.preventDefault(),s.value=p,u.value=!0,l.value=!1}),window.addEventListener("appinstalled",p=>{g()});const{needRefresh:r,updateServiceWorker:c}=Iu({onOfflineReady(){},async onNeedRefresh(){const p=await fetch(location.origin+"/avif2jpeg/dist/version.txt",{cache:"no-store"});if(p.status!==200)return;const E=await p.text();E&&(a.value=E)},onRegisterError(p){}});Me(async()=>{setTimeout(f,100)});async function f(){await w()&&(l.value=!!(k()||!u.value),l.value)}async function w(){var E;return await((E=navigator.userAgentData)==null?void 0:E.getHighEntropyValues(["brands"]).then(y=>y.brands.some(m=>m.brand.includes("Chromium")||m.brand.includes("Google Chrome")||m.brand.includes("Microsoft Edge"))))||/Chrome|Chromium|Edg\//.test(navigator.userAgent)}function k(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}async function z(){if(s.value){s.value.prompt();const p=await s.value.userChoice;s.value=null,p.outcome==="accepted"&&setTimeout(g,500)}}function g(){var p;(p=navigator.serviceWorker)==null||p.ready.then(E=>{var y;l.value||((y=E.active)==null||y.postMessage("app-installed"),l.value=!0)})}function S(){o.value=!0,setTimeout(()=>o.value=!1,60*60*1e3)}async function T(){r.value=!1,await c()}return(p,E)=>{const y=Ae,m=Ce,A=ze,v=Fe,x=qt;return L(),q("div",Lu,[l.value===!0?(L(),J(A,{key:0,placement:"bottom"},{trigger:e(()=>[n(m,{id:"app-installed",align:"center",size:1},{default:e(()=>[n(y,{component:t(nn)},null,8,["component"]),E[0]||(E[0]=$("PWA "))]),_:1,__:[0]})]),default:e(()=>[$(d(p.$t("PWAInstalledTooltip")),1)]),_:1})):l.value===!1&&s.value&&!t(r)?(L(),J(A,{key:1,placement:"bottom","keep-alive-on-hover":!0,style:{"max-width":"40vw"},delay:300,duration:150,"z-index":10},{trigger:e(()=>[n(v,{onClick:z,size:"tiny"},{icon:e(()=>[n(y,{component:t(nn)},null,8,["component"])]),default:e(()=>[$(" "+d(p.$t("installAsApp")),1)]),_:1})]),default:e(()=>[_("div",{id:"pwa-tooltip",innerHTML:p.$t("PWAinstallAsAppTooltip")},null,8,$u)]),_:1})):me("",!0),n(qe,null,{default:e(()=>[t(r)&&!o.value?(L(),J(x,{key:0,onClose:S,type:"info",closable:""},{default:e(()=>[n(m,{justify:"space-between",align:"center"},{default:e(()=>[n(m,{vertical:"",class:"message",size:1},{default:e(()=>[_("span",null,d(a.value),1),_("span",null,d(p.$t("PWAUpdateMessage")),1)]),_:1}),n(m,{size:8},{default:e(()=>[n(v,{onClick:T,round:"",type:"primary",size:"small"},{default:e(()=>[$(d(p.$t("Reload")),1)]),_:1}),n(v,{onClick:S,round:"",size:"small"},{default:e(()=>[$(d(p.$t("close")),1)]),_:1})]),_:1})]),_:1})]),_:1})):me("",!0)]),_:1})])}}}),Eu=["innerHTML"],Pu=ye({__name:"switch-lang",props:{delay:{}},emits:["ready","lang-ready","lang-change","lang-change-by-user"],async setup(i,{emit:s}){let u,l;const o=at(Qe),a=Ht(),{locale:r,t:c}=je(),f=pt(),w=i,k=s,z=Object.entries(Ps).map(([A,v])=>({label:v,value:A}));z.sort((A,v)=>{const x=A.label,B=v.label;return x>B?1:x<B?-1:0});let g="";Me(()=>{a.afterEach((A,v,x)=>{p(),o.switchToolTipVisibility()})}),[u,l]=vl(()=>p()),await u,l(),S(),k("ready");function S(){const A="/avif2jpeg/dist/",v=[];for(const x of _t){if(a.currentRoute.value.path.includes(x))continue;const B={rel:"alternate",hreflang:x,href:A+x};v.push(B)}v.push({rel:"alternate",hreflang:"x-default",href:A}),hl({title:c("title"),meta:[{property:"og:title",content:c("title")},{property:"og:description",content:c("metaDescription")}],link:[...v]})}async function T(A){if(A!==r.value||xt.global.availableLocales.indexOf(A)===-1){if(k("lang-change",A),await Ul(w.delay),!await Ds(A))return f.error({title:c("Failed to get language file"),positiveText:"OK",content:()=>le("div",[`lang: ${A}`])}),k("lang-ready",""),!1;r.value=A,document.title=c("title"),document.documentElement.lang=A,await $e()}return k("lang-ready",A),!0}async function p(){var x;const v=((x=(a.currentRoute.value.path||"").match(/([^/]+)\/?$/))==null?void 0:x[1])||"";v&&_t.includes(v)?await T(v)&&g===v&&k("lang-change-by-user",v):await E()}async function E(){const A=y().toLowerCase(),v=A.split(/[-_]/)[0];if(_t.includes(v)){let x=v;if(v==="zh")switch(A){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":x="zh-hant"}await T(x)}}function y(){const A=window.navigator;return A.language||A.userLanguage||A.browserLanguage}function m(A){g=A;const v=A?A+"/":"";a.push("/"+v)}return(A,v)=>{const x=Ae,B=Zt("router-link"),P=ze,R=Pt,ee=Ce;return L(),J(ee,{align:"center",size:2},{default:e(()=>[t(a).currentRoute.value.path!=="/"?(L(),J(P,{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"left",duration:0,delay:50},{trigger:e(()=>[n(B,{to:"/",onClick:v[0]||(v[0]=Q=>k("lang-change-by-user","")),style:{color:"gray","line-height":"0px","font-size":"1.2em"}},{default:e(()=>[n(x,{component:t(yl)},null,8,["component"])]),_:1})]),default:e(()=>[$(d(t(c)("selectLangCloseTooltip")),1)]),_:1})):me("",!0),n(P,{to:!1,trigger:"hover","keep-alive-on-hover":!1,placement:t(o).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:e(()=>[n(R,{ref:"langselect",size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,options:t(z),value:t(r),"onUpdate:value":m},{arrow:e(()=>[n(x,null,{default:e(()=>[n(t(_l))]),_:1})]),_:1},8,["options","value"])]),default:e(()=>[_("div",{innerHTML:A.$t("selectLanguage")},null,8,Eu)]),_:1},8,["placement"])]),_:1})}}}),Qe=Symbol("global variables"),Du=ye({__name:"Avif2Jpeg",emits:["ready"],setup(i,{emit:s}){const{t:u,locale:l}=je(),o=200,a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),r=!1,c=h([]),f=h([]);h(0);let w=h(void 0);const k=h(!0),z=h(!1),g=h(!1),S=h(!1),T=h(!0);h(!1);const p=h(null),E=h(!1),y=h();kl(Qe,{showTooltipsBeforeMounted:w,LANDSCAPE:k,IS_SP:a,IS_DEV:r,switchToolTipVisibility:P,SSR:!1}),Me(()=>{R(),window.addEventListener("resize",R),P(),setTimeout(()=>g.value=!0,3e3)}),At(()=>{window.removeEventListener("resize",R)});function m(){var ae;!((ae=hn().path.match(/[^/]+(?=\/?$)/))==null?void 0:ae[0])&&V.lang&&Ht().push("/"+V.lang)}let A=0;function v(){S.value=!1,A=Date.now()}function x(O){V.lang=O}function B(){const O=T.value?0:Math.max(0,o-(Date.now()-A));T.value=!1,$e(()=>{setTimeout(()=>S.value=!0,O)})}async function P(){}function R(){const O=document.body.clientWidth,C=document.body.clientHeight;k.value=O*.75>C||O>900}async function ee(O){V.autoStartConversion&&(c.value.length=0,await $e()),f.value=O}function Q(O){E.value=O}return(O,C)=>{const ae=Zt("ClientOnly"),fe=Gl,Y=Ce,Z=Ae,H=lt;return L(),J(Y,{vertical:"",align:"stretch",class:"avif2jpeg"},{default:e(()=>[n(Os,null,{"lang-switch":e(()=>[(L(),J(wl,null,{default:e(()=>[n(Pu,{onLangChange:v,onLangReady:B,onLangChangeByUser:x,onReady:m,delay:t(T)?0:o},null,8,["delay"])]),_:1}))]),_:1}),n(ae,null,{default:e(()=>[n(Fu)]),_:1}),n(qe,{name:"fade"},{default:e(()=>[Ge(n(Y,{vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:e(()=>[n(Y,{justify:"space-around",vertical:"",style:{height:"100%"}},{default:e(()=>[n(Ns),n(Y,{justify:"center",align:"center"},{default:e(()=>[n(nu,{key:"key-fselector",target:t(V).acceptTypeValue,"onUpdate:target":C[0]||(C[0]=N=>t(V).acceptTypeValue=N),userExtensions:t(V).editedAcceptTypes,"onUpdate:userExtensions":C[1]||(C[1]=N=>t(V).editedAcceptTypes=N),"disable-notifying-folder-select":t(V).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":C[2]||(C[2]=N=>t(V).disableNotifyingFolderSelect=N),"auto-start-opt":t(V).autoStartConversion,"onUpdate:autoStartOpt":C[3]||(C[3]=N=>t(V).autoStartConversion=N),forbidden:t(z),onInput:ee,onClick:C[4]||(C[4]=N=>Q(!0)),onCancel:C[5]||(C[5]=N=>Q(!1))},null,8,["target","userExtensions","disable-notifying-folder-select","auto-start-opt","forbidden"]),n(Tt,null,{default:e(()=>[Ge(n(fe,{key:"key-filelist","file-list":t(c),"onUpdate:fileList":C[6]||(C[6]=N=>Ie(c)?c.value=N:null),"additional-files":t(f)},null,8,["file-list","additional-files"]),[[Ke,t(c).length]])]),_:1})]),_:1}),n(Y,{vertical:"",align:"center"},{default:e(()=>[n(H,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(Z,{size:"5vh",color:"#DADADA",style:{margin:"0px"}},{default:e(()=>[n(t(bl))]),_:1})]),default:e(()=>[C[22]||(C[22]=_("span",null,"CONVERT TO👇",-1))]),_:1,__:[22]})]),_:1}),n(Y,{vertical:"",align:"center"},{default:e(()=>[n(gu,{format:t(V).imageFormat,"onUpdate:format":C[7]||(C[7]=N=>t(V).imageFormat=N),quality:t(V).imageQuality,"onUpdate:quality":C[8]||(C[8]=N=>t(V).imageQuality=N),method:t(V).outputMethod,"onUpdate:method":C[9]||(C[9]=N=>t(V).outputMethod=N),"target-folder-handle":t(p),"onUpdate:targetFolderHandle":C[10]||(C[10]=N=>Ie(p)?p.value=N:null),"is-multithread-enabled":t(V).multithread},null,8,["format","quality","method","target-folder-handle","is-multithread-enabled"])]),_:1}),n(Br,{input:t(c),format:t(V).imageFormat,quality:t(V).imageQuality,"retain-extension":t(V).retainExtension,maxZipSizeMB:t(V).maxZipSizeMB,threads:t(V).multithread?t(V).threadCount:0,"auto-start":t(V).autoStartConversion,"output-to-dir":t(V).outputMethod==="fs","output-dir-handle":t(V).outputMethod==="fs"?t(p):null,onStart:C[11]||(C[11]=N=>z.value=!0),onEnd:C[12]||(C[12]=N=>z.value=!1)},{"lang-switch":e(()=>C[23]||(C[23]=[])),_:1},8,["input","format","quality","retain-extension","maxZipSizeMB","threads","auto-start","output-to-dir","output-dir-handle"]),n(Y,{vertical:"",align:t(y)?"center":"end",style:{"padding-right":"1em"}},{default:e(()=>[n(ku,{"retain-ext":t(V).retainExtension,"onUpdate:retainExt":C[13]||(C[13]=N=>t(V).retainExtension=N),"use-folder-name-for-zip":t(V).useFolderNameForZip,"onUpdate:useFolderNameForZip":C[14]||(C[14]=N=>t(V).useFolderNameForZip=N),"max-zip-size":t(V).maxZipSizeMB,"onUpdate:maxZipSize":C[15]||(C[15]=N=>t(V).maxZipSizeMB=N),multithread:t(V).multithread,"onUpdate:multithread":C[16]||(C[16]=N=>t(V).multithread=N),"thread-count":t(V).threadCount,"onUpdate:threadCount":C[17]||(C[17]=N=>t(V).threadCount=N),expanded:t(y),"onUpdate:expanded":C[18]||(C[18]=N=>Ie(y)?y.value=N:null),"shrink-image":t(V).shrinkImage,"onUpdate:shrinkImage":C[19]||(C[19]=N=>t(V).shrinkImage=N),"max-width":t(V).maxWidth,"onUpdate:maxWidth":C[20]||(C[20]=N=>t(V).maxWidth=N),"max-height":t(V).maxHeight,"onUpdate:maxHeight":C[21]||(C[21]=N=>t(V).maxHeight=N)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","multithread","thread-count","expanded","shrink-image","max-width","max-height"])]),_:1},8,["align"]),n(Au)]),_:1})]),_:1},512),[[Ke,t(S)]])]),_:1})]),_:1})}}}),Mu={key:0,style:{"text-align":"center"}},Kt=ye({__name:"App",setup(i){const s={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{},Image:{toolbarColor:"#00000099"}},u=h(!0);return Me(()=>{u.value=!1}),(l,o)=>{const a=Tl,r=Cl,c=Sl,f=zl,w=Al;return L(),q(Pe,null,[t(u)?(L(),q("div",Mu," Rendering the page… please wait. ")):me("",!0),n(w,{"theme-overrides":s,style:{width:"100%",height:"100%"}},{default:e(()=>[n(f,null,{default:e(()=>[n(c,{placement:"top-left",closable:!0,max:50},{default:e(()=>[n(r,null,{default:e(()=>[n(a,null,{default:e(()=>[n(Du,{class:nt({hide:t(u)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}}),Ia=[{path:"/",name:"Home",component:Kt}];for(const i of _t)Ia.push({path:"/"+i+"/",strict:!0,name:i,component:Kt});xl(Kt,{routes:Ia,base:"/avif2jpeg/dist/"},({app:i,router:s,routes:u,isClient:l,initialState:o})=>{i.use(xt)});
