var Da=Object.defineProperty;var Oa=(i,s,r)=>s in i?Da(i,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[s]=r;var ut=(i,s,r)=>Oa(i,typeof s!="symbol"?s+"":s,r);import{m as ot,c as q,o as L,a as v,r as m,w as ke,n as $e,d as we,b as We,u as Te,e as Ma,f as X,_ as kt,g as t,h as e,i as st,j as me,k as Ce,l as n,N as Ct,p as I,t as d,F as Pe,q as it,B as Fe,s as Ne,v as Oe,x as vn,T as Tt,y as ze,z as Ae,A as Ie,C as Zt,D as $t,E as at,L as Ua,G as Ra,H as oe,I as lt,J as Ba,K as Na,M as hn,O as Ht,P as yn,Q as Wt,R as Se,S as ja,U as Bt,V as et,W as Za,X as Ha,Y as Ge,Z as Vt,$ as ge,a0 as ct,a1 as qe,a2 as Ke,a3 as _n,a4 as pt,a5 as Ft,a6 as dt,a7 as At,a8 as Wa,a9 as nt,aa as Va,ab as en,ac as tn,ad as wn,ae as qa,af as Et,ag as Ga,ah as Ka,ai as bn,aj as Qa,ak as nn,al as ft,am as Ya,an as kn,ao as Xa,ap as Pt,aq as Ja,ar as el,as as tl,at as Nt,au as zn,av as nl,aw as Sn,ax as Cn,ay as ol,az as al,aA as ll,aB as qt,aC as Tn,aD as sl,aE as An,aF as xn,aG as Gt,aH as il,aI as In,aJ as rl,aK as ul,aL as vt,aM as ht,aN as cl,aO as dl,aP as pl,aQ as fl,aR as gl,aS as ml,aT as on,aU as vl,aV as hl,aW as yl,aX as _l,aY as wl,aZ as bl,a_ as kl,a$ as zl,b0 as Sl,b1 as Cl,b2 as Tl,b3 as Al,b4 as xl}from"./vendor-Ct9teq27.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();const Il={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ll(i,s){return L(),q("svg",Il,s[0]||(s[0]=[v("path",{fill:"currentColor",d:"m12 13.4l-4.9 4.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.9-4.9l-4.9-4.9q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l4.9 4.9l4.9-4.9q.275-.275.7-.275t.7.275t.275.7t-.275.7L13.4 12l4.9 4.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275z"},null,-1)]))}const $l=ot({name:"material-symbols-close-rounded",render:Ll});function He(i,s=2){const r=Math.sign(i);i=Math.abs(i);const l=["Bytes","KB","MB","GB"],o=i?Math.floor(Math.log(i)/Math.log(1024)):0;return`${(i/Math.pow(1024,o)*r).toFixed(s)}${l[o]}`}function Ln(i,s=100,r=!1){s=typeof s=="number"?{width:s,height:s}:s;const{width:l,height:o}=s;let{width:a,height:u}=i;const c=a/u,p=l/o;return c>=p?(a=r?Math.min(l,a):l,u=a/c|0):(u=r?Math.min(o,u):o,a=u*c|0),{width:a,height:u}}class Fl{constructor(){ut(this,"_currentFileCount",0);ut(this,"_currentZipIndex",0);ut(this,"_totalFileCount",0);ut(this,"_zipLengthSumList",[]);ut(this,"_pathBank",{})}increase(s){return s&&(this._pathBank[s]=[this._zipLengthSumList.length,this._currentFileCount]),this._currentFileCount++,this._totalFileCount++}split(){this._zipLengthSumList.push(this._totalFileCount),this._currentZipIndex++,this._currentFileCount=0}get(s){if(typeof s=="number"){let r=this._zipLengthSumList.findIndex((a,u)=>s<a);r===-1&&(r=this._zipLengthSumList.length);const l=this._zipLengthSumList[r-1]||0,o=s-l;return[r,o]}else{const r=this._pathBank[String(s)];if(r)return r}return null}getZipIndex(){return this._currentZipIndex}getIndex(){return this._totalFileCount}}function El(i){return new Promise(s=>setTimeout(s,i))}function Pl(i,s=0,r,l){i.value=r;const o=setTimeout(()=>{i.value=!0},s);return()=>clearTimeout(o)}function Dl(i,s=0){const r=m(i);return ke(r,l=>{l!==void 0&&$e(()=>{setTimeout(()=>r.value=void 0,s)})},{immediate:!0}),r}const $n=we({__name:"prompt-on-dup",props:We({preset:{default:"dialog"},title:{},content:{},type:{},show:{type:Boolean},buttons:{},defaultButtons:{},closable:{type:Boolean},draggable:{type:Boolean},closeOnEsc:{type:Boolean},maskClosable:{type:Boolean},showApplyAll:{type:Boolean},labelApplyAll:{default:"Apply this action to all"}},{applyAllChecked:{type:Boolean},applyAllCheckedModifiers:{}}),emits:We(["start","close","applyAllChange"],["update:applyAllChecked"]),setup(i,{expose:s,emit:r}){const l=i,o=Te(i,"applyAllChecked"),a=r;s({start:f,click:E,close:C,isApplyAllChecked:T});const u=Ma(),c={overwrite:"Overwrite",skip:"Skip",rename:"Rename",cancel:"Cancel"},p=m(),_=m(!1);let w,b;ke(()=>l.show,(k,A)=>{k?f():C()},{immediate:l.show});function f(){p.value=F(),_.value=!0,b=void 0,o.value=!1;const k=new Promise(A=>{w=A});return a("start",k),k}function C(){_.value=!1;const k=b;return setTimeout(()=>{w(k),a("close",k)},50),b}function F(){const k=[];if(l.buttons)for(const A of l.buttons){let N,U;if(typeof A=="string"?N=U=A:A instanceof Array?([U,N]=A,typeof N>"u"&&(N=U)):A&&({key:N,label:U}=A),!N||!U)throw new Error("unexpected button item");k.push([U,N])}else(l.defaultButtons||["overwrite","skip","cancel"]).forEach(N=>{if(!(N in c))throw new Error(`${N} doen't exist in DEF_LABELS`);k.push([c[N],N])});return k}function g(k){return typeof k=="function"?k():k}function E(k){b=k,C()}function z(){b="close",C()}function h(k){a("applyAllChange",k)}function T(){return o.value}return(k,A)=>{const N=Fe,U=Ct,Z=Ce,ae=kt;return L(),X(ae,{show:t(_),closable:k.closable,draggable:k.draggable,preset:k.preset,title:k.title,content:k.content,type:k.type,onClose:A[1]||(A[1]=J=>k.closable&&z()),onEsc:A[2]||(A[2]=J=>k.closeOnEsc&&z()),onMaskClick:A[3]||(A[3]=J=>k.maskClosable&&z())},{action:e(()=>[u.action?st(k.$slots,"action",{key:0}):(L(!0),q(Pe,{key:1},it(t(p),J=>(L(),X(N,{onClick:M=>E(typeof J[1]<"u"?J[1]:J[0])},{default:e(()=>[I(d(g(J[0])),1)]),_:2},1032,["onClick"]))),256))]),default:e(()=>[st(k.$slots,"default"),k.showApplyAll?(L(),X(Z,{key:0,justify:"end",style:{padding:"1em","font-size":"0.8em"}},{default:e(()=>[n(U,{checked:o.value,"onUpdate:checked":A[0]||(A[0]=J=>o.value=J),onUpdateChecked:h},{default:e(()=>[I(d(k.labelApplyAll),1)]),_:1},8,["checked"])]),_:1})):me("",!0)]),header:e(()=>[st(k.$slots,"header")]),icon:e(()=>[st(k.$slots,"icon")]),close:e(()=>[st(k.$slots,"close")]),_:3},8,["show","closable","draggable","preset","title","content","type"])}}}),Ol={class:"list-label"},Ml={class:"sum"},Ul={class:"size"},Rl={class:"files"},Bl={class:"path"},Nl=3,jl=we({__name:"file-list",props:We({additionalFiles:{}},{"file-list":{required:!0},"file-listModifiers":{}}),emits:["update:file-list"],setup(i){const{t:s}=Ne(),r=i,l=Te(i,"file-list"),o=m([]),a=m(""),u=m(0),c=m(),p=m(!1),_=m(""),w=m([[()=>s("dupAction_replace"),"overwrite"],[()=>s("dupAction_skip"),"skip"],[()=>s("cancel"),"cancel"]]);Oe(()=>{ke(()=>r.additionalFiles,async f=>{const C=new Map(l.value.map(E=>[E.webkitRelativePath||E.name,E]));let F=!1,g="";for(const E of f){const z=E.webkitRelativePath||E.name;if(C.has(z)){_.value=z;const h=g||await c.value.start();switch(!g&&p.value&&(g=h),h){case"overwrite":F=!0;break;case"cancel":return;case"skip":default:continue}}C.set(z,E)}(C.size>l.value.length||F)&&(l.value=[...C.values()])}),ke(()=>l.value.length,(f,C)=>{const F=l.value.slice(-3);for(const E of F){const z=URL.createObjectURL(E),h=E.name;o.value.push({url:z,name:h})}const g=Math.min(Nl,l.value.length);o.value.length>g&&(o.value=o.value.slice(-g)),a.value=He(l.value.reduce((E,z)=>E+z.size,0)),u.value=C})});function b(){l.value.length=0,o.value.length=0}return(f,C)=>{const F=vn,g=Ce,E=Zt,z=$l,h=Ae,T=Fe,k=ze;return L(),q("div",null,[n(g,{class:"container",justify:"stretch",align:"stretch",wrap:!1,size:1},{default:e(()=>[n(g,{class:"list-box",wrap:!1,size:0},{default:e(()=>[v("span",Ol,d(f.$t("SourceImageList")),1),n(g,{class:"list-status",vertical:"",size:4,align:"end",justify:"end"},{default:e(()=>[v("div",Ml,d(f.$t("status.total")),1),v("div",Ul,d(t(a)),1),v("div",Rl,[n(F,{active:!0,duration:1e3,"show-separator":"",to:l.value.length,from:t(u)},null,8,["to","from"]),I(" "+d(f.$t("files",l.value.length)),1)])]),_:1}),n(Tt,{name:"list"},{default:e(()=>[(L(!0),q(Pe,null,it(t(o),(A,N)=>(L(),X(E,{key:A.name,src:A.url,alt:A.name,"object-fit":"cover",width:200/t(o).length,height:"100","preview-disabled":"",class:"image-item"},null,8,["src","alt","width"]))),128))]),_:1})]),_:1}),n(g,{class:"button-box",align:"center",justify:"center"},{default:e(()=>[n(k,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,delay:100},{trigger:e(()=>[n(T,{class:"close-button",bordered:!1,color:"gray",ghost:"",size:"tiny",onClick:C[0]||(C[0]=A=>b())},{default:e(()=>[n(g,{vertical:"",align:"center"},{default:e(()=>[n(h,{size:"1.6em"},{default:e(()=>[n(z)]),_:1}),v("span",null,d(f.$t("reset")),1)]),_:1})]),_:1})]),default:e(()=>[I(d(f.$t("resetListButtonTooltip")),1)]),_:1})]),_:1})]),_:1}),n($n,{ref_key:"promptdup",ref:c,closable:"",buttons:t(w),"close-on-esc":"","show-apply-all":"","label-apply-all":f.$t("confirmApplyAllLabel"),"apply-all-checked":t(p),"onUpdate:applyAllChecked":C[1]||(C[1]=A=>Ie(p)?p.value=A:null)},{header:e(()=>[I(d(f.$t("confirmListOverwrite")),1)]),default:e(()=>[v("div",null,d(f.$t("confirmListOverwriteMsg")),1),v("p",Bl,d(t(_)),1)]),_:1},8,["buttons","label-apply-all","apply-all-checked"])])}}}),je=(i,s)=>{const r=i.__vccOpts||i;for(const[l,o]of s)r[l]=o;return r},Zl=je(jl,[["__scopeId","data-v-1abb317d"]]),Hl=10,Re=m(navigator.hardwareConcurrency?Math.min(navigator.hardwareConcurrency,Hl):0),yt={threadCount:{min:2,max:Math.max(2,Re.value)}},Wl={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:Re.value,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1,changeLogCheckedDate:0,lang:"",autoStartConversion:!1,outputMethod:"zip",actionOnDuplicate:"prompt"},Vl=["outputMethod","actionOnDuplicate"],W=$t(Fn({}));function ql(){Fn(W)}function Fn(i){return Object.assign(i,Wl)}const En="avif2jpeg",Dt=JSON.parse(localStorage.getItem(En)||"{}");for(const i in W)if(Dt.hasOwnProperty(i)&&Dt[i]!==void 0){let s=Dt[i];yt.hasOwnProperty(i)&&(yt[i].min>s&&(s=yt[i].min),yt[i].max<s&&(s=yt[i].max)),W[i]=s}function Pn(){const i={};for(const s in W)Vl.includes(s)||(i[s]=W[s]);localStorage.setItem(En,JSON.stringify(i))}window.addEventListener("beforeunload",Pn);function Gl(){localStorage.clear(),window.removeEventListener("beforeunload",Pn)}const Kl={href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-weight":"bolder"}},Ql=we({__name:"github",setup(i){const s=at(Qe);return(r,l)=>{const o=Ae,a=Ce,u=ze;return L(),X(u,{to:!1,"display-directive":"show",show:t(s).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:e(()=>[v("a",Kl,[n(a,{align:"center",size:0},{default:e(()=>[n(o,{size:"1.2em"},{default:e(()=>[n(t(Ua))]),_:1}),l[0]||(l[0]=I("GitHub "))]),_:1,__:[0]})])]),default:e(()=>[I(" "+d(r.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),Yl=["href"],Xl=we({__name:"licenses",setup(i){const s=m(!1),r={Vue:"https://github.com/vuejs/core/blob/main/LICENSE",Vite:"https://github.com/vitejs/vite/blob/main/LICENSE","Vite SSG":"https://github.com/antfu/vite-ssg/blob/main/LICENSE","Naive UI":"https://github.com/TuSimple/naive-ui/blob/main/LICENSE",Ionicons:"https://github.com/ionic-team/ionicons/blob/main/LICENSE"};return(l,o)=>{const a=Fe;return L(),q(Pe,null,[n(a,{text:"",onClick:o[0]||(o[0]=u=>s.value=!0),style:{color:"black","font-size":"small"}},{default:e(()=>o[2]||(o[2]=[I("Licenses")])),_:1,__:[2]}),n(t(kt),{preset:"dialog",ref:"dialog",show:s.value,"onUpdate:show":o[1]||(o[1]=u=>s.value=u),"positive-text":"OK",title:"Licenses"},{default:e(()=>[o[3]||(o[3]=v("h3",null,"Frameworks and Libraries",-1)),v("ul",null,[(L(),q(Pe,null,it(r,(u,c)=>v("li",null,[v("a",{href:u},d(c),9,Yl)])),64))]),o[4]||(o[4]=v("h3",null,"App icon",-1)),o[5]||(o[5]=v("div",null,[I(" The app icon is derived from "),v("a",{href:"https://aomediacodec.github.io/av1-avif/"},"AVIF logo"),I(". ")],-1))]),_:1,__:[3,4,5]},8,["show"])],64)}}}),Jl=1,es=12,ts=1,ns="",zt={major:Jl,minor:es,build:ts,tag:ns},os={style:{"font-size":"x-small","user-select":"none"}},as=we({__name:"version",setup(i){const s=["0.0.118"],r=`${zt.major}.${zt.minor}.${zt.build}${zt.tag}`,l=s.map(c=>({label:`v${c}`,key:c,value:c}));function o(c){const{key:p,label:_}=c,w=u(p),b=oe("a",{href:w},_),f=oe("div",null,b);return oe("div",null,f)}function a(c){location.href=u(c)}function u(c){return`/avif2jpeg/old/${c}/`}return(c,p)=>{const _=Ra;return L(),X(_,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:t(l),"render-label":o,"onUpdate:value":a},{header:e(()=>[v("span",os,d(c.$t("previousVersion")),1)]),default:e(()=>[v("span",{style:{cursor:"pointer"}},"v"+d(r))]),_:1},8,["options"])}}}),ls={key:0,style:{color:"red"}},ss=["innerHTML"],is=we({__name:"changelog",props:{url:{}},setup(i){const s=i,r=m("fetching..."),l=m(!1);Oe(()=>a(s.url));let o=0;async function a(c){const p=await fetch(c,{headers:{Accept:"application/vnd.github.v3+json"}}).then(_=>_.ok?_.text():null);r.value="",p&&(r.value=p.replace(/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2}) \+\d+$/mg,(_,w)=>{const b=new Date(_),f=b.getTime(),C=b.toLocaleString();let F="";return f>W.changeLogCheckedDate&&(l.value=!0,f>o&&(o=f),F="update"),`<span class="date ${F}">${C}</span>`}))}function u(){o>W.changeLogCheckedDate&&(W.changeLogCheckedDate=o),l.value=!1}return(c,p)=>{const _=Ae,w=Ce,b=lt;return L(),X(b,{trigger:"click",placement:"bottom","arrow-point-to-center":"","onUpdate:show":u,style:{"margin-left":"-1em","max-width":"80%","white-space":"initial"}},{trigger:e(()=>[n(w,{align:"center",size:1,style:{cursor:"pointer"}},{default:e(()=>[n(_,{component:t(Ba),size:"1.5em",color:t(l)?"blue":"silver",style:{transition:"color 0.5s"}},null,8,["component","color"]),I(" "+d(c.$t("changelog")),1)]),_:1})]),default:e(()=>[t(r)?(L(),q("pre",{key:1,innerHTML:t(r),class:"commits"},null,8,ss)):(L(),q("div",ls," connection error "))]),_:1})}}}),rs="modulepreload",us=function(i){return"/avif2jpeg/dist/"+i},an={},xe=function(s,r,l){let o=Promise.resolve();if(r&&r.length>0){let u=function(_){return Promise.all(_.map(w=>Promise.resolve(w).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),p=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));o=u(r.map(_=>{if(_=us(_),_ in an)return;an[_]=!0;const w=_.endsWith(".css"),b=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${b}`))return;const f=document.createElement("link");if(f.rel=w?"stylesheet":rs,w||(f.as="script"),f.crossOrigin="",f.href=_,p&&f.setAttribute("nonce",p),document.head.appendChild(f),w)return new Promise((C,F)=>{f.addEventListener("load",C),f.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${_}`)))})}))}function a(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return o.then(u=>{for(const c of u||[])c.status==="rejected"&&a(c.reason);return s().catch(a)})},Dn="English",On="🇬🇧",Mn='AVIF to JPEG "Offline" Batch Converter',Un="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",Rn=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.',"Use this app at your own risk."],Bn="Select your language",Nn="Choose Target File Extentions",jn={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},Zn="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",Hn="Select your images from a dialog window.<br>*Multiple selection allowed.",Wn=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,Vn="Converting images",qn="Aborted",Gn="Some files failed to convert",Kn="Completed",Qn="Currently Busy",Yn="No files with the extentions were found.",Xn="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",Jn="Cancel",eo="Save",to="Close",no="Open",oo="Re-convert",ao="Convert previous selected {n} @:files again",lo="File | Files",so="thread | threads",io="You have not saved the converted images yet.",ro="Data have not been saved",uo="Open Source",co="Open the converted image",po="Copied to clipboard",fo="The converted image was copied to your clipboard as DataURL.",go="Copy the converted image as DataURL",mo="Convert Again",vo={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",showOnlyErrors:"Show only errors",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files",Shrinked:"Shrinked",Shrinking:"Shrinking",saveAll:"Save All",progressRetries:"Retrying files",success:"success",started:"started",total:"total",files:"files",failure:"failure",all:"all",filterLogSelect:"filter",showOnlySuccess:"Only successes",showOnlyError:"Only errors",showAll:"Show all",Progress:"Progress",PreviewImage:"Preview Images",Log:"Log",log:"Log",Output:"Output Results",expandLog:"expand log size",autoScroll:"auto-scroll",sortByStatus:"status",sort:"Sort list by",sortByName:"name",sortBySize:"size",sortByOutputSize:"size(output)",sortByStart:"starting order",sortByCompletion:"output order",outputToDir:"Export to Folder",numberOfFilesWrittenToDir:"Number of files written to the folder"},ho={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file",useFileSystemAPI:"Directly write output files to the local folder",autoStartConversion:"Automatically start conversion after loading images",outputFolderDenied:"Output folder selection was canceled",saveAsZIP:"Save as a ZIP File",changeSaveMethod:"Change Save Method",chooseOutputFolder:"Choose an output folder",saveToSpecifiedFolder:"Write to Selected Folder Directly",actionOnDuplicate:"Action on Duplicate",autoStartConversionTooltip:"Conversion will start automatically after images are loaded. The list is reset each time you load images.",chooseOutputFolderTooltip:"No output folder selected."},yo="Disabled",_o="Download",wo="Reset",bo="Back",ko="Failed",zo="Success",So="Previous version",Co=`
Height`,To="Width",Ao="Don't show this message again",xo="About the warning when selecting a folder",Io="OK",Lo={},$o="You must press the “Upload” button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",Fo="Continue",Eo="Cancel",Po="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",Do="This page may be an outdated version. Please reload the page.",Oo="Reload",Mo='If the conversion process frequently fails and an “Out of Memory” message appears, try reducing or disabling the number of "multi-threads" in the "Advanced Settings".',Uo="Next",Ro="Previous",Bo="or",No="Source Image Extensions",jo="Changelog",Zo="Choose source image extensions",Ho="Drag & Drop AVIF Images to Convert",Wo="Or just drag & drop",Vo="Install as App",qo='Installing allows you to launch this web app directly from desktop icons or other shortcuts. The security level is the same as a regular web page, so it remains safe. For more details, please see <a href="https://support.google.com/chrome/answer/9658361">Google’s support page</a>.',Go="Use the browser’s language setting",Ko="Installed as an app",Qo="A new version of the page is available. Click the Reload button to update.",Yo="Start Conversion",Xo="Default",Jo="Add Images",ea="Add Entire Folder",ta="Source Image List",na="Clear the current list of source images",oa="Click here to start conversion",aa="experimental",la="Show confirmation dialog",sa="Overwrite",ia="Skip",ra="Confirm List Overwrite",ua="This path already exists in the list.",ca="Replace",da="Output folder not specified.",pa="Apply this action to all",fa="A {type} with the same name already exists.",ga="file",ma="folder",va="Overwrite Confirmation",ha="Load source images first",ya="Converted images will be saved to the folder on your local drive.",_a="This feature is experimental. Continue only if it is acceptable to lose data in the output folder.",wa="Images will be written directly to folder",ba="Restore all settings to default",ka={lang:Dn,flags:On,title:Mn,metaDescription:Un,descriptions:Rn,selectLanguage:Bn,fileTypeRadioTitle:Nn,fileTypeRadioOptions:jn,editAcceptTypes:Zn,loadbuttontooltip:Hn,loadfoldertooltip:Wn,processing:Vn,aborted:qn,incomplete:Gn,completed:Kn,interfered:Qn,noimage:Yn,avifUnsupported:Xn,cancel:Jn,save:eo,close:to,open:no,reconvert:oo,reconvertTip:ao,files:lo,threads:so,confirmCloseDialog:io,confirmCloseDialogTitle:ro,githubOpenSource:uo,convertedImageUrlTooltip:co,copiedDataURLDialogTitle:po,copiedDataURLMessage:fo,convertedImageDataUrlTooltip:go,convertAgain:mo,status:vo,settings:ho,disabled:yo,Download:_o,reset:wo,back:bo,failed:ko,success:zo,previousVersion:So,height:Co,width:To,checkboxTextDontShowThis:Ao,loadfolderNotifyingTitle:xo,OK:Io,loadfolderNotifyingMessage:Lo,loadfolderNotifyingMessageTerm2:$o,Continue:Fo,Cancel:Eo,loadfolderNotifyingMessageTerm1:Po,errMsgWorkerLoadError:Do,Reload:Oo,annotationOutOfMemory:Mo,Next:Uo,Prev:Ro,or:Bo,TargetFileTypeExt:No,changelog:jo,TargetFileTypeExtTooltip:Zo,droptargetTooltip:Ho,droptargetLabel:Wo,installAsApp:Vo,PWAinstallAsAppTooltip:qo,selectLangCloseTooltip:Go,PWAInstalledTooltip:Ko,PWAUpdateMessage:Qo,StartConversion:Yo,Default:Xo,loadbutton:Jo,loadfolderbutton:ea,SourceImageList:ta,resetListButtonTooltip:na,convertTooltip:oa,experimental:aa,dupAction_prompt:la,dupAction_overwrite:sa,dupAction_skip:ia,confirmListOverwrite:ra,confirmListOverwriteMsg:ua,dupAction_replace:ca,errMsgOutputDirNotFound:da,confirmApplyAllLabel:pa,confirmFileOverwriteMsg:fa,file:ga,folder:ma,confirmFileOverwriteTitle:va,convertUnpreparedTooltip:ha,warnAboutFileSysBeforeConversion1:ya,warnAboutFileSysBeforeConversion2:_a,warnAboutFileSysTitle:wa,warnAboutResetMsg:ba},cs=Object.freeze(Object.defineProperty({__proto__:null,Cancel:Eo,Continue:Fo,Default:Xo,Download:_o,Next:Uo,OK:Io,PWAInstalledTooltip:Ko,PWAUpdateMessage:Qo,PWAinstallAsAppTooltip:qo,Prev:Ro,Reload:Oo,SourceImageList:ta,StartConversion:Yo,TargetFileTypeExt:No,TargetFileTypeExtTooltip:Zo,aborted:qn,annotationOutOfMemory:Mo,avifUnsupported:Xn,back:bo,cancel:Jn,changelog:jo,checkboxTextDontShowThis:Ao,close:to,completed:Kn,confirmApplyAllLabel:pa,confirmCloseDialog:io,confirmCloseDialogTitle:ro,confirmFileOverwriteMsg:fa,confirmFileOverwriteTitle:va,confirmListOverwrite:ra,confirmListOverwriteMsg:ua,convertAgain:mo,convertTooltip:oa,convertUnpreparedTooltip:ha,convertedImageDataUrlTooltip:go,convertedImageUrlTooltip:co,copiedDataURLDialogTitle:po,copiedDataURLMessage:fo,default:ka,descriptions:Rn,disabled:yo,droptargetLabel:Wo,droptargetTooltip:Ho,dupAction_overwrite:sa,dupAction_prompt:la,dupAction_replace:ca,dupAction_skip:ia,editAcceptTypes:Zn,errMsgOutputDirNotFound:da,errMsgWorkerLoadError:Do,experimental:aa,failed:ko,file:ga,fileTypeRadioOptions:jn,fileTypeRadioTitle:Nn,files:lo,flags:On,folder:ma,githubOpenSource:uo,height:Co,incomplete:Gn,installAsApp:Vo,interfered:Qn,lang:Dn,loadbutton:Jo,loadbuttontooltip:Hn,loadfolderNotifyingMessage:Lo,loadfolderNotifyingMessageTerm1:Po,loadfolderNotifyingMessageTerm2:$o,loadfolderNotifyingTitle:xo,loadfolderbutton:ea,loadfoldertooltip:Wn,metaDescription:Un,noimage:Yn,open:no,or:Bo,previousVersion:So,processing:Vn,reconvert:oo,reconvertTip:ao,reset:wo,resetListButtonTooltip:na,save:eo,selectLangCloseTooltip:Go,selectLanguage:Bn,settings:ho,status:vo,success:zo,threads:so,title:Mn,warnAboutFileSysBeforeConversion1:ya,warnAboutFileSysBeforeConversion2:_a,warnAboutFileSysTitle:wa,warnAboutResetMsg:ba,width:To},Symbol.toStringTag,{value:"Module"})),ds="Arabic",ps="German",fs="English",gs="Spanish",ms="Finnish",vs="French",hs="Hindi",ys="Indonesian",_s="Italian",ws="Japanese",bs="Korean",ks="Dutch",zs="Polish",Ss="Portuguese",Cs="Russian",Ts="Turkish",As="Ukrainian",xs="Chinese",Is={ar:ds,de:ps,en:fs,es:gs,fi:ms,fr:vs,hi:hs,id:ys,it:_s,ja:ws,ko:bs,nl:ks,pl:zs,pt:Ss,ru:Cs,tr:Ts,uk:As,"zh-hant":"Chinese(hant)",zh:xs},_t=[],za={en:ka},Kt={},ln=Object.assign({"./locales/ar.json":()=>xe(()=>import("./ar-Cq3xFD0d.js"),[]),"./locales/de.json":()=>xe(()=>import("./de-BYyL2Q8a.js"),[]),"./locales/en.json":()=>xe(()=>Promise.resolve().then(()=>cs),void 0),"./locales/es.json":()=>xe(()=>import("./es-y3kENsfK.js"),[]),"./locales/fi.json":()=>xe(()=>import("./fi-BOOsWj3A.js"),[]),"./locales/fr.json":()=>xe(()=>import("./fr-DBPGR-AH.js"),[]),"./locales/hi.json":()=>xe(()=>import("./hi-C0yXRgeK.js"),[]),"./locales/id.json":()=>xe(()=>import("./id-BKh816kV.js"),[]),"./locales/it.json":()=>xe(()=>import("./it-BZjU0Iw8.js"),[]),"./locales/ja.json":()=>xe(()=>import("./ja-DjfSGWhz.js"),[]),"./locales/ko.json":()=>xe(()=>import("./ko-DcgjgIJ8.js"),[]),"./locales/nl.json":()=>xe(()=>import("./nl-C0-dxknq.js"),[]),"./locales/pl.json":()=>xe(()=>import("./pl-BT6NOQ9_.js"),[]),"./locales/pt.json":()=>xe(()=>import("./pt-CpN3z_92.js"),[]),"./locales/ru.json":()=>xe(()=>import("./ru-GLKsqtkO.js"),[]),"./locales/tr.json":()=>xe(()=>import("./tr-jnx2eT_g.js"),[]),"./locales/uk.json":()=>xe(()=>import("./uk-q8xUtVmg.js"),[]),"./locales/zh-hant.json":()=>xe(()=>import("./zh-hant-DrVla1ow.js"),[]),"./locales/zh.json":()=>xe(()=>import("./zh-CbAaPGeL.js"),[])});var mn;for(const i in ln){const s=(mn=i.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:mn[1];s&&(_t.push(s),!(s in za)&&(Kt[s]=ln[i]))}let jt=$s();jt in Kt||(jt="en");const xt=Na({legacy:!1,globalInjection:!0,locale:jt,fallbackLocale:"en",messages:za,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Ls(i){if(xt.global.availableLocales.indexOf(i)>=0)return!0;const s=await Kt[i]().catch(r=>{});return s?(xt.global.setLocaleMessage(i,s),await $e(),!0):!1}function $s(){const i=location.pathname;return String(i.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Fs=we({__name:"header",setup(i){const s=hn(),{locale:r}=Ne();return(l,o)=>{const a=Ht("router-link"),u=Ce,c=yn;return L(),X(u,{vertical:"",justify:"start"},{default:e(()=>[n(u,{justify:"space-between",align:"center",wrap:!1},{default:e(()=>[n(u,{align:"center"},{default:e(()=>[n(Ql),n(as),n(is,{url:"/avif2jpeg/dist/commits.txt"}),n(Xl),n(u,{style:{"font-size":"1em"}},{default:e(()=>[t(s).path!=="/"?(L(),X(a,{key:0,to:"/",style:{color:"black"}},{default:e(()=>o[0]||(o[0]=[I("HOME")])),_:1,__:[0]})):me("",!0)]),_:1})]),_:1}),n(u,{align:"end",id:"langtarget"},{default:e(()=>[st(l.$slots,"lang-switch")]),_:3})]),_:3}),n(c,{style:{margin:"0px"}})]),_:3})}}}),Es="/avif2jpeg/dist/pwa-64x64.png",Ps={style:{padding:"0px",margin:"0px","text-align":"center"}},Ds=we({__name:"title",setup(i){const s=Wt();return Se(()=>{const r=s.currentRoute.value.path||"";return!String(r.match(new RegExp("(?<=^\\/)[^/]+"))||"")}),(r,l)=>{const o=Ce;return L(),X(o,{align:"center",justify:"center",style:{margin:"0px"}},{default:e(()=>[v("h1",Ps,[l[0]||(l[0]=v("img",{src:Es,style:{height:"1em","vertical-align":"middle"}},null,-1)),I(" "+d(r.$t("title")),1)])]),_:1})}}}),Os={viewBox:"0 0 15 16",width:"1.13em",height:"1.2em"};function Ms(i,s){return L(),q("svg",Os,s[0]||(s[0]=[ja('<path fill="currentColor" d="m6.22 8.14l-3.17 4.28c-.18.24 0 .58.29.58h6.32c.3 0 .47-.34.29-.58L6.8 8.14c-.14-.2-.44-.2-.58 0"></path><path fill="currentColor" d="m9.72 10.09l-1.9 2.57c-.11.14 0 .35.17.35h3.79c.18 0 .28-.2.17-.35l-1.89-2.57a.215.215 0 0 0-.35 0Z"></path><circle cx="10" cy="8" r="1" fill="currentColor"></circle><path fill="currentColor" d="M12.5 16h-10c-.83 0-1.5-.67-1.5-1.5v-13C1 .67 1.67 0 2.5 0h7.09c.4 0 .78.16 1.06.44l2.91 2.91c.28.28.44.66.44 1.06V14.5c0 .83-.67 1.5-1.5 1.5M2.5 1c-.28 0-.5.22-.5.5v13c0 .28.22.5.5.5h10c.28 0 .5-.22.5-.5V4.41a.47.47 0 0 0-.15-.35L9.94 1.15A.5.5 0 0 0 9.59 1z"></path><path fill="currentColor" d="M13.38 5h-2.91C9.66 5 9 4.34 9 3.53V.62c0-.28.22-.5.5-.5s.5.22.5.5v2.91c0 .26.21.47.47.47h2.91c.28 0 .5.22.5.5s-.22.5-.5.5"></path>',5)]))}const Us=ot({name:"formkit-fileimage",render:Ms}),Rs={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Bs(i,s){return L(),q("svg",Rs,s[0]||(s[0]=[v("path",{fill:"currentColor",d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm0-2h16V8h-8.825l-2-2H4zm0 0V6z"},null,-1)]))}const Sa=ot({name:"material-symbols-folder-outline",render:Bs}),Ns={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function js(i,s){return L(),q("svg",Ns,s[0]||(s[0]=[v("path",{fill:"currentColor",d:"M12 .037C5.373.037 0 5.394 0 12s5.373 11.963 12 11.963c6.628 0 12-5.357 12-11.963S18.627.037 12 .037m-.541 4.8c1.91-.13 3.876.395 5.432 1.934c1.426 1.437 2.51 3.44 2.488 5.317h2.133l-4.444 4.963l-4.445-4.963h2.313c-.001-1.724-.427-2.742-1.78-4.076c-1.325-1.336-2.667-2.11-4.978-2.303a9.2 9.2 0 0 1 3.281-.871zM6.934 6.95l4.445 4.963H9.066c0 1.724.426 2.742 1.778 4.076c1.326 1.336 2.667 2.112 4.978 2.305c-2.684 1.268-6.22 1.398-8.71-1.064c-1.427-1.437-2.512-3.44-2.489-5.317H2.488z"},null,-1)]))}const Zs=ot({name:"simple-icons-convertio",render:js}),sn=new Set,Hs=new Set,Ws=new Set,It=new Map;function Vs(i){const s=It.get(i);s&&(It.delete(i),s(),St==null||St(),St=null)}function qs(){for(const i of It.keys())Vs(i)}let St=null;function Ca(){qs();for(const i of sn)i.onmessage=null,i.terminate();sn.clear(),Hs.clear(),Ws.clear(),It.clear()}function Gs(i){return new Worker("/avif2jpeg/dist/assets/worker.zip-Bt_6u_43.js",{name:i==null?void 0:i.name})}function Ks(i){return new Worker("/avif2jpeg/dist/assets/worker.loader-S4gdDaLf.js",{name:i==null?void 0:i.name})}function Qs(){return typeof window.showDirectoryPicker=="function"}async function Ys(){let i,s;try{s=await window.showDirectoryPicker(),s&&(i=await s.quryPermission({mode:"readwrite"}),i!=="granted"&&(i=await s.requestPermission({mode:"readwrite"})))}catch{}if(i!=="granted")try{i=await s.requestPermission({mode:"readwrite"})}catch{return null}return i==="granted"?s:null}async function Xs(i,s,r){const l=s.split("/"),o=l.pop();let a=i;for(const c of l)a=await a.getDirectoryHandle(c);const u=await a.getFileHandle(o);return r?u.getFile():u}async function Js(i,s){const r=s.split("/"),l=r.pop();let o=i;for(const a of r)o=await o.getDirectoryHandle(a);return await o.getDirectoryHandle(l)}async function ei(i,s,r,l,o){const u=await(await i.getFileHandle(s,{create:!0})).createWritable();return await u.write(r),await u.close(),!0}async function ti(i,s,r,l){const o=r===!0;let a;try{if(a=await i.getDirectoryHandle(s,{create:o}),o)return a;!r||typeof r=="function"&&await r(i,s,l)}catch(u){if(u.name==="NotFoundError")a=await i.getDirectoryHandle(s,{create:!0});else throw u}return a}const rn=new Map;async function ni(i,s,r,l){let o=rn.get(i);o||(o={},rn.set(i,o));const a=[];let u=i,c;const p=typeof s=="string"?s.split("/"):s;c=p.join("/");do{if(o[c]){u=o[c],c+="/";break}a.unshift(p.pop()),c=p.join("/")}while(p.length);for(const _ of a){if(!_)throw new Error("folderName is empty");if(u=await ti(u,_,r,c),!u)return null;o[c+_]=u,c+=_+"/"}return u}async function oi(i,s,r,l){const o=s.split("/"),a=o.pop();if(!a)throw new Error("fileName is empty");const u=o.length?await ni(i,o,l):i;return u?await ei(u,a,r,l,o.length?o.join("/")+"/":""):!1}function ai(i){const s=new Set;for(const r of i){const o=r.webkitRelativePath.split("/");do{o.pop();const a=o.join("/");if(s.has(a))break;s.add(a)}while(o.length>=2)}return s}async function li(i,s){const l=[...ai(s)].sort(),o=new Set;let a,u="";for(let c of l){let p=c;u&&c.startsWith(u+"/")?p=p.slice(u.length+1):a=i;try{a=await Js(a,p),o.add(c),u=c}catch{u=""}}return o}const si=1e3*10;let tt;const Be=new Map,bt=new Map,Lt=new Map;let B;function Ot(i){tt=null,Be.clear(),bt.clear(),Lt.clear(),bt.clear(),Lt.clear(),B={...i}}async function ii(i){Ot(i),B.completedFileIdSet.clear(),B.completedFileDat.length=0;let s;try{s=await ri()}catch{return Ot(),{exception:new Error("worker-load-error"),callbackToClearConverter:new Function,callbackToGenerateFailedZips:new Function}}const[r,l]=s;tt=l;const o=new Promise(f=>{l.onmessage=C=>{const F=C.data,{action:g}=F;switch(g){case"squeeze-zip":case"zip-squeeze-error":f(void 0);break}}}),a=new Promise(f=>{r.onmessage=C=>{const{data:{action:F}}=C;F==="close-loader"&&f()}}),u=B.files.map(f=>[f._id,f.webkitRelativePath]);B.files.forEach(f=>bt.set(f._id,f));const c=ke(B.canceled,f=>{if(!f)return;c();const C={action:"cancel-convert"};r.postMessage(C)}),p={action:"start-convert",list:B.files,extraPropsForList:u,outputQuality:B.quality,outputType:B.format,keepExt:B.props.retainExtension,outputExt:B.outputExt,fsysDirHandler:B.fsysDirHandler,existingFolders:B.existingFolders,threads:B.props.threads,maxSize:W.shrinkImage?{width:W.maxWidth,height:W.maxHeight}:null};r.postMessage(p),await a,l.postMessage({action:"squeeze"}),await o,c();const _=()=>{Ca(),l.onmessage=null,l.terminate(),r.onmessage=null,r.terminate(),Ot()};let w=!1;return{callbackToClearConverter:_,callbackToGenerateFailedZips:async f=>{w||(w=!0,await yi(f,l,{},B.ConvStats))}}}async function ri(){Ca();const i=new Ks,s=new Gs,r=new Promise((u,c)=>{const p=C=>{s.removeEventListener("message",b),i.removeEventListener("message",b),clearTimeout(f),C?u(C):c(C)};let _=!1,w=!1;const b=C=>{C.target===s&&(_=!0),C.target===i&&(w=!0),_&&w&&p(!0)};let f=0;s.addEventListener("message",b),i.addEventListener("message",b),f=window.setTimeout(()=>p(!1),si)}),{port1:l,port2:o}=new MessageChannel,a={action:"set-zip-port"};return s.postMessage({action:"set-port-loader"},[l]),i.postMessage(a,[o]),await r,s.postMessage({action:"set-config",zipSize:B.props.maxZipSizeMB*1024*1024,keepExt:B.props.retainExtension,outputExt:B.outputExt,imageType:B.imageType}),i.addEventListener("message",ci),s.addEventListener("message",ui),[i,s]}const ui=i=>{const s=i.data,{action:r}=s;switch(r){case"add-zip-completed":{const{fileId:u,entireIndex:c,storedPath:p}=s;return}case"respond-image":{const{url:u,index:c,path:p,size:_,fileId:w}=s;B.ConvStats.convertedImageUrl=u,B.ConvStats.convertedImageSize=_,B.ConvStats.convertedImageIndex=c,B.ConvStats.convertedImageName=p;let b="",f=0,C="";const F=Be.get(w);if(w>=0){const g=bt.get(w);b=URL.createObjectURL(g),f=g.size,C=g.webkitRelativePath||g.name}B.ConvStats.convertedImageOrgUrl=b,B.ConvStats.convertedImageOrgSize=f,B.ConvStats.convertedImageOrgName=C,B.ConvStats.convertedImageShrinked=F==null?void 0:F.shrinked;return}case"respond-delete":{const{index:u,success:c,fileId:p}=s;Be.get(p).command="❌deleted",Be.get(p).completed=!1;return}}switch(r){case"error-push-filelist-zip":const{path:u}=s;B.ConvStats.failedZipDone=!0,B.message.error(`an error occurred "${u}"`,{duration:3e3});return}const{size:l,count:o}=s,a="url"in i.data?i.data.url:"";switch(r){case"push-zip":B.ConvStats.zips.push({url:a,size:l,count:o}),B.ConvStats.zippedTotalCount+=o,B.ConvStats.zippedTotalSize+=l;break;case"squeeze-zip":o>0&&(B.ConvStats.zips.push({url:a,size:l,count:o}),B.ConvStats.zippedTotalCount+=o,B.ConvStats.zippedTotalSize+=l);break;case"push-filelist":B.ConvStats.failedFileZippedCount++;break;case"squeeze-filelist-zip":B.ConvStats.failedZipDone=!0;case"push-filelist-zip":B.ConvStats.failedZips.push({url:a,size:l,count:o});break;case"zip-error":case"zip-squeeze-error":B.ConvStats.zippingErrorCount+=o;break}},ci=async i=>{const s=i.target,{data:r}=i,{action:l}=r;switch(l){case"list-start":break;case"list-end":break;case"file-start":{const{index:o,path:a,fileId:u}=r;pi(o,a,u);break}case"file-load":{const{thumbnail:o,width:a,height:u,fileId:c,workerId:p,inputsize:_}=r,w=Be.get(c);w.core=p,w.command="🖼️loaded",w.width=a,w.height=u,w.size=_,o&&(B.ConvStats.thumbnail=o);break}case"file-converted":{const{index:o,path:a,fileId:u,shrinked:c,outputWidth:p,outputHeight:_,outputsize:w,convertedImageBlob:b}=r,f=Be.get(u);f.command="🔃converted",f.shrinked=f.shrinked==null?c:f.shrinked,f.outputWidth=p,f.outputHeight=_,f.outputSize=w,B.ConvStats.converted++;break}case"file-sys-completed":case"file-completed":{const{inputsize:o,outputsize:a,fileId:u,storedPath:c}=r,p=Be.get(u);if(p&&(p.command="✅completed",p.completed=!0,p.fileId=u),B.ConvStats.inputTotalSize+=o,B.ConvStats.outputTotalSize+=a,B.ConvStats.done++,B.ConvStats.success++,B.completedFileIdSet.add(u),l==="file-sys-completed"&&(p.zippedIndex=B.completedFileDat.length,B.completedFileDat.push({path:c,id:u})),l==="file-completed"){const{entireIndex:_}=r;p.zippedIndex=_,B.ConvStats.ziplogs[_]={fileId:u,storedPath:c}}break}case"file-retry":{const{index:o,path:a,fileId:u}=r;fi(o,a,u);break}case"file-error":{const{index:o,path:a,fileId:u}=r;gi(o,a,u);break}case"file-canceled":{const{fileId:o,path:a}=r;mi(o);break}case"file-skip":{const{fileId:o,path:a}=r;vi(o);break}case"confirm-overwrite":{const{target:o,type:a,path:u,fileId:c,workerId:p}=r,_=await new Promise(w=>B.enqueueOverwriteConfirmation(w,o,a,u));s.postMessage({action:"respond-overwrite",command:_,target:o,path:u,fileId:c,workerId:p});break}}};let di=0;function pi(i,s,r){const l={key:di++,core:-1,index:i,path:s,command:"➡️started"};Be.set(r,l),B.ConvStats.logs.push(l),Lt.has(r)||B.canceled.value||B.ConvStats.startedCount++}function fi(i,s,r){const l=Be.get(r);l.command="⚠️retry",l.error=!0,B.ConvStats.retried++,Lt.set(r,1)}function gi(i,s,r){const l=Be.get(r);B.ConvStats.done++,B.ConvStats.failure++,l.command="❗failed",l.error=!0}function mi(i){const s=Be.get(i);B.ConvStats.done++,B.ConvStats.failure++,s.command="❗canceled",s.error=!0}function vi(i){const s=Be.get(i);B.ConvStats.done++,B.ConvStats.failure++,s.command="⚠skipped",s.error=!0}async function hi(i){if(B.fsysDirHandler){const s=B.completedFileDat[i];if(!s)return;const r=s.id;let l="",o=0,a="";if(Be.get(r),r>=0){const _=bt.get(r);l=URL.createObjectURL(_),o=_.size,a=_.webkitRelativePath||_.name}B.ConvStats.convertedImageOrgUrl=l,B.ConvStats.convertedImageOrgSize=o,B.ConvStats.convertedImageOrgName=a;const u=s.path,c=await Xs(B.fsysDirHandler,u,!0),p=URL.createObjectURL(c);B.ConvStats.convertedImageUrl=p,B.ConvStats.convertedImageSize=c.size,B.ConvStats.convertedImageIndex=i,B.ConvStats.convertedImageName=s.path}else tt==null||tt.postMessage({action:"request-image",index:i})}function Mt(i){tt==null||tt.postMessage({action:"delete-image",index:i})}async function yi(i,s,r,l){let o=0;for(const a of i){const u=(a.webkitRelativePath||a.name).replace(/^\//,"");if(l.failedZipDone)break;if(r.value)return;o-l.failedFileZippedCount>20&&await new Promise(c=>setTimeout(c,10)),s.postMessage({action:"add-filelist",file:a,path:u}),o++}if(l.failedZipDone){B.message.error("Zipping error files was aborted",{duration:5e3});return}s.postMessage({action:"squeeze-filelist"})}let wt;async function _i(i,s,r,l,o){let a="";const u=document.createElement("canvas"),c=u.getContext("2d");let p=new Bt;const _=[p],w=new Fl,b=r.format,f=r.quality/100,C=[...b.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),F=i.length,g=r.maxZipSizeMB*1024*1024;let E=0,z=null,h="",T="",k=0,A=0,N=0,U=0,Z=0,ae=!1;wt=Q=>{const[j,H]=w.get(Q),R=_[j],se=R.get(H,b);o.convertedImageIndex=Q,o.convertedImageName=R.getPathByIndex(H),o.convertedImageUrl=URL.createObjectURL(se),o.convertedImageSize=se.size;let le="",ue=0,ye="";const K=J[Q];le=URL.createObjectURL(K),ue=K.size,ye=K.webkitRelativePath||K.name,o.convertedImageOrgUrl=le,o.convertedImageOrgSize=ue,o.convertedImageOrgName=ye};const J=[];for(const Q of i){if(l.value)break;const j=Q.name;let H="";const R=Q.size,se=(Q.webkitRelativePath||Q.relativePath||j).replace(/^\//,""),le=document.createElement("img"),ue={key:N++,core:-1,index:E++,path:se,command:"➡️start"};o.startedCount=E,o.logs.push(ue),o.logs.length-1,a&&(URL.revokeObjectURL(a),a=""),a=URL.createObjectURL(Q),T=a,k=Q.size,le.src=a;const ye=await Ta(le).then(()=>!0).catch(()=>!1);if(!le.complete||!ye||l.value){o.done++,o.failure++,ue.command="❗failed";continue}const K=le.width,Ee=le.height;u.width=K,u.height=Ee,c.drawImage(le,0,0,K,Ee,0,0,K,Ee),ue.command="🖼️imgload",ue.width=K,ue.height=Ee,ue.size=Q.size,o.thumbnail=le;const de=await new Promise(_e=>{const Me=Ue=>{z=Ue,_e(Ue)};u.toBlob(Me,b,f)});if(l.value)break;if(!de){o.failure++;continue}A=de.size,o.converted++,ue.outputSize=A;let be="";if(Z+A>=g){try{await p.wait(),be=await p.url()}catch{ae=!0,alert("memory problem occurred");break}o.zips.push({url:be,size:Z,count:U}),o.zippedTotalCount+=U,o.zippedTotalSize+=Z,Z=0,U=0,w.split(),p=new Bt,_.push(p)}Z+=A;const ce=se||j;for(let _e=1;_e<255&&(H=ce.replace(r.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(_e>1?`(${_e})`:"")+"."+C,!!p.has(H));_e++);o.done++;try{U++,p.add(H,de)}catch{continue}w.increase(),J.push(Q),o.inputTotalSize+=R,o.outputTotalSize+=A,o.ziplogs.push({fileId:Q._id,storedPath:H}),h=H,ue.zippedIndex=o.success,o.success++,ue.command="✅completed",ue.completed=!0,ue.fileId=Q._id,s.add(Q._id)}if(o.success>0)if(F===1)z&&(o.convertedImageIndex=0,o.convertedImageName=h.replace(/^.*\/(?=[^/]+$)/,"").replace(r.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+C,o.convertedImageUrl=URL.createObjectURL(z),o.convertedImageOrgUrl=T,o.convertedImageOrgSize=k);else try{if(ae)throw new Error("terminated zipping process for memory problems");await p.wait();const Q=await p.url();o.zips.push({url:Q,count:U,size:Z}),o.zippedTotalCount+=U,o.zippedTotalSize+=Z}catch{}const M={value:!1},S=()=>{M.value=!0,_.forEach(Q=>Q.clear()),_.length=0,J.length=0,wt=null};let re=!1;return{callbackToClearConverter:S,callbackToGenerateFailedZips:async Q=>{re||(re=!0,bi(Q,g,o,M))}}}function wi(i){wt==null||wt(i)}async function bi(i,s,r,l){let o=0,a=0,u=new Bt;for(let c=0;c<i.length;c++){const p=i[c],_=(p.webkitRelativePath||p.name).replace(/^\//,"");if(l.value)return;try{await u.add(_,p)}catch{alert(`an error occurred during access to "${_}"`);break}if(a+=p.size,o++,r.failedFileZippedCount++,a>=s||c===i.length-1){await u.zip();const w=await u.url();r.failedZips.push({url:w,size:a,count:o}),u.clear(),a=0,o=0}}r.failedZipDone=!0}function Ta(i){if(typeof i.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((s,r)=>{i.onload=s,i.onerror=r})}const ki=["href","download","title"],zi='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',Si=we({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean},hidden:{type:Boolean}},emits:["load","error","next","prev"],setup(i,{expose:s,emit:r}){const{t:l}=Ne(),o=i,a=r,u=m();m();const c=m(!0),p=m(""),_=m(o.width||100),w=m(o.height||100),b=m(!1),f=$t({width:_.value+"px",height:w.value+"px",minWidth:"50px",minHeight:"50px"});et(()=>{var T,k,A;(k=(T=u.value)==null?void 0:T.previewInstRef)==null||k.setPreviewSrc(zi),URL.revokeObjectURL((((A=u.value)==null?void 0:A.imageRef)||{}).src),u.value=null});const C=m(!0);Za(()=>{C.value=!1}),Ha(()=>{C.value=!0}),ke(o,(T,k)=>{f.width=(o.width||100)+"px",f.height=(o.height||100)+"px"}),ke(()=>o.src,(T,k)=>{C.value&&E(T)},{immediate:!0}),s({download:z,openPreview:h,active:C});async function F(T){const k=T.target,A=k.naturalWidth,N=k.naturalHeight,{width:U,height:Z}=Ln({width:A,height:N},{width:o.maxWidth||100,height:o.maxHeight||100},o.expand);_.value=U,w.value=Z,a("load",{src:k.src,width:A,height:N}),c.value=!1,await new Promise(ae=>setTimeout(ae,100)),!c.value&&(b.value=!0)}function g(T){const k=T.target;a("error",k.src)}async function E(T){c.value=!0,b.value=!1,p.value=T}function z(){const T=document.createElement("a");T.href=p.value,T.download=o.fileName,T.click()}function h(){var T;(T=u.value)==null||T.click()}return(T,k)=>{const A=Zt,N=_n,U=Ce,Z=Vt;return Ge((L(),q("div",null,[n(t(ze),null,{trigger:e(()=>[n(Z,{show:t(c)||o.loading},{default:e(()=>[n(U,{justify:"center",align:"center",style:ge([t(f),{"line-height":"0px"}])},{default:e(()=>[Ge(v("a",{href:t(p),onClick:k[0]||(k[0]=ct(()=>{},["left","prevent"])),target:"_blank",download:o.fileName,title:o.fileName},[n(qe,{mode:"in-out"},{default:e(()=>[Ge(n(A,{ref_key:"nImageRef",ref:u,"show-toolbar-tooltip":"",onLoad:F,onError:g,src:t(p),width:t(_),height:t(w),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[Ke,t(b)]])]),_:1})],8,ki),[[Ke,!(t(c)||o.loading)]]),Ge(n(N,null,null,512),[[Ke,t(c)||o.loading]])]),_:1},8,["style"])]),_:1},8,["show"])]),default:e(()=>[I(" "+d(o.fileName),1)]),_:1})],512)),[[Ke,!T.hidden]])}}}),un=je(Si,[["__scopeId","data-v-a62add3a"]]),Ci=["href","download","title"],Ti={class:"left-num"},Ai={class:"right-num"},xi=["href","download","title"],Ii={class:"left-num"},Li={class:"right-num"},$i=["href","download"],Fi=we({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean},variousInfo:{}},emits:["demand-image","delete-image","close"],setup(i,{expose:s,emit:r}){const l=at(Qe),o=i,a=r;s({download:Ee,cleanup:ie,openPreview:V,isPreviewing(){return U.value},changeIndex(O){C.value=O}});const u=pt(),{t:c}=Ne();Ft();const p=m(),_=m(),w=m(),b=dt("viewerItemContainer"),f=m(!0),C=m(Math.max(o.index,0)+1),F=m(1),g=m(1),E=m(""),z=m(""),h=m(1),T=m(1),k=m(!1),A=m(!1),N=m(!1),U=Se(()=>{var O,P;return(P=(O=w.value)==null?void 0:O.previewInstRef)==null?void 0:P.displayed}),Z=Se(()=>{var O,P;return((P=(O=w==null?void 0:w.value)==null?void 0:O.previewInstRef)==null?void 0:P.previewSrc)===E.value}),ae=Se(()=>C.value<o.length),J=Se(()=>C.value>1),M=m("viewer-item-init"),S=m(0),re=m(!0);m({width:"auto",height:"auto"});const pe=m(!1);Oe(()=>{document.body.addEventListener("keydown",ue),document.body.addEventListener("keydown",le),R(C.value-1),se()}),et(()=>{clearTimeout(Q),document.body.removeEventListener("keydown",ue),document.body.removeEventListener("keydown",le),pe.value=!0}),At(()=>{URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl)});let Q=-1;ke(C,(O,P)=>{C.value<1||C.value>o.length||O===P||(clearTimeout(Q),O>P?M.value="viewer-item-next":M.value="viewer-item-prev",Q=setTimeout(()=>{o.index!==C.value-1&&(S.value=f.value?S.value:~S.value,re.value=!1,R(C.value-1))},50))});let j="",H="";ke(()=>o.url,()=>{var y,$;let O="";o.index===0&&f.value?(f.value=!1,C.value=1,O=o.url):o.index===C.value-1?(f.value=!1,k.value=!1,O=o.url):(URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl));const P=j,ee=H;if(URL.revokeObjectURL(P),URL.revokeObjectURL(ee),j=o.url,H=o.originalUrl,O){try{if(($=(y=w.value)==null?void 0:y.previewInstRef)!=null&&$.displayed){Z.value?w.value.previewInstRef.setPreviewSrc(O):w.value.previewInstRef.setPreviewSrc(o.originalUrl);try{const Y=w.value.previewInstRef.displayed;w.value.previewInstRef.handleAfterLeave(),w.value.previewInstRef.displayed=Y}catch{}}}catch{}E.value=O,z.value=o.originalUrl}},{immediate:!0});function R(O){k.value=!0,A.value=!1,N.value=!1,$e(()=>a("demand-image",O))}function se(){if(!l.IS_SP)return;let O=b.value.$el,P=0,ee=0,y=0,$=0,Y=0;const he=te=>{P=te.touches[0].pageX,ee=te.touches[0].pageY,Y=Date.now()};O.addEventListener("touchstart",he);const D=te=>{y=te.touches[0].pageX,$=te.touches[0].pageY,G()};window.addEventListener("touchmove",D);const x=()=>{G();const te=y-P,ne=Math.abs(te),ve=$-ee,fe=Math.abs(ve);ne<fe||ne<30||be(te>0?-1:1)};window.addEventListener("touchend",x);const G=()=>{const te=Date.now();te-Y>500&&(P=y,ee=$),Y=te};et(()=>{O.removeEventListener("touchstart",he),window.removeEventListener("touchmove",D),window.removeEventListener("touchend",x),O=null})}function le(O){var P,ee,y,$;if(O.key==="Escape")try{(ee=(P=w.value)==null?void 0:P.previewInstRef)!=null&&ee.displayed&&(O.stopPropagation(),($=(y=w.value)==null?void 0:y.previewInstRef)==null||$.toggleShow(!1))}catch{}}function ue(O){switch(O.code){case"ArrowRight":be(1);break;case"ArrowLeft":be(-1);break;case"Home":C.value=1;break;case"End":C.value=o.length;break;case"Space":case"Enter":case"NumpadEnter":if(!U.value)return;_e();break;case"ArrowUp":case"ArrowDown":default:return}O.stopPropagation(),O.preventDefault()}function ye({width:O,height:P}){F.value=O,g.value=P,A.value=!0}function K({width:O,height:P}){h.value=O,T.value=P,N.value=!0}function Ee(){Z.value?p.value.download():_.value.download()}async function de(O){try{const P=await fetch(O).then(ee=>ee.blob()).then(ee=>new Promise(y=>{const $=new FileReader;$.onload=y,$.readAsDataURL(ee)})).then(ee=>ee.target.result);navigator.clipboard.writeText(P),u.info({title:c("copiedDataURLDialogTitle"),content:()=>oe("div",[oe("div",c("copiedDataURLMessage"))]),positiveText:"OK"})}catch{u.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function be(O){O>0?C.value=Math.min(o.length,C.value+O)|0:O<0&&(C.value=Math.max(1,C.value+O)|0)}let ce="";const _e=()=>{var P,ee,y,$;ce=(y=window.getComputedStyle((ee=(P=w==null?void 0:w.value)==null?void 0:P.previewInstRef)==null?void 0:ee.previewRef))==null?void 0:y.transform;const O=Z.value;($=w==null?void 0:w.value)==null||$.next(),$e(()=>{var Y;Z.value===O&&((Y=w==null?void 0:w.value)==null||Y.next())})};function Me(){try{$e(()=>w.value.previewInstRef.previewRef.style.transform=ce)}catch{}}function Ue({nodes:O}){const P=oe(bn,{color:Z.value?"green":"gray",offset:[-20,-12],value:Z.value?c("status.Converted"):c("status.Original")},()=>oe(Fe,{round:!0,onClick(){_e()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>oe(Z.value?Ga:Ka)}));O.next=oe(Fe,{onClick(){be(1)},disabled:!ae.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>oe(tn)}),O.prev=oe(Fe,{onClick(){be(-1)},disabled:!J.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>oe(Qa)});try{const ee=O.download.children;ee.default=()=>c("save");const y=ee.trigger();y.props.onClick=Ee,ee.trigger=()=>y}catch{}return Ve(),[P,...Object.values(O)]}const Ye="#pathbox-"+String(Math.random()).substring(2);let De;function Ve(){var O,P,ee;try{if(De=(ee=(P=(O=w.value)==null?void 0:O.previewInstRef)==null?void 0:P.previewWrapperRef)==null?void 0:ee.parentNode,!De||De.querySelector(Ye))return;let y=oe("div",{id:Ye,onMousedown:$=>{$.stopPropagation()},className:"__preview-injected-pathbox"+(Z.value?" converted":"")},[oe("div",`${String(C.value).padStart(String(o.length).length,"0")}/${String(o.length).padStart(String(o.length).length,"0")}`),oe("div",He(Z.value?o.size:o.originalSize,0)),oe("div",Z.value?o.name:o.originalName)]);nn(y,De),y=null}catch{}}et(()=>{De&&(nn(null,De),De=null)});function V(){p.value.openPreview()}function ie(){}return(O,P)=>{const ee=Ae,y=Ce,$=wn,Y=lt,he=Et,D=Wa;return L(),X(y,{justify:"center",align:"stretch",vertical:"",style:ge([{visibility:f.value?"hidden":"visible"},{overflow:"visible"}]),class:"body",ref:"body"},{default:e(()=>[n(D,{ref_key:"nImageGroupRef",ref:w,"show-toolbar-tooltip":"","render-toolbar":Ue,onPreviewNext:Me},{default:e(()=>[n(y,{wrap:!1,align:"center",justify:"space-between",style:{overflow:"visible"}},{default:e(()=>[n(t(Fe),{onClick:P[0]||(P[0]=x=>be(-1)),bordered:!1,disabled:!t(J),class:nt({"thumb-arrow":!0,pale:!t(J)}),title:O.$t("Prev")},{icon:e(()=>[n(ee,{size:"30"},{default:e(()=>[n(t(Va))]),_:1})]),_:1},8,["disabled","class","title"]),n(y,{justify:"center",ref_key:"viewerItemContainer",ref:b,class:"viewer-item-container",style:{width:"100%"}},{default:e(()=>[n(qe,{name:M.value},{default:e(()=>[(L(),X(y,{vertical:"",key:S.value},{default:e(()=>[n(y,{align:"center",wrap:!1},{default:e(()=>[n(y,{vertical:""},{default:e(()=>[n(y,{align:"center",justify:"center",wrap:!1},{default:e(()=>[n(y,{align:"center",justify:"center",vertical:"",class:"original-thumb"},{default:e(()=>[v("a",{href:O.originalUrl,onClick:P[4]||(P[4]=ct(x=>{_.value.openPreview()},["prevent"])),download:O.originalName,title:O.originalName,class:"imglink"},[n(y,{align:"center",justify:"center",wrap:!1},{default:e(()=>[n(un,{ref:x=>{x!=null&&x.active&&(_.value=x)},src:z.value,width:1,"max-width":1,"max-height":1,loading:k.value,"file-name":O.originalName,"allow-next":C.value<o.length,"allow-prev":C.value>1,onLoad:K,onNext:P[1]||(P[1]=x=>be(1)),onPrev:P[2]||(P[2]=x=>be(-1)),hidden:!0},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(y,{vertical:"",align:"center"},{default:e(()=>[n(y,{class:"imglink-label"},{default:e(()=>[I(d(t(c)("status.Original")),1)]),_:1}),n(y,{justify:"center",class:"img-size",wrap:!1,size:2},{default:e(()=>[v("span",Ti,d(N.value?h.value:"?"),1),P[11]||(P[11]=I(" × ")),v("span",Ai,d(N.value?T.value:"?"),1)]),_:1,__:[11]}),n(y,{justify:"center"},{default:e(()=>[P[3]||(en(-1,!0),(P[3]=n(y,null,{default:e(()=>[I(d(N.value?t(He)(o.originalSize,0):"?"),1)]),_:1})).cacheIndex=3,en(1),P[3])]),_:1})]),_:1})]),_:1})],8,Ci)]),_:1}),n(y,{vertical:"",align:"center",class:"original-thumb"},{default:e(()=>[n(ee,{size:"20",color:"silver",component:t(tn)},null,8,["component"])]),_:1}),v("a",{href:E.value,onClick:P[5]||(P[5]=ct(x=>V(),["prevent"])),download:o.name,title:o.name,class:"imglink"},[n(y,{vertical:"",align:"center",justify:"center"},{default:e(()=>[n(y,{class:"imglink-label"},{default:e(()=>[I(d(t(c)("status.Converted")),1)]),_:1}),n(y,{vertical:"",align:"center",justify:"center",size:0},{default:e(()=>[n(y,{justify:"center"},{default:e(()=>{var x;return[n(y,{wrap:!1,style:ge((x=o.variousInfo)!=null&&x.shrinked?{color:"blue"}:{}),class:"img-size",size:2},{default:e(()=>[v("span",Ii,d(A.value?F.value:"?"),1),P[12]||(P[12]=I(" × ")),v("span",Li,d(A.value?g.value:"?"),1)]),_:1,__:[12]},8,["style"])]}),_:1})]),_:1}),n(y,{justify:"center"},{default:e(()=>[I(d(A.value?t(He)(o.size,0):"?"),1)]),_:1})]),_:1})],8,xi)]),_:1}),n(y,{ref:"fileNameContainer",justify:"center",align:"center",class:"pathbox",title:o.name,style:{overflow:"hidden"}},{default:e(()=>[n($,{"x-scrollable":!0,trigger:"hover",style:{"text-align":"center","font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:e(()=>[I(d(A.value?o.name:"?"),1)]),_:1})]),_:1},8,["title"])]),_:1}),n(y,{vertical:"",style:{overflow:"visible"}},{default:e(()=>[n(un,{ref:x=>{x!=null&&x.active&&(p.value=x)},src:E.value,width:142,"max-width":140,"max-height":100,loading:k.value,"file-name":o.name,"allow-next":C.value<o.length,"allow-prev":C.value>1,onLoad:ye,onNext:P[6]||(P[6]=x=>be(1)),onPrev:P[7]||(P[7]=x=>be(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(y,{justify:"center",align:"center",wrap:!1},{default:e(()=>[n(Y,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:e(()=>[v("a",{href:o.url,ref:"saveImg",target:"_blank",download:o.name,style:{"line-height":"1em"}},[n(t(Fe),{disabled:!A.value,round:"",size:"tiny"},{default:e(()=>[I(d(O.$t("save")),1)]),_:1},8,["disabled"])],8,$i)]),default:e(()=>[I(" "+d(O.$t("save")),1)]),_:1}),n(Y,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:e(()=>[n(t(Fe),{disabled:!A.value,onClick:P[8]||(P[8]=x=>de(o.url)),round:"",size:"tiny"},{default:e(()=>P[13]||(P[13]=[I("DataURL")])),_:1,__:[13]},8,["disabled"])]),default:e(()=>[I(" "+d(O.$t("convertedImageDataUrlTooltip")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["name"])]),_:1},512),n(t(Fe),{bordered:!1,onClick:P[9]||(P[9]=x=>be(1)),disabled:!t(ae),class:nt({"thumb-arrow":!0,next:!0,pale:!t(ae)}),title:O.$t("Next")},{icon:e(()=>[n(ee,{size:"30"},{default:e(()=>[n(t(qa))]),_:1})]),_:1},8,["disabled","class","title"])]),_:1}),O.isSingle?me("",!0):(L(),X(y,{key:0,justify:"center",align:"center",wrap:!1,size:4},{default:e(()=>[n(he,{value:C.value,"onUpdate:value":P[10]||(P[10]=x=>C.value=x),tooltip:!1,step:1,min:1,max:o.length,keyboard:!1,class:"index-slider"},null,8,["value","max"]),n(y,{class:"index",align:"center",justify:"center",wrap:!1,size:3},{default:e(()=>[n(y,null,{default:e(()=>[I(d(t(c)("status.index"))+":",1)]),_:1}),n(y,{justify:"end",align:"center",class:"counter"},{default:e(()=>[I(d(C.value),1)]),_:1}),n(y,null,{default:e(()=>P[14]||(P[14]=[I("/")])),_:1,__:[14]}),n(y,{justify:"start",align:"center",class:"counter"},{default:e(()=>[I(d(o.length),1)]),_:1})]),_:1})]),_:1}))]),_:1},512)]),_:1},8,["style"])}}}),Ei=je(Fi,[["__scopeId","data-v-493984f3"]]),Pi={key:0},Di={style:{}},Oi={key:1},Mi={key:2,style:{color:"red"}},Ui={key:1,style:{width:"106px",height:"80px",opacity:"0.15",border:"1px solid gray"}},Ri=we({__name:"status.progress",props:{processing:{type:Boolean},successPerc:{},elapsedTime:{},threads:{},fileType:{},shrink:{},zipSize:{},outputToDir:{type:Boolean},inputTotalSize:{},outputTotalSize:{},rateColor:{},difColor:{},totalSizeDifStr:{},thumbnail:{},opened:{type:Boolean}},setup(i){const s=i,r=m(null),l={W:110,H:80};let o;return ke(()=>[s.thumbnail,s.opened],()=>{if(!s.thumbnail||!s.opened||s.thumbnail===o||!r.value)return;const{width:a,height:u}=Ln(s.thumbnail,{width:l.W,height:l.H});r.value.width=a,r.value.height=u,r.value.style.width=a+"px",r.value.style.height=u+"px",s.thumbnail instanceof HTMLImageElement?r.value.getContext("2d").drawImage(s.thumbnail,0,0,a,u):(r.value.getContext("bitmaprenderer").transferFromImageBitmap(s.thumbnail),o=s.thumbnail,s.thumbnail.close())}),(a,u)=>{const c=Ce,p=Ya,_=ft;return L(),X(_,{name:"progress",style:{"white-space":"nowrap"}},{header:e(({collapsed:w})=>[n(c,{align:"center"},{default:e(()=>[I(d(a.$t("status.Progress"))+" ",1),w?(L(),q(Pe,{key:0},[I(" ("+d(a.successPerc|0)+"%) ",1)],64)):me("",!0)]),_:2},1024)]),default:e(()=>[n(c,{justify:"center",align:"center",size:0,wrap:!1,style:{"white-space":"nowrap","margin-top":"-1em","padding-bottom":"5px"}},{default:e(()=>[u[0]||(u[0]=v("div",{class:"grow"},null,-1)),n(c,{justify:"center",class:"grow",wrap:!1,style:{"z-index":"1"}},{default:e(()=>[n(c,{vertical:"",justify:"center",class:"left-column"},{default:e(()=>[n(p,{"tabular-nums":"",label:a.$t("status.elapsedTime")},{default:e(()=>[n(c,null,{default:e(()=>[I(d(a.elapsedTime),1)]),_:1})]),_:1},8,["label"]),n(p,{"tabular-nums":"",label:a.$t("status.multiThreading")},{default:e(()=>[n(c,{style:ge({color:a.threads?"":"red",fontSize:"0.7rem"})},{default:e(()=>[I(d(a.threads?a.$rt("{n} @:threads",a.threads):a.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(p,{"tabular-nums":"",label:a.$t("status.outputSettings")},{default:e(()=>[n(c,{vertical:"",justify:"end",style:{"font-size":"0.6rem","line-height":"0.6rem"}},{default:e(()=>[v("div",null,d(a.$t("settings.imageType"))+": "+d(a.fileType),1),a.shrink?(L(),q("div",Pi,[I(d(a.$t("status.Shrinking"))+": ",1),v("span",Di,d(a.shrink[0])+"×"+d(a.shrink[1]),1)])):me("",!0),a.outputToDir?(L(),q("div",Mi,d(a.$t("status.outputToDir")),1)):(L(),q("div",Oi,"Zip: "+d(a.zipSize)+"MB",1))]),_:1})]),_:1},8,["label"])]),_:1}),st(a.$slots,"center",{},void 0,!0),n(c,{vertical:"",style:{height:"100%"},justify:"center",class:"right-column"},{default:e(()=>[n(p,{"tabular-nums":"",label:a.$t("status.inputSize")},{default:e(()=>[n(c,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:e(()=>[I(d((a.inputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(p,{"tabular-nums":"",label:a.$t("status.outputSize")},{default:e(()=>[n(c,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:e(()=>[I(d((a.outputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(p,{"tabular-nums":"",label:a.$t("status.outInRate")},{default:e(()=>[n(c,{vertical:"",align:"end",justify:"start",style:{"font-size":"0.8em","font-family":"v-mono","line-height":"50%"}},{default:e(()=>[v("span",{style:ge({color:a.rateColor,fontSize:"larger"})},"× "+d((a.outputTotalSize/a.inputTotalSize||1).toFixed(2)),5),v("span",{style:ge({color:a.difColor})},"("+d(a.totalSizeDifStr)+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:3}),n(c,{class:"thumb-container",align:"center",style:{position:"relative"}},{default:e(()=>[n(c,{justify:"center",align:"center",class:"grow thumbnail",style:ge({width:l.W+"px",height:l.H+"px"})},{default:e(()=>[n(qe,{name:"fade",mode:"out-in"},{default:e(()=>[a.processing?(L(),q("canvas",{key:0,ref_key:"thumbcanvas",ref:r,width:"106",height:"80",class:"thumb-canvas"},null,512)):(L(),q("div",Ui))]),_:1})]),_:1},8,["style"])]),_:1})]),_:3,__:[0]})]),_:3})}}}),Bi=je(Ri,[["__scopeId","data-v-51e086be"]]),Ni={class:"status-table"},ji={class:"started"},Zi={class:"mini-counter"},Hi={class:"failure"},Wi={class:"mini-counter"},Vi={colspan:"2"},qi={class:"completed"},Gi={class:"main-counter"},Ki={class:"total"},Qi={class:"main-counter"},Yi=we({__name:"status.progress-center",props:{processing:{type:Boolean},interval:{},statusColor:{},success:{},successTo:{},successFrom:{},index:{},length:{},failure:{},retried:{},successPercTo:{},successPercFrom:{}},setup(i){const s=i,r=Ft(),l=m(r.value.successColor),o=m(!1);return ke(()=>s.processing,a=>{a||(s.success===s.length?o.value=!0:l.value=r.value.errorColor)}),(a,u)=>{const c=lt,p=Ae,_=vn,w=Ce,b=kn;return L(),X(b,{type:"multiple-circle","stroke-width":2,percentage:[a.successTo/a.length*100|0,a.index/a.length*100|0],color:[t(r).successColor,a.statusColor],"rail-style":[{stroke:t(l),opacity:.3}],style:{width:"12em"}},{default:e(()=>[n(w,{vertical:"",align:"center",justify:"center",size:0,style:{"white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:e(()=>[v("table",Ni,[v("tbody",null,[v("tr",ji,[v("td",null,d(a.$t("status.started"))+":",1),v("td",Zi,[n(c,{trigger:"hover",style:ge({color:t(r).infoColor}),placement:"left"},{trigger:e(()=>[v("span",{style:ge({color:t(r).infoColor})},d(a.index.toLocaleString("en-us")),5)]),default:e(()=>[I(" "+d(a.$t("status.progressStarted"))+" ("+d(a.index.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),v("tr",Hi,[v("td",null,d(a.$t("status.failure"))+":",1),v("td",Wi,[n(c,{trigger:"hover",style:ge({color:t(r).errorColor}),placement:"left"},{trigger:e(()=>[v("span",{style:ge({color:t(r).errorColor})},d(a.failure.toLocaleString("en-us")),5)]),default:e(()=>[I(" "+d(a.$t("status.progressErrors"))+" ("+d(a.failure.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"]),a.retried>0?(L(),X(c,{key:0,trigger:"hover",style:ge({color:t(r).warningColor}),placement:"left"},{trigger:e(()=>[v("span",{style:ge({color:t(r).warningColor})}," ("+d(a.retried.toLocaleString("en-us"))+") ",5)]),default:e(()=>[I(" "+d(a.$t("status.progressRetries"))+" ("+d(a.retried.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):me("",!0)])]),v("tr",null,[v("td",Vi,[n(w,{size:0,align:"center",justify:"center",style:ge({color:a.processing?a.statusColor:t(l)}),wrap:!1,class:"percent"},{default:e(()=>[t(o)?(L(),X(p,{key:0,component:t(Xa)},null,8,["component"])):me("",!0),n(_,{duration:a.interval*3|0,from:a.successPercFrom|0,to:a.successPercTo|0,active:!0},null,8,["duration","from","to"]),u[0]||(u[0]=I("% "))]),_:1,__:[0]},8,["style"])])]),v("tr",qi,[v("td",null,d(a.$t("status.success"))+":",1),v("td",Gi,[n(c,{trigger:"hover",duration:0,delay:0,style:ge({color:t(r).successColor}),placement:"bottom"},{trigger:e(()=>[v("span",{style:ge({color:t(r).successColor})},[n(_,{duration:a.interval*3|0,from:a.successFrom,to:a.successTo,active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:e(()=>[I(" "+d(a.$t("status.progressSuccess"))+" ("+d(a.successTo.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),v("tr",Ki,[v("td",null,d(a.$t("status.all"))+":",1),v("td",Qi,[n(c,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:e(()=>[I(d(a.length.toLocaleString("en-us")),1)]),default:e(()=>[I(" "+d(a.$t("status.progressTotal"))+" ("+d(a.length.toLocaleString("en-us"))+") ",1)]),_:1})])])])])]),_:1})]),_:1},8,["percentage","color","rail-style"])}}}),Xi={key:0,class:"log-table",ref:"table"},Ji={class:"log-tr label"},er=["title"],tr={style:{"min-width":"7em"},class:"log-th"},nr={style:{"padding-left":"2em"},class:"log-th"},or=["data-index-loglist"],ar={class:"log-td"},lr={class:"log-td"},sr={class:"log-td"},ir={class:"log-td"},rr={key:0,class:"log-td log-extra",style:{"padding-left":"0.5em"}},ur={key:0},cr={key:1,style:{color:"blue"}},dr={key:1},cn=2,dn=3e3,Ut=80,pr=100,fr=we({__name:"status.log",props:We({processing:{type:Boolean},opened:{type:Boolean},previewCollapsed:{type:Boolean},logs:{},imageIndex:{}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},"auto-scroll":{type:Boolean,required:!1},"auto-scrollModifiers":{},order:{required:!1,default:"processed"},orderModifiers:{}}),emits:We(["open-preview","change-index"],["update:expanded","update:auto-scroll","update:order"]),setup(i,{emit:s}){const{t:r}=Ne(),l=i,o=Te(i,"expanded"),a=Te(i,"auto-scroll"),u=s;dt("table");const c=dt("tbody"),p=m(),_=m(null),w=m(40),b=Se(()=>o.value?w.value:Ut),f=m(Ut),C=Se(()=>{let y=l.logs;switch(T.value){case"success":y=y.filter($=>$.completed);break;case"error":y=y.filter($=>!$.completed);break}return y}),F=Dl(!1),E=m([{type:"group",label:()=>r("status.sort"),key:"sort",children:[{label:()=>r("status.sortByStart"),value:"processed"},{label:()=>r("status.sortByCompletion"),value:"zipped"},{label:()=>r("status.sortByName"),value:"name"},{label:()=>r("status.sortBySize"),value:"size"},{label:()=>r("status.sortByOutputSize"),value:"outputsize"},{label:()=>r("status.sortByStatus"),value:"status"}]}]),z=Te(i,"order");ke(z,()=>{Ue()});const h=[{label:()=>r("status.showAll"),value:""},{label:()=>r("status.showOnlySuccess"),value:"success"},{label:()=>r("status.showOnlyError"),value:"error"}],T=m(h[0].value);let k;Oe(()=>{k=tl(),J(),window.addEventListener("resize",()=>J());const y=new ResizeObserver(()=>J());y.observe(k.parent.parent.vnode.el),et(()=>{window.removeEventListener("resize",()=>J()),y.disconnect()})}),et(()=>{clearTimeout(U),clearTimeout(ue),clearTimeout(S)});let A=0;ke(()=>l.imageIndex,y=>N(y));async function N(y){var x;const $=y||l.imageIndex;let Y=C.value.findIndex(G=>G.zippedIndex===$);Y===-1&&(Y=$);const he=Y<=H.value,D=Y>H.value+R.value;if(he||D){const G=Y*se.value-(D?b.value:0);(x=p.value)==null||x.scrollTo({behavior:"instant",top:G,left:V}),await $e(),de(!0),await $e()}$e(()=>{var te,ne;let G=_.value;G&&(A>Y&&(G=G.previousSibling||G,G instanceof HTMLElement||((te=p.value)==null||te.scrollTo(V,0),G=null)),(ne=G==null?void 0:G.scrollIntoView)==null||ne.call(G,{behavior:"instant",block:"nearest"}),A=Y)})}ke(()=>l.opened,y=>{$e(()=>{y&&(N(),de())})});let U;const Z=m(document.documentElement.clientHeight),ae=m(100);function J(){clearTimeout(U),U=setTimeout(()=>{if(!l.opened||!p.value)return;const y=p.value.$parent.$el.offsetHeight,$=window.innerHeight-k.parent.parent.parent.parent.parent.vnode.el.offsetHeight-8,Y=Math.min(se.value*Math.max(5,l.logs.length+2),Math.max(200,y+$));Z.value=document.documentElement.clientHeight,ae.value=Math.min(se.value*Math.max(5,l.logs.length),Math.max(Ut,Y)),l.opened&&(w.value=Math.max(Y,f.value))},100)}function M(){pe(!0),J(),F.value=!0}let S=0,re=!1;function pe(y=!1){if(!re){if(S){re=!0;return}$e(()=>{!y&&!a.value||(p.value.scrollTo({behavior:"instant",top:l.logs.length*50,left:V}),S=window.setTimeout(()=>{S=0,re&&(re=!1,pe())},pr))})}}const Q=m({height:"0px"}),j=m({height:"0px"}),H=m(0),R=Se(()=>b.value/se.value+cn*2|0),se=m(15);let le=0,ue=0,ye=0,K=-999,Ee=-1;function de(y){const $=Date.now();if(y!==!0){if(ue)return;if($-ye<30){ue=window.setTimeout(()=>{ue=0,de()},30-($-ye));return}}ye=$,!le&&l.logs.length&&(le=c.value.rows[1].offsetHeight,se.value=le);const Y=C.value.length,D=p.value.scrollbarInstRef.containerRef.scrollTop;if(!y&&Y===Ee&&Math.abs(D-K)<se.value*.5)return;K=D,Ee=Y;const x=Math.max(0,(D/se.value|0)-cn);H.value=x,Q.value.height=x*se.value+"px",j.value.height=Math.max(0,Y-(x+R.value))*se.value+"px"}function be(){var y;(y=p.value)==null||y.scrollTo(0,0),de()}ke(()=>l.logs,()=>{l.opened&&($e(de),a.value&&pe(),Me())});let ce=0,_e=0;function Me(){if(z.value==="processed"||!z.value)return;const y=Date.now();if(y-_e<dn){if(ce)return;ce=window.setTimeout(Me,dn-(y-_e));return}ce=0,_e=y,Ue()}function Ue(){switch(z.value){case"zipped":l.logs.sort((y,$)=>y.zippedIndex-$.zippedIndex);break;case"status":l.logs.sort((y,$)=>y.command>$.command?1:-1);break;case"name":l.logs.sort((y,$)=>y.path>$.path?1:-1);break;case"size":l.logs.sort((y,$)=>y.size-$.size);break;case"outputsize":l.logs.sort((y,$)=>y.outputSize-$.outputSize);break;case"processed":default:l.logs.sort((y,$)=>y.index-$.index);break}}function Ye(y){const $=l.logs,Y=$.findIndex(ne=>ne.zippedIndex===l.imageIndex);let he=0,D=1;switch(y.code){case"ArrowUp":he=-1;break;case"ArrowDown":he=1;break;case"PageUp":he=-1,D=b.value/se.value-1|0;break;case"PageDown":he=1,D=b.value/se.value-1|0;break;case"Enter":case"NumpadEnter":if(Y>=0&&l.previewCollapsed){$e(()=>u("open-preview")),y.stopPropagation(),y.preventDefault();return}break;default:return}let x=Y,G=-1;const te=$.length;do{if(x+=he,x<0||x>te-1||x===Y)break;if($[x].completed){if(G=x,--D>0)continue;break}}while(!0);if(G>=0){const ne=$[G];u("change-index",!0,ne.path,ne.fileId,ne.zippedIndex),y.preventDefault()}}let De=-1,Ve=-1,V=0,ie=!1;function O(y){var he,D;if(de(),ie){ie=!1;return}const{scrollLeft:$=0,scrollTop:Y=0}=(D=(he=p.value)==null?void 0:he.scrollbarInstRef)==null?void 0:D.containerRef;($!==De||De<0)&&(Y===Ve||Ve<0)&&(V=$),De=$,Ve=Y,$e(()=>{var G,te;ie=!0;const x=(te=(G=p.value)==null?void 0:G.scrollbarInstRef)==null?void 0:te.containerRef;x&&(x.scrollLeft=V)})}function P(y){a.value=!1}function ee(y,$){var ne,ve;const he=(ve=(ne=y.target.closest("tr"))==null?void 0:ne.dataset)==null?void 0:ve.indexLoglist;if(!/^\d+$/.test(he))return;const{completed:D,path:x,fileId:G,zippedIndex:te}=C.value[he];D&&(l.imageIndex!==te&&u("change-index",D,x,G,te),$&&u("open-preview"))}return(y,$)=>{const Y=Ce,he=Ae,D=Pt,x=Ct,G=ze,te=Et,ne=lt,ve=ft;return L(),X(ve,{name:"log",style:{"white-space":"nowrap"}},{header:e(()=>[n(Y,{align:"center",wrap:!1},{default:e(()=>[I(d(y.$t("status.Log")),1)]),_:1})]),"header-extra":e(()=>[l.opened?(L(),X(Y,{key:0,align:"center",justify:"end",wrap:!0,style:{"margin-top":"0.2em","margin-left":"0.5em"}},{default:e(()=>[n(D,{value:z.value,"onUpdate:value":[$[0]||($[0]=fe=>z.value=fe),Ue],options:t(E),style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1,size:"tiny"},{arrow:e(()=>[n(he,{component:t(Ja)},null,8,["component"])]),_:1},8,["value","options"]),n(D,{value:t(T),"onUpdate:value":[$[1]||($[1]=fe=>Ie(T)?T.value=fe:null),$[2]||($[2]=fe=>be())],options:h,placeholder:y.$t("status.filterLogSelect"),size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1},{arrow:e(()=>[n(he,{component:t(el)},null,8,["component"])]),_:1},8,["value","placeholder"]),n(x,{key:"b",checked:a.value,"onUpdate:checked":[$[3]||($[3]=fe=>a.value=fe),$[4]||($[4]=fe=>fe&&pe(!0))],size:"small",style:{"font-size":"0.9em"}},{default:e(()=>[I(d(y.$t("status.autoScroll")),1)]),_:1},8,["checked"]),n(ne,{trigger:"hover",show:t(F),disabled:!o.value,placement:"top",delay:0,duration:1e3},{trigger:e(()=>[n(G,{style:{"max-width":"30em"},disabled:!0},{trigger:e(()=>[n(x,{size:"small",checked:o.value,"onUpdate:checked":[$[5]||($[5]=fe=>o.value=fe),M],style:{"font-size":"0.9em"}},{default:e(()=>[I(d(y.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:e(()=>[I(d(y.$t("status.expandLog")),1)]),_:1})]),default:e(()=>[n(Y,{wrap:!1,align:"center",style:{"font-size":"0.8em"}},{default:e(()=>[n(te,{value:t(f),"onUpdate:value":$[6]||($[6]=fe=>Ie(f)?f.value=fe:null),onUpdateValue:$[7]||($[7]=fe=>J()),disabled:!o.value,"format-tooltip":fe=>`Log size: ${fe}`,tooltip:!0,step:1,min:t(ae),max:t(Z),style:{"z-index":"3",width:"100px"}},null,8,["value","disabled","format-tooltip","min","max"])]),_:1})]),_:1},8,["show","disabled"])]),_:1})):me("",!0)]),default:e(()=>[n(Y,{wrap:!1,align:"stretch",class:nt({"log-container":1,"expand-log":o.value}),style:ge({height:t(b)+"px"}),onKeydown:Ye,tabindex:"-1"},{default:e(()=>[n(t(wn),{ref_key:"scrollref",ref:p,distance:10,"x-scrollable":!0,onMousedownCapture:P,onWheel:$[9]||($[9]=fe=>a.value=!1),onScroll:O,load:"handleLogLoad",trigger:"none",style:ge([{"z-index":"2","padding-right":"10px",height:"100%"},{height:t(b)+"px"}]),size:50},{default:e(()=>[l.opened?(L(),q("table",Xi,[v("thead",null,[v("tr",Ji,[v("th",{class:"log-th",title:y.$t("status.table.core")},"th",8,er),$[10]||($[10]=v("th",{class:"log-th"},"no.",-1)),v("th",tr,d(y.$t("status.table.status")),1),v("th",nr,d(y.$t("status.table.details")),1),$[11]||($[11]=v("th",{class:"log-th"},"size",-1))])]),v("tbody",{ref:"tbody",onClick:ee,onDblclick:$[8]||($[8]=fe=>ee(fe,!0))},[v("tr",{style:ge(t(Q))},null,4),(L(!0),q(Pe,null,it(t(C).slice(t(H),t(H)+t(R)),({index:fe,key:Ze,command:Xe,path:gt,core:Le,zippedIndex:rt,completed:mt,fileId:Je,shrinked:Ia,width:Yt,height:La,outputWidth:$a,outputHeight:Fa,size:Ea,outputSize:Xt},Jt)=>(L(),q("tr",{key:Ze,class:nt({"log-tr":1,completed:mt,selected:y.imageIndex===rt,stripe:(t(H)+Jt)%2}),ref_for:!0,ref:Pa=>{y.imageIndex===rt&&(_.value=Pa)},"data-index-loglist":t(H)+Jt},[v("td",ar,d(Le>=0?Le+1:"-"),1),v("td",lr,d(fe+1),1),v("td",sr,d(Xe),1),v("td",ir,d(gt),1),Yt?(L(),q("td",rr,[I(d(`[${Yt}×${La}] (${t(He)(Ea,0)})`)+" ",1),Xt?(L(),q("span",ur,[$[12]||($[12]=I(" → ")),v("span",null," ("+d(t(He)(Xt,0))+") ",1)])):me("",!0),Ia?(L(),q("span",cr,d(` [${$a}×${Fa}]`),1)):me("",!0)])):(L(),q("td",dr))],10,or))),128)),v("tr",{style:ge(t(j))},null,4)],544)],512)):me("",!0),$[13]||($[13]=v("div",{style:{height:"1em"}},null,-1))]),_:1,__:[13]},8,["style"])]),_:1},8,["class","style"])]),_:1})}}}),gr={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function mr(i,s){return L(),q("svg",gr,s[0]||(s[0]=[v("path",{fill:"currentColor",d:"M4 18h8.13L11 19.13V20H4a2 2 0 0 1-2-2V6c0-1.11.89-2 2-2h6l2 2h8a2 2 0 0 1 2 2v2.15c-.26-.09-.54-.15-.83-.15c-.42 0-.81.11-1.17.3V8H4zm18.85-4.53l-1.32-1.32c-.2-.2-.53-.2-.72 0l-.98.98l2.04 2.04l.98-.98c.2-.19.2-.52 0-.72M13 19.96V22h2.04l6.13-6.12l-2.04-2.05z"},null,-1)]))}const Aa=ot({name:"mdi-folder-edit-outline",render:mr}),vr={class:"container"},hr={__name:"zipicon",setup(i){return(s,r)=>(L(),q("span",vr,[n(t(Ae),null,{default:e(()=>[n(t(Nt))]),_:1}),r[0]||(r[0]=v("span",{class:"text"},"ZIP",-1))]))}},yr=je(hr,[["__scopeId","data-v-8b8df2f0"]]),_r=["innerHTML"],wr={style:{margin:"1px"}},br=["href","download","onClick"],kr={key:0,style:{position:"relative"}},zr=["href","download"],Sr=["href","download"],Cr={style:{"margin-left":"0.5em"}},Tr={key:0,style:{margin:"1px"}},Ar=["href","download","onClick"],xr=we({__name:"status.result",props:{processing:{type:Boolean},listLength:{},zippingFlag:{type:Boolean},converted:{},success:{},zippedTotalCount:{},zippedTotalSize:{},baseZipName:{},zips:{},unconvertedListText:{},unconvertedFileCount:{},unconvertedTotalSize:{},failedZips:{},failedZipDone:{type:Boolean},failedToCreateFailedZip:{type:Boolean},failedFileZippedCount:{},imgUrl:{},imgName:{},type:{},outputToDir:{type:Boolean},outputDirName:{}},emits:["all-zips-clicked","demand-zip-errors"],setup(i,{emit:s}){const r=pt(),{t:l}=Ne(),o=Ft(),a=i,u=s,c=m(!1),p=m([]),_=m([]),w=m(void 0),b=Se(()=>[{key:"open",label:l("status.openFailedList"),icon:()=>oe(Ae,()=>oe(zn)),onSelect(){F()}},{key:"download",label:l("status.saveFailedList"),icon:()=>oe(Ae,()=>oe(nl)),onSelect(){F(!0)}},{key:"zip",label:`${l("status.zipFailedList")}`+(a.failedZipDone?`(✔${l("status.done")})`:""),icon:()=>oe(Vt,{show:c.value&&!a.failedZipDone,size:"small"},()=>oe(Ae,()=>oe(Nt))),disabled:c.value,onSelect(g){return c.value=!0,u("demand-zip-errors"),!1}}]);ke([()=>a.zips.length,()=>a.failedZips.length],()=>{{p.value.length>a.zips.length&&(p.value.length=0);let g=0;const E=a.zips.length===1&&a.zippedTotalCount===a.listLength;for(let z=p.value.length;z<a.zips.length;z++){const h=a.zips[z],T=a.baseZipName+(E?"":"-"+String(z+1).padStart(2,"0"))+".zip";g+=h.size,p.value[z]={url:h.url,size:h.size,number:E?0:z+1,sizeByUnit:He(h.size),name:T,count:h.count,clicked:!1}}}{_.value.length>a.failedZips.length&&(_.value.length=0);let g=0;const E=a.failedZipDone&&a.failedZips.length===1;for(let z=_.value.length;z<a.failedZips.length;z++){const h=a.failedZips[z],T=a.baseZipName+"-error"+(E?"":"-"+String(z+1).padStart(2,"0"))+".zip";g+=h.size,_.value[z]={url:h.url,size:h.size,number:E?0:z+1,sizeByUnit:He(h.size),name:T,count:h.count,clicked:!1}}}});function f(g,E=!1){const{url:z,name:h}=g;if(E){const T=document.createElement("a");T.href=z,T.download=h,T.click()}g.clicked||(g.clicked=!0,a.processing||p.value.every(T=>T.clicked)&&u("all-zips-clicked"))}async function C(g){if(a.zippingFlag){if(p.value.length>=2&&!await new Promise((h,T)=>r.warning({title:l("Download"),content:l("status.confirmDownloadMessage",[p.value.length]),positiveText:"OK",negativeText:l("cancel"),onPositiveClick:()=>h(!0),onNegativeClick:()=>T()})))return;const E=p.value;for(const z of E)f(z,!0)}}function F(g=!1){const E=new Blob([a.unconvertedListText],{type:"text/plain;charset=utf8"}),z=URL.createObjectURL(E),h=document.createElement("a");h.href=z,h.target="_blank",g&&(h.download=a.baseZipName+"-error.txt"),h.click()}return(g,E)=>{const z=kn,h=lt,T=Fe,k=Ce,A=yr,N=bn,U=Aa,Z=Cn,ae=ol,J=ft;return L(),X(J,{name:"output",style:{"white-space":"nowrap"},disabled:""},{header:e(()=>[v("span",{style:{color:"black"},innerHTML:g.$t("status.Output")},null,8,_r)]),default:e(()=>[n(k,{wrap:!1,vertical:"",style:{"margin-top":"-1.3em"}},{default:e(()=>[g.outputToDir?me("",!0):(L(),X(k,{key:0,justify:"center"},{default:e(()=>[Ge(n(k,{vertical:"",align:"center"},{default:e(()=>[n(h,{placement:"left"},{trigger:e(()=>[n(z,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":a.zippedTotalCount===g.listLength?"white":"green",processing:a.processing,percentage:a.zippedTotalCount/g.listLength*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:e(()=>[v("span",wr,d(a.zippedTotalCount/g.listLength*100|0)+"% "+d(g.$t("status.zippingProgress"))+" ("+d(a.zippedTotalCount)+"/"+d(a.converted)+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:e(()=>[I(" "+d(g.$t("status.zippingProgress"))+" ("+d(a.zippedTotalCount/a.listLength*100|0)+"%) ",1)]),_:1}),t(p).length>=2||a.processing?(L(),X(Tt,{key:0,name:"zips",class:"zip-buttons-parent",tag:"div"},{default:e(()=>[(L(!0),q(Pe,null,it(t(p),(M,S)=>(L(),q("span",{key:S},[n(h,{trigger:"hover",duration:0,delay:0},{trigger:e(()=>[v("a",{href:M.url,download:M.name,class:"in-button-anchor",onClick:re=>f(M)},[n(T,{class:"zip-button",size:"tiny",color:M.clicked?"#050":"lime","text-color":M.clicked?"gray":"white",onClick:ct(re=>f(M),["stop"]),round:""},{default:e(()=>[n(t(Ae),{size:"tiny"},{default:e(()=>[n(t(Nt))]),_:1}),I("ZIP"+d(M.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,br)]),default:e(()=>[v("div",{style:ge({color:t(o).successColor})},[v("div",null,"ZIP "+d(M.number||"")+" ("+d(g.$t("success"))+")",1),v("div",null,d(M.name),1),v("div",null,d(M.sizeByUnit),1),v("div",null,d(g.$rt("{n} @:files",M.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):me("",!0)]),_:1},512),[[Ke,g.zippingFlag]])]),_:1})),n(qe,null,{default:e(()=>[Ge(n(k,{justify:"center",align:"center"},{default:e(()=>[g.outputToDir?(L(),X(h,{key:1,trigger:"hover",duration:0,delay:0,placement:"left",style:ge({color:"white",backgroundColor:t(o).successColor}),"arrow-style":{backgroundColor:t(o).successColor}},{trigger:e(()=>[n(k,{align:"center",size:1,style:ge(`border: 1px solid ${t(o).successColor}; border-radius:4px; padding:0.3em;`)},{default:e(()=>[n(U,{style:{"vertical-align":"middle"}}),n(Z,{style:{"font-size":"smaller","max-width":"25em"}},{default:e(()=>[I(d(g.outputDirName),1)]),_:1}),v("span",Cr,[v("span",{style:ge({color:t(o).successColor})},d(g.success),5),I(" "+d(t(l)("files",g.success)),1)])]),_:1},8,["style"])]),default:e(()=>[I(d(g.$t("status.numberOfFilesWrittenToDir")),1)]),_:1},8,["style","arrow-style"])):(L(),X(h,{key:0,trigger:"hover",duration:0,delay:0,placement:"left",style:ge({color:"white",backgroundColor:t(o).successColor}),"arrow-style":{backgroundColor:t(o).successColor}},{trigger:e(()=>[n(qe,{name:"save"},{default:e(()=>[g.success>0?(L(),q("span",kr,[n(N,{value:g.zippingFlag?a.zippedTotalCount.toLocaleString("en-us"):a.type.replace(/\(.+\)/,""),color:t(o).successColorHover,offset:[-20,-3]},{default:e(()=>[g.zippingFlag?(L(),X(T,{key:0,size:"medium",onClick:C,color:t(o).successColor,round:""},{default:e(()=>[t(p).length?(L(),q("a",{key:0,href:t(p)[0].url,download:t(p)[0].name,class:"in-button-anchor",onClick:E[0]||(E[0]=ct(()=>{},["prevent"]))},[n(A),I(" × "+d(t(p).length)+" "+d(g.$t("status.saveAll")),1)],8,zr)):me("",!0)]),_:1},8,["color"])):(L(),q("a",{key:1,href:a.imgUrl,download:a.imgName,class:"in-button-anchor"},[n(T,{size:"medium",color:t(o).successColor,round:""},{default:e(()=>[n(t(Ae),{size:"tiny",component:t(Sn)},null,8,["component"]),I(" "+d(g.$t("save")),1)]),_:1},8,["color"])],8,Sr))]),_:1},8,["value","color"])])):me("",!0)]),_:1})]),default:e(()=>[a.listLength>=2?(L(),q(Pe,{key:0},[v("div",null,d(t(l)("success"))+": "+d(g.zippedTotalCount.toLocaleString()),1),v("div",null,d(t(l)("status.totalSize"))+": "+d(t(He)(a.zippedTotalSize)),1),v("div",null,"ZIP × "+d(t(p).length),1),v("div",null,d(t(l)("status.saveAllZipsTooltip")),1)],64)):(L(),q(Pe,{key:1},[I(d(g.$t("status.downloadConvertedImage",t(p).length)),1)],64))]),_:1},8,["style","arrow-style"])),!a.processing&&a.success!==g.listLength?(L(),X(ae,{key:2,options:t(b),onSelect:E[1]||(E[1]=(M,S)=>{var re;return(re=t(b).find(({key:pe})=>M===pe))==null?void 0:re.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:e(()=>[n(h,{show:t(w),duration:0,delay:0,placement:"right",style:ge({color:"white",backgroundColor:t(o).errorColor}),"arrow-style":{backgroundColor:t(o).errorColor}},{trigger:e(()=>[n(N,{value:a.unconvertedFileCount.toLocaleString(),color:t(o).errorColorHover,offset:[-0,-3]},{default:e(()=>[n(T,{size:"small",color:t(o).errorColor},{default:e(()=>[n(t(Ae),{size:"medium",style:{"vertical-align":"middle"},component:t(al)},null,8,["component"])]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:e(()=>[v("div",null,[v("div",null,d(t(l)("failed"))+": "+d(a.unconvertedFileCount.toLocaleString()),1),v("div",null,d(t(l)("status.totalSize"))+": "+d(t(He)(a.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])):me("",!0)]),_:1},512),[[Ke,!a.processing||g.outputToDir]])]),_:1}),n(qe,{name:"zipcontainer"},{default:e(()=>[Ge(n(k,{vertical:"",align:"center"},{default:e(()=>[n(h,{placement:"left"},{trigger:e(()=>[n(z,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":a.failedFileZippedCount===a.unconvertedFileCount?"white":"#500",processing:t(c)&&!a.failedZipDone&&!a.failedToCreateFailedZip,percentage:a.failedFileZippedCount/a.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:e(()=>[a.failedToCreateFailedZip?(L(),q("div",{key:1,style:ge({color:t(o).errorColor})},d(g.$t("status.failureZippingFailedFiles")),5)):(L(),q("span",Tr,d(a.failedFileZippedCount/a.unconvertedFileCount*100|0)+"% "+d(g.$t("status.zipped"))+" ("+d(a.failedFileZippedCount)+"/"+d(a.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:e(()=>[I(" "+d(g.$t("status.zippingProgress"))+" ("+d(a.failedFileZippedCount/a.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(Tt,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:e(()=>[(L(!0),q(Pe,null,it(t(_),(M,S)=>(L(),q("span",{key:S},[n(h,{trigger:"hover",duration:0,delay:0},{trigger:e(()=>[v("a",{href:M.url,download:M.name,class:"in-button-anchor",onClick:re=>f(M)},[n(T,{class:"zip-button",size:"tiny",color:M.clicked?"#551122":"#F00","text-color":M.clicked?"gray":"white",onClick:ct(re=>f(M),["stop"]),round:""},{default:e(()=>[n(t(Ae),{size:"tiny",component:t(ll)},null,8,["component"]),I("ZIP"+d(M.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Ar)]),default:e(()=>[v("div",{style:ge({color:t(o).errorColor})},[v("div",null,"ZIP "+d(M.number||"")+" ("+d(g.$t("failed"))+")",1),v("div",null,d(M.name),1),v("div",null,d(M.sizeByUnit),1),v("div",null,d(g.$rt("{n} @:files",M.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1},512),[[Ke,t(c)]])]),_:1})]),_:1})]),_:1})}}}),Ir=je(xr,[["__scopeId","data-v-1aee218a"]]),Lr=we({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image","delete-image"],setup(i,{expose:s,emit:r}){const l={itemMargin:"1px",titlePadding:"2px",titleFontSize:"0.8rem"},{t:o}=Ne(),a=Ft(),u=i,c=r;s({cleanup:Ve});const p=m(!1),_=m([]),w=m(!1),b=m(!1),f=m([0,0]),C=m([0,0]),F=m([0,0]),g=m([0,0]),E=m([0,0]),z=m([0,0]),h=m(0),T=m(0),k=m([0,0]),A=m(0),N=m(a.value.infoColor),U=m("#000000"),Z=m("#000000"),ae=m(0),J=m(0),M=m(""),S=m("00:00:00"),re=m(null),pe=m(["progress","log","output"]),Q=V=>pe.value.includes(V),j=V=>pe.value.push(V),H=V=>{const ie=pe.value.findIndex(O=>O===V);ie>=0&&pe.value.splice(ie,1)},R=Se(()=>pe.value.includes("log")),se=Se(()=>pe.value.includes("progress")),le=m(!1),ue=m(!0),ye=m("processed"),K=$t({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:0,various:{shrinked:!1}}),Ee=dt("body"),de=dt("imageViewer");Oe(()=>{ke(u.status,()=>Me(),{deep:!1});let V=0;const ie=()=>{if(V)return;const O=Date.now();S.value="00:00:00",V=window.setInterval(()=>{const P=(Date.now()-O)/1e3;S.value=`${String(P/3600|0).padStart(2,"0")}:${String(P/60%60|0).padStart(2,"0")}:${String(P%60|0).padStart(2,"0")}`},300)};ie(),b.value=!0,ke(()=>u.processing,(O,P)=>{O||Ue(),O?(ie(),_.value.length=0,p.value=!1,w.value=!1):(clearInterval(V),V=0)}),et(()=>{clearInterval(V),clearTimeout(_e)}),At(()=>clearInterval(V))}),et(()=>{Ve()}),At(()=>{clearTimeout(_e)});const be=u.interval||100;let ce=!1,_e=0;function Me(){if(ce)return;if(_e){ce=!0;return}_e=window.setTimeout(()=>{_e=0,ce&&(ce=!1,Me())},be);const V=u.status;p.value=V.length>=2,C.value[1]=C.value[0],C.value[0]=V.startedCount,F.value[1]=F.value[0],F.value[0]=V.success,g.value[1]=g.value[0],g.value[0]=V.failure,E.value[1]=E.value[0],E.value[0]=V.done,z.value[1]=z.value[0],z.value[0]=V.converted,h.value=V.retried,T.value=V.length,k.value[1]=k.value[0],k.value[0]=V.zippedTotalCount,ae.value=V.inputTotalSize,J.value=V.outputTotalSize,A.value=V.failedFileZippedCount;const ie=J.value-ae.value;M.value=(ie>=0?"+ ":"")+He(ie);const O=J.value/ae.value,P=(256|Math.min(255,Math.max(0,O-1.5)*255|0)).toString(16).substring(1);U.value="#"+P+"0000";const ee=1024*1024,y=(256|Math.min(255,Math.max(0,ie/1024/ee)*255|0)).toString(16).substring(1);Z.value="#"+y+"0000",f.value[1]=f.value[0],f.value[0]=F.value[0]/T.value*100,(R.value||!u.processing)&&(_.value=_.value.concat(V.logs),V.logs.length=0),re.value=V.thumbnail,u.processing?N.value=g.value[0]?a.value.errorColor:h.value?a.value.warningColor:a.value.infoColor:b.value=!1,V.convertedImageUrl!==K.url&&(K.url=V.convertedImageUrl,K.name=V.convertedImageName,K.dataUrl=V.convertedImageDataUrl,K.size=V.convertedImageSize||V.outputTotalSize,K.originalSize=V.convertedImageOrgSize,K.originalName=V.convertedImageOrgName,K.index=V.convertedImageIndex,K.originalUrl=V.convertedImageOrgUrl,K.various={shrinked:V.convertedImageShrinked})}function Ue(){const V=u.status;N.value=u.status.success===u.status.length?a.value.successColor:a.value.errorColor,ye.value==="processed"&&(ye.value="zipped"),V.success>0&&(ue.value&&(H("log"),le.value=!0),j("preview"))}async function Ye(V,ie,O,P){var y;if(!V)return;const ee=P;Q("preview")||(j("preview"),await $e()),(y=de.value)==null||y.changeIndex(ee+1),await $e(()=>{var $;try{($=de.value)==null||$.$el.scrollIntoView({behavior:"instant",block:"nearest"})}catch{}})}const De=m(!1);function Ve(){De.value=!0,URL.revokeObjectURL(K.url),URL.revokeObjectURL(K.originalName),K.originalUrl="",K.url="",K.index=0,u.status.logs.length=0,_.value.length=0}return(V,ie)=>{const O=Ce,P=ft,ee=qt;return L(),X(O,{ref_key:"body",ref:Ee,vertical:"",justify:"center"},{default:e(()=>[n(ee,{"display-directive":"show","trigger-areas":["arrow","main"],"expanded-names":t(pe),"onUpdate:expandedNames":ie[7]||(ie[7]=y=>Ie(pe)?pe.value=y:null),"theme-overrides":l},{default:e(()=>[n(Bi,{processing:t(b),"elapsed-time":t(S),"success-perc":t(f)[0],"input-total-size":t(ae),"output-total-size":t(J),"file-type":u.status.type,shrink:u.status.shrink,threads:u.status.threads,"zip-size":u.status.zipSize,"output-to-dir":u.status.outputToDir,"rate-color":t(U),"dif-color":t(Z),"total-size-dif-str":t(M),thumbnail:t(re),opened:t(se)},{center:e(()=>[t(De)?me("",!0):(L(),X(Yi,{key:0,index:t(C)[0],success:t(F)[0],length:V.status.length,"success-to":t(F)[0],"success-from":t(F)[1],failure:t(g)[0],"success-perc-to":t(f)[0],"success-perc-from":t(f)[1],retried:t(h),processing:t(b),interval:t(be),"status-color":t(N),class:"center-column"},null,8,["index","success","length","success-to","success-from","failure","success-perc-to","success-perc-from","retried","processing","interval","status-color"]))]),_:1},8,["processing","elapsed-time","success-perc","input-total-size","output-total-size","file-type","shrink","threads","zip-size","output-to-dir","rate-color","dif-color","total-size-dif-str","thumbnail","opened"]),n(fr,{processing:t(b),"image-index":t(K).index,opened:t(R),"preview-collapsed":Q("preview"),logs:t(_),expanded:t(le),"onUpdate:expanded":ie[0]||(ie[0]=y=>Ie(le)?le.value=y:null),"auto-scroll":t(ue),"onUpdate:autoScroll":ie[1]||(ie[1]=y=>Ie(ue)?ue.value=y:null),order:t(ye),onChangeIndex:Ye,onOpenPreview:ie[2]||(ie[2]=y=>{var $;return($=t(de))==null?void 0:$.openPreview()}),name:"log",style:{"white-space":"nowrap"}},null,8,["processing","image-index","opened","preview-collapsed","logs","expanded","auto-scroll","order"]),n(P,{title:V.$t("status.PreviewImage"),name:"preview",style:{"white-space":"nowrap"},disabled:!(t(F)[0]>0)},{default:e(()=>[n(O,{justify:"center",align:"center",vertical:"",style:{"margin-top":"-1em"}},{default:e(()=>[n(Ei,{"_v-else-if":"imageViewerStarted && status.success > 0 /*&& (props.status.threads || !zippingFlag)*/ && !cleaningUp",ref_key:"imageViewer",ref:de,url:t(K).url,size:t(K).size,"original-url":t(K).originalUrl,"original-size":t(K).originalSize,name:t(K).name,originalName:t(K).originalName,length:t(F)[0],index:t(K).index,"various-info":t(K).various,"is-single":!t(p),onDemandImage:ie[3]||(ie[3]=y=>c("demand-image",y)),on_deleteImage:ie[4]||(ie[4]=y=>c("delete-image",y)),_close:"imageViewerStarted=false"},null,8,["url","size","original-url","original-size","name","originalName","length","index","various-info","is-single"])]),_:1})]),_:1},8,["title","disabled"]),n(Ir,{processing:t(b),"list-length":t(T),zippingFlag:t(p),zips:u.status.zips,"img-url":t(K).url,"img-name":t(K).name,success:t(F)[0],failure:t(g)[0],done:t(E)[0],converted:t(z)[0],retried:t(h),"zipped-total-count":t(k)[0],"zipped-total-size":u.status.zippedTotalSize,"base-zip-name":u.status.baseZipName,"failed-file-zipped-count":t(A),"failed-to-create-failed-zip":u.status.failedToCreateFailedZip,"failed-zip-done":u.status.failedZipDone,"failed-zips":u.status.failedZips,"unconverted-file-count":u.status.unconvertedFileCount,"unconverted-list-text":u.status.unconvertedListText,"unconverted-total-size":u.status.unconvertedTotalSize,"output-to-dir":V.status.outputToDir,"output-dir-name":V.status.outputDirName,type:u.status.type,onAllZipsClicked:ie[5]||(ie[5]=y=>c("all-zips-clicked")),onDemandZipErrors:ie[6]||(ie[6]=y=>c("demand-zip-errors"))},null,8,["processing","list-length","zippingFlag","zips","img-url","img-name","success","failure","done","converted","retried","zipped-total-count","zipped-total-size","base-zip-name","failed-file-zipped-count","failed-to-create-failed-zip","failed-zip-done","failed-zips","unconverted-file-count","unconverted-list-text","unconverted-total-size","output-to-dir","output-dir-name","type"])]),_:1},8,["expanded-names"])]),_:1},512)}}}),$r=je(Lr,[["__scopeId","data-v-a067ea79"]]),Fr=["innerHTML"],Er={style:{color:"red"}},Pr=we({__name:"converter",props:We({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},autoStart:{type:Boolean},threads:{},outputToDir:{type:Boolean},outputDirHandle:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:We(["start","end"],["update:showNote"]),setup(i,{expose:s,emit:r}){at(Qe);const{t:l}=Ne(),o=pt(),a=Tn(),u=10,c=navigator.hardwareConcurrency,p=typeof OffscreenCanvas=="function",_=100,w=m([[()=>l("dupAction_overwrite"),"overwrite"],[()=>l("dupAction_skip"),"skip"],[()=>l("cancel"),"cancel"]]),b=i,f=Te(i,"showNote"),C=r;s({beginConversion:ce});const F=m(!1),g=m(!1),E=m(!1),z=m(!1),h=m(!1),T=m(()=>"initializing"),k=m("info"),A=$t(Me()),N=dt("stat"),U=m(0),Z=Se(()=>{var D;return(D=b.input)==null?void 0:D.length}),ae=m(),J=m(""),M=m(!1),S=m(!0),re=m(!1);let pe=()=>{};const Q=m(!1);let j=!1,H=!1,R,se=()=>{},le,ue=0,ye=!1;ke(()=>b.input.length,(D,x)=>{D>=x&&b.autoStart&&ce()}),ke(z,D=>{document.body.style.overflowY=D?"hidden":"auto"}),Oe(async()=>{await V(),ie()});async function K(){let D=!0;if(ue>u*1e3&&!b.outputToDir&&!ye&&A.success>0&&(D=!1,await new Promise(x=>{o.warning({title:l("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:l("close"),negativeText:l("back"),onPositiveClick:()=>D=!0,onAfterLeave:x,content:l("confirmCloseDialog")})})),!D)return!1;a.destroyAll(),z.value=!1,f.value=!1}function Ee(D){le==null||le(D)}function de(D){Mt==null||Mt(D)}function be(){!g.value&&F.value?g.value=!0:K()}async function ce(){var D;if(!((D=b.input)!=null&&D.length)||F.value){o.error({title:"error",positiveText:"OK",content:"An unexpected error occurred."});return}if(b.outputToDir&&!b.outputDirHandle){o.error({title:"error",positiveText:"OK",content:l("errMsgOutputDirNotFound")});return}if(F.value){o.error({title:"Busy",positiveText:"OK",content:l("interfered")});return}if(b.outputToDir&&!Q.value&&(await new Promise(x=>{re.value=!0,j=!1,pe=x}),!j)){Q.value=!1;return}Ye(b.input)}let _e=m(()=>{});function Me(D){const x={logs:[],ziplogs:[],startedCount:0,converted:0,success:0,failure:0,retried:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",convertedImageOrgUrl:"",convertedImageIndex:-1,convertedImageShrinked:!1,zipSize:b.maxZipSizeMB,shrink:W.multithread&&W.shrinkImage?[W.maxWidth,W.maxHeight]:void 0,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1,outputToDir:b.outputToDir,outputDirName:b.outputDirHandle?b.outputDirHandle.name:""};return Object.assign(D||{},x)}function Ue(){h.value=!1,URL.revokeObjectURL(A.convertedImageUrl),URL.revokeObjectURL(A.convertedImageOrgUrl);for(const D of A.zips)URL.revokeObjectURL(D.url);A.zips.length=0;for(const D of A.failedZips)URL.revokeObjectURL(D.url);A.failedZips.length=0,Me(A),se(),se=()=>{},le=null,ye=!1,E.value=!1,g.value=!1,P=!1,ee.length=0,R=void 0,$.clear(),Y.clear()}async function Ye(D){z.value&&(U.value^=1);let x=D.concat();Me(A),Ue(),z.value=!0,h.value=!0,F.value=!0,A.processing=!0,k.value="info",T.value=()=>l("processing");const G=new Set,te=[],ne=b.format,ve=b.quality,fe=[...ne.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),Ze=Ve(ne,ve,x[0].webkitRelativePath);let Xe=new Set;b.outputDirHandle&&(Xe=await li(b.outputDirHandle,x)),A.length=x.length,A.baseZipName=Ze,A.type=ne.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(ne)?" ("+ve+")":""),A.threads=H?0:b.threads;const gt=Date.now();C("start");let Le,rt,mt;if(!H&&b.threads>=2?(le=hi,mt=await ii({files:x,completedFileIdSet:G,completedFileDat:te,ConvStats:A,canceled:g,props:b,imageType:ne,quality:ve,outputExt:fe,format:ne,message:a,fsysDirHandler:b.outputDirHandle,writeUsingFileSystem:O,enqueueOverwriteConfirmation:y,existingFolders:Xe})):(le=wi,mt=await _i(x,G,b,g,A)),{exception:rt,callbackToGenerateFailedZips:Le,callbackToClearConverter:se}=mt,rt){let Je;switch(rt.message){case"worker-load-error":Je=l("errMsgWorkerLoadError");break;default:Je="unexpected error"}o.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:()=>oe("div",[oe("p",Je),oe(Fe,{onClick(){location.reload()}},l("Reload"))])})}if(A.success===A.length?(k.value="success",T.value=()=>l("completed")):(k.value="error",T.value=()=>g.value?l("aborted"):l("incomplete")),G.size!==x.length){const Je=De(D,G);_e.value=()=>{!Je||!Je.length||Le(Je)}}F.value=!1,A.processing=!1,E.value=!0,x.length=0,ue=Date.now()-gt,C("end")}function De(D,x){const G=[],te=[];let ne=0;for(const ve of D)x.has(ve._id)||(G.push(ve),te.push(ve.webkitRelativePath||ve.relativePath||ve.name),ne+=ve.size);return te.length&&(A.unconvertedListText=te.join(`
`),A.unconvertedFileCount=G.length,A.unconvertedTotalSize=ne),G}function Ve(D,x,G){var Ze;const te=new Date;D=D.replace(/^image\//,"").toLowerCase();const ne=W.useFolderNameForZip&&((Ze=String(G).match(/^\/?([^/]+)\//))==null?void 0:Ze[1])||"avif2jpg",ve=`
    ${te.getFullYear().toString().substring(2)}
    ${String((te.getMonth()+1)*100+te.getDate()).padStart(4,"0")}
    ${String(te.getHours()*1e4+te.getMinutes()*100+te.getSeconds()).padStart(6,"0")}
    -
    ${D+(/jpe?g|webp/i.test(D)?x:"")}
  `.replace(/\s/g,"");return`${ne}-${ve}`.replace(/\s+/g," ")}async function V(){const D="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",x=document.createElement("img"),G=Ta(x).then(()=>!0,()=>!1);x.src=D,await G||o.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:l("avifUnsupported")})}function ie(){(!p||c<2||!Promise.any)&&(H=!0),H&&(Re.value=0)}async function O(D,x){const G=b.outputDirHandle;if(!G)throw new Error("Directory Handle is empty");await oi(G,D,x,!0)}let P=!1;const ee=[];async function y(D,x,G,te){P?ee.push({resolver:D,target:x,type:G,path:te}):(P=!0,he(D,x,G))}const $=new Set,Y=new Set;async function he(D,x,G,te){let ne="";if(g.value?ne="cancel":$.has(x)?ne="overwrite":Y.has(x)?ne="skip":(J.value=x,S.value=G==="folder",ne=R||await ae.value.start(),ne.startsWith("cancel")&&(g.value=!0),ne==="overwrite"&&$.add(x),ne==="skip"&&Y.add(x),ne==="close"&&(M.value=!1),await $e(),!R&&M.value&&(ne+="-all",R=ne)),D(ne),ee.length){const{resolver:ve,target:fe,type:Ze,path:Xe}=ee.shift();he(ve,fe,Ze)}else P=!1}return(D,x)=>{const G=Zs,te=Ae,ne=ze,ve=Ce,fe=Vt,Ze=kt,Xe=Sa,gt=Us;return L(),q(Pe,null,[t(F)?me("",!0):(L(),X(ve,{key:0,justify:"center",align:"center",style:{"margin-top":"0.4em"}},{default:e(()=>[n(ne,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:e(()=>[n(qe,null,{default:e(()=>[n(t(Fe),{disabled:!t(Z),onClick:ce,round:"",size:"large",style:{"font-size":"1.5em",padding:"1em"},type:t(Z)?"success":void 0,"_:class":"{'button-ready': isReadyToConvert}"},{icon:e(()=>[n(te,{size:"1.2em"},{default:e(()=>[n(G)]),_:1})]),default:e(()=>[I(" "+d(t(l)("StartConversion")),1)]),_:1},8,["disabled","type"])]),_:1})]),default:e(()=>[v("div",{innerHTML:t(Z)?t(l)("convertTooltip"):t(l)("convertUnpreparedTooltip")},null,8,Fr)]),_:1})]),_:1})),n(Ze,{ref:"processingModal","display-directive":"show",show:t(z),"onUpdate:show":x[2]||(x[2]=Le=>Ie(z)?z.value=Le:null),closable:t(E),"close-on-esc":!1,preset:"dialog",onClick:x[3]||(x[3]=Le=>{t(a).destroyAll()}),onMaskClick:x[4]||(x[4]=Le=>{t(a).destroyAll()}),onClose:K,onEsc:be,title:t(T),type:t(k),"mask-closable":!1,onAfterLeave:Ue,onBeforeLeave:x[5]||(x[5]=Le=>{t(N).cleanup()}),class:"processing-dialog"},{default:e(()=>[n(ve,{vertical:"",style:{"flex-grow":"1"}},{default:e(()=>[t(h)?(L(),X($r,{ref_key:"stat",ref:N,key:t(U),processing:t(F),status:t(A),interval:_,onAllZipsClicked:x[0]||(x[0]=Le=>Ie(ye)?ye.value=!0:ye=!0),onDemandZipErrors:t(_e),onDemandImage:Ee,onDeleteImage:de},null,8,["processing","status","onDemandZipErrors"])):me("",!0),n(ve,{justify:"end",align:"center",wrap:!1},{default:e(()=>[t(F)?(L(),X(t(Fe),{key:0,disabled:t(g),ref:"cancelbutton",round:"",size:"large",onClick:x[1]||(x[1]=Le=>g.value=!0)},{default:e(()=>[n(fe,{show:t(g)&&!t(E),size:"small"},{default:e(()=>[I(d(t(l)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):t(E)?(L(),X(t(Fe),{key:1,onClick:K,round:"",size:"large"},{default:e(()=>[I(d(t(l)("close")),1)]),_:1})):me("",!0)]),_:1})]),_:1})]),_:1},8,["show","closable","title","type"]),n($n,{ref_key:"promptref",ref:ae,closable:"",draggable:"",type:"warning","close-on-esc":"",buttons:t(w),"show-apply-all":"","label-apply-all":D.$t("confirmApplyAllLabel"),"apply-all-checked":t(M),"onUpdate:applyAllChecked":x[6]||(x[6]=Le=>Ie(M)?M.value=Le:null)},{header:e(()=>[I(d(D.$t("confirmFileOverwriteTitle",{type:t(S)?D.$t("folder"):D.$t("file")})),1)]),default:e(()=>[v("div",null,d(D.$t("confirmFileOverwriteMsg",{type:t(S)?D.$t("folder"):D.$t("file")})),1),n(ve,{class:"path",align:"center",size:1,wrap:!1},{default:e(()=>[t(S)?(L(),X(Xe,{key:0})):(L(),X(gt,{key:1})),I(" "+d(t(J)),1)]),_:1})]),_:1},8,["buttons","label-apply-all","apply-all-checked"]),n(Ze,{preset:"dialog",type:"warning",show:t(re),"onUpdate:show":x[7]||(x[7]=Le=>Ie(re)?re.value=Le:null),title:D.$t("warnAboutFileSysTitle"),onAfterLeave:x[8]||(x[8]=Le=>t(pe)()),"positive-text":D.$t("Continue"),"negative-text":D.$t("cancel"),onPositiveClick:x[9]||(x[9]=Le=>void(Ie(j)?j.value=!0:j=!0)),onNegativeClick:x[10]||(x[10]=Le=>void(Ie(j)?j.value=!1:j=!1))},{default:e(()=>[v("p",Er,d(D.$t("warnAboutFileSysBeforeConversion1")),1),n(ve,{class:"path",align:"center",size:1,wrap:!1},{default:e(()=>[n(Xe),I(" "+d(D.outputDirHandle.name),1)]),_:1}),v("p",null,d(D.$t("warnAboutFileSysBeforeConversion2")),1)]),_:1},8,["show","title","positive-text","negative-text"])],64)}}}),Dr={class:"container-1"},Or={style:{color:"gray",padding:"0.2em","font-size":"smaller","text-align":"center"}},Mr=["innerHTML"],Ur={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},Rr=we({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(i,{emit:s}){at(Qe);const r=i,l=s,o=sl(),a=m(!1),u=m(0),c=m("");Oe(()=>{p(r.dropTarget||document)});function p(w){document.ondragstart=b=>b.preventDefault(),document.ondragover=b=>b.preventDefault(),w.ondrop=async b=>{var C;if(b.preventDefault(),a.value||r.forbidden)return;a.value=!0,u.value=0,c.value="";let f;try{const F=[...b.dataTransfer.items].map(g=>g.webkitGetAsEntry());o.start(),f=await _(F),o.finish()}catch{f=[...((C=b.dataTransfer)==null?void 0:C.files)??[]],o.error()}a.value&&(a.value=!1,l("drop",f))}}async function _(w,b){b=b||[];for(const f of w)if(f.isFile){const C=await new Promise(F=>f.file(g=>F(g)));Object.defineProperty(C,"webkitRelativePath",{value:f.fullPath}),b.push(C),u.value++}else if(f.isDirectory){c.value=f.fullPath;const C=f.createReader();do{const F=await new Promise(g=>C.readEntries(E=>g(E)));if(!F.length)break;await _(F,b)}while(!0)}return b}return(w,b)=>{const f=ze,C=Ce,F=kt;return L(),q("div",Dr,[n(f,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:e(()=>[v("div",Or," ("+d(w.$t("droptargetLabel"))+") ",1)]),default:e(()=>[v("h3",{innerHTML:w.$t("droptargetTooltip"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,Mr)]),_:1}),n(F,{show:t(a),"onUpdate:show":b[0]||(b[0]=g=>Ie(a)?a.value=g:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":w.$t("cancel")},{default:e(()=>[n(C,{vertical:"",align:"center"},{default:e(()=>[v("div",Ur,d(t(c)),1),v("div",null,"found "+d(t(u))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])])}}}),Br=je(Rr,[["__scopeId","data-v-86730a6a"]]),Nr={class:"container-1"},jr={class:"container-2"},Zr=["innerHTML"],Hr=["innerHTML"],Wr={style:{"white-space":"nowrap","font-size":"smaller"}},Vr={style:{"padding-left":"1em"}},qr=["innerHTML"],Gr=["accept"],Kr=we({__name:"file-selector",props:We({target:{},userExtensions:{},forbidden:{type:Boolean}},{"auto-start-opt":{type:Boolean,required:!0},"auto-start-optModifiers":{},expanded:{type:Boolean,required:!1},expandedModifiers:{},disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:We(["input","click","cancel","on-change-accept","update:target","update:userExtensions"],["update:auto-start-opt","update:expanded","update:disableNotifyingFolderSelect"]),setup(i,{emit:s}){const r=pt(),{t:l}=Ne(),o=at(Qe),a=["avif_only","all_images","all_files","edit_type"],u=[];for(const j of a)u.push({label:()=>l("fileTypeRadioOptions."+j),value:j});const c=({node:j,option:H})=>oe(ze,{placement:"right"},{trigger:()=>j,default:()=>M(H.value).replace(/,/g,", ")}),p=i,_=Te(i,"auto-start-opt"),w=s,b=m(0),f=m(!1),C=m(!1),F=Se(()=>M(z.value)),g=Se(()=>h.value.split(",").every(H=>/^\s*(\.[\w\-]+)*\s*$/.test(H))?"success":"error"),E=Se(()=>!p.forbidden&&!C.value);Te(i,"expanded");const z=Se({get:()=>a.indexOf(p.target)>=0?p.target:a[0],set:j=>{w("update:target",j)}}),h=Se({get:()=>p.userExtensions,set:j=>{w("update:userExtensions",j)}}),T=Te(i,"disableNotifyingFolderSelect"),k=m(null),A=m(null),N=m(J());ke(z,j=>{w("on-change-accept",F.value)}),Oe(()=>{});async function U(j){if(w("click"),j===A.value&&!T.value){let H=!1;if(await new Promise(R=>{r.info({title:l("loadfolderNotifyingTitle"),positiveText:l("Continue"),negativeText:l("Cancel"),onAfterLeave:()=>R(H),onPositiveClick:()=>H=!0,content:()=>oe("div",[oe("p",{},l("loadfolderNotifyingMessageTerm1")),oe("div",[oe(Zt,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/dist//notification-folder.png"})]),oe("p",{},l("loadfolderNotifyingMessageTerm2")),oe("p",[oe(Ct,{onUpdateChecked:se=>T.value=se,checked:T.value},()=>l("checkboxTextDontShowThis"))])])})}),!H){T.value=!1,w("cancel");return}}j.click()}function Z(){w("cancel")}function ae(j){const R=[...j.target.files];k.value.value="",A.value.value="",re(R)}function J(){return"webkitdirectory"in document.createElement("input")}function M(j){switch(j){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico, .svg";case"edit_type":return h.value;case"all_files":default:return".*"}}async function S(j){const H=String(F.value).toLowerCase().replace(/\s+/g,"");if(H&&F.value!==".*"){const R=H.split(",");j=j.filter(se=>R.includes(se.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),j.length||(await new Promise(se=>{r.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:se,content:()=>oe("div",[oe(_n,{description:"NO IMAGES"}),`${l("noimage")}`,oe("br"),F.value])})}),Z())}return j}async function re(j){C.value=!0,j=await S(j),b.value=j.length,j.length>0&&w("input",Q(j)),C.value=!1}let pe=0;function Q(j){const H=[];for(const R of j)R.hasOwnProperty("_id")||Object.defineProperty(R,"_id",{value:pe++}),H.push(R);return H}return(j,H)=>{const R=Ae,se=Fe,le=Ce,ue=Pt,ye=il,K=Gt,Ee=lt;return L(),q(Pe,null,[v("div",Nr,[v("div",jr,[n(le,{vertical:"",align:"center",justify:"center",inline:"",size:"large"},{default:e(()=>[n(le,{align:"center",justify:"space-around",class:"main-buttons"},{default:e(()=>[n(le,{vertical:"",align:"stretch",justify:"center"},{default:e(()=>[n(t(ze),null,{trigger:e(()=>[n(t(Ct),{checked:_.value,"onUpdate:checked":H[0]||(H[0]=de=>_.value=de),size:"small",style:{"font-size":"smaller"}},{default:e(()=>[I(d(j.$t("settings.autoStartConversion")),1)]),_:1},8,["checked"])]),default:e(()=>[I(d(j.$t("settings.autoStartConversionTooltip")),1)]),_:1}),n(t(ze),{to:!1,"display-directive":"show",show:t(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:"top",duration:0,delay:0,"z-index":10},{trigger:e(()=>[n(se,{disabled:!t(E),size:"large",onClick:H[1]||(H[1]=de=>U(t(k))),round:"",style:{width:"100%","background-color":"white","font-size":"1.3em"}},{icon:e(()=>[n(R,{size:"large",color:"gray"},{default:e(()=>[n(t(An))]),_:1})]),default:e(()=>[I(" "+d(j.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:e(()=>[v("div",{innerHTML:j.$t("loadbuttontooltip")},null,8,Zr)]),_:1},8,["show"]),t(N)||t(o).SSR?(L(),q(Pe,{key:0},[n(t(ze),{to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:t(o).showTooltipsBeforeMounted.value},{trigger:e(()=>[n(se,{disabled:!t(E),size:"large",onClick:H[2]||(H[2]=de=>U(t(A))),round:"",style:{width:"100%","background-color":"white","font-size":"1.3em"}},{icon:e(()=>[n(R,{size:"large",color:"gray"},{default:e(()=>[n(t(xn))]),_:1})]),default:e(()=>[I(" "+d(j.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:e(()=>[v("div",{innerHTML:j.$t("loadfoldertooltip")},null,8,Hr)]),_:1},8,["show"]),t(o).IS_SP?me("",!0):(L(),X(Br,{key:0,onDrop:re,forbidden:!t(E),_class:"drop-target"},null,8,["forbidden"]))],64)):me("",!0)]),_:1})]),_:1}),n(le,{vertical:""},{default:e(()=>[n(le,{wrap:t(o).IS_SP,align:"center",justify:"stretch"},{default:e(()=>[n(t(ze),{to:!1,"display-directive":"show",trigger:"hover","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:t(o).showTooltipsBeforeMounted.value},{trigger:e(()=>[v("span",Wr,d(j.$t("TargetFileTypeExt"))+": ",1)]),default:e(()=>[I(d(j.$t("TargetFileTypeExtTooltip")),1)]),_:1},8,["show"]),n(t(ze),{"keep-alive-on-hover":!1,placement:"right",style:{"max-width":"200px"},duration:0,delay:0},{trigger:e(()=>[n(ue,{trigger:"click",width:"trigger",size:"tiny",value:t(z),"onUpdate:value":H[3]||(H[3]=de=>Ie(z)?z.value=de:null),options:u,"render-option":c,"consistent-menu-width":!1},null,8,["value"])]),default:e(()=>[I(" "+d(M(t(z)).replace(/,/g,", ")),1)]),_:1})]),_:1},8,["wrap"]),t(z)==="edit_type"?(L(),X(t(ze),{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:t(f),duration:0,delay:0},{trigger:e(()=>[v("div",Vr,[n(Ee,{trigger:"manual",placement:"right-end",show:t(z)==="edit_type"&&t(g)!=="success"&&!!t(f)},{trigger:e(()=>[n(ye,{value:t(h),"onUpdate:value":H[4]||(H[4]=de=>Ie(h)?h.value=de:null),status:t(g),disabled:t(z)!=="edit_type",onFocus:H[5]||(H[5]=de=>f.value=!0),onBlur:H[6]||(H[6]=de=>f.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:e(()=>[n(K,{type:"error","show-icon":!0,title:"Validation error"},{default:e(()=>H[7]||(H[7]=[I(" Please correct the extension list."),v("br",null,null,-1),v("ul",null,[v("li",null,"Each extension must begin with a period. "),v("li",null,"Separate each extension with a comma. "),v("li",null,"Use alphameric characters.")],-1)])),_:1,__:[7]})]),_:1},8,["show"])])]),default:e(()=>[v("span",{innerHTML:j.$t("editAcceptTypes")},null,8,qr)]),_:1},8,["show"])):me("",!0)]),_:1})]),_:1})])]),v("input",{ref_key:"fileinput",ref:k,onInput:ae,onCancel:Z,type:"file",multiple:"",accept:t(F),style:{display:"none"}},null,40,Gr),v("input",{ref_key:"folderinput",ref:A,webkitdirectory:"",directory:"",onInput:ae,onCancel:Z,type:"file",style:{display:"none"}},null,544)],64)}}}),Qr=je(Kr,[["__scopeId","data-v-6f706eda"]]),Yr={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Xr(i,s){return L(),q("svg",Yr,s[0]||(s[0]=[v("path",{fill:"currentColor","fill-rule":"evenodd",d:"M9.293 7.293a1 1 0 0 1 1.414 0L15.414 12l-4.707 4.707a1 1 0 0 1-1.414-1.414L12.586 12L9.293 8.707a1 1 0 0 1 0-1.414","clip-rule":"evenodd"},null,-1)]))}const Jr=ot({name:"stash-chevron-right-duotone",render:Xr}),eu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function tu(i,s){return L(),q("svg",eu,s[0]||(s[0]=[v("path",{fill:"currentColor",d:"M5 21q-1.275 0-1.812-1.137t.262-2.113L9 11V5H8q-.425 0-.712-.288T7 4t.288-.712T8 3h8q.425 0 .713.288T17 4t-.288.713T16 5h-1v6l5.55 6.75q.8.975.263 2.113T19 21zm2-3h10l-3.4-4h-3.2zm-2 1h14l-6-7.3V5h-2v6.7zm7-7"},null,-1)]))}const nu=ot({name:"material-symbols-experiment-outline",render:tu}),ou={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function au(i,s){return L(),q("svg",ou,s[0]||(s[0]=[v("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"},[v("path",{d:"M19.5 11c0-.818 0-1.57-.152-1.937s-.441-.657-1.02-1.235l-4.736-4.736c-.499-.499-.748-.748-1.058-.896a2 2 0 0 0-.197-.082C12.014 2 11.661 2 10.956 2c-3.245 0-4.868 0-5.967.886a4 4 0 0 0-.603.603C3.5 4.59 3.5 6.211 3.5 9.456V14c0 3.771 0 5.657 1.172 6.828S7.729 22 11.5 22h8m-7-19.5V3c0 2.828 0 4.243.879 5.121C14.257 9 15.672 9 18.5 9h.5"}),v("path",{d:"M14.5 13.999v5M12 19H9l3-5H9m8 3v-3h2a1.5 1.5 0 0 1 0 3zm0 0v2"})],-1)]))}const lu=ot({name:"hugeicons-zip02",render:au}),su={style:{"white-space":"nowrap"}},iu=we({__name:"settings-output",props:We({quality:{},format:{},isMultithreadEnabled:{type:Boolean}},{method:{required:!0},methodModifiers:{},"target-folder-handle":{},"target-folder-handleModifiers":{},"action-on-duplicate":{default:"prompt"},"action-on-duplicateModifiers":{}}),emits:We(["update:format","update:quality"],["update:method","update:target-folder-handle","update:action-on-duplicate"]),setup(i,{emit:s}){const r=i,l=Te(i,"method"),o=Te(i,"target-folder-handle");Te(i,"action-on-duplicate");const a=s,{t:u}=Ne(),c=pt();Tn();const p=at(Qe),_=m([]),w=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],b=Se({get:()=>r.format,set:U=>{U=h(U),a("update:format",U)}}),f=Se({get:()=>r.quality,set:U=>{a("update:quality",U)}}),C=Se(()=>/png|bmp/i.test(b.value)),F=m(null),g=m(!1),E=Se(()=>l.value==="fs"&&!o.value);ke(()=>r.isMultithreadEnabled,U=>{U||(l.value="zip")});const z=Qs();Oe(()=>{T(),!z&&l.value==="fs"&&(l.value="zip")});function h(U){return _.value.indexOf(U)<0&&(U=_.value[0]),U}function T(){for(const U of w)F.value.toDataURL(U).indexOf(U)>=0&&_.value.push(U);_.value.length===0&&_.value.push(w[0])}function k(){return o.value.name}function A(){l.value="fs",Pl(g,200,!1)}async function N(){const U=await Ys();if(!U){if(await c.warning({title:"Rejected",positiveText:"OK",maskClosable:!0,content:u("settings.outputFolderDenied")}),o.value)return;l.value="zip"}o.value=U}return(U,Z)=>{const ae=Ae,J=Pt,M=Ce,S=ze,re=Et,pe=In,Q=lu,j=rl,H=Aa,R=nu,se=Jr,le=Sa,ue=Cn,ye=Fe,K=Gt,Ee=lt,de=ft,be=qt;return L(),q(Pe,null,[n(M,{vertical:"",justify:"center",class:"body"},{default:e(()=>[n(M,{vertical:""},{default:e(()=>[n(S,{to:!1,"display-directive":"show",show:t(p).showTooltipsBeforeMounted.value,trigger:"hover",placement:t(p).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(M,{align:"center",wrap:!1},{default:e(()=>[n(ae,null,{default:e(()=>[n(t(An))]),_:1}),I(d(t(u)("settings.imageType"))+": ",1),n(J,{value:b.value,"onUpdate:value":Z[0]||(Z[0]=ce=>b.value=ce),options:_.value.map(ce=>({value:ce,label:ce})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:e(()=>[I(" "+d(t(u)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(S,{to:!1,"display-directive":"show",show:t(p).showTooltipsBeforeMounted.value,trigger:"hover",placement:t(p).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(M,{align:"center"},{default:e(()=>[n(M,{align:"start",wrap:!1},{default:e(()=>[n(ae,null,{default:e(()=>[n(t(Sn))]),_:1}),v("span",su,d(t(u)("settings.quality"))+":",1),n(M,{align:"center",justify:"space-between"},{default:e(()=>[n(re,{tooltip:!1,value:f.value,"onUpdate:value":Z[1]||(Z[1]=ce=>f.value=ce),step:1,style:{width:"120px"},disabled:C.value},null,8,["value","disabled"]),n(pe,{onBlur:Z[2]||(Z[2]=ce=>f.value=f.value==null?0:f.value),value:f.value,"onUpdate:value":Z[3]||(Z[3]=ce=>f.value=ce),step:"1",min:"0",max:"100",disabled:C.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:e(()=>[I(" "+d(t(u)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1}),n(be,{"trigger-areas":["arrow","main"]},{default:e(()=>[n(de,{disabled:l.value==="fs"},{header:e(()=>[I(d(U.$t("settings.changeSaveMethod")),1)]),default:e(()=>[n(M,{vertical:"",align:"stretch",class:"method-box",size:1},{default:e(()=>[n(j,{checked:l.value==="zip","onUpdate:checked":Z[4]||(Z[4]=ce=>ce&&(l.value="zip"))},{default:e(()=>[n(M,{align:"center",size:2,class:nt(l.value==="zip"?"method-active":"method-inactive")},{default:e(()=>[n(ae,{size:"1.5em"},{default:e(()=>[n(Q)]),_:1}),v("span",null,d(U.$t("settings.saveAsZIP"))+" ("+d(U.$t("Default"))+") ",1)]),_:1},8,["class"])]),_:1},8,["checked"]),n(j,{disabled:!t(z)||!U.isMultithreadEnabled,checked:l.value==="fs","onUpdate:checked":Z[5]||(Z[5]=ce=>ce&&t(z)&&A())},{default:e(()=>[n(M,{align:"center",size:2,class:nt(l.value==="fs"?"method-active":"method-inactive")},{default:e(()=>[n(ae,{size:"1.5em"},{default:e(()=>[n(H)]),_:1}),n(M,{align:"center",size:1},{default:e(()=>[I(d(U.$t("settings.saveToSpecifiedFolder"))+" (",1),n(R),I(d(U.$t("experimental"))+") ",1)]),_:1})]),_:1},8,["class"])]),_:1},8,["disabled","checked"]),n(qe,null,{default:e(()=>[l.value==="fs"?(L(),X(M,{key:0,vertical:"",justify:"center",style:{"margin-left":"2em"}},{default:e(()=>[n(Ee,{trigger:"manual",placement:"right-start",show:g.value&&E.value,"keep-alive-on-hover":!0},{trigger:e(()=>[n(ye,{onClick:Z[6]||(Z[6]=ce=>N()),size:"small",style:{"justify-content":"start"},ghost:"",color:o.value?"green":"red"},{icon:e(()=>[n(se)]),default:e(()=>[o.value?(L(),X(M,{key:0,wrap:!1,size:2,align:"center"},{default:e(()=>[n(le),n(ue,{style:{"max-width":"15em"}},{default:e(()=>[I(d(k()),1)]),_:1})]),_:1})):(L(),X(M,{key:1,wrap:!1,size:2,align:"center"},{default:e(()=>[I(d(U.$t("settings.chooseOutputFolder")),1)]),_:1}))]),_:1},8,["color"])]),default:e(()=>[n(K,{type:"error","show-icon":!0,title:U.$t("settings.chooseOutputFolderTooltip")},null,8,["title"])]),_:1},8,["show"])]),_:1})):me("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1}),v("canvas",{ref_key:"canvas",ref:F,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),ru=je(iu,[["__scopeId","data-v-0b7a23ab"]]),uu={style:{"font-size":"1.1em"}},cu={style:{"font-size":"1.1em"}},du={style:{width:"4em","text-align":"left"}},pu={style:{width:"4em","text-align":"left"}},Rt=100,pn=2e3,fn=4096,gn=4096,fu=100,gu=100,mu=we({__name:"settings-adv",props:{expanded:{type:Boolean,required:!1},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}},emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(i){const s=at(Qe),r={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},l=Te(i,"expanded"),o=Te(i,"multithread"),a=Te(i,"threadCount"),u=Te(i,"maxZipSize"),c=Te(i,"retainExt"),p=Te(i,"useFolderNameForZip"),_=Te(i,"shrinkImage"),w=Te(i,"maxWidth"),b=Te(i,"maxHeight");ke(Re,z=>{z>1||(o.value=!1),a.value>z&&(a.value=z)},{immediate:!0});const f=m(!1);let C=!1,F=()=>{};const g=Se(()=>o.value&&Re.value>1);Oe(()=>{Re.value>1&&typeof a.value>"u"&&(a.value=Math.max(Re.value,2))});async function E(){C=!1,await new Promise(z=>{f.value=!0,F=z}),C&&ql()}return(z,h)=>{const T=Ae,k=Fe,A=dl,N=Ce,U=Et,Z=In,ae=ft,J=qt,M=kt;return L(),q(Pe,null,[n(N,{justify:"center"},{default:e(()=>[n(J,{"display-directive":"show","default-expanded-names":l.value?["collapitem"]:"","on-update:expanded-names":S=>l.value=!!String(S),"trigger-areas":["arrow","main"],class:nt(["settings-body",l.value?"expand-adv-settings":""])},ul({arrow:e(()=>[v("span",uu,[n(T,{style:ge(l.value&&{top:"8px"})},{default:e(()=>[n(t(gl))]),_:1},8,["style"]),n(T,null,{default:e(()=>[n(t(ml))]),_:1})])]),default:e(()=>[n(ae,{name:"collapitem"},{header:e(()=>[v("span",cu,d(z.$t("settings.advancedSettings")),1)]),default:e(()=>[n(N,{vertical:"",style:{"padding-left":"2em"}},{default:e(()=>[n(t(ze),vt(ht(r)),{trigger:e(()=>[n(N,{vertical:""},{default:e(()=>[n(N,{wrap:!1,align:"center"},{default:e(()=>[n(k,{text:"",disabled:!t(Re),style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:h[2]||(h[2]=S=>o.value=!o.value)},{icon:e(()=>[n(T,null,{default:e(()=>[n(t(cl))]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(A,{value:o.value,"onUpdate:value":h[3]||(h[3]=S=>o.value=S),disabled:!t(Re),size:"small"},null,8,["value","disabled"])]),_:1}),n(N,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(U,{value:a.value,"onUpdate:value":h[4]||(h[4]=S=>a.value=S),disabled:!t(Re)||!o.value,step:1,min:2,max:t(Re),style:{width:"120px"}},null,8,["value","disabled","max"]),n(Z,{onBlur:h[5]||(h[5]=S=>a.value=a.value==null?2:a.value),size:"tiny",value:a.value,"onUpdate:value":h[6]||(h[6]=S=>a.value=S),disabled:!t(Re)||!o.value,step:1,min:2,max:t(Re),style:{width:"10em"}},{suffix:e(()=>[I(d(z.$t("threads",a.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(t(ze),vt(ht(r)),{trigger:e(()=>[n(N,{vertical:""},{default:e(()=>[n(N,{wrap:!1,align:"center"},{default:e(()=>[n(k,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:e(()=>[n(T,{style:{"vertical-align":"middle"}},{default:e(()=>[n(t(pl))]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(N,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(U,{tooltip:!1,value:u.value,"onUpdate:value":h[7]||(h[7]=S=>u.value=S),step:1,min:Rt,max:pn,style:{width:"120px"}},null,8,["value"]),n(Z,{onBlur:h[8]||(h[8]=S=>u.value=u.value==null?Rt:u.value),size:"tiny",value:u.value,"onUpdate:value":h[9]||(h[9]=S=>u.value=S),step:"1",min:Rt,max:pn,style:{width:"10em"}},{suffix:e(()=>h[25]||(h[25]=[I("(MB)")])),_:1},8,["value"])]),_:1})]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(t(ze),vt(ht(r)),{trigger:e(()=>[n(N,{wrap:!1,align:"center"},{default:e(()=>[n(k,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:h[10]||(h[10]=S=>p.value=!p.value)},{icon:e(()=>[n(T,null,{default:e(()=>[n(t(xn))]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.useFolderNameForZip")),1)]),_:1}),n(A,{value:p.value,"onUpdate:value":h[11]||(h[11]=S=>p.value=S),size:"small"},null,8,["value"])]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(t(ze),vt(ht(r)),{trigger:e(()=>[n(N,{wrap:!1,align:"center"},{default:e(()=>[n(k,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:h[12]||(h[12]=S=>c.value=!c.value)},{icon:e(()=>[n(T,null,{default:e(()=>[n(t(zn))]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.retainOriginalExtension")),1)]),_:1}),n(A,{value:c.value,"onUpdate:value":h[13]||(h[13]=S=>c.value=S),size:"small"},null,8,["value"])]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.retainExtTooltip")),1)]),_:1},16),n(t(ze),vt(ht(r)),{trigger:e(()=>[n(N,{vertical:""},{default:e(()=>[n(N,{wrap:!1,align:"center"},{default:e(()=>[n(k,{disabled:!g.value,text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:h[14]||(h[14]=S=>_.value=!_.value)},{icon:e(()=>[n(T,null,{default:e(()=>[n(t(fl))]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(A,{disabled:!g.value,value:_.value,"onUpdate:value":h[15]||(h[15]=S=>_.value=S),size:"small"},null,8,["disabled","value"])]),_:1}),n(N,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(U,{value:w.value,"onUpdate:value":h[16]||(h[16]=S=>w.value=S),disabled:!_.value||!g.value,step:1,min:fu,max:fn,style:{width:"120px"}},null,8,["value","disabled"]),n(Z,{size:"tiny",onBlur:h[17]||(h[17]=S=>w.value=w.value==null?8:w.value),value:w.value,"onUpdate:value":h[18]||(h[18]=S=>w.value=S),disabled:!_.value||!g.value,step:1,min:8,max:fn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:e(()=>[v("span",du,d(z.$t("width")),1)]),suffix:e(()=>h[26]||(h[26]=[I("px")])),_:1},8,["value","disabled","max"])]),_:1}),n(N,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(U,{value:b.value,"onUpdate:value":h[19]||(h[19]=S=>b.value=S),disabled:!_.value||!g.value,step:1,min:gu,max:gn,style:{width:"120px"}},null,8,["value","disabled"]),n(Z,{size:"tiny",onBlur:h[20]||(h[20]=S=>b.value=b.value==null?8:b.value),value:b.value,"onUpdate:value":h[21]||(h[21]=S=>b.value=S),disabled:!_.value||!g.value,step:1,min:8,max:gn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:e(()=>[v("span",pu,d(z.$t("height")),1)]),suffix:e(()=>h[27]||(h[27]=[I("px")])),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1})]),_:2},[l.value?{name:"header-extra",fn:e(()=>[n(t(ze),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(k,{onClick:h[0]||(h[0]=S=>E()),size:"tiny",style:{"font-size":"xx-small"}},{default:e(()=>[I(d(z.$t("reset")),1)]),_:1})]),default:e(()=>[I(" "+d(z.$t("settings.resetButtonTooltip")),1)]),_:1}),t(s).IS_DEV?(L(),q("button",{key:0,onClick:h[1]||(h[1]=S=>t(Gl)())},"delcfg")):me("",!0)]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1}),n(M,{preset:"confirm",type:"info",show:t(f),"onUpdate:show":h[22]||(h[22]=S=>Ie(f)?f.value=S:null),title:z.$t("reset"),"positive-text":z.$t("OK"),"negative-text":z.$t("cancel"),onPositiveClick:h[23]||(h[23]=S=>Ie(C)?C.value=!0:C=!0),onAfterLeave:h[24]||(h[24]=S=>t(F)())},{default:e(()=>[I(d(z.$t("warnAboutResetMsg")),1)]),_:1},8,["show","title","positive-text","negative-text"])],64)}}}),vu=je(mu,[["__scopeId","data-v-c3ff20ca"]]),hu={},yu={style:{color:"gray","padding-left":"20px"}},_u=["innerHTML"];function wu(i,s){const r=yn,l=Ce;return L(),X(l,{vertical:"",justify:"end"},{default:e(()=>[n(r,{style:{margin:"0px"}}),n(l,{justify:"center"},{default:e(()=>[v("ul",yu,[(L(!0),q(Pe,null,it(i.$tm("descriptions"),o=>(L(),q("li",{key:o,style:{"text-align":"left"},innerHTML:o},null,8,_u))),128))])]),_:1})]),_:1})}const bu=je(hu,[["render",wu]]);function ku(i={}){const{immediate:s=!1,onNeedRefresh:r,onOfflineReady:l,onRegistered:o,onRegisteredSW:a,onRegisterError:u}=i;let c,p,_;const w=async(f=!0)=>{await p,_==null||_()};async function b(){if("serviceWorker"in navigator){if(c=await xe(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/avif2jpeg/dist/sw.js",{scope:"/avif2jpeg/dist/",type:"classic"})).catch(f=>{u==null||u(f)}),!c)return;_=()=>{c==null||c.messageSkipWaiting()};{let f=!1;const C=()=>{f=!0,c==null||c.addEventListener("controlling",F=>{F.isUpdate&&window.location.reload()}),r==null||r()};c.addEventListener("installed",F=>{typeof F.isUpdate>"u"?typeof F.isExternal<"u"&&F.isExternal?C():!f&&(l==null||l()):F.isUpdate||l==null||l()}),c.addEventListener("waiting",C)}c.register({immediate:s}).then(f=>{a?a("/avif2jpeg/dist/sw.js",f):o==null||o(f)}).catch(f=>{u==null||u(f)})}}return p=b(),w}function zu(i={}){const{immediate:s=!0,onNeedRefresh:r,onOfflineReady:l,onRegistered:o,onRegisteredSW:a,onRegisterError:u}=i,c=m(!1),p=m(!1);return{updateServiceWorker:ku({immediate:s,onNeedRefresh(){c.value=!0,r==null||r()},onOfflineReady(){p.value=!0,l==null||l()},onRegistered:o,onRegisteredSW:a,onRegisterError:u}),offlineReady:p,needRefresh:c}}const Su={style:{"line-height":"0px"}},Cu=["innerHTML"],Tu=we({__name:"PWAPrompt",setup(i){const s=m(null),r=m(!1),l=m(void 0),o=m(!1),a=m("unknown");window.addEventListener("beforeinstallprompt",g=>{g.preventDefault(),s.value=g,r.value=!0,l.value=!1}),window.addEventListener("appinstalled",g=>{f()});const{needRefresh:u,updateServiceWorker:c}=zu({onOfflineReady(){},async onNeedRefresh(){const g=await fetch(location.origin+"/avif2jpeg/dist/version.txt",{cache:"no-store"});if(g.status!==200)return;const E=await g.text();E&&(a.value=E)},onRegisterError(g){}});Oe(async()=>{setTimeout(p,100)});async function p(){await _()&&(l.value=!!(w()||!r.value),l.value)}async function _(){var E;return await((E=navigator.userAgentData)==null?void 0:E.getHighEntropyValues(["brands"]).then(z=>z.brands.some(h=>h.brand.includes("Chromium")||h.brand.includes("Google Chrome")||h.brand.includes("Microsoft Edge"))))||/Chrome|Chromium|Edg\//.test(navigator.userAgent)}function w(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}async function b(){if(s.value){s.value.prompt();const g=await s.value.userChoice;s.value=null,g.outcome==="accepted"&&setTimeout(f,500)}}function f(){var g;(g=navigator.serviceWorker)==null||g.ready.then(E=>{var z;l.value||((z=E.active)==null||z.postMessage("app-installed"),l.value=!0)})}function C(){o.value=!0,setTimeout(()=>o.value=!1,60*60*1e3)}async function F(){u.value=!1,await c()}return(g,E)=>{const z=Ae,h=Ce,T=ze,k=Fe,A=Gt;return L(),q("div",Su,[l.value===!0?(L(),X(T,{key:0,placement:"bottom"},{trigger:e(()=>[n(h,{id:"app-installed",align:"center",size:1},{default:e(()=>[n(z,{component:t(on)},null,8,["component"]),E[0]||(E[0]=I("PWA "))]),_:1,__:[0]})]),default:e(()=>[I(d(g.$t("PWAInstalledTooltip")),1)]),_:1})):l.value===!1&&s.value&&!t(u)?(L(),X(T,{key:1,placement:"bottom","keep-alive-on-hover":!0,style:{"max-width":"40vw"},delay:300,duration:150,"z-index":10},{trigger:e(()=>[n(k,{onClick:b,size:"tiny"},{icon:e(()=>[n(z,{component:t(on)},null,8,["component"])]),default:e(()=>[I(" "+d(g.$t("installAsApp")),1)]),_:1})]),default:e(()=>[v("div",{id:"pwa-tooltip",innerHTML:g.$t("PWAinstallAsAppTooltip")},null,8,Cu)]),_:1})):me("",!0),n(qe,null,{default:e(()=>[t(u)&&!o.value?(L(),X(A,{key:0,onClose:C,type:"info",closable:""},{default:e(()=>[n(h,{justify:"space-between",align:"center"},{default:e(()=>[n(h,{vertical:"",class:"message",size:1},{default:e(()=>[v("span",null,d(a.value),1),v("span",null,d(g.$t("PWAUpdateMessage")),1)]),_:1}),n(h,{size:8},{default:e(()=>[n(k,{onClick:F,round:"",type:"primary",size:"small"},{default:e(()=>[I(d(g.$t("Reload")),1)]),_:1}),n(k,{onClick:C,round:"",size:"small"},{default:e(()=>[I(d(g.$t("close")),1)]),_:1})]),_:1})]),_:1})]),_:1})):me("",!0)]),_:1})])}}}),Au=["innerHTML"],xu=we({__name:"switch-lang",props:{delay:{}},emits:["ready","lang-ready","lang-change","lang-change-by-user"],async setup(i,{emit:s}){let r,l;const o=at(Qe),a=Wt(),{locale:u,t:c}=Ne(),p=pt(),_=i,w=s,b=Object.entries(Is).map(([T,k])=>({label:k,value:T}));b.sort((T,k)=>{const A=T.label,N=k.label;return A>N?1:A<N?-1:0});let f="";Oe(()=>{a.afterEach((T,k,A)=>{g(),o.switchToolTipVisibility()})}),[r,l]=vl(()=>g()),await r,l(),C(),w("ready");function C(){const T="/avif2jpeg/dist/",k=[];for(const A of _t){if(a.currentRoute.value.path.includes(A))continue;const N={rel:"alternate",hreflang:A,href:T+A};k.push(N)}k.push({rel:"alternate",hreflang:"x-default",href:T}),hl({title:c("title"),meta:[{property:"og:title",content:c("title")},{property:"og:description",content:c("metaDescription")}],link:[...k]})}async function F(T){if(T!==u.value||xt.global.availableLocales.indexOf(T)===-1){if(w("lang-change",T),await El(_.delay),!await Ls(T))return p.error({title:c("Failed to get language file"),positiveText:"OK",content:()=>oe("div",[`lang: ${T}`])}),w("lang-ready",""),!1;u.value=T,document.title=c("title"),document.documentElement.lang=T,await $e()}return w("lang-ready",T),!0}async function g(){var A;const k=((A=(a.currentRoute.value.path||"").match(/([^/]+)\/?$/))==null?void 0:A[1])||"";k&&_t.includes(k)?await F(k)&&f===k&&w("lang-change-by-user",k):await E()}async function E(){const T=z().toLowerCase(),k=T.split(/[-_]/)[0];if(_t.includes(k)){let A=k;if(k==="zh")switch(T){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":A="zh-hant"}await F(A)}}function z(){const T=window.navigator;return T.language||T.userLanguage||T.browserLanguage}function h(T){f=T;const k=T?T+"/":"";a.push("/"+k)}return(T,k)=>{const A=Ae,N=Ht("router-link"),U=ze,Z=Pt,ae=Ce;return L(),X(ae,{align:"center",size:2},{default:e(()=>[t(a).currentRoute.value.path!=="/"?(L(),X(U,{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"left",duration:0,delay:50},{trigger:e(()=>[n(N,{to:"/",onClick:k[0]||(k[0]=J=>w("lang-change-by-user","")),style:{color:"gray","line-height":"0px","font-size":"1.2em"}},{default:e(()=>[n(A,{component:t(yl)},null,8,["component"])]),_:1})]),default:e(()=>[I(d(t(c)("selectLangCloseTooltip")),1)]),_:1})):me("",!0),n(U,{to:!1,trigger:"hover","keep-alive-on-hover":!1,placement:t(o).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:e(()=>[n(Z,{ref:"langselect",size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,options:t(b),value:t(u),"onUpdate:value":h},{arrow:e(()=>[n(A,null,{default:e(()=>[n(t(_l))]),_:1})]),_:1},8,["options","value"])]),default:e(()=>[v("div",{innerHTML:T.$t("selectLanguage")},null,8,Au)]),_:1},8,["placement"])]),_:1})}}}),Qe=Symbol("global variables"),Iu=we({__name:"Avif2Jpeg",emits:["ready"],setup(i,{emit:s}){const{t:r,locale:l}=Ne(),o=200,a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),u=!1,c=m([]),p=m([]);m(0);let _=m(void 0);const w=m(!0),b=m(!1),f=m(!1),C=m(!1),F=m(!0);m(!1);const g=m(null),E=m(!1),z=m();kl(Qe,{showTooltipsBeforeMounted:_,LANDSCAPE:w,IS_SP:a,IS_DEV:u,switchToolTipVisibility:U,SSR:!1}),Oe(()=>{Z(),window.addEventListener("resize",Z),U(),setTimeout(()=>f.value=!0,3e3)}),At(()=>{window.removeEventListener("resize",Z)});function h(){var re;!((re=hn().path.match(/[^/]+(?=\/?$)/))==null?void 0:re[0])&&W.lang&&Wt().push("/"+W.lang)}let T=0;function k(){C.value=!1,T=Date.now()}function A(M){W.lang=M}function N(){const M=F.value?0:Math.max(0,o-(Date.now()-T));F.value=!1,$e(()=>{setTimeout(()=>C.value=!0,M)})}async function U(){}function Z(){const M=document.body.clientWidth,S=document.body.clientHeight;w.value=M*.75>S||M>900}async function ae(M){W.autoStartConversion&&(c.value.length=0,await $e()),p.value=M}function J(M){E.value=M}return(M,S)=>{const re=Ht("ClientOnly"),pe=Zl,Q=Ce,j=Ae,H=lt;return L(),X(Q,{vertical:"",align:"stretch",class:"avif2jpeg"},{default:e(()=>[n(Fs,null,{"lang-switch":e(()=>[(L(),X(wl,null,{default:e(()=>[n(xu,{onLangChange:k,onLangReady:N,onLangChangeByUser:A,onReady:h,delay:t(F)?0:o},null,8,["delay"])]),_:1}))]),_:1}),n(re,null,{default:e(()=>[n(Tu)]),_:1}),n(qe,{name:"fade"},{default:e(()=>[Ge(n(Q,{vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:e(()=>[n(Q,{justify:"space-around",vertical:"",style:{height:"100%"}},{default:e(()=>[n(Ds),n(Q,{justify:"center",align:"center"},{default:e(()=>[n(Qr,{key:"key-fselector",target:t(W).acceptTypeValue,"onUpdate:target":S[0]||(S[0]=R=>t(W).acceptTypeValue=R),userExtensions:t(W).editedAcceptTypes,"onUpdate:userExtensions":S[1]||(S[1]=R=>t(W).editedAcceptTypes=R),"disable-notifying-folder-select":t(W).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":S[2]||(S[2]=R=>t(W).disableNotifyingFolderSelect=R),"auto-start-opt":t(W).autoStartConversion,"onUpdate:autoStartOpt":S[3]||(S[3]=R=>t(W).autoStartConversion=R),forbidden:t(b),onInput:ae,onClick:S[4]||(S[4]=R=>J(!0)),onCancel:S[5]||(S[5]=R=>J(!1))},null,8,["target","userExtensions","disable-notifying-folder-select","auto-start-opt","forbidden"]),n(Tt,null,{default:e(()=>[Ge(n(pe,{key:"key-filelist","file-list":t(c),"onUpdate:fileList":S[6]||(S[6]=R=>Ie(c)?c.value=R:null),"additional-files":t(p)},null,8,["file-list","additional-files"]),[[Ke,t(c).length]])]),_:1})]),_:1}),n(Q,{vertical:"",align:"center"},{default:e(()=>[n(H,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(j,{size:"5vh",color:"#DADADA",style:{margin:"0px"}},{default:e(()=>[n(t(bl))]),_:1})]),default:e(()=>[S[22]||(S[22]=v("span",null,"CONVERT TO👇",-1))]),_:1,__:[22]})]),_:1}),n(Q,{vertical:"",align:"center"},{default:e(()=>[n(ru,{format:t(W).imageFormat,"onUpdate:format":S[7]||(S[7]=R=>t(W).imageFormat=R),quality:t(W).imageQuality,"onUpdate:quality":S[8]||(S[8]=R=>t(W).imageQuality=R),method:t(W).outputMethod,"onUpdate:method":S[9]||(S[9]=R=>t(W).outputMethod=R),"target-folder-handle":t(g),"onUpdate:targetFolderHandle":S[10]||(S[10]=R=>Ie(g)?g.value=R:null),"is-multithread-enabled":t(W).multithread},null,8,["format","quality","method","target-folder-handle","is-multithread-enabled"])]),_:1}),n(Pr,{input:t(c),format:t(W).imageFormat,quality:t(W).imageQuality,"retain-extension":t(W).retainExtension,maxZipSizeMB:t(W).maxZipSizeMB,threads:t(W).multithread?t(W).threadCount:0,"auto-start":t(W).autoStartConversion,"output-to-dir":t(W).outputMethod==="fs","output-dir-handle":t(W).outputMethod==="fs"?t(g):null,onStart:S[11]||(S[11]=R=>b.value=!0),onEnd:S[12]||(S[12]=R=>b.value=!1)},{"lang-switch":e(()=>S[23]||(S[23]=[])),_:1},8,["input","format","quality","retain-extension","maxZipSizeMB","threads","auto-start","output-to-dir","output-dir-handle"]),n(Q,{vertical:"",align:t(z)?"center":"end",style:{"padding-right":"1em"}},{default:e(()=>[n(vu,{"retain-ext":t(W).retainExtension,"onUpdate:retainExt":S[13]||(S[13]=R=>t(W).retainExtension=R),"use-folder-name-for-zip":t(W).useFolderNameForZip,"onUpdate:useFolderNameForZip":S[14]||(S[14]=R=>t(W).useFolderNameForZip=R),"max-zip-size":t(W).maxZipSizeMB,"onUpdate:maxZipSize":S[15]||(S[15]=R=>t(W).maxZipSizeMB=R),multithread:t(W).multithread,"onUpdate:multithread":S[16]||(S[16]=R=>t(W).multithread=R),"thread-count":t(W).threadCount,"onUpdate:threadCount":S[17]||(S[17]=R=>t(W).threadCount=R),expanded:t(z),"onUpdate:expanded":S[18]||(S[18]=R=>Ie(z)?z.value=R:null),"shrink-image":t(W).shrinkImage,"onUpdate:shrinkImage":S[19]||(S[19]=R=>t(W).shrinkImage=R),"max-width":t(W).maxWidth,"onUpdate:maxWidth":S[20]||(S[20]=R=>t(W).maxWidth=R),"max-height":t(W).maxHeight,"onUpdate:maxHeight":S[21]||(S[21]=R=>t(W).maxHeight=R)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","multithread","thread-count","expanded","shrink-image","max-width","max-height"])]),_:1},8,["align"]),n(bu)]),_:1})]),_:1},512),[[Ke,t(C)]])]),_:1})]),_:1})}}}),Lu={key:0,style:{"text-align":"center"}},Qt=we({__name:"App",setup(i){const s={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{},Image:{toolbarColor:"#00000099"}},r=m(!0);return Oe(()=>{r.value=!1}),(l,o)=>{const a=Tl,u=Cl,c=Sl,p=zl,_=Al;return L(),q(Pe,null,[t(r)?(L(),q("div",Lu," Rendering the page… please wait. ")):me("",!0),n(_,{"theme-overrides":s,style:{width:"100%",height:"100%"}},{default:e(()=>[n(p,null,{default:e(()=>[n(c,{placement:"top-left",closable:!0,max:50},{default:e(()=>[n(u,null,{default:e(()=>[n(a,null,{default:e(()=>[n(Iu,{class:nt({hide:t(r)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}}),xa=[{path:"/",name:"Home",component:Qt}];for(const i of _t)xa.push({path:"/"+i+"/",strict:!0,name:i,component:Qt});xl(Qt,{routes:xa,base:"/avif2jpeg/dist/"},({app:i,router:s,routes:r,isClient:l,initialState:o})=>{i.use(xt)});
