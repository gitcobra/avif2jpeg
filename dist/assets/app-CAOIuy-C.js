var na=Object.defineProperty;var oa=(i,s,r)=>s in i?na(i,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[s]=r;var tt=(i,s,r)=>oa(i,typeof s!="symbol"?s+"":s,r);import{r as k,a as xt,d as ye,i as Qe,c as J,o as P,_ as xe,u as e,w as t,b as T,t as d,e as y,f as n,g as Ae,N as he,L as aa,h as la,j as K,k as De,l as Xe,m as te,n as sa,p as ia,q as ra,s as ce,v as Rt,x as gn,y as mn,z as Ie,A as we,B as Ce,C as Ot,D as Ut,E as We,F as Ke,G as ua,H as da,I as Be,J as It,K as ie,M as Je,T as et,O as vn,P as Ze,Q as Dt,R as Tt,S as Nt,U as nt,V as vt,W as ca,X as Oe,Y as ot,Z as pa,$ as Jt,a0 as en,a1 as hn,a2 as fa,a3 as At,a4 as ga,a5 as ma,a6 as jt,a7 as va,a8 as tn,a9 as St,aa as ha,ab as Re,ac as _n,ad as _a,ae as wa,af as at,ag as Fe,ah as ya,ai as ht,aj as Lt,ak as ba,al as He,am as ka,an as wn,ao as yn,ap as za,aq as bn,ar as nn,as as kn,at as xa,au as Ia,av as Ta,aw as Aa,ax as Sa,ay as zn,az as La,aA as Bt,aB as xn,aC as Ca,aD as $a,aE as In,aF as Ea,aG as it,aH as rt,aI as Pa,aJ as Fa,aK as Oa,aL as Ua,aM as Ma,aN as Ra,aO as Da,aP as Na,aQ as ja,aR as Ba,aS as Za,aT as Ha,aU as Va,aV as Wa,aW as qa,aX as Ga,aY as Ka,aZ as Ya}from"./vendor-BgheHLCn.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))u(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&u(f)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function u(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();const Me=k(navigator.hardwareConcurrency?Math.min(navigator.hardwareConcurrency,12):0),ut={threadCount:{min:2,max:Math.max(2,Me.value)}},Qa={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:Me.value,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1,changeLogCheckedDate:0},H=xt(Tn({}));function Xa(){Tn(H)}function Tn(i){return Object.assign(i,Qa)}const An="avif2jpeg",$t=JSON.parse(localStorage.getItem(An)||"{}");for(const i in H)if($t.hasOwnProperty(i)&&$t[i]!==void 0){let s=$t[i];ut.hasOwnProperty(i)&&(ut[i].min>s&&(s=ut[i].min),ut[i].max<s&&(s=ut[i].max)),H[i]=s}const Sn=()=>{const i={};for(const s in H)i[s]=H[s];localStorage.setItem(An,JSON.stringify(i))};window.addEventListener("beforeunload",Sn);function Ja(){localStorage.clear(),window.removeEventListener("beforeunload",Sn)}const el={href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-weight":"bolder"}},tl=ye({__name:"github",setup(i){const s=Qe(qe);return(r,u)=>{const o=he,l=Ae,f=xe;return P(),J(f,{to:!1,"display-directive":"show",show:e(s).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",el,[n(l,{align:"center",size:0},{default:t(()=>[n(o,{size:"1.2em"},{default:t(()=>[n(e(aa))]),_:1}),u[0]||(u[0]=T("GitHub "))]),_:1})])]),default:t(()=>[T(" "+d(r.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),nl=1,ol=10,al=15,ll="",ft={major:nl,minor:ol,build:al,tag:ll},sl={style:{"font-size":"x-small","user-select":"none"}},il=ye({__name:"version",setup(i){const s=["0.0.118"],r=`${ft.major}.${ft.minor}.${ft.build}${ft.tag}`,u=s.map(c=>({label:`v${c}`,key:c,value:c}));function o(c){const{key:z,label:_}=c,h=f(z),b=K("a",{href:h},_),w=K("div",null,b);return K("div",null,w)}function l(c){location.href=f(c)}function f(c){return`/avif2jpeg/old/${c}/`}return(c,z)=>{const _=la;return P(),J(_,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:e(u),"render-label":o,"onUpdate:value":l},{header:t(()=>[y("span",sl,d(c.$t("previousVersion")),1)]),default:t(()=>[y("span",{style:{cursor:"pointer"}},"v"+d(r))]),_:1},8,["options"])}}}),rl={key:0,style:{color:"red"}},ul=["innerHTML"],dl=ye({__name:"changelog",props:{url:{}},setup(i){const s=i,r=k("fetching..."),u=k(!1);De(()=>l(s.url));let o=0;async function l(c){var h;const z=await fetch(c,{headers:{Accept:"application/vnd.github.v3+json"}}).then(b=>b.ok?b.text():null);if(r.value="",!z)return;console.log(z);const _=(h=z.match(/^\d{4}.+/))==null?void 0:h[0];_&&(o=new Date(_).getTime(),o>H.changeLogCheckedDate&&(u.value=!0),r.value=z.replace(/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2}) \+\d+$/mg,b=>new Date(b).toLocaleString()))}function f(){H.changeLogCheckedDate=o,u.value=!1}return(c,z)=>{const _=he,h=Ae,b=Xe;return P(),J(b,{trigger:"click",placement:"bottom-start","onUpdate:show":f},{trigger:t(()=>[n(h,{align:"center",size:1,style:{cursor:"pointer"}},{default:t(()=>[n(_,{component:e(sa),size:"1.5em",color:e(u)?"blue":"silver"},null,8,["component","color"]),T(" "+d(c.$t("changelog")),1)]),_:1})]),default:t(()=>[e(r)?(P(),te("pre",{key:1,innerHTML:e(r),class:"commits"},null,8,ul)):(P(),te("div",rl," connection error "))]),_:1})}}}),cl=ye({__name:"header",setup(i){const s=ia();return(r,u)=>{const o=ra("router-link"),l=Ae,f=gn;return P(),J(l,{vertical:"",justify:"start"},{default:t(()=>[n(l,{justify:"space-between",align:"center",wrap:!1},{default:t(()=>[n(l,{align:"center"},{default:t(()=>[n(tl),n(dl,{url:"/avif2jpeg/dist/commits.txt"}),n(il),n(l,{style:{"font-size":"1em",color:"black"}},{default:t(()=>[e(s).path!=="/"?(P(),J(o,{key:0,to:"/"},{default:t(()=>u[0]||(u[0]=[T("HOME")])),_:1})):ce("",!0)]),_:1})]),_:1}),n(l,{align:"end"},{default:t(()=>[Rt(r.$slots,"lang-switch")]),_:3})]),_:3}),n(f,{style:{margin:"0px"}})]),_:3})}}}),pl={style:{padding:"0px",margin:"0px","text-align":"center"}},fl=ye({__name:"title",setup(i){const s=mn();return Ie(()=>{const r=s.currentRoute.value.path||"";return!String(r.match(new RegExp("(?<=^\\/)[^/]+"))||"")}),(r,u)=>{const o=Ae;return P(),J(o,{align:"center",justify:"center",style:{margin:"0px"}},{default:t(()=>[y("h1",pl,d(r.$t("title")),1)]),_:1})}}}),on=new Set,gl=new Set,ml=new Set,_t=new Map;function vl(i){const s=_t.get(i);if(!s){console.warn("the worker was already released.",i.id);return}_t.delete(i),s(),gt==null||gt(),gt=null}function hl(){for(const i of _t.keys())vl(i)}let gt=null;function Ln(){hl();for(const i of on)i.onmessage=null,i.terminate();on.clear(),gl.clear(),ml.clear(),_t.clear()}function _l(i){return new Worker("/avif2jpeg/dist/assets/worker.zip-BpG-kYFu.js",{name:i==null?void 0:i.name})}function wl(i){return new Worker("/avif2jpeg/dist/assets/worker.loader-hdSA9Vyi.js",{name:i==null?void 0:i.name})}const yl=1e3*10;let Ye;const Ne=new Map,wt=new Map,yt=new Map;let Zt,Y,Ht,bt,mt,Cn,$n,En,Pn,ct;function Et(i){if({files:mt,completedFileIdSet:Zt,ConvStats:Y,canceled:Ht,props:bt,format:Cn,quality:$n,outputExt:En,imageType:Pn,message:ct}=i||{},Ye=null,Ne.clear(),wt.clear(),yt.clear(),wt.clear(),yt.clear(),i)for(const r in i)delete i[r]}async function bl(i){Et(i),Zt.clear();let s;try{s=await kl()}catch{return Et(),{exception:new Error("worker-load-error"),callbackToClearConverter:new Function,callbackToGenerateFailedZips:new Function}}const[r,u]=s;Ye=u;const o=new Promise(w=>{u.onmessage=m=>{const g=m.data,{action:E}=g;switch(E){case"squeeze-zip":case"zip-squeeze-error":w(void 0);break}}}),l=new Promise(w=>{r.onmessage=m=>{const{data:{action:g}}=m;g==="close-loader"&&w()}}),f=mt.map(w=>w._id);mt.forEach(w=>wt.set(w._id,w));const c=we(Ht,w=>{if(!w)return;c();const m={action:"cancel-convert"};r.postMessage(m)}),z={action:"start-convert",list:mt,fileIdList:f,outputQuality:$n,outputType:Cn,threads:bt.threads,maxSize:H.shrinkImage?{width:H.maxWidth,height:H.maxHeight}:null};r.postMessage(z),await l,console.log("end loader worker"),u.postMessage({action:"squeeze"}),await o,console.log("end zip worker"),c();const _=()=>{Ln(),u.onmessage=null,u.terminate(),r.onmessage=null,r.terminate(),Et()};let h=!1;return{callbackToClearConverter:_,callbackToGenerateFailedZips:async w=>{h||(h=!0,await $l(w,u,{},Y))}}}async function kl(){Ln();const i=new wl,s=new _l,r=new Promise((f,c)=>{const z=m=>{s.removeEventListener("message",b),i.removeEventListener("message",b),clearTimeout(w),m?(console.log("workers are avialble"),f(m)):(console.error("couldn't get responses from workers"),c(m))};let _=!1,h=!1;const b=m=>{m.target===s&&(console.log("got a message from zip worker"),_=!0),m.target===i&&(console.log("got a message from loader worker"),h=!0),_&&h&&z(!0)};let w=0;s.addEventListener("message",b),i.addEventListener("message",b),w=window.setTimeout(()=>z(!1),yl)}),{port1:u,port2:o}=new MessageChannel,l={action:"set-zip-port"};return s.postMessage({action:"set-port-loader"},[u]),i.postMessage(l,[o]),console.log("test workers' availability"),await r,s.postMessage({action:"set-config",zipSize:bt.maxZipSizeMB*1024*1024,keepExt:bt.retainExtension,outputExt:En,imageType:Pn}),i.addEventListener("message",xl),s.addEventListener("message",zl),[i,s]}const zl=i=>{const s=i.data,{action:r}=s;switch(r){case"add-zip-completed":{const{fileId:f,entireIndex:c,storedPath:z}=s;return}case"respond-image":{const{url:f,index:c,path:z,size:_,fileId:h}=s;Y.convertedImageUrl=f,Y.convertedImageSize=_,Y.convertedImageIndex=c,Y.convertedImageName=z;let b="",w=0,m="";const g=Ne.get(h);if(h>=0){const E=wt.get(h);b=URL.createObjectURL(E),w=E.size,m=E.webkitRelativePath||E.name}Y.convertedImageOrgUrl=b,Y.convertedImageOrgSize=w,Y.convertedImageOrgName=m,Y.convertedImageShrinked=g==null?void 0:g.shrinked;return}case"respond-delete":{const{index:f,success:c,fileId:z}=s;Ne.get(z).command="âŒdeleted",Ne.get(z).completed=!1;return}}switch(r){case"error-push-filelist-zip":const{path:f}=s;Y.failedZipDone=!0,ct.error(`an error occurred "${f}"`,{duration:3e3});return}const{size:u,count:o}=s,l="url"in i.data?i.data.url:"";switch(r){case"push-zip":Y.zips.push({url:l,size:u,count:o}),Y.zippedTotalCount+=o,Y.zippedTotalSize+=u;break;case"squeeze-zip":o>0&&(Y.zips.push({url:l,size:u,count:o}),Y.zippedTotalCount+=o,Y.zippedTotalSize+=u);break;case"push-filelist":Y.failedFileZippedCount++;break;case"squeeze-filelist-zip":Y.failedZipDone=!0;case"push-filelist-zip":console.log("push-filelist-zip",o),Y.failedZips.push({url:l,size:u,count:o}),console.log(o);break;case"zip-error":case"zip-squeeze-error":Y.zippingErrorCount+=o;break}},xl=i=>{i.target;const{data:s}=i,{action:r}=s;switch(r){case"list-start":break;case"list-end":break;case"file-start":{const{index:u,path:o,fileId:l}=s;Tl(u,o,l);break}case"file-load":{const{thumbnail:u,width:o,height:l,fileId:f,workerId:c,inputsize:z}=s,_=Ne.get(f);_.core=c,_.command="ðŸ–¼ï¸loaded",_.width=o,_.height=l,_.size=z,u&&(Y.thumbnail=u);break}case"file-converted":{const{index:u,path:o,fileId:l,shrinked:f,outputWidth:c,outputHeight:z,outputsize:_}=s,h=Ne.get(l);h.command="ðŸ”ƒconverted",h.shrinked??(h.shrinked=f),h.outputWidth=c,h.outputHeight=z,h.outputSize=_,Y.converted++;break}case"file-completed":{const{inputsize:u,outputsize:o,fileId:l,entireIndex:f,storedPath:c}=s,z=Ne.get(l);z&&(z.command="âœ…completed",z.completed=!0,z.fileId=l),Y.inputTotalSize+=u,Y.outputTotalSize+=o,Y.done++,Y.success++,Zt.add(l),z.zippedIndex=f,Y.ziplogs[f]={fileId:l,storedPath:c};break}case"file-retry":{const{index:u,path:o,fileId:l}=s;Al(u,o,l);break}case"file-error":{const{index:u,path:o,fileId:l}=s;Sl(u,o,l);break}case"file-canceled":{const{fileId:u,path:o}=s;Ll(u);break}}};let Il=0;function Tl(i,s,r){const u={key:Il++,core:-1,index:i,path:s,command:"âž¡ï¸started"};Ne.set(r,u),Y.logs.push(u),yt.has(r)?console.warn(`retry "${s}".`):Ht.value||Y.startedCount++}function Al(i,s,r){const u=Ne.get(r);u.command="âš ï¸retrying",u.error=!0,ct.warning(`retrying "${s}"`,{duration:3e3}),Y.retried++,yt.set(r,1)}function Sl(i,s,r){console.error(`failed to load "${s}". the image may be corrupted or cannot be read by some reason.`);const u=Ne.get(r);Y.done++,Y.failure++,u.command="â—failed",u.error=!0,ct.error(`failed to load "${s}"`,{duration:5e3})}function Ll(i){const s=Ne.get(i);Y.done++,Y.failure++,s.command="â—canceled",s.error=!0}function Cl(i){Ye==null||Ye.postMessage({action:"request-image",index:i})}function Pt(i){Ye==null||Ye.postMessage({action:"delete-image",index:i})}async function $l(i,s,r,u){let o=0;for(const l of i){const f=(l.webkitRelativePath||l.name).replace(/^\//,"");if(u.failedZipDone)break;if(r.value)return;o-u.failedFileZippedCount>20&&await new Promise(c=>setTimeout(c,10)),s.postMessage({action:"add-filelist",file:l,path:f}),o++}if(u.failedZipDone){ct.error("Zipping error files was aborted",{duration:5e3});return}s.postMessage({action:"squeeze-filelist"})}function je(i,s=2){const r=Math.sign(i);i=Math.abs(i);const u=["Bytes","KB","MB","GB"],o=i?Math.floor(Math.log(i)/Math.log(1024)):0;return`${(i/Math.pow(1024,o)*r).toFixed(s)}${u[o]}`}function Fn(i,s=100,r=!1){s=typeof s=="number"?{width:s,height:s}:s;const{width:u,height:o}=s;let{width:l,height:f}=i;const c=l/f,z=u/o;return c>=z?(l=r?Math.min(u,l):u,f=l/c|0):(f=r?Math.min(o,f):o,l=f*c|0),{width:l,height:f}}class El{constructor(){tt(this,"_currentFileCount",0);tt(this,"_currentZipIndex",0);tt(this,"_totalFileCount",0);tt(this,"_zipLengthSumList",[]);tt(this,"_pathBank",{})}increase(s){return s&&(this._pathBank[s]=[this._zipLengthSumList.length,this._currentFileCount]),this._currentFileCount++,this._totalFileCount++}split(){this._zipLengthSumList.push(this._totalFileCount),this._currentZipIndex++,this._currentFileCount=0}get(s){if(typeof s=="number"){let r=this._zipLengthSumList.findIndex((l,f)=>s<l);r===-1&&(r=this._zipLengthSumList.length);const u=this._zipLengthSumList[r-1]||0,o=s-u;return[r,o]}else{const r=this._pathBank[String(s)];if(r)return r}return null}getZipIndex(){return this._currentZipIndex}getIndex(){return this._totalFileCount}}function Pl(i){return new Promise(s=>setTimeout(s,i))}function Fl(i,s=0){const r=k(i);return we(r,u=>{u!==void 0&&Ce(()=>{setTimeout(()=>r.value=void 0,s)})},{immediate:!0}),r}let dt;async function Ol(i,s,r,u,o){let l="";const f=document.createElement("canvas"),c=f.getContext("2d");let z=new Ot;const _=[z],h=new El,b=r.format,w=r.quality/100,m=[...b.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),g=i.length,E=r.maxZipSizeMB*1024*1024;let C=0,M=null,O="",I="",N=0,V=0,D=0,v=0,j=0,ve=!1;dt=A=>{const[Z,G]=h.get(A),le=_[Z],pe=le.get(G,b);o.convertedImageIndex=A,o.convertedImageName=le.getPathByIndex(G),o.convertedImageUrl=URL.createObjectURL(pe),o.convertedImageSize=pe.size;let ne="",se=0,ke="";const ge=ue[A];ne=URL.createObjectURL(ge),se=ge.size,ke=ge.webkitRelativePath||ge.name,o.convertedImageOrgUrl=ne,o.convertedImageOrgSize=se,o.convertedImageOrgName=ke};const ue=[];for(const A of i){if(u.value)break;const Z=A.name;let G="";const le=A.size,pe=(A.webkitRelativePath||A.relativePath||Z).replace(/^\//,""),ne=document.createElement("img"),se={key:D++,core:-1,index:C++,path:pe,command:"âž¡ï¸start"};o.startedCount=C,o.logs.push(se),o.logs.length-1,l&&(URL.revokeObjectURL(l),l=""),l=URL.createObjectURL(A),I=l,N=A.size,ne.src=l;const ke=await On(ne).then(()=>!0).catch(()=>!1);if(!ne.complete||!ke||u.value){o.done++,o.failure++,se.command="â—failed";continue}const ge=ne.width,x=ne.height;f.width=ge,f.height=x,c.drawImage(ne,0,0,ge,x,0,0,ge,x),se.command="ðŸ–¼ï¸imgload",se.width=ge,se.height=x,se.size=A.size,o.thumbnail=ne;const q=await new Promise(ee=>{const ae=Ee=>{M=Ee,ee(Ee)};f.toBlob(ae,b,w)});if(u.value)break;if(!q){console.log("failed to toBlob",Z),o.failure++;continue}V=q.size,o.converted++,se.outputSize=V;let W="";if(j+V>=E){try{await z.wait(),W=await z.url()}catch(ee){ve=!0,console.warn(ee.message,j),alert("memory problem occurred");break}o.zips.push({url:W,size:j,count:v}),o.zippedTotalCount+=v,o.zippedTotalSize+=j,j=0,v=0,h.split(),z=new Ot,_.push(z)}j+=V;const oe=pe||Z;for(let ee=1;ee<255&&(G=oe.replace(r.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(ee>1?`(${ee})`:"")+"."+m,!!z.has(G));ee++);o.done++;try{v++,z.add(G,q)}catch(ee){console.error(ee.message);continue}h.increase(),ue.push(A),o.inputTotalSize+=le,o.outputTotalSize+=V,o.ziplogs.push({fileId:A._id,storedPath:G}),O=G,se.zippedIndex=o.success,o.success++,se.command="âœ…completed",se.completed=!0,se.fileId=A._id,s.add(A._id)}if(o.success>0)if(g===1)M&&(o.convertedImageIndex=0,o.convertedImageName=O.replace(/^.*\/(?=[^/]+$)/,"").replace(r.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+m,o.convertedImageUrl=URL.createObjectURL(M),o.convertedImageOrgUrl=I,o.convertedImageOrgSize=N);else try{if(ve)throw new Error("terminated zipping process for memory problems");await z.wait();const A=await z.url();o.zips.push({url:A,count:v,size:j}),o.zippedTotalCount+=v,o.zippedTotalSize+=j}catch(A){console.error(A.message)}const R={value:!1},be=()=>{R.value=!0,_.forEach(A=>A.clear()),_.length=0,ue.length=0,dt=null};let Se=!1;return{callbackToClearConverter:be,callbackToGenerateFailedZips:async A=>{Se||(Se=!0,Ml(A,E,o,R))}}}function Ul(i){dt==null||dt(i)}async function Ml(i,s,r,u){let o=0,l=0,f=new Ot;for(let c=0;c<i.length;c++){const z=i[c],_=(z.webkitRelativePath||z.name).replace(/^\//,"");if(u.value)return;try{await f.add(_,z)}catch{alert(`an error occurred during access to "${_}"`);break}if(l+=z.size,o++,r.failedFileZippedCount++,l>=s||c===i.length-1){await f.zip();const h=await f.url();r.failedZips.push({url:h,size:l,count:o}),f.clear(),l=0,o=0}}r.failedZipDone=!0}function On(i){if(typeof i.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((s,r)=>{i.onload=s,i.onerror=r})}const Ve=(i,s)=>{const r=i.__vccOpts||i;for(const[u,o]of s)r[u]=o;return r},Rl={class:"container"},Dl={__name:"zipicon",setup(i){return(s,r)=>(P(),te("span",Rl,[n(e(he),null,{default:t(()=>[n(e(Ut))]),_:1}),r[0]||(r[0]=y("span",{class:"text"},"ZIP",-1))]))}},Nl=Ve(Dl,[["__scopeId","data-v-8b8df2f0"]]),jl=["href","download","title"],Bl='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',Zl=ye({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean},hidden:{type:Boolean}},emits:["load","error","next","prev"],setup(i,{expose:s,emit:r}){const{t:u}=We(),o=i,l=r,f=k();k();const c=k(!0),z=k(""),_=k(o.width||100),h=k(o.height||100),b=k(!1),w=xt({width:_.value+"px",height:h.value+"px",minWidth:"50px",minHeight:"50px"});Ke(()=>{var I,N,V;(N=(I=f.value)==null?void 0:I.previewInstRef)==null||N.setPreviewSrc(Bl),URL.revokeObjectURL((((V=f.value)==null?void 0:V.imageRef)||{}).src),f.value=null});const m=k(!0);ua(()=>{m.value=!1}),da(()=>{m.value=!0}),we(o,(I,N)=>{w.width=(o.width||100)+"px",w.height=(o.height||100)+"px"}),we(()=>o.src,(I,N)=>{m.value&&C(I)},{immediate:!0}),s({download:M,openPreview:O,active:m});async function g(I){const N=I.target,V=N.naturalWidth,D=N.naturalHeight,{width:v,height:j}=Fn({width:V,height:D},{width:o.maxWidth||100,height:o.maxHeight||100},o.expand);_.value=v,h.value=j,l("load",{src:N.src,width:V,height:D}),c.value=!1,await new Promise(ve=>setTimeout(ve,100)),!c.value&&(b.value=!0)}function E(I){const N=I.target;l("error",N.src)}async function C(I){c.value=!0,b.value=!1,z.value=I,console.log("changeSrc:",z.value)}function M(){const I=document.createElement("a");I.href=z.value,I.download=o.fileName,I.click()}function O(){var I;(I=f.value)==null||I.click()}return(I,N)=>{const V=vn,D=Dt,v=Ae,j=It;return Be((P(),te("div",null,[n(e(xe),null,{trigger:t(()=>[n(j,{show:e(c)||o.loading},{default:t(()=>[n(v,{justify:"center",align:"center",style:ie(e(w))},{default:t(()=>[y("a",{"_v-show":"!(imgloading || props.loading)",href:e(z),onClick:N[0]||(N[0]=Je(()=>{},["left","prevent"])),target:"_blank",download:o.fileName,title:o.fileName,style:{"line-height":"0px"}},[n(et,{mode:"in-out"},{default:t(()=>[Be(n(V,{ref_key:"nImageRef",ref:f,"show-toolbar-tooltip":"",onLoad:g,onError:E,src:e(z),width:e(_),height:e(h),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[Ze,e(b)]])]),_:1})],8,jl),e(c)||o.loading?(P(),J(D,{key:0})):ce("",!0)]),_:1},8,["style"])]),_:1},8,["show"])]),default:t(()=>[T(" "+d(o.fileName),1)]),_:1})],512)),[[Ze,!I.hidden]])}}}),an=Ve(Zl,[["__scopeId","data-v-6c94d582"]]),Hl=["href","download","title"],Vl={class:"left-num"},Wl={class:"right-num"},ql=["href","download","title"],Gl={class:"left-num"},Kl={class:"right-num"},Yl=["href","download"],Ql=ye({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean},variousInfo:{}},emits:["demand-image","delete-image","close"],setup(i,{expose:s,emit:r}){const u=Qe(qe),o=i,l=r;s({download:x,cleanup:ze,openPreview:Le,isPreviewing(){return v.value},changeIndex($){m.value=$}});const f=Tt(),{t:c}=We();Nt();const z=k(),_=k(),h=k(),b=nt("viewerItemContainer"),w=k(!0),m=k(Math.max(o.index,0)+1),g=k(1),E=k(1),C=k(""),M=k(""),O=k(1),I=k(1),N=k(!1),V=k(!1),D=k(!1),v=Ie(()=>{var $,L;return(L=($=h.value)==null?void 0:$.previewInstRef)==null?void 0:L.displayed}),j=Ie(()=>{var $,L;return((L=($=h==null?void 0:h.value)==null?void 0:$.previewInstRef)==null?void 0:L.previewSrc)===C.value}),ve=Ie(()=>m.value<o.length),ue=Ie(()=>m.value>1),R=k("viewer-item-init"),be=k(0),Se=k(!0);k({width:"auto",height:"auto"});const $e=k(!1);De(()=>{document.body.addEventListener("keydown",se),document.body.addEventListener("keydown",ne),le(m.value-1),pe()}),Ke(()=>{clearTimeout(A),document.body.removeEventListener("keydown",se),document.body.removeEventListener("keydown",ne),$e.value=!0}),vt(()=>{URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl)});let A=-1;we(m,($,L)=>{m.value<1||m.value>o.length||$===L||(clearTimeout(A),$>L?R.value="viewer-item-next":R.value="viewer-item-prev",A=setTimeout(()=>{o.index!==m.value-1&&(be.value=w.value?be.value:~be.value,Se.value=!1,le(m.value-1))},50))});let Z="",G="";we(()=>o.url,()=>{var a,p;let $="";o.index===0&&w.value?(w.value=!1,m.value=1,$=o.url):o.index===m.value-1?(w.value=!1,N.value=!1,$=o.url):(URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl));const L=Z,Q=G;if(URL.revokeObjectURL(L),URL.revokeObjectURL(Q),Z=o.url,G=o.originalUrl,$){try{if((p=(a=h.value)==null?void 0:a.previewInstRef)!=null&&p.displayed){j.value?h.value.previewInstRef.setPreviewSrc($):h.value.previewInstRef.setPreviewSrc(o.originalUrl);try{const F=h.value.previewInstRef.displayed;h.value.previewInstRef.handleAfterLeave(),h.value.previewInstRef.displayed=F}catch(F){console.error(F)}}}catch{}C.value=$,M.value=o.originalUrl}},{immediate:!0});function le($){N.value=!0,V.value=!1,D.value=!1,Ce(()=>l("demand-image",$))}function pe(){if(!u.IS_SP)return;let $=b.value.$el,L=0,Q=0,a=0,p=0,F=0;const U=fe=>{L=fe.touches[0].pageX,Q=fe.touches[0].pageY,F=Date.now()};$.addEventListener("touchstart",U);const B=fe=>{a=fe.touches[0].pageX,p=fe.touches[0].pageY,me()};window.addEventListener("touchmove",B);const S=()=>{me();const fe=a-L,Ue=Math.abs(fe),lt=p-Q,st=Math.abs(lt);Ue<st||Ue<30||W(fe>0?-1:1)};window.addEventListener("touchend",S);const me=()=>{const fe=Date.now();fe-F>500&&(L=a,Q=p),F=fe};Ke(()=>{$.removeEventListener("touchstart",U),window.removeEventListener("touchmove",B),window.removeEventListener("touchend",S),$=null})}function ne($){var L,Q,a,p;if($.key==="Escape")try{(Q=(L=h.value)==null?void 0:L.previewInstRef)!=null&&Q.displayed&&($.stopPropagation(),(p=(a=h.value)==null?void 0:a.previewInstRef)==null||p.toggleShow(!1))}catch{}}function se($){switch($.code){case"ArrowRight":W(1);break;case"ArrowLeft":W(-1);break;case"Home":m.value=1;break;case"End":m.value=o.length;break;case"Space":case"Enter":case"NumpadEnter":if(!v.value)return;ee();break;case"ArrowUp":case"ArrowDown":default:return}$.stopPropagation(),$.preventDefault()}function ke({width:$,height:L}){g.value=$,E.value=L,V.value=!0}function ge({width:$,height:L}){O.value=$,I.value=L,D.value=!0}function x(){j.value?z.value.download():_.value.download()}async function q($){try{const L=await fetch($).then(Q=>Q.blob()).then(Q=>new Promise(a=>{const p=new FileReader;p.onload=a,p.readAsDataURL(Q)})).then(Q=>Q.target.result);navigator.clipboard.writeText(L),f.info({title:c("copiedDataURLDialogTitle"),content:()=>K("div",[K("div",c("copiedDataURLMessage"))]),positiveText:"OK"})}catch(L){console.error(L),f.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function W($){$>0?m.value=Math.min(o.length,m.value+$)|0:$<0&&(m.value=Math.max(1,m.value+$)|0)}let oe="";const ee=()=>{var L,Q,a,p;oe=(a=window.getComputedStyle((Q=(L=h==null?void 0:h.value)==null?void 0:L.previewInstRef)==null?void 0:Q.previewRef))==null?void 0:a.transform;const $=j.value;(p=h==null?void 0:h.value)==null||p.next(),Ce(()=>{var F;j.value===$&&((F=h==null?void 0:h.value)==null||F.next())})};function ae(){try{Ce(()=>h.value.previewInstRef.previewRef.style.transform=oe)}catch{}}function Ee({nodes:$}){const L=K(jt,{color:j.value?"green":"gray",offset:[-20,-12],value:j.value?c("status.Converted"):c("status.Original")},()=>K(Oe,{round:!0,onClick(){ee()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>K(j.value?ga:ma)}));$.next=K(Oe,{onClick(){W(1)},disabled:!ve.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>K(en)}),$.prev=K(Oe,{onClick(){W(-1)},disabled:!ue.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>K(va)});try{const Q=$.download.children;Q.default=()=>c("save");const a=Q.trigger();a.props.onClick=x,Q.trigger=()=>a}catch{}return de(),[L,...Object.values($)]}const Pe="#pathbox-"+String(Math.random()).substring(2);let Te;function de(){var $,L,Q;try{if(Te=(Q=(L=($=h.value)==null?void 0:$.previewInstRef)==null?void 0:L.previewWrapperRef)==null?void 0:Q.parentNode,!Te||Te.querySelector(Pe))return;let a=K("div",{id:Pe,onMousedown:p=>{p.stopPropagation()},className:"__preview-injected-pathbox"+(j.value?" converted":"")},[K("div",`${String(m.value).padStart(String(o.length).length,"0")}/${String(o.length).padStart(String(o.length).length,"0")}`),K("div",je(j.value?o.size:o.originalSize,0)),K("div",j.value?o.name:o.originalName)]);tn(a,Te),a=null}catch(a){console.error(a)}}Ke(()=>{Te&&(tn(null,Te),Te=null)});function Le(){z.value.openPreview()}function ze(){}return($,L)=>{const Q=he,a=Ae,p=hn,F=Xe,U=At,B=ca;return P(),J(a,{justify:"center",align:"stretch",vertical:"",style:ie([{visibility:w.value?"hidden":"visible"},{overflow:"visible"}]),class:"body",ref:"body"},{default:t(()=>[n(B,{ref_key:"nImageGroupRef",ref:h,"show-toolbar-tooltip":"","render-toolbar":Ee,onPreviewNext:ae},{default:t(()=>[n(a,{wrap:!1,align:"center",justify:"space-between",style:{overflow:"visible"}},{default:t(()=>[n(e(Oe),{onClick:L[0]||(L[0]=S=>W(-1)),bordered:!1,disabled:!e(ue),class:ot({"thumb-arrow":!0,pale:!e(ue)}),title:$.$t("Prev")},{icon:t(()=>[n(Q,{size:"30"},{default:t(()=>[n(e(pa))]),_:1})]),_:1},8,["disabled","class","title"]),n(a,{justify:"center",ref_key:"viewerItemContainer",ref:b,class:"viewer-item-container"},{default:t(()=>[n(et,{name:R.value},{default:t(()=>[(P(),J(a,{vertical:"",key:be.value,"_v-show":"viewerItemVisibility"},{default:t(()=>[n(a,{align:"center",wrap:!1},{default:t(()=>[n(a,{vertical:""},{default:t(()=>[n(a,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(a,{align:"center",justify:"center",vertical:"",class:"original-thumb"},{default:t(()=>[y("a",{href:$.originalUrl,onClick:L[4]||(L[4]=Je(S=>{_.value.openPreview()},["prevent"])),download:$.originalName,title:$.originalName,class:"imglink"},[n(a,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(an,{ref:S=>{S!=null&&S.active&&(_.value=S)},src:M.value,width:1,"max-width":1,"max-height":1,loading:N.value,"file-name":$.originalName,"allow-next":m.value<o.length,"allow-prev":m.value>1,onLoad:ge,onNext:L[1]||(L[1]=S=>W(1)),onPrev:L[2]||(L[2]=S=>W(-1)),hidden:!0},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(a,{vertical:"",align:"center"},{default:t(()=>[n(a,{class:"imglink-label"},{default:t(()=>[T(d(e(c)("status.Original")),1)]),_:1}),n(a,{justify:"center",class:"img-size",wrap:!1,size:2},{default:t(()=>[y("span",Vl,d(D.value?O.value:"?"),1),L[11]||(L[11]=T(" Ã— ")),y("span",Wl,d(D.value?I.value:"?"),1)]),_:1}),n(a,{justify:"center"},{default:t(()=>[L[3]||(Jt(-1,!0),(L[3]=n(a,null,{default:t(()=>[T(d(D.value?e(je)(o.originalSize,0):"?"),1)]),_:1})).cacheIndex=3,Jt(1),L[3])]),_:1})]),_:1})]),_:1})],8,Hl)]),_:1}),n(a,{vertical:"",align:"center",class:"original-thumb"},{default:t(()=>[n(Q,{size:"20",color:"silver",component:e(en)},null,8,["component"])]),_:1}),y("a",{href:C.value,onClick:L[5]||(L[5]=Je(S=>Le(),["prevent"])),download:o.name,title:o.name,class:"imglink"},[n(a,{vertical:"",align:"center",justify:"center"},{default:t(()=>[n(a,{class:"imglink-label"},{default:t(()=>[T(d(e(c)("status.Converted")),1)]),_:1}),n(a,{vertical:"",align:"center",justify:"center",size:0},{default:t(()=>[n(a,{justify:"center"},{default:t(()=>{var S;return[n(a,{wrap:!1,style:ie((S=o.variousInfo)!=null&&S.shrinked?{color:"blue"}:{}),class:"img-size",size:2},{default:t(()=>[y("span",Gl,d(V.value?g.value:"?"),1),L[12]||(L[12]=T(" Ã— ")),y("span",Kl,d(V.value?E.value:"?"),1)]),_:1},8,["style"])]}),_:1})]),_:1}),n(a,{justify:"center"},{default:t(()=>[T(d(V.value?e(je)(o.size,0):"?"),1)]),_:1})]),_:1})],8,ql)]),_:1}),n(a,{ref:"fileNameContainer",justify:"center",align:"center",class:"pathbox",title:o.name,style:{overflow:"hidden","flex-grow":"0"}},{default:t(()=>[n(p,{"x-scrollable":!0,trigger:"hover",style:{"text-align":"center","font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:t(()=>[T(d(V.value?o.name:"?"),1)]),_:1})]),_:1},8,["title"])]),_:1}),n(a,{vertical:""},{default:t(()=>[n(an,{ref:S=>{S!=null&&S.active&&(z.value=S)},src:C.value,width:142,"max-width":140,"max-height":100,loading:N.value,"file-name":o.name,"allow-next":m.value<o.length,"allow-prev":m.value>1,onLoad:ke,onNext:L[6]||(L[6]=S=>W(1)),onPrev:L[7]||(L[7]=S=>W(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(a,{justify:"center",align:"center",wrap:!1},{default:t(()=>[n(F,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",{href:o.url,ref:"saveImg",target:"_blank",download:o.name,style:{"line-height":"1em"}},[n(e(Oe),{disabled:!V.value,round:"",size:"tiny"},{default:t(()=>[T(d($.$t("save")),1)]),_:1},8,["disabled"])],8,Yl)]),default:t(()=>[T(" "+d($.$t("save")),1)]),_:1}),n(F,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(e(Oe),{disabled:!V.value,onClick:L[8]||(L[8]=S=>q(o.url)),round:"",size:"tiny"},{default:t(()=>L[13]||(L[13]=[T("DataURL")])),_:1},8,["disabled"])]),default:t(()=>[T(" "+d($.$t("convertedImageDataUrlTooltip")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["name"])]),_:1},512),n(e(Oe),{bordered:!1,onClick:L[9]||(L[9]=S=>W(1)),disabled:!e(ve),class:ot({"thumb-arrow":!0,next:!0,pale:!e(ve)}),title:$.$t("Next")},{icon:t(()=>[n(Q,{size:"30"},{default:t(()=>[n(e(fa))]),_:1})]),_:1},8,["disabled","class","title"])]),_:1}),Be(n(a,{style:{width:"100%"},wrap:!1},{default:t(()=>[n(U,{value:m.value,"onUpdate:value":L[10]||(L[10]=S=>m.value=S),tooltip:!1,step:1,min:1,max:o.length,keyboard:!1,class:"index-slider"},null,8,["value","max"]),n(a,{class:"index",align:"center",justify:"center",wrap:!1,size:3},{default:t(()=>[n(a,null,{default:t(()=>[T(d(e(c)("status.index"))+":",1)]),_:1}),n(a,{justify:"end",align:"center",class:"counter"},{default:t(()=>[T(d(m.value),1)]),_:1}),n(a,null,{default:t(()=>L[14]||(L[14]=[T("/")])),_:1}),n(a,{justify:"start",align:"center",class:"counter"},{default:t(()=>[T(d(o.length),1)]),_:1})]),_:1})]),_:1},512),[[Ze,!$.isSingle]])]),_:1},512)]),_:1},8,["style"])}}}),Xl=Ve(Ql,[["__scopeId","data-v-70206ce1"]]),Jl={key:0},es={style:{}},ts=ye({__name:"status.progress",props:{successPerc:{},elapsedTime:{},threads:{},fileType:{},shrink:{},zipSize:{},inputTotalSize:{},outputTotalSize:{},rateColor:{},difColor:{},totalSizeDifStr:{}},setup(i){return(s,r)=>{const u=Ae,o=ha,l=St;return P(),J(l,{name:"progress",style:{"white-space":"nowrap"}},{header:t(({collapsed:f})=>[n(u,null,{default:t(()=>[T(d(s.$t("status.Progress"))+" ",1),f?(P(),te(Re,{key:0},[T(" ("+d(s.successPerc|0)+"%) ",1)],64)):ce("",!0)]),_:2},1024)]),default:t(()=>[n(u,{justify:"center",align:"center",wrap:!1,style:{"white-space":"nowrap","margin-top":"-2em","padding-bottom":"5px"}},{default:t(()=>[n(u,{vertical:"",justify:"center",class:"left-column"},{default:t(()=>[n(o,{"tabular-nums":"",label:s.$t("status.elapsedTime")},{default:t(()=>[n(u,null,{default:t(()=>[T(d(s.elapsedTime),1)]),_:1})]),_:1},8,["label"]),n(o,{"tabular-nums":"",label:s.$t("status.multiThreading")},{default:t(()=>[n(u,{style:ie({color:s.threads?"":"red",fontSize:"0.7rem"})},{default:t(()=>[T(d(s.threads?s.$rt("{n} @:threads",s.threads):s.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(o,{"tabular-nums":"",label:s.$t("status.outputSettings")},{default:t(()=>[n(u,{vertical:"",justify:"end",style:{"font-size":"0.6rem","line-height":"0.6rem"}},{default:t(()=>[y("div",null,d(s.$t("settings.imageType"))+": "+d(s.fileType),1),s.shrink?(P(),te("div",Jl,[T(d(s.$t("status.Shrinking"))+": ",1),y("span",es,d(s.shrink[0])+"Ã—"+d(s.shrink[1]),1)])):ce("",!0),y("div",null,"Zip: "+d(s.zipSize)+"MB",1)]),_:1})]),_:1},8,["label"])]),_:1}),Rt(s.$slots,"center",{},void 0,!0),n(u,{vertical:"",style:{height:"100%"},justify:"center",class:"right-column"},{default:t(()=>[n(o,{"tabular-nums":"",label:s.$t("status.inputSize")},{default:t(()=>[n(u,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[T(d((s.inputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(o,{"tabular-nums":"",label:s.$t("status.outputSize")},{default:t(()=>[n(u,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[T(d((s.outputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(o,{"tabular-nums":"",label:s.$t("status.outInRate")},{default:t(()=>[n(u,{vertical:"",align:"end",justify:"start",style:{"font-size":"0.8em","font-family":"v-mono","line-height":"50%"}},{default:t(()=>[y("span",{style:ie({color:s.rateColor,fontSize:"larger"})},"Ã— "+d((s.outputTotalSize/s.inputTotalSize||1).toFixed(2)),5),y("span",{style:ie({color:s.difColor})},"("+d(s.totalSizeDifStr)+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:3})]),_:3})}}}),ns=Ve(ts,[["__scopeId","data-v-fd007c07"]]),os={class:"status-table"},as={class:"started"},ls={class:"mini-counter"},ss={class:"failure"},is={class:"mini-counter"},rs={colspan:"2"},us={class:"completed"},ds={class:"main-counter"},cs={class:"total"},ps={class:"main-counter"},fs=ye({__name:"status.progress-center",props:{processing:{type:Boolean},interval:{},statusColor:{},success:{},successTo:{},successFrom:{},index:{},length:{},failure:{},retried:{},successPercTo:{},successPercFrom:{}},setup(i){const s=i,r=Nt(),u=k(r.value.successColor),o=k(!1);return we(()=>s.processing,l=>{l||(s.success===s.length?o.value=!0:u.value=r.value.errorColor)}),(l,f)=>{const c=Xe,z=he,_=wa,h=Ae,b=_n;return P(),J(b,{type:"multiple-circle","stroke-width":2,percentage:[l.successTo/l.length*100|0,l.index/l.length*100|0],color:[e(r).successColor,l.statusColor],"rail-style":[{stroke:e(u),opacity:.3}],style:{width:"12em"}},{default:t(()=>[n(h,{vertical:"",align:"center",justify:"center",size:0,style:{"white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:t(()=>[y("table",os,[y("tbody",null,[y("tr",as,[y("td",null,d(l.$t("status.started"))+":",1),y("td",ls,[n(c,{trigger:"hover",style:ie({color:e(r).infoColor}),placement:"left"},{trigger:t(()=>[y("span",{style:ie({color:e(r).infoColor})},d(l.index.toLocaleString("en-us")),5)]),default:t(()=>[T(" "+d(l.$t("status.progressStarted"))+" ("+d(l.index.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),y("tr",ss,[y("td",null,d(l.$t("status.failure"))+":",1),y("td",is,[n(c,{trigger:"hover",style:ie({color:e(r).errorColor}),placement:"left"},{trigger:t(()=>[y("span",{style:ie({color:e(r).errorColor})},d(l.failure.toLocaleString("en-us")),5)]),default:t(()=>[T(" "+d(l.$t("status.progressErrors"))+" ("+d(l.failure.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"]),l.retried>0?(P(),J(c,{key:0,trigger:"hover",style:ie({color:e(r).warningColor}),placement:"left"},{trigger:t(()=>[y("span",{style:ie({color:e(r).warningColor})}," ("+d(l.retried.toLocaleString("en-us"))+") ",5)]),default:t(()=>[T(" "+d(l.$t("status.progressRetries"))+" ("+d(l.retried.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):ce("",!0)])]),y("tr",null,[y("td",rs,[n(h,{size:0,align:"center",justify:"center",style:ie({color:l.processing?l.statusColor:e(u)}),wrap:!1,class:"percent"},{default:t(()=>[e(o)?(P(),J(z,{key:0,component:e(_a)},null,8,["component"])):ce("",!0),n(_,{duration:l.interval*3|0,from:l.successPercFrom|0,to:l.successPercTo|0,active:!0},null,8,["duration","from","to"]),f[0]||(f[0]=T("% "))]),_:1},8,["style"])])]),y("tr",us,[y("td",null,d(l.$t("status.success"))+":",1),y("td",ds,[n(c,{trigger:"hover",duration:0,delay:0,style:ie({color:e(r).successColor}),placement:"bottom"},{trigger:t(()=>[y("span",{style:ie({color:e(r).successColor})},[n(_,{duration:l.interval*3|0,from:l.successFrom,to:l.successTo,active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:t(()=>[T(" "+d(l.$t("status.progressSuccess"))+" ("+d(l.successTo.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),y("tr",cs,[y("td",null,d(l.$t("status.all"))+":",1),y("td",ps,[n(c,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:t(()=>[T(d(l.length.toLocaleString("en-us")),1)]),default:t(()=>[T(" "+d(l.$t("status.progressTotal"))+" ("+d(l.length.toLocaleString("en-us"))+") ",1)]),_:1})])])])])]),_:1})]),_:1},8,["percentage","color","rail-style"])}}}),gs={key:0,class:"log-table",ref:"table"},ms={class:"log-tr label"},vs=["title"],hs={style:{"min-width":"7em"},class:"log-th"},_s={style:{"padding-left":"2em"},class:"log-th"},ws={ref:"tbody"},ys=["onClick","onDblclick"],bs={class:"log-td"},ks={class:"log-td"},zs={class:"log-td"},xs={class:"log-td"},Is={key:0,class:"log-td log-extra",style:{"padding-left":"0.5em"}},Ts={key:0},As={key:1,style:{color:"blue"}},Ss={key:1},ln=3,sn=3e3,Ls=100,Cs=ye({__name:"status.log",props:at({processing:{type:Boolean},opened:{type:Boolean},previewCollapsed:{type:Boolean},logs:{},imageIndex:{},thumbnail:{}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},order:{required:!1,default:"processed"},orderModifiers:{}}),emits:at(["open-preview","change-index"],["update:expanded","update:order"]),setup(i,{emit:s}){const{t:r}=We(),u={W:160,H:80},o=i,l=Fe(i,"expanded"),f=s;nt("table");const c=nt("tbody"),z=k(),_=k(null),h=k(null),b=k(!0),w=k(80),m=k(200),g=Ie(()=>{let a=o.logs;switch(N.value){case"success":a=a.filter(p=>p.completed);break;case"error":a=a.filter(p=>!p.completed);break}return a}),E=Fl(!1),M=k([{type:"group",label:()=>r("status.sort"),key:"sort",children:[{label:()=>r("status.sortByStart"),value:"processed"},{label:()=>r("status.sortByCompletion"),value:"zipped"},{label:()=>r("status.sortByName"),value:"name"},{label:()=>r("status.sortBySize"),value:"size"},{label:()=>r("status.sortByOutputSize"),value:"outputsize"},{label:()=>r("status.sortByStatus"),value:"status"}]}]),O=Fe(i,"order");we(O,Pe);const I=[{label:()=>r("status.showAll"),value:""},{label:()=>r("status.showOnlySuccess"),value:"success"},{label:()=>r("status.showOnlyError"),value:"error"}],N=k(I[0].value);De(()=>{j=ya(),R(),window.addEventListener("resize",()=>R());const a=new ResizeObserver(()=>R());a.observe(j.parent.parent.vnode.el),Ke(()=>{window.removeEventListener("resize",()=>R()),a.disconnect()})}),Ke(()=>{V==null||V.close(),clearTimeout(v),clearTimeout(ke),clearTimeout(Se)});let V;we(()=>[o.thumbnail,o.opened],()=>{if(!o.thumbnail||!o.opened||o.thumbnail===V)return;const{width:a,height:p}=Fn(o.thumbnail,{width:u.W,height:u.H});h.value.width=a,h.value.height=p,h.value.style.width=a+"px",h.value.style.height=p+"px",o.thumbnail instanceof HTMLImageElement?h.value.getContext("2d").drawImage(o.thumbnail,0,0,a,p):(h.value.getContext("bitmaprenderer").transferFromImageBitmap(o.thumbnail),V=o.thumbnail,o.thumbnail.close())});let D=0;we(()=>o.imageIndex,async()=>{var B;const a=o.imageIndex;let p=g.value.findIndex(S=>S.zippedIndex===a);p===-1&&(p=a);const F=p<le.value,U=p>le.value+pe.value;if(F||U){const S=p*ne-(U?w.value:0);(B=z.value)==null||B.scrollTo({behavior:"instant",top:S,left:ze}),await Ce(),W(!0),await Ce()}Ce(()=>{var me,fe;let S=_.value;S&&(D>p&&(S=S.previousSibling||S,S instanceof HTMLElement||((me=z.value)==null||me.scrollTo(ze,0),S=null)),(fe=S==null?void 0:S.scrollIntoView)==null||fe.call(S,{behavior:"instant",block:"nearest"}),D=p)})});let v,j;const ve=k(document.documentElement.clientHeight),ue=k(100),R=a=>{clearTimeout(v),v=setTimeout(()=>{const p=z.value.$parent.$el.offsetHeight,F=window.innerHeight-j.parent.parent.vnode.el.offsetHeight-8,U=Math.max(200,p+F);ve.value=document.documentElement.clientHeight,ue.value=Math.max(100,U),!(!o.opened||!l.value)&&(w.value=Math.max(U,m.value))},100)};function be(a){a&&(A(!0),R(),E.value=!0)}let Se=0,$e=!1;function A(a=!1){if(!$e){if(Se){$e=!0;return}Ce(()=>{!a&&!b.value||(z.value.scrollTo({behavior:"instant",top:o.logs.length*50,left:ze}),Se=window.setTimeout(()=>{Se=0,$e&&($e=!1,A())},Ls))})}}const Z=k({height:"0px"}),G=k({height:"0px"}),le=k(0),pe=Ie(()=>w.value/ne+ln*2|0);let ne=15,se=0,ke=0,ge=0,x=-999,q=-1;function W(a){const p=Date.now();if(a!==!0){if(ke)return;if(p-ge<30){ke=window.setTimeout(()=>{ke=0,W()},30-(p-ge));return}}ge=p,se||(se=c.value.rows[1].offsetHeight,ne=se);const F=g.value.length,B=z.value.scrollbarInstRef.containerRef.scrollTop;if(!a&&F===q&&Math.abs(B-x)<ne*.5)return;x=B,q=F;const S=Math.max(0,(B/ne|0)-ln);le.value=S,Z.value.height=S*ne+"px",G.value.height=Math.max(0,F-(S+pe.value))*ne+"px"}function oe(){var a;(a=z.value)==null||a.scrollTo(0,0),W()}we(()=>o.logs,()=>{o.opened&&(Ce(W),b.value&&A(),Ee())}),we(()=>o.opened,a=>{a&&W()});let ee=0,ae=0;function Ee(){if(O.value==="processed"||!O.value)return;const a=Date.now();if(a-ae<sn){if(ee)return;ee=window.setTimeout(Ee,sn-(a-ae));return}ee=0,ae=a,Pe()}function Pe(){switch(console.log("sortList",O.value),O.value){case"zipped":o.logs.sort((a,p)=>a.zippedIndex-p.zippedIndex);break;case"status":o.logs.sort((a,p)=>a.command>p.command?1:-1);break;case"name":o.logs.sort((a,p)=>a.path>p.path?1:-1);break;case"size":o.logs.sort((a,p)=>a.size-p.size);break;case"outputsize":o.logs.sort((a,p)=>a.outputSize-p.outputSize);break;case"processed":default:o.logs.sort((a,p)=>a.index-p.index);break}}function Te(a){const p=o.logs,F=p.findIndex(Ue=>Ue.zippedIndex===o.imageIndex);let U=0,B=1;switch(a.code){case"ArrowUp":U=-1;break;case"ArrowDown":U=1;break;case"PageUp":U=-1,B=w.value/ne|0;break;case"PageDown":U=1,B=w.value/ne|0;break;case"Enter":case"NumpadEnter":if(F>=0&&o.previewCollapsed){Ce(()=>f("open-preview")),a.stopPropagation(),a.preventDefault();return}break;default:return}let S=F,me=-1;const fe=p.length;do{if(S+=U,S<0||S>fe-1||S===F)break;if(p[S].completed){if(me=S,--B>0)continue;break}}while(!0);if(me>=0){const Ue=p[me];f("change-index",!0,Ue.path,Ue.fileId,Ue.zippedIndex),a.preventDefault()}}let de=-1,Le=-1,ze=0,$=!1;function L(a){var U,B;if(W(),$){$=!1;return}const{scrollLeft:p=0,scrollTop:F=0}=(B=(U=z.value)==null?void 0:U.scrollbarInstRef)==null?void 0:B.containerRef;(p!==de||de<0)&&(F===Le||Le<0)&&(ze=p,console.log(ze,"storedLogTableScrollLeft")),de=p,Le=F,Ce(()=>{var me,fe;$=!0;const S=(fe=(me=z.value)==null?void 0:me.scrollbarInstRef)==null?void 0:fe.containerRef;S&&(S.scrollLeft=ze)})}function Q(a){b.value=!1}return(a,p)=>{const F=It,U=Ae,B=he,S=Lt,me=wn,fe=xe,Ue=At,lt=Xe,st=Dt,X=St;return P(),J(X,{name:"log",style:{"white-space":"nowrap"}},{header:t(()=>[n(U,{align:"center",wrap:!1},{default:t(()=>[T(d(a.$t("status.Log")),1),Be(n(F,{size:16},null,512),[[Ze,a.processing&&!o.opened]])]),_:1})]),"header-extra":t(()=>[Be(n(U,{align:"center",justify:"end",wrap:!0,style:{"margin-top":"0.2em","margin-left":"0.5em"}},{default:t(()=>[n(S,{value:O.value,"onUpdate:value":[p[0]||(p[0]=re=>O.value=re),Pe],options:e(M),style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1,size:"tiny"},{arrow:t(()=>[n(B,{component:e(ba)},null,8,["component"])]),_:1},8,["value","options"]),n(S,{value:e(N),"onUpdate:value":[p[1]||(p[1]=re=>He(N)?N.value=re:null),p[2]||(p[2]=re=>oe())],options:I,placeholder:a.$t("status.filterLogSelect"),size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1},{arrow:t(()=>[n(B,{component:e(ka)},null,8,["component"])]),_:1},8,["value","placeholder"]),n(me,{key:"b",checked:e(b),"onUpdate:checked":[p[3]||(p[3]=re=>He(b)?b.value=re:null),p[4]||(p[4]=re=>re&&A(!0))],size:"small",style:{"font-size":"0.9em"}},{default:t(()=>[T(d(a.$t("status.autoScroll")),1)]),_:1},8,["checked"]),n(lt,{trigger:"hover",show:e(E),disabled:!l.value,placement:"top",delay:0},{trigger:t(()=>[n(fe,{style:{"max-width":"30em"},disabled:!0},{trigger:t(()=>[n(me,{size:"small",checked:l.value,"onUpdate:checked":[p[5]||(p[5]=re=>l.value=re),be],style:{"font-size":"0.9em"}},{default:t(()=>[T(d(a.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:t(()=>[T(d(a.$t("status.expandLog")),1)]),_:1})]),default:t(()=>[n(U,{wrap:!1,align:"center",style:{"font-size":"0.8em"}},{default:t(()=>[n(Ue,{value:e(m),"onUpdate:value":p[6]||(p[6]=re=>He(m)?m.value=re:null),onUpdateValue:p[7]||(p[7]=re=>R()),disabled:!l.value,"format-tooltip":re=>`Log size: ${re}`,tooltip:!0,step:1,min:e(ue),max:e(ve),style:{"z-index":"3",width:"100px"}},null,8,["value","disabled","format-tooltip","min","max"])]),_:1})]),_:1},8,["show","disabled"])]),_:1},512),[[Ze,o.opened]])]),default:t(()=>[n(U,{wrap:!1,align:"stretch",class:ot({"log-container":1,"expand-log":l.value}),style:ie(l.value?{height:e(w)+"px"}:{height:"110px"}),onKeydown:Te,tabindex:"-1"},{default:t(()=>[n(e(hn),{ref_key:"scrollref",ref:z,distance:10,"x-scrollable":!0,onMousedownCapture:Q,onWheel:p[8]||(p[8]=re=>b.value=!1),onScroll:L,load:"handleLogLoad",trigger:"none",style:ie([{"z-index":"2","padding-right":"10px",height:"100%"},l.value?{height:e(w)+"px"}:{}]),size:50},{default:t(()=>[o.opened?(P(),te("table",gs,[y("thead",null,[y("tr",ms,[y("th",{class:"log-th",title:a.$t("status.table.core")},"th",8,vs),p[9]||(p[9]=y("th",{class:"log-th"},"no.",-1)),y("th",hs,d(a.$t("status.table.status")),1),y("th",_s,d(a.$t("status.table.details")),1),p[10]||(p[10]=y("th",{class:"log-th"},"size",-1))])]),y("tbody",ws,[y("tr",{style:ie(e(Z))},null,4),(P(!0),te(Re,null,ht(e(g).slice(e(le),e(le)+e(pe)),({index:re,key:Ge,command:Ct,path:qt,core:Gt,zippedIndex:pt,completed:Kt,fileId:Yo,shrinked:Qo,width:Yt,height:Xo,outputWidth:Jo,outputHeight:ea,size:ta,outputSize:Qt},Ki)=>(P(),te("tr",{key:Ge,class:ot({"log-tr":1,completed:Kt,selected:a.imageIndex===pt}),ref_for:!0,ref:Xt=>{a.imageIndex===pt&&(_.value=Xt)},onClick:Xt=>f("change-index",Kt,qt,Yo,pt),onDblclick:()=>{a.imageIndex===pt&&f("open-preview")}},[y("td",bs,d(Gt>=0?Gt+1:"-"),1),y("td",ks,d(re+1),1),y("td",zs,d(Ct),1),y("td",xs,d(qt),1),Yt?(P(),te("td",Is,[T(d(`[${Yt}Ã—${Xo}] (${e(je)(ta,0)})`)+" ",1),Qt?(P(),te("span",Ts,[p[11]||(p[11]=T(" â†’ ")),y("span",null," ("+d(e(je)(Qt,0))+") ",1)])):ce("",!0),Qo?(P(),te("span",As,d(` [${Jo}Ã—${ea}]`),1)):ce("",!0)])):(P(),te("td",Ss))],42,ys))),128)),y("tr",{style:ie(e(G))},null,4)],512)],512)):ce("",!0),p[12]||(p[12]=y("div",{style:{height:"1em"}},null,-1))]),_:1},8,["style"]),n(U,{style:ie([{"align-self":"center",position:"absolute","z-index":"0","margin-top":"10px",right:"0.1em","line-height":"0px"},{width:u.W+"px",height:u.H+"px"}]),justify:"center",align:"center"},{default:t(()=>[n(F,{size:"small",show:a.processing},{default:t(()=>[o.thumbnail===void 0?(P(),J(st,{key:0,description:"EMPTY"})):ce("",!0),Be(y("canvas",{ref_key:"thumbcanvas",ref:h,width:"106",height:"80",style:ie({border:"1px solid gray",filter:a.processing?"":"opacity(0.35)"})},null,4),[[Ze,o.thumbnail!==void 0]])]),_:1},8,["show"])]),_:1},8,["style"])]),_:1},8,["class","style"])]),_:1})}}}),$s=["innerHTML"],Es={style:{margin:"1px"}},Ps=["href","download","onClick"],Fs={key:0,style:{position:"relative"}},Os=["href","download"],Us=["href","download"],Ms={key:0,style:{margin:"1px"}},Rs=["href","download","onClick"],Ds=ye({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image","delete-image"],setup(i,{expose:s,emit:r}){const u={itemMargin:"1px",titlePadding:"2px",titleFontSize:"0.8rem"},o=Tt(),{t:l}=We(),f=Nt(),c=i,z=r;s({cleanup:Q});const _=k(!1),h=k([]),b=k(!1),w=k([]),m=k([]),g=k(!1),E=k([0,0]),C=k([0,0]),M=k([0,0]),O=k([0,0]),I=k([0,0]),N=k([0,0]),V=k(0),D=k(0),v=k([0,0]),j=k(f.value.infoColor),ve=k("#000000"),ue=k("#000000"),R=k(0),be=k(0),Se=k(""),$e=k("00:00:00"),A=k(void 0),Z=k(null),G=k(["progress","log","output"]),le=a=>G.value.includes(a),pe=a=>G.value.push(a),ne=a=>{const p=G.value.findIndex(F=>F===a);p>=0&&G.value.splice(p,1)},se=Ie(()=>G.value.includes("log")),ke=k(!1),ge=k("processed"),x=xt({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:0,various:{shrinked:!1}}),q=nt("body"),W=nt("imageViewer");De(()=>{we(c.status,()=>Ee(),{deep:!1});let a=0;const p=()=>{if(a)return;const F=Date.now();$e.value="00:00:00",a=window.setInterval(()=>{const U=(Date.now()-F)/1e3;$e.value=`${String(U/3600|0).padStart(2,"0")}:${String(U/60%60|0).padStart(2,"0")}:${String(U%60|0).padStart(2,"0")}`},300)};p(),g.value=!0,we(()=>c.processing,(F,U)=>{F||Pe(),F?(p(),h.value.length=0,_.value=!1,b.value=!1,w.value=[],m.value=[]):(clearInterval(a),a=0)}),Ke(()=>{clearInterval(a),clearTimeout(ae)}),vt(()=>clearInterval(a))}),Ke(()=>{Q()}),vt(()=>{clearTimeout(ae)}),we([()=>c.status.zips.length,()=>c.status.failedZips.length],()=>{const a=c.status;{w.value.length>a.zips.length&&(w.value.length=0);let p=0;const F=a.zips.length===1&&a.zippedTotalCount===a.length;for(let U=w.value.length;U<a.zips.length;U++){const B=a.zips[U],S=a.baseZipName+(F?"":"-"+String(U+1).padStart(2,"0"))+".zip";p+=B.size,w.value[U]={url:B.url,size:B.size,number:F?0:U+1,sizeByUnit:je(B.size),name:S,count:B.count,clicked:!1}}}{m.value.length>a.failedZips.length&&(m.value.length=0);let p=0;const F=a.failedZipDone&&a.failedZips.length===1;for(let U=m.value.length;U<a.failedZips.length;U++){const B=a.failedZips[U],S=a.baseZipName+"-error"+(F?"":"-"+String(U+1).padStart(2,"0"))+".zip";p+=B.size,m.value[U]={url:B.url,size:B.size,number:F?0:U+1,sizeByUnit:je(B.size),name:S,count:B.count,clicked:!1}}}});const oe=c.interval||100;let ee=!1,ae=0;function Ee(){if(ee)return;if(ae){ee=!0;return}ae=window.setTimeout(()=>{ae=0,ee&&(ee=!1,Ee())},oe);const a=c.status;_.value=a.length>=2,C.value[1]=C.value[0],C.value[0]=a.startedCount,M.value[1]=M.value[0],M.value[0]=a.success,O.value[1]=O.value[0],O.value[0]=a.failure,I.value[1]=I.value[0],I.value[0]=a.done,N.value[1]=N.value[0],N.value[0]=a.converted,V.value=a.retried,D.value=a.length,v.value[1]=v.value[0],v.value[0]=a.zippedTotalCount,R.value=a.inputTotalSize,be.value=a.outputTotalSize;const p=be.value-R.value;Se.value=(p>=0?"+ ":"")+je(p);const F=be.value/R.value,U=(256|Math.min(255,Math.max(0,F-1.5)*255|0)).toString(16).substring(1);ve.value="#"+U+"0000";const B=1024*1024,S=(256|Math.min(255,Math.max(0,p/1024/B)*255|0)).toString(16).substring(1);ue.value="#"+S+"0000",E.value[1]=E.value[0],E.value[0]=M.value[0]/D.value*100,(se.value||!c.processing)&&(h.value=h.value.concat(a.logs),a.logs.length=0),Z.value=a.thumbnail,c.processing?j.value=O.value[0]?f.value.errorColor:V.value?f.value.warningColor:f.value.infoColor:g.value=!1,a.convertedImageUrl!==x.url&&(x.url=a.convertedImageUrl,x.name=a.convertedImageName,x.dataUrl=a.convertedImageDataUrl,x.size=a.convertedImageSize||a.outputTotalSize,x.originalSize=a.convertedImageOrgSize,x.originalName=a.convertedImageOrgName,x.index=a.convertedImageIndex,x.originalUrl=a.convertedImageOrgUrl,x.various={shrinked:a.convertedImageShrinked})}function Pe(){const a=c.status;j.value=c.status.success===c.status.length?f.value.successColor:f.value.errorColor,ge.value==="processed"&&(ge.value="zipped"),a.success>0&&(ke.value||ne("log"),pe("preview"))}async function Te(a,p,F,U){var S;if(!a)return;const B=U;console.log(a,p,F,U,"completed, path, fileId, zippedIndex"),console.log(B,c.status.ziplogs[B]),le("preview")||(pe("preview"),await Ce()),(S=W.value)==null||S.changeIndex(B+1),await Ce(()=>{var me;try{(me=W.value)==null||me.$el.scrollIntoView({behavior:"instant",block:"nearest"})}catch{}})}const de=Ie(()=>[{key:"open",label:l("status.openFailedList"),icon:()=>K(he,()=>K(yn)),onSelect(){$()}},{key:"download",label:l("status.saveFailedList"),icon:()=>K(he,()=>K(za)),onSelect(){$(!0)}},{key:"zip",label:`${l("status.zipFailedList")}`+(c.status.failedZipDone?`(âœ”${l("status.done")})`:""),icon:()=>K(It,{show:b.value&&!c.status.failedZipDone,size:"small"},()=>K(he,()=>K(Ut))),disabled:b.value,onSelect(a){return b.value=!0,z("demand-zip-errors"),!1}}]);function Le(a,p=!1){const{url:F,name:U}=a;if(p){const B=document.createElement("a");B.href=F,B.download=U,B.click()}a.clicked||(a.clicked=!0,g.value||w.value.every(B=>B.clicked)&&z("all-zips-clicked"))}async function ze(){if(_.value){if(w.value.length>=2&&!await new Promise((F,U)=>o.warning({title:l("Download"),content:l("status.confirmDownloadMessage",[w.value.length]),positiveText:"OK",negativeText:l("cancel"),onPositiveClick:()=>F(!0),onNegativeClick:()=>U()})))return;const a=w.value;for(const p of a)Le(p,!0)}else W.value.download()}function $(a=!1){const p=new Blob([c.status.unconvertedListText],{type:"text/plain;charset=utf8"}),F=URL.createObjectURL(p),U=document.createElement("a");U.href=F,U.target="_blank",a&&(U.download=c.status.baseZipName+"-error.txt"),U.click()}const L=k(!1);function Q(){L.value=!0,URL.revokeObjectURL(x.url),URL.revokeObjectURL(x.originalName),x.originalUrl="",x.url="",x.index=0,c.status.logs.length=0,h.value.length=0,m.value.length=0,w.value.length=0}return(a,p)=>{const F=Ae,U=St,B=_n,S=Xe,me=Oe,fe=Nl,Ue=jt,lt=xa,st=bn;return P(),J(F,{ref_key:"body",ref:q,vertical:"",justify:"center"},{default:t(()=>[n(st,{"display-directive":"show","trigger-areas":["arrow","main"],"expanded-names":e(G),"onUpdate:expandedNames":p[6]||(p[6]=X=>He(G)?G.value=X:null),"theme-overrides":u},{default:t(()=>[n(ns,{"elapsed-time":e($e),"success-perc":e(E)[0],"input-total-size":e(R),"output-total-size":e(be),"file-type":c.status.type,shrink:c.status.shrink,threads:c.status.threads,"zip-size":c.status.zipSize,"rate-color":e(ve),"dif-color":e(ue),"total-size-dif-str":e(Se)},{center:t(()=>[e(L)?ce("",!0):(P(),J(fs,{key:0,index:e(C)[0],success:e(M)[0],length:a.status.length,"success-to":e(M)[0],"success-from":e(M)[1],failure:e(O)[0],"success-perc-to":e(E)[0],"success-perc-from":e(E)[1],retried:e(V),processing:e(g),interval:e(oe),"status-color":e(j),class:"center-column"},null,8,["index","success","length","success-to","success-from","failure","success-perc-to","success-perc-from","retried","processing","interval","status-color"]))]),_:1},8,["elapsed-time","success-perc","input-total-size","output-total-size","file-type","shrink","threads","zip-size","rate-color","dif-color","total-size-dif-str"]),n(Cs,{processing:e(g),"image-index":e(x).index,thumbnail:e(Z),opened:e(se),"preview-collapsed":le("preview"),logs:e(h),expanded:e(ke),order:e(ge),onChangeIndex:Te,onOpenPreview:p[0]||(p[0]=X=>{var re;return(re=e(W))==null?void 0:re.openPreview()}),name:"log",style:{"white-space":"nowrap"}},null,8,["processing","image-index","thumbnail","opened","preview-collapsed","logs","expanded","order"]),n(U,{title:a.$t("status.PreviewImage"),name:"preview",style:{"white-space":"nowrap"},disabled:!(e(M)[0]>0)},{default:t(()=>[n(F,{justify:"center",align:"center",vertical:""},{default:t(()=>[n(Xl,{"_v-else-if":"imageViewerStarted && status.success > 0 /*&& (props.status.threads || !zippingFlag)*/ && !cleaningUp",ref_key:"imageViewer",ref:W,url:e(x).url,size:e(x).size,"original-url":e(x).originalUrl,"original-size":e(x).originalSize,name:e(x).name,originalName:e(x).originalName,length:e(M)[0],index:e(x).index,"various-info":e(x).various,"is-single":!e(_),onDemandImage:p[1]||(p[1]=X=>z("demand-image",X)),on_deleteImage:p[2]||(p[2]=X=>z("delete-image",X)),_close:"imageViewerStarted=false"},null,8,["url","size","original-url","original-size","name","originalName","length","index","various-info","is-single"])]),_:1})]),_:1},8,["title","disabled"]),n(U,{name:"output",style:{"white-space":"nowrap"},disabled:""},{header:t(()=>[y("span",{style:{color:"black"},innerHTML:a.$t("status.Output")},null,8,$s)]),default:t(()=>[n(F,{wrap:!1,vertical:"",style:{"margin-top":"-1.3em"}},{default:t(()=>[e(L)?ce("",!0):(P(),J(F,{key:0,justify:"center"},{default:t(()=>[Be(n(F,{vertical:"",align:"center"},{default:t(()=>[n(S,{placement:"left"},{trigger:t(()=>[n(B,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":e(v)[0]===e(D)?"white":"green",processing:e(g),percentage:e(v)[0]/e(D)*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[y("span",Es,d(e(v)[0]/e(D)*100|0)+"% "+d(a.$t("status.zipped"))+" ("+d(e(v)[0])+"/"+d(e(N)[0])+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[T(" "+d(a.$t("status.zippingProgress"))+" ("+d(e(v)[0]/e(D)*100|0)+"%) ",1)]),_:1}),n(et,{name:"zipcontainer"},{default:t(()=>[e(w).length>=1||e(g)?(P(),J(nn,{key:0,name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(P(!0),te(Re,null,ht(e(w),(X,re)=>(P(),te("span",{key:re},[n(S,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",{href:X.url,download:X.name,class:"in-button-anchor",onClick:Ge=>Le(X)},[n(me,{class:"zip-button",size:"tiny",color:X.clicked?"#050":"lime","text-color":X.clicked?"gray":"white",onClick:Je(Ge=>Le(X),["stop"]),round:""},{default:t(()=>[n(e(he),{size:"tiny"},{default:t(()=>[n(e(Ut))]),_:1}),T("ZIP"+d(X.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Ps)]),default:t(()=>[y("div",{style:ie({color:e(f).successColor})},[y("div",null,"ZIP "+d(X.number||"")+" ("+d(a.$t("success"))+")",1),y("div",null,d(X.name),1),y("div",null,d(X.sizeByUnit),1),y("div",null,d(a.$rt("{n} @:files",X.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):ce("",!0)]),_:1})]),_:1},512),[[Ze,e(_)]])]),_:1})),n(et,null,{default:t(()=>[e(L)?ce("",!0):Be((P(),J(F,{key:0,justify:"center",align:"center"},{default:t(()=>[n(S,{trigger:"hover",duration:0,delay:0,placement:"left",style:ie({color:"white",backgroundColor:e(f).successColor}),"arrow-style":{backgroundColor:e(f).successColor}},{trigger:t(()=>[n(et,{name:"save"},{default:t(()=>[e(M)[0]>0?(P(),te("span",Fs,[n(Ue,{value:e(_)?e(v)[0].toLocaleString("en-us"):c.status.type.replace(/\(.+\)/,""),color:e(f).successColorHover,offset:[-20,-3]},{default:t(()=>[n(me,{size:"medium",onClick:ze,color:e(f).successColor,round:""},{default:t(()=>[e(_)?(P(),te(Re,{key:0},[e(w).length?(P(),te("a",{key:0,href:e(w)[0].url,download:e(w)[0].name,class:"in-button-anchor",onClick:p[3]||(p[3]=Je(()=>{},["prevent"]))},[n(fe),T(" Ã— "+d(e(w).length)+" "+d(a.$t("status.saveAll")),1)],8,Os)):ce("",!0)],64)):(P(),te("a",{key:1,href:e(x).url,download:e(x).name,class:"in-button-anchor",onClick:p[4]||(p[4]=Je(()=>{},["prevent"]))},[n(e(he),{size:"tiny"},{default:t(()=>[n(e(kn))]),_:1}),T(" "+d(a.$t("save")),1)],8,Us))]),_:1},8,["color"])]),_:1},8,["value","color"])])):ce("",!0)]),_:1})]),default:t(()=>[a.status.length>=2?(P(),te(Re,{key:0},[y("div",null,d(e(l)("success"))+": "+d(e(v)[0].toLocaleString()),1),y("div",null,d(e(l)("status.totalSize"))+": "+d(e(je)(a.status.zippedTotalSize)),1),y("div",null,"ZIP Ã— "+d(e(w).length),1),y("div",null,d(e(l)("status.saveAllZipsTooltip")),1)],64)):(P(),te(Re,{key:1},[T(d(a.$t("status.downloadConvertedImage",e(w).length)),1)],64))]),_:1},8,["style","arrow-style"]),!e(g)&&a.status.success!==e(D)?(P(),J(lt,{key:0,options:e(de),onSelect:p[5]||(p[5]=(X,re)=>{var Ge;return(Ge=e(de).find(({key:Ct})=>X===Ct))==null?void 0:Ge.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:t(()=>[n(S,{show:e(A),duration:0,delay:0,placement:"right",style:ie({color:"white",backgroundColor:e(f).errorColor}),"arrow-style":{backgroundColor:e(f).errorColor}},{trigger:t(()=>[n(Ue,{value:a.status.unconvertedFileCount.toLocaleString(),color:e(f).errorColorHover,offset:[-0,-3]},{default:t(()=>[n(me,{size:"small",color:e(f).errorColor},{default:t(()=>[n(e(he),{size:"medium",style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Ia))]),_:1})]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:t(()=>[y("div",null,[y("div",null,d(e(l)("failed"))+": "+d(a.status.unconvertedFileCount.toLocaleString()),1),y("div",null,d(e(l)("status.totalSize"))+": "+d(e(je)(a.status.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])):ce("",!0)]),_:1},512)),[[Ze,!e(g)]])]),_:1}),n(et,{name:"zipcontainer"},{default:t(()=>[e(L)?ce("",!0):Be((P(),J(F,{key:0,vertical:"",align:"center"},{default:t(()=>[n(S,{placement:"left"},{trigger:t(()=>[n(B,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":a.status.failedFileZippedCount===a.status.unconvertedFileCount?"white":"#500",processing:e(b)&&!a.status.failedZipDone&&!a.status.failedToCreateFailedZip,percentage:a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[a.status.failedToCreateFailedZip?(P(),te("div",{key:1,style:ie({color:e(f).errorColor})},d(a.$t("status.failureZippingFailedFiles")),5)):(P(),te("span",Ms,d(a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0)+"% "+d(a.$t("status.zipped"))+" ("+d(a.status.failedFileZippedCount)+"/"+d(a.status.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[T(" "+d(a.$t("status.zippingProgress"))+" ("+d(a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(nn,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(P(!0),te(Re,null,ht(e(m),(X,re)=>(P(),te("span",{key:re},[n(S,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",{href:X.url,download:X.name,class:"in-button-anchor",onClick:Ge=>Le(X)},[n(me,{class:"zip-button",size:"tiny",color:X.clicked?"#551122":"#F00","text-color":X.clicked?"gray":"white",onClick:Je(Ge=>Le(X),["stop"]),round:""},{default:t(()=>[n(e(he),{size:"tiny"},{default:t(()=>[n(e(Ta))]),_:1}),T("ZIP"+d(X.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Rs)]),default:t(()=>[y("div",{style:ie({color:e(f).errorColor})},[y("div",null,"ZIP "+d(X.number||"")+" ("+d(a.$t("failed"))+")",1),y("div",null,d(X.name),1),y("div",null,d(X.sizeByUnit),1),y("div",null,d(a.$rt("{n} @:files",X.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1},512)),[[Ze,e(b)]])]),_:1})]),_:1})]),_:1})]),_:1},8,["expanded-names"])]),_:1},512)}}}),Ns=Ve(Ds,[["__scopeId","data-v-be7bfeda"]]),js=["innerHTML"],Bs=ye({__name:"converter",props:at({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},threads:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:at(["start","end"],["update:showNote"]),setup(i,{emit:s}){Qe(qe);const{t:r}=We(),u=Tt(),o=Aa(),l=10,f=navigator.hardwareConcurrency,c=typeof OffscreenCanvas=="function",z=100,_=i,h=Fe(i,"showNote"),b=s,w=k(!1),m=k(!1),g=k(!1),E=k(!1),C=k(!1),M=k(()=>"initializing"),O=k("info"),I=xt(G()),N=nt("stat"),V=k(0);let D=!1,v=()=>{},j,ve=0,ue=!1;we(()=>_.input,x=>{x!=null&&x.length&&pe(x)}),we(E,x=>{document.body.style.overflowY=x?"hidden":"auto"}),De(async()=>{await ke(),ge()});async function R(){let x=!0;if(ve>l*1e3&&!ue&&I.success>0&&(x=!1,await new Promise(q=>{u.warning({title:r("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:r("close"),negativeText:r("back"),onPositiveClick:()=>x=!0,onAfterLeave:q,content:r("confirmCloseDialog")})})),!x)return!1;o.destroyAll(),E.value=!1,h.value=!1}function be(x){j==null||j(x),console.log(x,"demanded")}function Se(x){Pt==null||Pt(x),console.log(x,"delete")}function $e(){!m.value&&w.value?m.value=!0:R()}function A(){pe(_.input)}let Z=k(()=>{});function G(x){const q={logs:[],ziplogs:[],startedCount:0,converted:0,success:0,failure:0,retried:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",convertedImageOrgUrl:"",convertedImageIndex:-1,convertedImageShrinked:!1,zipSize:_.maxZipSizeMB,shrink:H.multithread&&H.shrinkImage?[H.maxWidth,H.maxHeight]:void 0,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1};return Object.assign(x||{},q)}function le(){C.value=!1,URL.revokeObjectURL(I.convertedImageUrl),URL.revokeObjectURL(I.convertedImageOrgUrl);for(const x of I.zips)URL.revokeObjectURL(x.url);I.zips.length=0;for(const x of I.failedZips)URL.revokeObjectURL(x.url);I.failedZips.length=0,G(I),v(),v=()=>{},j=null,ue=!1,g.value=!1,m.value=!1}async function pe(x){if(w.value){u.error({title:"Busy",positiveText:"OK",content:r("interfered")});return}E.value&&(V.value^=1);let q=x.concat();G(I),le(),E.value=!0,C.value=!0,w.value=!0,I.processing=!0,O.value="info",M.value=()=>r("processing");const W=new Set,oe=_.format,ee=_.quality,ae=[...oe.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),Ee=se(oe,ee,q[0].webkitRelativePath);I.length=q.length,I.baseZipName=Ee,I.type=oe.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(oe)?" ("+ee+")":""),I.threads=D?0:_.threads;const Pe=Date.now();b("start");let Te,de,Le;if(!D&&_.threads>=2?(j=Cl,Le=await bl({files:q,completedFileIdSet:W,ConvStats:I,canceled:m,props:_,imageType:oe,quality:ee,outputExt:ae,format:oe,message:o})):(j=Ul,Le=await Ol(q,W,_,m,I)),{exception:de,callbackToGenerateFailedZips:Te,callbackToClearConverter:v}=Le,de){let ze;switch(de.message){case"worker-load-error":ze=r("errMsgWorkerLoadError");break;default:ze="unexpected error"}u.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:()=>K("div",[K("p",ze),K(Oe,{onClick(){location.reload()}},r("Reload"))])})}if(I.success===I.length?(O.value="success",M.value=()=>r("completed")):(O.value="error",M.value=()=>m.value?r("aborted"):r("incomplete")),W.size!==q.length){const ze=ne(x,W);Z.value=()=>{!ze||!ze.length||Te(ze)}}w.value=!1,I.processing=!1,g.value=!0,q.length=0,ve=Date.now()-Pe,b("end")}function ne(x,q){const W=[],oe=[];let ee=0;for(const ae of x)q.has(ae._id)||(W.push(ae),oe.push(ae.webkitRelativePath||ae.relativePath||ae.name),ee+=ae.size);return oe.length&&(I.unconvertedListText=oe.join(`
`),I.unconvertedFileCount=W.length,I.unconvertedTotalSize=ee),W}function se(x,q,W){var Pe;const oe=new Date;x=x.replace(/^image\//,"").toLowerCase();const ee=H.useFolderNameForZip&&((Pe=String(W).match(/^\/?([^/]+)\//))==null?void 0:Pe[1])||"avif2jpg",ae=`
    ${oe.getFullYear().toString().substring(2)}
    ${String((oe.getMonth()+1)*100+oe.getDate()).padStart(4,"0")}
    ${String(oe.getHours()*1e4+oe.getMinutes()*100+oe.getSeconds()).padStart(6,"0")}
    -
    ${x+(/jpe?g|webp/i.test(x)?q:"")}
  `.replace(/\s/g,"");return`${ee}-${ae}`.replace(/\s+/g," ")}async function ke(){const x="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",q=document.createElement("img"),W=On(q).then(()=>!0,()=>!1);q.src=x,await W||u.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:r("avifUnsupported")})}function ge(){(!c||f<2||!Promise.any)&&(D=!0),D&&(Me.value=0)}return(x,q)=>{var Te;const W=he,oe=jt,ee=xe,ae=Ae,Ee=It,Pe=zn;return P(),te(Re,null,[!e(w)&&((Te=_.input)!=null&&Te.length)?(P(),J(ae,{key:0,justify:"center",align:"center",style:{"margin-top":"0.4em"}},{default:t(()=>[n(ee,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:t(()=>{var de;return[n(oe,{value:((de=x.input)==null?void 0:de.length)||0,offset:[-12,-5],color:"#99999966"},{default:t(()=>[n(e(Oe),{onClick:A,round:"",size:"medium"},{icon:t(()=>[n(W,{size:"1.2em",color:"#CCCCCC"},{default:t(()=>[n(e(Sa))]),_:1})]),default:t(()=>[T(" "+d(e(r)("convertAgain")),1)]),_:1})]),_:1},8,["value"])]}),default:t(()=>{var de;return[y("div",{innerHTML:e(r)("reconvertTip",(de=_.input)==null?void 0:de.length)},null,8,js)]}),_:1})]),_:1})):ce("",!0),n(Pe,{ref:"processingModal","display-directive":"show",show:e(E),"onUpdate:show":q[2]||(q[2]=de=>He(E)?E.value=de:null),closable:e(g),"close-on-esc":!1,preset:"dialog",onClick:q[3]||(q[3]=de=>{e(o).destroyAll()}),onMaskClick:q[4]||(q[4]=de=>{e(o).destroyAll()}),onClose:R,onEsc:$e,title:e(M),type:e(O),"mask-closable":!1,onAfterLeave:le,onBeforeLeave:q[5]||(q[5]=de=>{e(N).cleanup()}),class:"processing-dialog"},{default:t(()=>[n(ae,{vertical:"",style:{"flex-grow":"1"}},{default:t(()=>[e(C)?(P(),J(Ns,{ref_key:"stat",ref:N,key:e(V),processing:e(w),status:e(I),interval:z,onAllZipsClicked:q[0]||(q[0]=de=>He(ue)?ue.value=!0:ue=!0),onDemandZipErrors:e(Z),onDemandImage:be,onDeleteImage:Se},null,8,["processing","status","onDemandZipErrors"])):ce("",!0),n(ae,{justify:"end",align:"center",wrap:!1},{default:t(()=>[n(ae,{justify:"start",align:"center"},{default:t(()=>[Rt(x.$slots,"lang-switch")]),_:3}),e(w)?(P(),J(e(Oe),{key:0,disabled:e(m),ref:"cancelbutton",round:"",size:"large",onClick:q[1]||(q[1]=de=>m.value=!0)},{default:t(()=>[n(Ee,{show:e(m)&&!e(g),size:"small"},{default:t(()=>[T(d(e(r)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):e(g)?(P(),J(e(Oe),{key:1,onClick:R,round:"",size:"large",style:{"margin-top":"1em"}},{default:t(()=>[T(d(e(r)("close")),1)]),_:1})):ce("",!0)]),_:3})]),_:3})]),_:3},8,["show","closable","title","type"])],64)}}}),Zs="/avif2jpeg/dist/avif.png",Hs={class:"container-1"},Vs={style:{position:"relative"}},Ws={style:{position:"absolute","font-size":"0.5em",right:"-3.5em",bottom:"-1.5em","white-space":"nowrap"}},qs={style:{color:"#666666"}},Gs=["innerHTML"],Ks={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},Ys=ye({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(i,{emit:s}){Qe(qe);const r=i,u=s,o=La(),l=k(!1),f=k(0),c=k("");De(()=>{z(r.dropTarget||document)});function z(h){document.ondragstart=b=>b.preventDefault(),document.ondragover=b=>b.preventDefault(),h.ondrop=async b=>{var m;if(b.preventDefault(),l.value||r.forbidden)return;l.value=!0,f.value=0,c.value="";let w;try{const g=[...b.dataTransfer.items].map(E=>E.webkitGetAsEntry());o.start(),w=await _(g),o.finish()}catch{w=[...((m=b.dataTransfer)==null?void 0:m.files)??[]],o.error()}l.value&&(l.value=!1,u("drop",w))}}async function _(h,b){b=b||[];for(const w of h)if(w.isFile){const m=await new Promise(g=>w.file(E=>g(E)));Object.defineProperty(m,"webkitRelativePath",{value:w.fullPath}),b.push(m),f.value++}else if(w.isDirectory){c.value=w.fullPath;const m=w.createReader();do{const g=await new Promise(E=>m.readEntries(C=>E(C)));if(!g.length)break;await _(g,b)}while(!0)}return b}return(h,b)=>{const w=he,m=Xe,g=Ae,E=xe,C=zn;return P(),te("div",Hs,[n(E,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"bottom-end"},{trigger:t(()=>[n(g,{vertical:"",class:"container-2"},{default:t(()=>[n(g,{align:"center",wrap:!1,class:"container-3"},{default:t(()=>[n(g,{vertical:"",align:"center",wrap:!1,style:{"font-weight":"bold","font-size":"1em","line-height":"90%","white-space":"nowrap"}},{default:t(()=>[b[5]||(b[5]=y("span",null,"Drag & Drop",-1)),y("span",Vs,[b[4]||(b[4]=T(" AVIF Images ")),y("span",Ws,[b[3]||(b[3]=T(" or ")),n(m,{placement:"bottom-end"},{trigger:t(()=>[y("span",qs,[n(w,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Bt))]),_:1}),b[1]||(b[1]=T(" Folders "))])]),default:t(()=>[b[2]||(b[2]=T(" You can drag and drop your local folders "))]),_:1})])])]),_:1}),n(g,null,{default:t(()=>b[6]||(b[6]=[y("img",{src:Zs,class:"avif"},null,-1)])),_:1})]),_:1})]),_:1})]),default:t(()=>[y("h3",{innerHTML:h.$t("droptarget"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,Gs)]),_:1}),n(C,{show:e(l),"onUpdate:show":b[0]||(b[0]=M=>He(l)?l.value=M:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":h.$t("cancel")},{default:t(()=>[n(g,{vertical:"",align:"center"},{default:t(()=>[y("div",Ks,d(e(c)),1),y("div",null,"found "+d(e(f))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])])}}}),Qs=Ve(Ys,[["__scopeId","data-v-963c44a5"]]),Xs={class:"container-1"},Js={class:"container-2"},ei=["innerHTML"],ti=["innerHTML"],ni={style:{"white-space":"nowrap"}},oi={style:{"padding-left":"1em"}},ai=["innerHTML"],li=["accept"],si=ye({__name:"file-selector",props:at({target:{},userExtensions:{},forbidden:{type:Boolean}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:at(["input","click","cancel","on-change-accept","update:target","update:userExtensions"],["update:expanded","update:disableNotifyingFolderSelect"]),setup(i,{emit:s}){const r=Tt(),{t:u}=We(),o=Qe(qe),l=["avif_only","all_images","all_files","edit_type"],f=[];for(const A of l)f.push({label:()=>u("fileTypeRadioOptions."+A),value:A});const c=({node:A,option:Z})=>K(xe,{placement:"right"},{trigger:()=>A,default:()=>ue(Z.value).replace(/,/g,", ")}),z=i,_=s,h=k(0),b=k(!1),w=k(!1),m=Ie(()=>ue(C.value)),g=Ie(()=>M.value.split(",").every(Z=>/^\s*(\.[\w\-]+)*\s*$/.test(Z))?"success":"error"),E=Ie(()=>!z.forbidden&&!w.value);Fe(i,"expanded");const C=Ie({get:()=>l.indexOf(z.target)>=0?z.target:l[0],set:A=>{_("update:target",A)}}),M=Ie({get:()=>z.userExtensions,set:A=>{_("update:userExtensions",A)}}),O=Fe(i,"disableNotifyingFolderSelect"),I=k(null),N=k(null),V=k(ve());we(C,A=>{_("on-change-accept",m.value)}),De(()=>{});async function D(A){if(_("click"),A===N.value&&!O.value){let Z=!1;if(await new Promise(G=>{r.info({title:u("loadfolderNotifyingTitle"),positiveText:u("Continue"),negativeText:u("Cancel"),onAfterLeave:()=>G(Z),onPositiveClick:()=>Z=!0,content:()=>K("div",[K("p",{},u("loadfolderNotifyingMessageTerm1")),K("div",[K(vn,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/dist//notification-folder.png"})]),K("p",{},u("loadfolderNotifyingMessageTerm2")),K("p",[K(wn,{onUpdateChecked:le=>O.value=le,checked:O.value},()=>u("checkboxTextDontShowThis"))])])})}),!Z){O.value=!1,_("cancel");return}}A.click()}function v(){_("cancel")}function j(A){const G=[...A.target.files];I.value.value="",N.value.value="",be(G)}function ve(){return"webkitdirectory"in document.createElement("input")}function ue(A){switch(A){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico";case"edit_type":return M.value;case"all_files":default:return".*"}}async function R(A){const Z=String(m.value).toLowerCase().replace(/\s+/g,"");if(Z&&m.value!==".*"){const G=Z.split(",");A=A.filter(le=>G.includes(le.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),A.length||(await new Promise(le=>{r.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:le,content:()=>K("div",[K(Dt,{description:"NO IMAGES"}),`${u("noimage")}`,K("br"),m.value])})}),v())}return A}async function be(A){w.value=!0,A=await R(A),h.value=A.length,A.length>0&&_("input",$e(A)),w.value=!1}let Se=0;function $e(A){const Z=[];for(const G of A)G.hasOwnProperty("_id")||Object.defineProperty(G,"_id",{value:Se++}),Z.push(G);return Z}return(A,Z)=>{const G=he,le=Oe,pe=Ae,ne=Lt,se=$a,ke=Ca,ge=Xe;return P(),te(Re,null,[y("div",Xs,[y("div",Js,[n(pe,{vertical:"",align:"center",justify:"center",inline:"",size:"large"},{default:t(()=>[n(pe,{align:"center",justify:"space-around",class:"main-buttons"},{default:t(()=>[n(pe,{vertical:"",align:"stretch",justify:"center"},{default:t(()=>[n(e(xe),{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(o).LANDSCAPE.value?"right":"top",duration:0,delay:0,"z-index":10},{trigger:t(()=>[n(le,{disabled:!e(E),size:"large",onClick:Z[0]||(Z[0]=x=>D(e(I))),round:"",style:{width:"100%","background-color":"white","font-size":"1.5em"}},{icon:t(()=>[n(G,{size:"large",color:"gray"},{default:t(()=>[n(e(xn))]),_:1})]),default:t(()=>[T(" "+d(A.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[y("div",{innerHTML:A.$t("loadbuttontooltip")},null,8,ei)]),_:1},8,["show","placement"]),!e(o).IS_SP&&e(V)||e(o).SSR?(P(),te(Re,{key:0},[n(pe,{align:"center",justify:"center",style:{color:"gray",margin:"0em"}},{default:t(()=>[T(d(A.$t("or")),1)]),_:1}),n(e(xe),{to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:e(o).showTooltipsBeforeMounted.value},{trigger:t(()=>[n(le,{disabled:!e(E),size:"large",onClick:Z[1]||(Z[1]=x=>D(e(N))),round:"",style:{width:"100%","background-color":"white","font-size":"1.5em"}},{icon:t(()=>[n(G,{size:"large",color:"gray"},{default:t(()=>[n(e(Bt))]),_:1})]),default:t(()=>[T(" "+d(A.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[y("div",{innerHTML:A.$t("loadfoldertooltip")},null,8,ti)]),_:1},8,["show"])],64)):ce("",!0)]),_:1}),e(o).IS_SP?ce("",!0):(P(),J(Qs,{key:0,onDrop:be,forbidden:!e(E),class:"drop-target"},null,8,["forbidden"]))]),_:1}),n(pe,{vertical:""},{default:t(()=>[n(pe,{wrap:e(o).IS_SP,align:"center",justify:"stretch"},{default:t(()=>[y("span",ni,d(A.$t("TargetFileTypeExt"))+": ",1),n(e(xe),{"keep-alive-on-hover":!1,placement:"right",style:{"max-width":"200px"},duration:0,delay:0},{trigger:t(()=>[n(ne,{trigger:"click",width:"trigger",size:"small",value:e(C),"onUpdate:value":Z[2]||(Z[2]=x=>He(C)?C.value=x:null),options:f,"render-option":c,"consistent-menu-width":!1},null,8,["value"])]),default:t(()=>[T(" "+d(ue(e(C)).replace(/,/g,", ")),1)]),_:1})]),_:1},8,["wrap"]),e(C)==="edit_type"?(P(),J(e(xe),{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:e(b),duration:0,delay:0},{trigger:t(()=>[y("div",oi,[n(ge,{trigger:"manual",placement:"right-end",show:e(C)==="edit_type"&&e(g)!=="success"&&!!e(b)},{trigger:t(()=>[n(se,{value:e(M),"onUpdate:value":Z[3]||(Z[3]=x=>He(M)?M.value=x:null),status:e(g),disabled:e(C)!=="edit_type",onFocus:Z[4]||(Z[4]=x=>b.value=!0),onBlur:Z[5]||(Z[5]=x=>b.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:t(()=>[n(ke,{type:"error","show-icon":!0,title:"Validation error"},{default:t(()=>Z[6]||(Z[6]=[T(" Please correct the extension list."),y("br",null,null,-1),y("ul",null,[y("li",null,"Each extension must begin with a period. "),y("li",null,"Separate each extension with a comma. "),y("li",null,"Use alphameric characters.")],-1)])),_:1})]),_:1},8,["show"])])]),default:t(()=>[y("span",{innerHTML:A.$t("editAcceptTypes")},null,8,ai)]),_:1},8,["show"])):ce("",!0)]),_:1})]),_:1})])]),y("input",{ref_key:"fileinput",ref:I,onInput:j,onCancel:v,type:"file",multiple:"",accept:e(m),style:{display:"none"}},null,40,li),y("input",{ref_key:"folderinput",ref:N,webkitdirectory:"",directory:"",onInput:j,onCancel:v,type:"file",style:{display:"none"}},null,544)],64)}}}),ii=Ve(si,[["__scopeId","data-v-e613e1ac"]]),ri={style:{"white-space":"nowrap"}},ui=ye({__name:"settings-output",props:{quality:{},format:{}},emits:["update:format","update:quality"],setup(i,{emit:s}){const r=i,u=s,{t:o}=We(),l=Qe(qe),f=k([]),c=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],z=Ie({get:()=>r.format,set:g=>{g=w(g),u("update:format",g)}}),_=Ie({get:()=>r.quality,set:g=>{u("update:quality",g)}}),h=Ie(()=>/png|bmp/i.test(z.value)),b=k(null);De(()=>{m()});function w(g){return f.value.indexOf(g)<0&&(g=f.value[0]),g}function m(){for(const g of c)b.value.toDataURL(g).indexOf(g)>=0&&f.value.push(g);f.value.length===0&&f.value.push(c[0])}return(g,E)=>{const C=he,M=Lt,O=Ae,I=xe,N=At,V=In;return P(),te(Re,null,[n(O,{justify:"center",class:"body"},{default:t(()=>[n(O,{vertical:""},{default:t(()=>[n(I,{to:!1,"display-directive":"show",show:e(l).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(l).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(O,{align:"center",wrap:!1},{default:t(()=>[n(C,null,{default:t(()=>[n(e(xn))]),_:1}),T(d(e(o)("settings.imageType"))+": ",1),n(M,{value:z.value,"onUpdate:value":E[0]||(E[0]=D=>z.value=D),options:f.value.map(D=>({value:D,label:D})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:t(()=>[T(" "+d(e(o)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(I,{to:!1,"display-directive":"show",show:e(l).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(l).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(O,{align:"center"},{default:t(()=>[n(O,{align:"start",wrap:!1},{default:t(()=>[n(C,null,{default:t(()=>[n(e(kn))]),_:1}),y("span",ri,d(e(o)("settings.quality"))+":",1),n(O,{align:"center",justify:"space-between"},{default:t(()=>[n(N,{tooltip:!1,value:_.value,"onUpdate:value":E[1]||(E[1]=D=>_.value=D),step:1,style:{width:"120px"},disabled:h.value},null,8,["value","disabled"]),n(V,{onBlur:E[2]||(E[2]=D=>_.value??(_.value=0)),value:_.value,"onUpdate:value":E[3]||(E[3]=D=>_.value=D),step:"1",min:"0",max:"100",disabled:h.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:t(()=>[T(" "+d(e(o)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1})]),_:1}),y("canvas",{ref_key:"canvas",ref:b,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),di=Ve(ui,[["__scopeId","data-v-060333f5"]]),ci={style:{width:"4em","text-align":"left"}},pi={style:{width:"4em","text-align":"left"}},Ft=100,rn=2e3,un=4096,dn=4096,fi=100,gi=100,mi=ye({__name:"settings-adv",props:{expanded:{type:Boolean,required:!1},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}},emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(i){const s=Qe(qe),r={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},u=Fe(i,"expanded"),o=Fe(i,"multithread"),l=Fe(i,"threadCount"),f=Fe(i,"maxZipSize"),c=Fe(i,"retainExt"),z=Fe(i,"useFolderNameForZip"),_=Fe(i,"shrinkImage"),h=Fe(i,"maxWidth"),b=Fe(i,"maxHeight");we(Me,m=>{m>1||(o.value=!1),l.value>m&&(l.value=m)},{immediate:!0});const w=Ie(()=>o.value&&Me.value>1);return De(()=>{Me.value>1&&typeof l.value>"u"&&(l.value=Math.max(Me.value,2))}),(m,g)=>{const E=he,C=Oe,M=Fa,O=Ae,I=At,N=In,V=St,D=bn;return P(),J(O,{justify:"center"},{default:t(()=>[n(D,{"display-directive":"show","default-expanded-names":u.value?["collapitem"]:"","on-update:expanded-names":v=>u.value=!!String(v),"trigger-areas":["arrow","main"],class:ot(["settings-body",u.value?"expand-adv-settings":""])},Ea({arrow:t(()=>[n(E,{style:ie(u.value&&{top:"8px"})},{default:t(()=>[n(e(Ma))]),_:1},8,["style"]),n(E,null,{default:t(()=>[n(e(Ra))]),_:1})]),default:t(()=>[n(V,{title:m.$t("settings.advancedSettings"),name:"collapitem"},{default:t(()=>[n(O,{vertical:"",style:{"padding-left":"2em"}},{default:t(()=>[n(e(xe),it(rt(r)),{trigger:t(()=>[n(O,{vertical:""},{default:t(()=>[n(O,{wrap:!1,align:"center"},{default:t(()=>[n(C,{text:"",disabled:!e(Me),style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[1]||(g[1]=v=>o.value=!o.value)},{icon:t(()=>[n(E,null,{default:t(()=>[n(e(Pa))]),_:1})]),default:t(()=>[T(" "+d(m.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(M,{value:o.value,"onUpdate:value":g[2]||(g[2]=v=>o.value=v),disabled:!e(Me),size:"small"},null,8,["value","disabled"])]),_:1}),n(O,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(I,{value:l.value,"onUpdate:value":g[3]||(g[3]=v=>l.value=v),disabled:!e(Me)||!o.value,step:1,min:2,max:e(Me),style:{width:"120px"}},null,8,["value","disabled","max"]),n(N,{onBlur:g[4]||(g[4]=v=>l.value??(l.value=2)),size:"tiny",value:l.value,"onUpdate:value":g[5]||(g[5]=v=>l.value=v),disabled:!e(Me)||!o.value,step:1,min:2,max:e(Me),style:{width:"10em"}},{suffix:t(()=>[T(d(m.$t("threads",l.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[T(" "+d(m.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(e(xe),it(rt(r)),{trigger:t(()=>[n(O,{vertical:""},{default:t(()=>[n(O,{wrap:!1,align:"center"},{default:t(()=>[n(C,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:t(()=>[n(E,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Oa))]),_:1})]),default:t(()=>[T(" "+d(m.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(O,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(I,{tooltip:!1,value:f.value,"onUpdate:value":g[6]||(g[6]=v=>f.value=v),step:1,min:Ft,max:rn,style:{width:"120px"}},null,8,["value"]),n(N,{onBlur:g[7]||(g[7]=v=>f.value??(f.value=Ft)),size:"tiny",value:f.value,"onUpdate:value":g[8]||(g[8]=v=>f.value=v),step:"1",min:Ft,max:rn,style:{width:"10em"}},{suffix:t(()=>g[21]||(g[21]=[T("(MB)")])),_:1},8,["value"])]),_:1})]),_:1})]),default:t(()=>[T(" "+d(m.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(e(xe),it(rt(r)),{trigger:t(()=>[n(O,{wrap:!1,align:"center"},{default:t(()=>[n(C,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[9]||(g[9]=v=>z.value=!z.value)},{icon:t(()=>[n(E,null,{default:t(()=>[n(e(Bt))]),_:1})]),default:t(()=>[T(" "+d(m.$t("settings.useFolderNameForZip")),1)]),_:1}),n(M,{value:z.value,"onUpdate:value":g[10]||(g[10]=v=>z.value=v),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[T(" "+d(m.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(e(xe),it(rt(r)),{trigger:t(()=>[n(O,{wrap:!1,align:"center"},{default:t(()=>[n(C,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[11]||(g[11]=v=>c.value=!c.value)},{icon:t(()=>[n(E,null,{default:t(()=>[n(e(yn))]),_:1})]),default:t(()=>[T(" "+d(m.$t("settings.retainOriginalExtension")),1)]),_:1}),n(M,{value:c.value,"onUpdate:value":g[12]||(g[12]=v=>c.value=v),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[T(" "+d(m.$t("settings.retainExtTooltip")),1)]),_:1},16),n(e(xe),it(rt(r)),{trigger:t(()=>[n(O,{vertical:""},{default:t(()=>[n(O,{wrap:!1,align:"center"},{default:t(()=>[n(C,{disabled:!w.value,text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[13]||(g[13]=v=>_.value=!_.value)},{icon:t(()=>[n(E,null,{default:t(()=>[n(e(Ua))]),_:1})]),default:t(()=>[T(" "+d(m.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(M,{disabled:!w.value,value:_.value,"onUpdate:value":g[14]||(g[14]=v=>_.value=v),size:"small"},null,8,["disabled","value"])]),_:1}),n(O,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(I,{value:h.value,"onUpdate:value":g[15]||(g[15]=v=>h.value=v),disabled:!_.value||!w.value,step:1,min:fi,max:un,style:{width:"120px"}},null,8,["value","disabled"]),n(N,{size:"tiny",onBlur:g[16]||(g[16]=v=>h.value??(h.value=8)),value:h.value,"onUpdate:value":g[17]||(g[17]=v=>h.value=v),disabled:!_.value||!w.value,step:1,min:8,max:un*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[y("span",ci,d(m.$t("width")),1)]),suffix:t(()=>g[22]||(g[22]=[T("px")])),_:1},8,["value","disabled","max"])]),_:1}),n(O,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(I,{value:b.value,"onUpdate:value":g[18]||(g[18]=v=>b.value=v),disabled:!_.value||!w.value,step:1,min:gi,max:dn,style:{width:"120px"}},null,8,["value","disabled"]),n(N,{size:"tiny",onBlur:g[19]||(g[19]=v=>b.value??(b.value=8)),value:b.value,"onUpdate:value":g[20]||(g[20]=v=>b.value=v),disabled:!_.value||!w.value,step:1,min:8,max:dn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[y("span",pi,d(m.$t("height")),1)]),suffix:t(()=>g[23]||(g[23]=[T("px")])),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[T(" "+d(m.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1},8,["title"])]),_:2},[u.value?{name:"header-extra",fn:t(()=>[n(e(xe),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(C,{onClick:e(Xa),size:"tiny",style:{"font-size":"xx-small"}},{default:t(()=>[T(d(m.$t("reset")),1)]),_:1},8,["onClick"])]),default:t(()=>[T(" "+d(m.$t("settings.resetButtonTooltip")),1)]),_:1}),e(s).IS_DEV?(P(),te("button",{key:0,onClick:g[0]||(g[0]=v=>e(Ja)())},"delcfg")):ce("",!0)]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1})}}}),vi=Ve(mi,[["__scopeId","data-v-31f045db"]]),hi={},_i={style:{color:"gray","padding-left":"20px"}},wi=["innerHTML"];function yi(i,s){const r=gn,u=Ae;return P(),J(u,{vertical:"",justify:"end"},{default:t(()=>[n(r,{style:{margin:"0px"}}),n(u,{justify:"center"},{default:t(()=>[y("ul",_i,[(P(!0),te(Re,null,ht(i.$tm("descriptions"),o=>(P(),te("li",{key:o,style:{"text-align":"left"},innerHTML:o},null,8,wi))),128))])]),_:1})]),_:1})}const bi=Ve(hi,[["render",yi]]),ki="modulepreload",zi=function(i){return"/avif2jpeg/dist/"+i},cn={},_e=function(s,r,u){let o=Promise.resolve();if(r&&r.length>0){let f=function(_){return Promise.all(_.map(h=>Promise.resolve(h).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),z=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));o=f(r.map(_=>{if(_=zi(_),_ in cn)return;cn[_]=!0;const h=_.endsWith(".css"),b=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${b}`))return;const w=document.createElement("link");if(w.rel=h?"stylesheet":ki,h||(w.as="script"),w.crossOrigin="",w.href=_,z&&w.setAttribute("nonce",z),document.head.appendChild(w),h)return new Promise((m,g)=>{w.addEventListener("load",m),w.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(f){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=f,window.dispatchEvent(c),!c.defaultPrevented)throw f}return o.then(f=>{for(const c of f||[])c.status==="rejected"&&l(c.reason);return s().catch(l)})},Un="English",Mn="ðŸ‡¬ðŸ‡§",Rn='AVIF to JPEG "Offline" Batch Converter',Dn="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",Nn="Drag & Drop AVIF Images to Convert",jn=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.'],Bn="Select your language",Zn="Choose Target File Extentions",Hn={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},Vn="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",Wn="Load Images",qn="Select your images from a dialog window.<br>*Multiple selection allowed.",Gn="Load a Whole Folder",Kn=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,Yn="Converting images",Qn="Aborted",Xn="Some files failed to convert",Jn="Completed",eo="Currently Busy",to="No files with the extentions were found.",no="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",oo="Cancel",ao="Save",lo="Close",so="Open",io="Re-convert",ro="Convert previous selected {n} @:files again",uo="File | Files",co="thread | threads",po="You have not saved the converted images yet.",fo="Data have not been saved",go="Open Source",mo="Open the converted image",vo="Copied to clipboard",ho="The converted image was copied to your clipboard as DataURL.",_o="Copy the converted image as DataURL",wo="Convert Again",yo={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",showOnlyErrors:"Show only errors",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files",Shrinked:"Shrinked",Shrinking:"Shrinking",saveAll:"Save All",progressRetries:"Retrying files",success:"success",started:"started",total:"total",files:"files",failure:"failure",all:"all",filterLogSelect:"filter",showOnlySuccess:"Only successes",showOnlyError:"Only errors",showAll:"Show all",Progress:"Progress",PreviewImage:"Preview Images",Log:"Log",log:"Log",Output:"Output Results",expandLog:"expand log size",autoScroll:"auto-scroll",sortByStatus:"status",sort:"Sort list by",sortByName:"name",sortBySize:"size",sortByOutputSize:"size(output)",sortByStart:"starting order",sortByCompletion:"output order"},bo={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file"},ko="Disabled",zo="Download",xo="Reset",Io="Back",To="Failed",Ao="Success",So="Previous version",Lo=`
Height`,Co="Width",$o="Don't show this message again",Eo="About the warning when selecting a folder",Po="OK",Fo={},Oo="You must press the â€œUploadâ€ button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",Uo="Continue",Mo="Cancel",Ro="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",Do="This page may be an outdated version. Please reload the page.",No="Reload",jo='If the conversion process frequently fails and an â€œOut of Memoryâ€ message appears, try reducing or disabling the number of "multi-threads" in the "Advanced Settings".',Bo="Next",Zo="Previous",Ho="or",Vo="Target File Extensions",Wo="Changelog",qo={lang:Un,flags:Mn,title:Rn,metaDescription:Dn,droptarget:Nn,descriptions:jn,selectLanguage:Bn,fileTypeRadioTitle:Zn,fileTypeRadioOptions:Hn,editAcceptTypes:Vn,loadbutton:Wn,loadbuttontooltip:qn,loadfolderbutton:Gn,loadfoldertooltip:Kn,processing:Yn,aborted:Qn,incomplete:Xn,completed:Jn,interfered:eo,noimage:to,avifUnsupported:no,cancel:oo,save:ao,close:lo,open:so,reconvert:io,reconvertTip:ro,files:uo,threads:co,confirmCloseDialog:po,confirmCloseDialogTitle:fo,githubOpenSource:go,convertedImageUrlTooltip:mo,copiedDataURLDialogTitle:vo,copiedDataURLMessage:ho,convertedImageDataUrlTooltip:_o,convertAgain:wo,status:yo,settings:bo,disabled:ko,Download:zo,reset:xo,back:Io,failed:To,success:Ao,previousVersion:So,height:Lo,width:Co,checkboxTextDontShowThis:$o,loadfolderNotifyingTitle:Eo,OK:Po,loadfolderNotifyingMessage:Fo,loadfolderNotifyingMessageTerm2:Oo,Continue:Uo,Cancel:Mo,loadfolderNotifyingMessageTerm1:Ro,errMsgWorkerLoadError:Do,Reload:No,annotationOutOfMemory:jo,Next:Bo,Prev:Zo,or:Ho,TargetFileTypeExt:Vo,changelog:Wo},xi=Object.freeze(Object.defineProperty({__proto__:null,Cancel:Mo,Continue:Uo,Download:zo,Next:Bo,OK:Po,Prev:Zo,Reload:No,TargetFileTypeExt:Vo,aborted:Qn,annotationOutOfMemory:jo,avifUnsupported:no,back:Io,cancel:oo,changelog:Wo,checkboxTextDontShowThis:$o,close:lo,completed:Jn,confirmCloseDialog:po,confirmCloseDialogTitle:fo,convertAgain:wo,convertedImageDataUrlTooltip:_o,convertedImageUrlTooltip:mo,copiedDataURLDialogTitle:vo,copiedDataURLMessage:ho,default:qo,descriptions:jn,disabled:ko,droptarget:Nn,editAcceptTypes:Vn,errMsgWorkerLoadError:Do,failed:To,fileTypeRadioOptions:Hn,fileTypeRadioTitle:Zn,files:uo,flags:Mn,githubOpenSource:go,height:Lo,incomplete:Xn,interfered:eo,lang:Un,loadbutton:Wn,loadbuttontooltip:qn,loadfolderNotifyingMessage:Fo,loadfolderNotifyingMessageTerm1:Ro,loadfolderNotifyingMessageTerm2:Oo,loadfolderNotifyingTitle:Eo,loadfolderbutton:Gn,loadfoldertooltip:Kn,metaDescription:Dn,noimage:to,open:so,or:Ho,previousVersion:So,processing:Yn,reconvert:io,reconvertTip:ro,reset:xo,save:ao,selectLanguage:Bn,settings:bo,status:yo,success:Ao,threads:co,title:Rn,width:Co},Symbol.toStringTag,{value:"Module"})),Ii="Arabic",Ti="German",Ai="English",Si="Spanish",Li="Finnish",Ci="French",$i="Hindi",Ei="Indonesian",Pi="Italian",Fi="Japanese",Oi="Korean",Ui="Dutch",Mi="Polish",Ri="Portuguese",Di="Russian",Ni="Turkish",ji="Ukrainian",Bi="Chinese",Zi={ar:Ii,de:Ti,en:Ai,es:Si,fi:Li,fr:Ci,hi:$i,id:Ei,it:Pi,ja:Fi,ko:Oi,nl:Ui,pl:Mi,pt:Ri,ru:Di,tr:Ni,uk:ji,"zh-hant":"Chinese(hant)",zh:Bi},kt=[],Go={en:qo},Vt={},pn=Object.assign({"./locales/ar.json":()=>_e(()=>import("./ar-Bs-dVZYB.js"),[]),"./locales/de.json":()=>_e(()=>import("./de-BQPc6VLI.js"),[]),"./locales/en.json":()=>_e(()=>Promise.resolve().then(()=>xi),void 0),"./locales/es.json":()=>_e(()=>import("./es-CqBg_y9a.js"),[]),"./locales/fi.json":()=>_e(()=>import("./fi-Ds7g1iCb.js"),[]),"./locales/fr.json":()=>_e(()=>import("./fr-D8EtgegO.js"),[]),"./locales/hi.json":()=>_e(()=>import("./hi-Ezqk50Rr.js"),[]),"./locales/id.json":()=>_e(()=>import("./id-BsMMe9nO.js"),[]),"./locales/it.json":()=>_e(()=>import("./it-BdKCrqWM.js"),[]),"./locales/ja.json":()=>_e(()=>import("./ja-C5lmyrcu.js"),[]),"./locales/ko.json":()=>_e(()=>import("./ko-CNwBvC5L.js"),[]),"./locales/nl.json":()=>_e(()=>import("./nl-C-Lgg7BA.js"),[]),"./locales/pl.json":()=>_e(()=>import("./pl-OSkpSBPS.js"),[]),"./locales/pt.json":()=>_e(()=>import("./pt-BO4nYfyj.js"),[]),"./locales/ru.json":()=>_e(()=>import("./ru-DEYnX-lF.js"),[]),"./locales/tr.json":()=>_e(()=>import("./tr-XAfWKbVj.js"),[]),"./locales/uk.json":()=>_e(()=>import("./uk-f9rkog-K.js"),[]),"./locales/zh-hant.json":()=>_e(()=>import("./zh-hant-eBVV34fF.js"),[]),"./locales/zh.json":()=>_e(()=>import("./zh-k4YjZC5w.js"),[])});var fn;for(const i in pn){const s=(fn=i.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:fn[1];s&&(kt.push(s),!(s in Go)&&(Vt[s]=pn[i]))}let Mt=Vi();Mt in Vt||(Mt="en");const zt=Da({legacy:!1,globalInjection:!0,locale:Mt,fallbackLocale:"en",messages:Go,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Hi(i){if(zt.global.availableLocales.indexOf(i)>=0)return;const s=await Vt[i]();zt.global.setLocaleMessage(i,s),await Ce()}function Vi(){const i=location.pathname;return String(i.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Wi=["innerHTML"],qi=ye({__name:"switch-lang",props:{delay:{}},emits:["lang-ready","lang-change"],async setup(i,{emit:s}){let r,u;const o=Qe(qe),l=mn(),{locale:f,t:c}=We(),z=i,_=s,h=Object.entries(Zi).map(([C,M])=>({label:M,value:C}));h.sort((C,M)=>{const O=C.label,I=M.label;return O>I?1:O<I?-1:0}),De(()=>{l.afterEach((C,M,O)=>{w(),o.switchToolTipVisibility()})}),[r,u]=Na(()=>w()),await r,u();async function b(C){(C!==f.value||zt.global.availableLocales.indexOf(C)===-1)&&(_("lang-change",C),await Pl(z.delay),await Hi(C),f.value=C,document.title=c("title"),await Ce()),_("lang-ready",C)}async function w(){const C=l.currentRoute.value.path||"",M=String(C.match(new RegExp("(?<=^\\/)[^/]+"))||"");M&&kt.includes(M)?(await b(M),f.value=M):await m()}async function m(){const C=g().toLowerCase(),M=C.split(/[-_]/)[0];if(kt.includes(M)){let O=M;if(M==="zh")switch(C){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":O="zh-hant"}await b(O)}}function g(){const C=window.navigator;return C.language||C.userLanguage||C.browserLanguage}function E(C){console.log(`changeRoute: ${l.currentRoute.value.fullPath} => ${C}`),l.push("/"+C+"/")}return(C,M)=>{const O=he,I=Lt,N=xe;return P(),J(N,{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(o).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:t(()=>[n(I,{ref:"langselect",size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,options:e(h),"_v-model:value":"locale",value:e(f),"onUpdate:value":E},{arrow:t(()=>[n(O,null,{default:t(()=>[n(e(ja))]),_:1})]),_:1},8,["options","value"])]),default:t(()=>[y("div",{innerHTML:C.$t("selectLanguage")},null,8,Wi)]),_:1},8,["show","placement"])}}}),qe=Symbol("global variables"),Gi=ye({__name:"Avif2Jpeg",emits:["ready"],setup(i,{emit:s}){const{t:r,locale:u}=We(),o=200,l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),f=!1,c=k(null);k(0);let z=k(void 0);const _=k(!0),h=k(!1),b=k(!1),w=k(!1),m=k(!0),g=k(!1);Ha(qe,{showTooltipsBeforeMounted:z,LANDSCAPE:_,IS_SP:l,IS_DEV:f,switchToolTipVisibility:O,SSR:!1}),De(()=>{I(),window.addEventListener("resize",I),O(),setTimeout(()=>b.value=!0,3e3)}),vt(()=>{window.removeEventListener("resize",I)});let E=0;function C(){w.value=!1,E=Date.now()}function M(){const D=m.value?0:Math.max(0,o-(Date.now()-E));m.value=!1,Ce(()=>{setTimeout(()=>w.value=!0,D)})}async function O(){}function I(){const D=document.body.clientWidth,v=document.body.clientHeight;_.value=D*.75>v||D>900}function N(D){c.value=D}function V(D){g.value=D}return(D,v)=>{const j=Ae,ve=he,ue=Xe;return P(),J(j,{vertical:"",align:"stretch",class:"avif2jpeg"},{default:t(()=>[n(cl,null,{"lang-switch":t(()=>[(P(),J(Ba,null,{default:t(()=>[n(qi,{onLangChange:C,onLangReady:M,delay:e(m)?0:o},null,8,["delay"])]),_:1}))]),_:1}),n(et,{name:"fade"},{default:t(()=>[Be(n(j,{vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:t(()=>[n(j,{justify:"space-around",vertical:"",style:{height:"100%"}},{default:t(()=>[n(fl),n(j,{justify:"center"},{default:t(()=>[n(ii,{"_v-model_expanded":"UserSettings.expandExtButtons",target:e(H).acceptTypeValue,"onUpdate:target":v[0]||(v[0]=R=>e(H).acceptTypeValue=R),userExtensions:e(H).editedAcceptTypes,"onUpdate:userExtensions":v[1]||(v[1]=R=>e(H).editedAcceptTypes=R),"disable-notifying-folder-select":e(H).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":v[2]||(v[2]=R=>e(H).disableNotifyingFolderSelect=R),forbidden:e(h),onInput:N,onClick:v[3]||(v[3]=R=>V(!0)),onCancel:v[4]||(v[4]=R=>V(!1))},null,8,["target","userExtensions","disable-notifying-folder-select","forbidden"])]),_:1}),n(Bs,{input:e(c),format:e(H).imageFormat,quality:e(H).imageQuality,"retain-extension":e(H).retainExtension,maxZipSizeMB:e(H).maxZipSizeMB,threads:e(H).multithread?e(H).threadCount:0,"show-note":e(g),"onUpdate:showNote":v[5]||(v[5]=R=>He(g)?g.value=R:null),onStart:v[6]||(v[6]=R=>h.value=!0),onEnd:v[7]||(v[7]=R=>h.value=!1)},{"lang-switch":t(()=>v[18]||(v[18]=[])),_:1},8,["input","format","quality","retain-extension","maxZipSizeMB","threads","show-note"]),n(j,{vertical:"",align:"center"},{default:t(()=>[n(ue,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(ve,{size:"5vh",color:"#DADADA",style:{margin:"0px"}},{default:t(()=>[n(e(Za))]),_:1})]),default:t(()=>[v[19]||(v[19]=y("span",null,"CONVERT TOðŸ‘‡",-1))]),_:1})]),_:1}),n(j,{vertical:"",align:"center"},{default:t(()=>[n(di,{format:e(H).imageFormat,"onUpdate:format":v[8]||(v[8]=R=>e(H).imageFormat=R),quality:e(H).imageQuality,"onUpdate:quality":v[9]||(v[9]=R=>e(H).imageQuality=R)},null,8,["format","quality"]),n(vi,{"retain-ext":e(H).retainExtension,"onUpdate:retainExt":v[10]||(v[10]=R=>e(H).retainExtension=R),"use-folder-name-for-zip":e(H).useFolderNameForZip,"onUpdate:useFolderNameForZip":v[11]||(v[11]=R=>e(H).useFolderNameForZip=R),"max-zip-size":e(H).maxZipSizeMB,"onUpdate:maxZipSize":v[12]||(v[12]=R=>e(H).maxZipSizeMB=R),"_v-model:expanded":"UserSettings.expandAdvSettings",multithread:e(H).multithread,"onUpdate:multithread":v[13]||(v[13]=R=>e(H).multithread=R),"thread-count":e(H).threadCount,"onUpdate:threadCount":v[14]||(v[14]=R=>e(H).threadCount=R),"_:thread-max":"availableThreadCount","shrink-image":e(H).shrinkImage,"onUpdate:shrinkImage":v[15]||(v[15]=R=>e(H).shrinkImage=R),"max-width":e(H).maxWidth,"onUpdate:maxWidth":v[16]||(v[16]=R=>e(H).maxWidth=R),"max-height":e(H).maxHeight,"onUpdate:maxHeight":v[17]||(v[17]=R=>e(H).maxHeight=R)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","multithread","thread-count","shrink-image","max-width","max-height"])]),_:1}),n(bi)]),_:1})]),_:1},512),[[Ze,e(w)]])]),_:1})]),_:1})}}}),Wt=ye({__name:"App",setup(i){const s={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{},Image:{toolbarColor:"#00000099"}},r=k(!0);return De(()=>{r.value=!1}),(u,o)=>{const l=Ga,f=qa,c=Wa,z=Va,_=Ka;return P(),J(_,{"theme-overrides":s,style:{width:"100%",height:"100%"}},{default:t(()=>[n(z,null,{default:t(()=>[n(c,{placement:"top-left",closable:!0,max:50},{default:t(()=>[n(f,null,{default:t(()=>[n(l,null,{default:t(()=>[n(Gi,{class:ot({hide:e(r)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),Ko=[{path:"/",name:"Home",component:Wt}];for(const i of kt)Ko.push({path:"/"+i+"/",strict:!0,name:i,component:Wt});Ya(Wt,{routes:Ko,base:"/avif2jpeg/dist/"},({app:i,router:s,routes:r,isClient:u,initialState:o})=>{i.use(zt)});
