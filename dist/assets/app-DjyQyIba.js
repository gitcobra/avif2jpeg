var pa=Object.defineProperty;var fa=(i,r,s)=>r in i?pa(i,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[r]=s;var Je=(i,r,s)=>fa(i,typeof r!="symbol"?r+"":r,s);import{r as w,a as zt,d as we,i as Qe,c as ee,o as C,_ as xe,u as e,w as t,b as S,t as d,e as b,f as n,g as Se,N as ke,L as ga,h as K,F as Oe,B as Ee,j as Ot,k as ut,l as ma,m as J,n as Re,p as Ye,q as va,s as ha,v as Ce,x as cn,y as Ne,z as Ut,A as ue,C as dn,D as pn,E as Mt,G as Te,H as Ie,I as Et,J as qe,K as _a,M as ya,O as Ze,P as kt,Q as pe,R as et,T as Ge,S as fn,U as We,V as gn,W as ct,X as xt,Y as tt,Z as vt,$ as wa,a0 as nt,a1 as ba,a2 as Gt,a3 as Kt,a4 as mn,a5 as za,a6 as Tt,a7 as ka,a8 as xa,a9 as Rt,aa as Ta,ab as Qt,ac as dt,ad as Ia,ae as vn,af as Sa,ag as Aa,ah as ot,ai as Pe,aj as It,ak as La,al as je,am as Ca,an as hn,ao as $a,ap as Ft,aq as _n,ar as Ea,as as Yt,at as yn,au as Fa,av as Pa,aw as Oa,ax as wn,ay as Ua,az as Ma,aA as Ra,aB as bn,aC as zn,aD as kn,aE as ja,aF as xn,aG as Da,aH as at,aI as lt,aJ as Na,aK as Ba,aL as Za,aM as Wa,aN as Ha,aO as Va,aP as Xt,aQ as qa,aR as Ga,aS as Ka,aT as Qa,aU as Ya,aV as Xa,aW as Ja,aX as el,aY as tl,aZ as nl,a_ as ol,a$ as al,b0 as ll}from"./vendor-DN75Llvx.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();const Me=w(navigator.hardwareConcurrency?Math.min(navigator.hardwareConcurrency,12):0),st={threadCount:{min:2,max:Math.max(2,Me.value)}},sl={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:Me.value,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1,changeLogCheckedDate:0,lang:""},N=zt(Tn({}));function il(){Tn(N)}function Tn(i){return Object.assign(i,sl)}const In="avif2jpeg",St=JSON.parse(localStorage.getItem(In)||"{}");for(const i in N)if(St.hasOwnProperty(i)&&St[i]!==void 0){let r=St[i];st.hasOwnProperty(i)&&(st[i].min>r&&(r=st[i].min),st[i].max<r&&(r=st[i].max)),N[i]=r}const Sn=()=>{const i={};for(const r in N)i[r]=N[r];localStorage.setItem(In,JSON.stringify(i))};window.addEventListener("beforeunload",Sn);function rl(){localStorage.clear(),window.removeEventListener("beforeunload",Sn)}const ul={href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-weight":"bolder"}},cl=we({__name:"github",setup(i){const r=Qe(Ve);return(s,l)=>{const a=ke,o=Se,u=xe;return C(),ee(u,{to:!1,"display-directive":"show",show:e(r).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:t(()=>[b("a",ul,[n(o,{align:"center",size:0},{default:t(()=>[n(a,{size:"1.2em"},{default:t(()=>[n(e(ga))]),_:1}),l[0]||(l[0]=S("GitHub "))]),_:1,__:[0]})])]),default:t(()=>[S(" "+d(s.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),dl=["href"],pl=we({__name:"licenses",setup(i){const r=w(!1),s={Vue:"https://github.com/vuejs/core/blob/main/LICENSE",Vite:"https://github.com/vitejs/vite/blob/main/LICENSE","Vite SSG":"https://github.com/antfu/vite-ssg/blob/main/LICENSE","Naive UI":"https://github.com/TuSimple/naive-ui/blob/main/LICENSE",Ionicons:"https://github.com/ionic-team/ionicons/blob/main/LICENSE"};return(l,a)=>{const o=Ee;return C(),K(Oe,null,[n(o,{text:"",onClick:a[0]||(a[0]=u=>r.value=!0),style:{color:"black","font-size":"small"}},{default:t(()=>a[2]||(a[2]=[S("Licenses")])),_:1,__:[2]}),n(e(Ot),{preset:"dialog",ref:"dialog",show:r.value,"onUpdate:show":a[1]||(a[1]=u=>r.value=u),"positive-text":"OK",title:"Licenses"},{default:t(()=>[a[3]||(a[3]=b("h3",null,"Frameworks and Libraries",-1)),b("ul",null,[(C(),K(Oe,null,ut(s,(u,c)=>b("li",null,[b("a",{href:u},d(c),9,dl)])),64))]),a[4]||(a[4]=b("h3",null,"App icon",-1)),a[5]||(a[5]=b("div",null,[S(" The app icon is derived from "),b("a",{href:"https://aomediacodec.github.io/av1-avif/"},"AVIF logo"),S(". ")],-1))]),_:1,__:[3,4,5]},8,["show"])],64)}}}),fl=1,gl=11,ml=4,vl="",ft={major:fl,minor:gl,build:ml,tag:vl},hl={style:{"font-size":"x-small","user-select":"none"}},_l=we({__name:"version",setup(i){const r=["0.0.118"],s=`${ft.major}.${ft.minor}.${ft.build}${ft.tag}`,l=r.map(c=>({label:`v${c}`,key:c,value:c}));function a(c){const{key:g,label:v}=c,_=u(g),x=J("a",{href:_},v),p=J("div",null,x);return J("div",null,p)}function o(c){location.href=u(c)}function u(c){return`/avif2jpeg/old/${c}/`}return(c,g)=>{const v=ma;return C(),ee(v,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:e(l),"render-label":a,"onUpdate:value":o},{header:t(()=>[b("span",hl,d(c.$t("previousVersion")),1)]),default:t(()=>[b("span",{style:{cursor:"pointer"}},"v"+d(s))]),_:1},8,["options"])}}}),yl={key:0,style:{color:"red"}},wl=["innerHTML"],bl=we({__name:"changelog",props:{url:{}},setup(i){const r=i,s=w("fetching..."),l=w(!1);Re(()=>o(r.url));let a=0;async function o(c){const g=await fetch(c,{headers:{Accept:"application/vnd.github.v3+json"}}).then(v=>v.ok?v.text():null);s.value="",g&&(s.value=g.replace(/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2}) \+\d+$/mg,(v,_)=>{const x=new Date(v),p=x.getTime(),h=x.toLocaleString();let f="";return p>N.changeLogCheckedDate&&(l.value=!0,p>a&&(a=p),f="update"),`<span class="date ${f}">${h}</span>`}))}function u(){a>N.changeLogCheckedDate&&(N.changeLogCheckedDate=a),l.value=!1}return(c,g)=>{const v=ke,_=Se,x=Ye;return C(),ee(x,{trigger:"click",placement:"bottom","arrow-point-to-center":"","onUpdate:show":u,style:{"margin-left":"-1em","max-width":"80%","white-space":"initial"}},{trigger:t(()=>[n(_,{align:"center",size:1,style:{cursor:"pointer"}},{default:t(()=>[n(v,{component:e(va),size:"1.5em",color:e(l)?"blue":"silver",style:{transition:"color 0.5s"}},null,8,["component","color"]),S(" "+d(c.$t("changelog")),1)]),_:1})]),default:t(()=>[e(s)?(C(),K("pre",{key:1,innerHTML:e(s),class:"commits"},null,8,wl)):(C(),K("div",yl," connection error "))]),_:1})}}}),zl="modulepreload",kl=function(i){return"/avif2jpeg/dist/"+i},Jt={},ze=function(r,s,l){let a=Promise.resolve();if(s&&s.length>0){let u=function(v){return Promise.all(v.map(_=>Promise.resolve(_).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),g=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=u(s.map(v=>{if(v=kl(v),v in Jt)return;Jt[v]=!0;const _=v.endsWith(".css"),x=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${x}`))return;const p=document.createElement("link");if(p.rel=_?"stylesheet":zl,_||(p.as="script"),p.crossOrigin="",p.href=v,g&&p.setAttribute("nonce",g),document.head.appendChild(p),_)return new Promise((h,f)=>{p.addEventListener("load",h),p.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${v}`)))})}))}function o(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return a.then(u=>{for(const c of u||[])c.status==="rejected"&&o(c.reason);return r().catch(o)})},An="English",Ln="üá¨üáß",Cn='AVIF to JPEG "Offline" Batch Converter',$n="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",En=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.',"Use this app at your own risk."],Fn="Select your language",Pn="Choose Target File Extentions",On={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},Un="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",Mn="Load Images",Rn="Select your images from a dialog window.<br>*Multiple selection allowed.",jn="Load a Whole Folder",Dn=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,Nn="Converting images",Bn="Aborted",Zn="Some files failed to convert",Wn="Completed",Hn="Currently Busy",Vn="No files with the extentions were found.",qn="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",Gn="Cancel",Kn="Save",Qn="Close",Yn="Open",Xn="Re-convert",Jn="Convert previous selected {n} @:files again",eo="File | Files",to="thread | threads",no="You have not saved the converted images yet.",oo="Data have not been saved",ao="Open Source",lo="Open the converted image",so="Copied to clipboard",io="The converted image was copied to your clipboard as DataURL.",ro="Copy the converted image as DataURL",uo="Convert Again",co={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",showOnlyErrors:"Show only errors",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files",Shrinked:"Shrinked",Shrinking:"Shrinking",saveAll:"Save All",progressRetries:"Retrying files",success:"success",started:"started",total:"total",files:"files",failure:"failure",all:"all",filterLogSelect:"filter",showOnlySuccess:"Only successes",showOnlyError:"Only errors",showAll:"Show all",Progress:"Progress",PreviewImage:"Preview Images",Log:"Log",log:"Log",Output:"Output Results",expandLog:"expand log size",autoScroll:"auto-scroll",sortByStatus:"status",sort:"Sort list by",sortByName:"name",sortBySize:"size",sortByOutputSize:"size(output)",sortByStart:"starting order",sortByCompletion:"output order"},po={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file"},fo="Disabled",go="Download",mo="Reset",vo="Back",ho="Failed",_o="Success",yo="Previous version",wo=`
Height`,bo="Width",zo="Don't show this message again",ko="About the warning when selecting a folder",xo="OK",To={},Io="You must press the ‚ÄúUpload‚Äù button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",So="Continue",Ao="Cancel",Lo="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",Co="This page may be an outdated version. Please reload the page.",$o="Reload",Eo='If the conversion process frequently fails and an ‚ÄúOut of Memory‚Äù message appears, try reducing or disabling the number of "multi-threads" in the "Advanced Settings".',Fo="Next",Po="Previous",Oo="or",Uo="Source Image Extensions",Mo="Changelog",Ro="Choose source image extensions",jo="Drag & Drop AVIF Images to Convert",Do="Or just drag & drop",No="Install as App",Bo="A new version of the page is available. Click the reload button to update.",Zo='Installing allows you to launch this web app directly from desktop icons or other shortcuts. The security level is the same as a regular web page, so it remains safe. For more details, please see <a href="https://support.google.com/chrome/answer/9658361">Google‚Äôs support page</a>.',Wo="Use the browser‚Äôs language setting",Ho="Installed as an app",Vo={lang:An,flags:Ln,title:Cn,metaDescription:$n,descriptions:En,selectLanguage:Fn,fileTypeRadioTitle:Pn,fileTypeRadioOptions:On,editAcceptTypes:Un,loadbutton:Mn,loadbuttontooltip:Rn,loadfolderbutton:jn,loadfoldertooltip:Dn,processing:Nn,aborted:Bn,incomplete:Zn,completed:Wn,interfered:Hn,noimage:Vn,avifUnsupported:qn,cancel:Gn,save:Kn,close:Qn,open:Yn,reconvert:Xn,reconvertTip:Jn,files:eo,threads:to,confirmCloseDialog:no,confirmCloseDialogTitle:oo,githubOpenSource:ao,convertedImageUrlTooltip:lo,copiedDataURLDialogTitle:so,copiedDataURLMessage:io,convertedImageDataUrlTooltip:ro,convertAgain:uo,status:co,settings:po,disabled:fo,Download:go,reset:mo,back:vo,failed:ho,success:_o,previousVersion:yo,height:wo,width:bo,checkboxTextDontShowThis:zo,loadfolderNotifyingTitle:ko,OK:xo,loadfolderNotifyingMessage:To,loadfolderNotifyingMessageTerm2:Io,Continue:So,Cancel:Ao,loadfolderNotifyingMessageTerm1:Lo,errMsgWorkerLoadError:Co,Reload:$o,annotationOutOfMemory:Eo,Next:Fo,Prev:Po,or:Oo,TargetFileTypeExt:Uo,changelog:Mo,TargetFileTypeExtTooltip:Ro,droptargetTooltip:jo,droptargetLabel:Do,installAsApp:No,PWAUpdateMessage:Bo,PWAinstallAsAppTooltip:Zo,selectLangCloseTooltip:Wo,PWAInstalledTooltip:Ho},xl=Object.freeze(Object.defineProperty({__proto__:null,Cancel:Ao,Continue:So,Download:go,Next:Fo,OK:xo,PWAInstalledTooltip:Ho,PWAUpdateMessage:Bo,PWAinstallAsAppTooltip:Zo,Prev:Po,Reload:$o,TargetFileTypeExt:Uo,TargetFileTypeExtTooltip:Ro,aborted:Bn,annotationOutOfMemory:Eo,avifUnsupported:qn,back:vo,cancel:Gn,changelog:Mo,checkboxTextDontShowThis:zo,close:Qn,completed:Wn,confirmCloseDialog:no,confirmCloseDialogTitle:oo,convertAgain:uo,convertedImageDataUrlTooltip:ro,convertedImageUrlTooltip:lo,copiedDataURLDialogTitle:so,copiedDataURLMessage:io,default:Vo,descriptions:En,disabled:fo,droptargetLabel:Do,droptargetTooltip:jo,editAcceptTypes:Un,errMsgWorkerLoadError:Co,failed:ho,fileTypeRadioOptions:On,fileTypeRadioTitle:Pn,files:eo,flags:Ln,githubOpenSource:ao,height:wo,incomplete:Zn,installAsApp:No,interfered:Hn,lang:An,loadbutton:Mn,loadbuttontooltip:Rn,loadfolderNotifyingMessage:To,loadfolderNotifyingMessageTerm1:Lo,loadfolderNotifyingMessageTerm2:Io,loadfolderNotifyingTitle:ko,loadfolderbutton:jn,loadfoldertooltip:Dn,metaDescription:$n,noimage:Vn,open:Yn,or:Oo,previousVersion:yo,processing:Nn,reconvert:Xn,reconvertTip:Jn,reset:mo,save:Kn,selectLangCloseTooltip:Wo,selectLanguage:Fn,settings:po,status:co,success:_o,threads:to,title:Cn,width:bo},Symbol.toStringTag,{value:"Module"})),Tl="Arabic",Il="German",Sl="English",Al="Spanish",Ll="Finnish",Cl="French",$l="Hindi",El="Indonesian",Fl="Italian",Pl="Japanese",Ol="Korean",Ul="Dutch",Ml="Polish",Rl="Portuguese",jl="Russian",Dl="Turkish",Nl="Ukrainian",Bl="Chinese",Zl={ar:Tl,de:Il,en:Sl,es:Al,fi:Ll,fr:Cl,hi:$l,id:El,it:Fl,ja:Pl,ko:Ol,nl:Ul,pl:Ml,pt:Rl,ru:jl,tr:Dl,uk:Nl,"zh-hant":"Chinese(hant)",zh:Bl},it=[],qo={en:Vo},jt={},en=Object.assign({"./locales/ar.json":()=>ze(()=>import("./ar-BCwJwSOe.js"),[]),"./locales/de.json":()=>ze(()=>import("./de-Dav8UAql.js"),[]),"./locales/en.json":()=>ze(()=>Promise.resolve().then(()=>xl),void 0),"./locales/es.json":()=>ze(()=>import("./es-DiG0cPVO.js"),[]),"./locales/fi.json":()=>ze(()=>import("./fi-CJ7eRb1B.js"),[]),"./locales/fr.json":()=>ze(()=>import("./fr-CrAyd6-S.js"),[]),"./locales/hi.json":()=>ze(()=>import("./hi-DQ_dcued.js"),[]),"./locales/id.json":()=>ze(()=>import("./id-B-UrEhSH.js"),[]),"./locales/it.json":()=>ze(()=>import("./it-DJTBBHm0.js"),[]),"./locales/ja.json":()=>ze(()=>import("./ja-DKr0Mpni.js"),[]),"./locales/ko.json":()=>ze(()=>import("./ko-pIlEATZL.js"),[]),"./locales/nl.json":()=>ze(()=>import("./nl-BDeiLMZ_.js"),[]),"./locales/pl.json":()=>ze(()=>import("./pl-CVWOyDVL.js"),[]),"./locales/pt.json":()=>ze(()=>import("./pt-CSs4Ul4K.js"),[]),"./locales/ru.json":()=>ze(()=>import("./ru-DDfSOvoB.js"),[]),"./locales/tr.json":()=>ze(()=>import("./tr-B1Vk8hgp.js"),[]),"./locales/uk.json":()=>ze(()=>import("./uk-DC5w1r7d.js"),[]),"./locales/zh-hant.json":()=>ze(()=>import("./zh-hant-8PCSQrWu.js"),[]),"./locales/zh.json":()=>ze(()=>import("./zh-BIahqxaA.js"),[])});var un;for(const i in en){const r=(un=i.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:un[1];r&&(it.push(r),!(r in qo)&&(jt[r]=en[i]))}let Pt=Hl();Pt in jt||(Pt="en");const ht=ha({legacy:!1,globalInjection:!0,locale:Pt,fallbackLocale:"en",messages:qo,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Wl(i){if(ht.global.availableLocales.indexOf(i)>=0)return!0;const r=await jt[i]().catch(s=>{});return r?(ht.global.setLocaleMessage(i,r),await Ce(),!0):!1}function Hl(){const i=location.pathname;return String(i.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Vl=we({__name:"header",setup(i){const r=cn(),{locale:s}=Ne();return(l,a)=>{const o=Ut("router-link"),u=Se,c=pn;return C(),ee(u,{vertical:"",justify:"start"},{default:t(()=>[n(u,{justify:"space-between",align:"center",wrap:!1},{default:t(()=>[n(u,{align:"center"},{default:t(()=>[n(cl),n(_l),n(bl,{url:"/avif2jpeg/dist/commits.txt"}),n(pl),n(u,{style:{"font-size":"1em"}},{default:t(()=>[e(r).path!=="/"?(C(),ee(o,{key:0,to:"/",style:{color:"black"}},{default:t(()=>a[0]||(a[0]=[S("HOME")])),_:1,__:[0]})):ue("",!0)]),_:1})]),_:1}),n(u,{align:"end",id:"langtarget"},{default:t(()=>[dn(l.$slots,"lang-switch")]),_:3})]),_:3}),n(c,{style:{margin:"0px"}})]),_:3})}}}),ql="/avif2jpeg/dist/pwa-64x64.png",Gl={style:{padding:"0px",margin:"0px","text-align":"center"}},Kl=we({__name:"title",setup(i){const r=Mt();return Te(()=>{const s=r.currentRoute.value.path||"";return!String(s.match(new RegExp("(?<=^\\/)[^/]+"))||"")}),(s,l)=>{const a=Se;return C(),ee(a,{align:"center",justify:"center",style:{margin:"0px"}},{default:t(()=>[b("h1",Gl,[l[0]||(l[0]=b("img",{src:ql,style:{height:"1em","vertical-align":"middle"}},null,-1)),S(" "+d(s.$t("title")),1)])]),_:1})}}}),tn=new Set,Ql=new Set,Yl=new Set,_t=new Map;function Xl(i){const r=_t.get(i);r&&(_t.delete(i),r(),gt==null||gt(),gt=null)}function Jl(){for(const i of _t.keys())Xl(i)}let gt=null;function Go(){Jl();for(const i of tn)i.onmessage=null,i.terminate();tn.clear(),Ql.clear(),Yl.clear(),_t.clear()}function es(i){return new Worker("/avif2jpeg/dist/assets/worker.zip-Bt_6u_43.js",{name:i==null?void 0:i.name})}function ts(i){return new Worker("/avif2jpeg/dist/assets/worker.loader-D7gK7Qbe.js",{name:i==null?void 0:i.name})}const ns=1e3*10;let Ke;const De=new Map,yt=new Map,wt=new Map;let Dt,te,Nt,bt,mt,Ko,Qo,Yo,Xo,pt;function At(i){if({files:mt,completedFileIdSet:Dt,ConvStats:te,canceled:Nt,props:bt,format:Ko,quality:Qo,outputExt:Yo,imageType:Xo,message:pt}=i||{},Ke=null,De.clear(),yt.clear(),wt.clear(),yt.clear(),wt.clear(),i)for(const s in i)delete i[s]}async function os(i){At(i),Dt.clear();let r;try{r=await as()}catch{return At(),{exception:new Error("worker-load-error"),callbackToClearConverter:new Function,callbackToGenerateFailedZips:new Function}}const[s,l]=r;Ke=l;const a=new Promise(p=>{l.onmessage=h=>{const f=h.data,{action:k}=f;switch(k){case"squeeze-zip":case"zip-squeeze-error":p(void 0);break}}}),o=new Promise(p=>{s.onmessage=h=>{const{data:{action:f}}=h;f==="close-loader"&&p()}}),u=mt.map(p=>[p._id,p.webkitRelativePath]);mt.forEach(p=>yt.set(p._id,p));const c=Ie(Nt,p=>{if(!p)return;c();const h={action:"cancel-convert"};s.postMessage(h)}),g={action:"start-convert",list:mt,extraPropsForList:u,outputQuality:Qo,outputType:Ko,threads:bt.threads,maxSize:N.shrinkImage?{width:N.maxWidth,height:N.maxHeight}:null};s.postMessage(g),await o,l.postMessage({action:"squeeze"}),await a,c();const v=()=>{Go(),l.onmessage=null,l.terminate(),s.onmessage=null,s.terminate(),At()};let _=!1;return{callbackToClearConverter:v,callbackToGenerateFailedZips:async p=>{_||(_=!0,await fs(p,l,{},te))}}}async function as(){Go();const i=new ts,r=new es,s=new Promise((u,c)=>{const g=h=>{r.removeEventListener("message",x),i.removeEventListener("message",x),clearTimeout(p),h?u(h):c(h)};let v=!1,_=!1;const x=h=>{h.target===r&&(v=!0),h.target===i&&(_=!0),v&&_&&g(!0)};let p=0;r.addEventListener("message",x),i.addEventListener("message",x),p=window.setTimeout(()=>g(!1),ns)}),{port1:l,port2:a}=new MessageChannel,o={action:"set-zip-port"};return r.postMessage({action:"set-port-loader"},[l]),i.postMessage(o,[a]),await s,r.postMessage({action:"set-config",zipSize:bt.maxZipSizeMB*1024*1024,keepExt:bt.retainExtension,outputExt:Yo,imageType:Xo}),i.addEventListener("message",ss),r.addEventListener("message",ls),[i,r]}const ls=i=>{const r=i.data,{action:s}=r;switch(s){case"add-zip-completed":{const{fileId:u,entireIndex:c,storedPath:g}=r;return}case"respond-image":{const{url:u,index:c,path:g,size:v,fileId:_}=r;te.convertedImageUrl=u,te.convertedImageSize=v,te.convertedImageIndex=c,te.convertedImageName=g;let x="",p=0,h="";const f=De.get(_);if(_>=0){const k=yt.get(_);x=URL.createObjectURL(k),p=k.size,h=k.webkitRelativePath||k.name}te.convertedImageOrgUrl=x,te.convertedImageOrgSize=p,te.convertedImageOrgName=h,te.convertedImageShrinked=f==null?void 0:f.shrinked;return}case"respond-delete":{const{index:u,success:c,fileId:g}=r;De.get(g).command="‚ùådeleted",De.get(g).completed=!1;return}}switch(s){case"error-push-filelist-zip":const{path:u}=r;te.failedZipDone=!0,pt.error(`an error occurred "${u}"`,{duration:3e3});return}const{size:l,count:a}=r,o="url"in i.data?i.data.url:"";switch(s){case"push-zip":te.zips.push({url:o,size:l,count:a}),te.zippedTotalCount+=a,te.zippedTotalSize+=l;break;case"squeeze-zip":a>0&&(te.zips.push({url:o,size:l,count:a}),te.zippedTotalCount+=a,te.zippedTotalSize+=l);break;case"push-filelist":te.failedFileZippedCount++;break;case"squeeze-filelist-zip":te.failedZipDone=!0;case"push-filelist-zip":te.failedZips.push({url:o,size:l,count:a});break;case"zip-error":case"zip-squeeze-error":te.zippingErrorCount+=a;break}},ss=i=>{i.target;const{data:r}=i,{action:s}=r;switch(s){case"list-start":break;case"list-end":break;case"file-start":{const{index:l,path:a,fileId:o}=r;rs(l,a,o);break}case"file-load":{const{thumbnail:l,width:a,height:o,fileId:u,workerId:c,inputsize:g}=r,v=De.get(u);v.core=c,v.command="üñºÔ∏èloaded",v.width=a,v.height=o,v.size=g,l&&(te.thumbnail=l);break}case"file-converted":{const{index:l,path:a,fileId:o,shrinked:u,outputWidth:c,outputHeight:g,outputsize:v}=r,_=De.get(o);_.command="üîÉconverted",_.shrinked??(_.shrinked=u),_.outputWidth=c,_.outputHeight=g,_.outputSize=v,te.converted++;break}case"file-completed":{const{inputsize:l,outputsize:a,fileId:o,entireIndex:u,storedPath:c}=r,g=De.get(o);g&&(g.command="‚úÖcompleted",g.completed=!0,g.fileId=o),te.inputTotalSize+=l,te.outputTotalSize+=a,te.done++,te.success++,Dt.add(o),g.zippedIndex=u,te.ziplogs[u]={fileId:o,storedPath:c};break}case"file-retry":{const{index:l,path:a,fileId:o}=r;us(l,a,o);break}case"file-error":{const{index:l,path:a,fileId:o}=r;cs(l,a,o);break}case"file-canceled":{const{fileId:l,path:a}=r;ds(l);break}}};let is=0;function rs(i,r,s){const l={key:is++,core:-1,index:i,path:r,command:"‚û°Ô∏èstarted"};De.set(s,l),te.logs.push(l),wt.has(s)||Nt.value||te.startedCount++}function us(i,r,s){const l=De.get(s);l.command="‚ö†Ô∏èretrying",l.error=!0,pt.warning(`retrying "${r}"`,{duration:3e3}),te.retried++,wt.set(s,1)}function cs(i,r,s){const l=De.get(s);te.done++,te.failure++,l.command="‚ùófailed",l.error=!0,pt.error(`failed to load "${r}"`,{duration:5e3})}function ds(i){const r=De.get(i);te.done++,te.failure++,r.command="‚ùócanceled",r.error=!0}function ps(i){Ke==null||Ke.postMessage({action:"request-image",index:i})}function Lt(i){Ke==null||Ke.postMessage({action:"delete-image",index:i})}async function fs(i,r,s,l){let a=0;for(const o of i){const u=(o.webkitRelativePath||o.name).replace(/^\//,"");if(l.failedZipDone)break;if(s.value)return;a-l.failedFileZippedCount>20&&await new Promise(c=>setTimeout(c,10)),r.postMessage({action:"add-filelist",file:o,path:u}),a++}if(l.failedZipDone){pt.error("Zipping error files was aborted",{duration:5e3});return}r.postMessage({action:"squeeze-filelist"})}function He(i,r=2){const s=Math.sign(i);i=Math.abs(i);const l=["Bytes","KB","MB","GB"],a=i?Math.floor(Math.log(i)/Math.log(1024)):0;return`${(i/Math.pow(1024,a)*s).toFixed(r)}${l[a]}`}function Jo(i,r=100,s=!1){r=typeof r=="number"?{width:r,height:r}:r;const{width:l,height:a}=r;let{width:o,height:u}=i;const c=o/u,g=l/a;return c>=g?(o=s?Math.min(l,o):l,u=o/c|0):(u=s?Math.min(a,u):a,o=u*c|0),{width:o,height:u}}class gs{constructor(){Je(this,"_currentFileCount",0);Je(this,"_currentZipIndex",0);Je(this,"_totalFileCount",0);Je(this,"_zipLengthSumList",[]);Je(this,"_pathBank",{})}increase(r){return r&&(this._pathBank[r]=[this._zipLengthSumList.length,this._currentFileCount]),this._currentFileCount++,this._totalFileCount++}split(){this._zipLengthSumList.push(this._totalFileCount),this._currentZipIndex++,this._currentFileCount=0}get(r){if(typeof r=="number"){let s=this._zipLengthSumList.findIndex((o,u)=>r<o);s===-1&&(s=this._zipLengthSumList.length);const l=this._zipLengthSumList[s-1]||0,a=r-l;return[s,a]}else{const s=this._pathBank[String(r)];if(s)return s}return null}getZipIndex(){return this._currentZipIndex}getIndex(){return this._totalFileCount}}function ms(i){return new Promise(r=>setTimeout(r,i))}function vs(i,r=0){const s=w(i);return Ie(s,l=>{l!==void 0&&Ce(()=>{setTimeout(()=>s.value=void 0,r)})},{immediate:!0}),s}let rt;async function hs(i,r,s,l,a){let o="";const u=document.createElement("canvas"),c=u.getContext("2d");let g=new Et;const v=[g],_=new gs,x=s.format,p=s.quality/100,h=[...x.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),f=i.length,k=s.maxZipSizeMB*1024*1024;let O=0,F=null,z="",y="",E=0,D=0,W=0,P=0,M=0,T=!1;rt=$=>{const[H,Y]=_.get($),ce=v[H],ie=ce.get(Y,x);a.convertedImageIndex=$,a.convertedImageName=ce.getPathByIndex(Y),a.convertedImageUrl=URL.createObjectURL(ie),a.convertedImageSize=ie.size;let de="",se=0,Le="";const V=Q[$];de=URL.createObjectURL(V),se=V.size,Le=V.webkitRelativePath||V.name,a.convertedImageOrgUrl=de,a.convertedImageOrgSize=se,a.convertedImageOrgName=Le};const Q=[];for(const $ of i){if(l.value)break;const H=$.name;let Y="";const ce=$.size,ie=($.webkitRelativePath||$.relativePath||H).replace(/^\//,""),de=document.createElement("img"),se={key:W++,core:-1,index:O++,path:ie,command:"‚û°Ô∏èstart"};a.startedCount=O,a.logs.push(se),a.logs.length-1,o&&(URL.revokeObjectURL(o),o=""),o=URL.createObjectURL($),y=o,E=$.size,de.src=o;const Le=await ea(de).then(()=>!0).catch(()=>!1);if(!de.complete||!Le||l.value){a.done++,a.failure++,se.command="‚ùófailed";continue}const V=de.width,R=de.height;u.width=V,u.height=R,c.drawImage(de,0,0,V,R,0,0,V,R),se.command="üñºÔ∏èimgload",se.width=V,se.height=R,se.size=$.size,a.thumbnail=de;const B=await new Promise(le=>{const me=Fe=>{F=Fe,le(Fe)};u.toBlob(me,x,p)});if(l.value)break;if(!B){a.failure++;continue}D=B.size,a.converted++,se.outputSize=D;let ne="";if(M+D>=k){try{await g.wait(),ne=await g.url()}catch{T=!0,alert("memory problem occurred");break}a.zips.push({url:ne,size:M,count:P}),a.zippedTotalCount+=P,a.zippedTotalSize+=M,M=0,P=0,_.split(),g=new Et,v.push(g)}M+=D;const oe=ie||H;for(let le=1;le<255&&(Y=oe.replace(s.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(le>1?`(${le})`:"")+"."+h,!!g.has(Y));le++);a.done++;try{P++,g.add(Y,B)}catch{continue}_.increase(),Q.push($),a.inputTotalSize+=ce,a.outputTotalSize+=D,a.ziplogs.push({fileId:$._id,storedPath:Y}),z=Y,se.zippedIndex=a.success,a.success++,se.command="‚úÖcompleted",se.completed=!0,se.fileId=$._id,r.add($._id)}if(a.success>0)if(f===1)F&&(a.convertedImageIndex=0,a.convertedImageName=z.replace(/^.*\/(?=[^/]+$)/,"").replace(s.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+h,a.convertedImageUrl=URL.createObjectURL(F),a.convertedImageOrgUrl=y,a.convertedImageOrgSize=E);else try{if(T)throw new Error("terminated zipping process for memory problems");await g.wait();const $=await g.url();a.zips.push({url:$,count:P,size:M}),a.zippedTotalCount+=P,a.zippedTotalSize+=M}catch{}const ae={value:!1},ge=()=>{ae.value=!0,v.forEach($=>$.clear()),v.length=0,Q.length=0,rt=null};let Ae=!1;return{callbackToClearConverter:ge,callbackToGenerateFailedZips:async $=>{Ae||(Ae=!0,ys($,k,a,ae))}}}function _s(i){rt==null||rt(i)}async function ys(i,r,s,l){let a=0,o=0,u=new Et;for(let c=0;c<i.length;c++){const g=i[c],v=(g.webkitRelativePath||g.name).replace(/^\//,"");if(l.value)return;try{await u.add(v,g)}catch{alert(`an error occurred during access to "${v}"`);break}if(o+=g.size,a++,s.failedFileZippedCount++,o>=r||c===i.length-1){await u.zip();const _=await u.url();s.failedZips.push({url:_,size:o,count:a}),u.clear(),o=0,a=0}}s.failedZipDone=!0}function ea(i){if(typeof i.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((r,s)=>{i.onload=r,i.onerror=s})}const ws=["href","download","title"],bs='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',zs=we({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean},hidden:{type:Boolean}},emits:["load","error","next","prev"],setup(i,{expose:r,emit:s}){const{t:l}=Ne(),a=i,o=s,u=w();w();const c=w(!0),g=w(""),v=w(a.width||100),_=w(a.height||100),x=w(!1),p=zt({width:v.value+"px",height:_.value+"px",minWidth:"50px",minHeight:"50px"});qe(()=>{var y,E,D;(E=(y=u.value)==null?void 0:y.previewInstRef)==null||E.setPreviewSrc(bs),URL.revokeObjectURL((((D=u.value)==null?void 0:D.imageRef)||{}).src),u.value=null});const h=w(!0);_a(()=>{h.value=!1}),ya(()=>{h.value=!0}),Ie(a,(y,E)=>{p.width=(a.width||100)+"px",p.height=(a.height||100)+"px"}),Ie(()=>a.src,(y,E)=>{h.value&&O(y)},{immediate:!0}),r({download:F,openPreview:z,active:h});async function f(y){const E=y.target,D=E.naturalWidth,W=E.naturalHeight,{width:P,height:M}=Jo({width:D,height:W},{width:a.maxWidth||100,height:a.maxHeight||100},a.expand);v.value=P,_.value=M,o("load",{src:E.src,width:D,height:W}),c.value=!1,await new Promise(T=>setTimeout(T,100)),!c.value&&(x.value=!0)}function k(y){const E=y.target;o("error",E.src)}async function O(y){c.value=!0,x.value=!1,g.value=y}function F(){const y=document.createElement("a");y.href=g.value,y.download=a.fileName,y.click()}function z(){var y;(y=u.value)==null||y.click()}return(y,E)=>{const D=fn,W=gn,P=Se,M=kt;return Ze((C(),K("div",null,[n(e(xe),null,{trigger:t(()=>[n(M,{show:e(c)||a.loading},{default:t(()=>[n(P,{justify:"center",align:"center",style:pe([e(p),{"line-height":"0px"}])},{default:t(()=>[Ze(b("a",{href:e(g),onClick:E[0]||(E[0]=et(()=>{},["left","prevent"])),target:"_blank",download:a.fileName,title:a.fileName},[n(Ge,{mode:"in-out"},{default:t(()=>[Ze(n(D,{ref_key:"nImageRef",ref:u,"show-toolbar-tooltip":"",onLoad:f,onError:k,src:e(g),width:e(v),height:e(_),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[We,e(x)]])]),_:1})],8,ws),[[We,!(e(c)||a.loading)]]),Ze(n(W,null,null,512),[[We,e(c)||a.loading]])]),_:1},8,["style"])]),_:1},8,["show"])]),default:t(()=>[S(" "+d(a.fileName),1)]),_:1})],512)),[[We,!y.hidden]])}}}),Be=(i,r)=>{const s=i.__vccOpts||i;for(const[l,a]of r)s[l]=a;return s},nn=Be(zs,[["__scopeId","data-v-a62add3a"]]),ks=["href","download","title"],xs={class:"left-num"},Ts={class:"right-num"},Is=["href","download","title"],Ss={class:"left-num"},As={class:"right-num"},Ls=["href","download"],Cs=we({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean},variousInfo:{}},emits:["demand-image","delete-image","close"],setup(i,{expose:r,emit:s}){const l=Qe(Ve),a=i,o=s;r({download:R,cleanup:G,openPreview:U,isPreviewing(){return P.value},changeIndex(A){h.value=A}});const u=ct(),{t:c}=Ne();xt();const g=w(),v=w(),_=w(),x=tt("viewerItemContainer"),p=w(!0),h=w(Math.max(a.index,0)+1),f=w(1),k=w(1),O=w(""),F=w(""),z=w(1),y=w(1),E=w(!1),D=w(!1),W=w(!1),P=Te(()=>{var A,L;return(L=(A=_.value)==null?void 0:A.previewInstRef)==null?void 0:L.displayed}),M=Te(()=>{var A,L;return((L=(A=_==null?void 0:_.value)==null?void 0:A.previewInstRef)==null?void 0:L.previewSrc)===O.value}),T=Te(()=>h.value<a.length),Q=Te(()=>h.value>1),ae=w("viewer-item-init"),ge=w(0),Ae=w(!0);w({width:"auto",height:"auto"});const j=w(!1);Re(()=>{document.body.addEventListener("keydown",se),document.body.addEventListener("keydown",de),ce(h.value-1),ie()}),qe(()=>{clearTimeout($),document.body.removeEventListener("keydown",se),document.body.removeEventListener("keydown",de),j.value=!0}),vt(()=>{URL.revokeObjectURL(a.url),URL.revokeObjectURL(a.originalUrl)});let $=-1;Ie(h,(A,L)=>{h.value<1||h.value>a.length||A===L||(clearTimeout($),A>L?ae.value="viewer-item-next":ae.value="viewer-item-prev",$=setTimeout(()=>{a.index!==h.value-1&&(ge.value=p.value?ge.value:~ge.value,Ae.value=!1,ce(h.value-1))},50))});let H="",Y="";Ie(()=>a.url,()=>{var m,I;let A="";a.index===0&&p.value?(p.value=!1,h.value=1,A=a.url):a.index===h.value-1?(p.value=!1,E.value=!1,A=a.url):(URL.revokeObjectURL(a.url),URL.revokeObjectURL(a.originalUrl));const L=H,X=Y;if(URL.revokeObjectURL(L),URL.revokeObjectURL(X),H=a.url,Y=a.originalUrl,A){try{if((I=(m=_.value)==null?void 0:m.previewInstRef)!=null&&I.displayed){M.value?_.value.previewInstRef.setPreviewSrc(A):_.value.previewInstRef.setPreviewSrc(a.originalUrl);try{const q=_.value.previewInstRef.displayed;_.value.previewInstRef.handleAfterLeave(),_.value.previewInstRef.displayed=q}catch{}}}catch{}O.value=A,F.value=a.originalUrl}},{immediate:!0});function ce(A){E.value=!0,D.value=!1,W.value=!1,Ce(()=>o("demand-image",A))}function ie(){if(!l.IS_SP)return;let A=x.value.$el,L=0,X=0,m=0,I=0,q=0;const _e=he=>{L=he.touches[0].pageX,X=he.touches[0].pageY,q=Date.now()};A.addEventListener("touchstart",_e);const ve=he=>{m=he.touches[0].pageX,I=he.touches[0].pageY,re()};window.addEventListener("touchmove",ve);const Z=()=>{re();const he=m-L,$e=Math.abs(he),Xe=I-X,ye=Math.abs(Xe);$e<ye||$e<30||ne(he>0?-1:1)};window.addEventListener("touchend",Z);const re=()=>{const he=Date.now();he-q>500&&(L=m,X=I),q=he};qe(()=>{A.removeEventListener("touchstart",_e),window.removeEventListener("touchmove",ve),window.removeEventListener("touchend",Z),A=null})}function de(A){var L,X,m,I;if(A.key==="Escape")try{(X=(L=_.value)==null?void 0:L.previewInstRef)!=null&&X.displayed&&(A.stopPropagation(),(I=(m=_.value)==null?void 0:m.previewInstRef)==null||I.toggleShow(!1))}catch{}}function se(A){switch(A.code){case"ArrowRight":ne(1);break;case"ArrowLeft":ne(-1);break;case"Home":h.value=1;break;case"End":h.value=a.length;break;case"Space":case"Enter":case"NumpadEnter":if(!P.value)return;le();break;case"ArrowUp":case"ArrowDown":default:return}A.stopPropagation(),A.preventDefault()}function Le({width:A,height:L}){f.value=A,k.value=L,D.value=!0}function V({width:A,height:L}){z.value=A,y.value=L,W.value=!0}function R(){M.value?g.value.download():v.value.download()}async function B(A){try{const L=await fetch(A).then(X=>X.blob()).then(X=>new Promise(m=>{const I=new FileReader;I.onload=m,I.readAsDataURL(X)})).then(X=>X.target.result);navigator.clipboard.writeText(L),u.info({title:c("copiedDataURLDialogTitle"),content:()=>J("div",[J("div",c("copiedDataURLMessage"))]),positiveText:"OK"})}catch{u.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function ne(A){A>0?h.value=Math.min(a.length,h.value+A)|0:A<0&&(h.value=Math.max(1,h.value+A)|0)}let oe="";const le=()=>{var L,X,m,I;oe=(m=window.getComputedStyle((X=(L=_==null?void 0:_.value)==null?void 0:L.previewInstRef)==null?void 0:X.previewRef))==null?void 0:m.transform;const A=M.value;(I=_==null?void 0:_.value)==null||I.next(),Ce(()=>{var q;M.value===A&&((q=_==null?void 0:_.value)==null||q.next())})};function me(){try{Ce(()=>_.value.previewInstRef.previewRef.style.transform=oe)}catch{}}function Fe({nodes:A}){const L=J(Rt,{color:M.value?"green":"gray",offset:[-20,-12],value:M.value?c("status.Converted"):c("status.Original")},()=>J(Ee,{round:!0,onClick(){le()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>J(M.value?ka:xa)}));A.next=J(Ee,{onClick(){ne(1)},disabled:!T.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>J(Kt)}),A.prev=J(Ee,{onClick(){ne(-1)},disabled:!Q.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>J(Ta)});try{const X=A.download.children;X.default=()=>c("save");const m=X.trigger();m.props.onClick=R,X.trigger=()=>m}catch{}return fe(),[L,...Object.values(A)]}const Ue="#pathbox-"+String(Math.random()).substring(2);let be;function fe(){var A,L,X;try{if(be=(X=(L=(A=_.value)==null?void 0:A.previewInstRef)==null?void 0:L.previewWrapperRef)==null?void 0:X.parentNode,!be||be.querySelector(Ue))return;let m=J("div",{id:Ue,onMousedown:I=>{I.stopPropagation()},className:"__preview-injected-pathbox"+(M.value?" converted":"")},[J("div",`${String(h.value).padStart(String(a.length).length,"0")}/${String(a.length).padStart(String(a.length).length,"0")}`),J("div",He(M.value?a.size:a.originalSize,0)),J("div",M.value?a.name:a.originalName)]);Qt(m,be),m=null}catch{}}qe(()=>{be&&(Qt(null,be),be=null)});function U(){g.value.openPreview()}function G(){}return(A,L)=>{const X=ke,m=Se,I=mn,q=Ye,_e=Tt,ve=wa;return C(),ee(m,{justify:"center",align:"stretch",vertical:"",style:pe([{visibility:p.value?"hidden":"visible"},{overflow:"visible"}]),class:"body",ref:"body"},{default:t(()=>[n(ve,{ref_key:"nImageGroupRef",ref:_,"show-toolbar-tooltip":"","render-toolbar":Fe,onPreviewNext:me},{default:t(()=>[n(m,{wrap:!1,align:"center",justify:"space-between",style:{overflow:"visible"}},{default:t(()=>[n(e(Ee),{onClick:L[0]||(L[0]=Z=>ne(-1)),bordered:!1,disabled:!e(Q),class:nt({"thumb-arrow":!0,pale:!e(Q)}),title:A.$t("Prev")},{icon:t(()=>[n(X,{size:"30"},{default:t(()=>[n(e(ba))]),_:1})]),_:1},8,["disabled","class","title"]),n(m,{justify:"center",ref_key:"viewerItemContainer",ref:x,class:"viewer-item-container",style:{width:"100%"}},{default:t(()=>[n(Ge,{name:ae.value},{default:t(()=>[(C(),ee(m,{vertical:"",key:ge.value},{default:t(()=>[n(m,{align:"center",wrap:!1},{default:t(()=>[n(m,{vertical:""},{default:t(()=>[n(m,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(m,{align:"center",justify:"center",vertical:"",class:"original-thumb"},{default:t(()=>[b("a",{href:A.originalUrl,onClick:L[4]||(L[4]=et(Z=>{v.value.openPreview()},["prevent"])),download:A.originalName,title:A.originalName,class:"imglink"},[n(m,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(nn,{ref:Z=>{Z!=null&&Z.active&&(v.value=Z)},src:F.value,width:1,"max-width":1,"max-height":1,loading:E.value,"file-name":A.originalName,"allow-next":h.value<a.length,"allow-prev":h.value>1,onLoad:V,onNext:L[1]||(L[1]=Z=>ne(1)),onPrev:L[2]||(L[2]=Z=>ne(-1)),hidden:!0},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(m,{vertical:"",align:"center"},{default:t(()=>[n(m,{class:"imglink-label"},{default:t(()=>[S(d(e(c)("status.Original")),1)]),_:1}),n(m,{justify:"center",class:"img-size",wrap:!1,size:2},{default:t(()=>[b("span",xs,d(W.value?z.value:"?"),1),L[11]||(L[11]=S(" √ó ")),b("span",Ts,d(W.value?y.value:"?"),1)]),_:1,__:[11]}),n(m,{justify:"center"},{default:t(()=>[L[3]||(Gt(-1,!0),(L[3]=n(m,null,{default:t(()=>[S(d(W.value?e(He)(a.originalSize,0):"?"),1)]),_:1})).cacheIndex=3,Gt(1),L[3])]),_:1})]),_:1})]),_:1})],8,ks)]),_:1}),n(m,{vertical:"",align:"center",class:"original-thumb"},{default:t(()=>[n(X,{size:"20",color:"silver",component:e(Kt)},null,8,["component"])]),_:1}),b("a",{href:O.value,onClick:L[5]||(L[5]=et(Z=>U(),["prevent"])),download:a.name,title:a.name,class:"imglink"},[n(m,{vertical:"",align:"center",justify:"center"},{default:t(()=>[n(m,{class:"imglink-label"},{default:t(()=>[S(d(e(c)("status.Converted")),1)]),_:1}),n(m,{vertical:"",align:"center",justify:"center",size:0},{default:t(()=>[n(m,{justify:"center"},{default:t(()=>{var Z;return[n(m,{wrap:!1,style:pe((Z=a.variousInfo)!=null&&Z.shrinked?{color:"blue"}:{}),class:"img-size",size:2},{default:t(()=>[b("span",Ss,d(D.value?f.value:"?"),1),L[12]||(L[12]=S(" √ó ")),b("span",As,d(D.value?k.value:"?"),1)]),_:1,__:[12]},8,["style"])]}),_:1})]),_:1}),n(m,{justify:"center"},{default:t(()=>[S(d(D.value?e(He)(a.size,0):"?"),1)]),_:1})]),_:1})],8,Is)]),_:1}),n(m,{ref:"fileNameContainer",justify:"center",align:"center",class:"pathbox",title:a.name,style:{overflow:"hidden"}},{default:t(()=>[n(I,{"x-scrollable":!0,trigger:"hover",style:{"text-align":"center","font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:t(()=>[S(d(D.value?a.name:"?"),1)]),_:1})]),_:1},8,["title"])]),_:1}),n(m,{vertical:"",style:{overflow:"visible"}},{default:t(()=>[n(nn,{ref:Z=>{Z!=null&&Z.active&&(g.value=Z)},src:O.value,width:142,"max-width":140,"max-height":100,loading:E.value,"file-name":a.name,"allow-next":h.value<a.length,"allow-prev":h.value>1,onLoad:Le,onNext:L[6]||(L[6]=Z=>ne(1)),onPrev:L[7]||(L[7]=Z=>ne(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(m,{justify:"center",align:"center",wrap:!1},{default:t(()=>[n(q,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[b("a",{href:a.url,ref:"saveImg",target:"_blank",download:a.name,style:{"line-height":"1em"}},[n(e(Ee),{disabled:!D.value,round:"",size:"tiny"},{default:t(()=>[S(d(A.$t("save")),1)]),_:1},8,["disabled"])],8,Ls)]),default:t(()=>[S(" "+d(A.$t("save")),1)]),_:1}),n(q,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(e(Ee),{disabled:!D.value,onClick:L[8]||(L[8]=Z=>B(a.url)),round:"",size:"tiny"},{default:t(()=>L[13]||(L[13]=[S("DataURL")])),_:1,__:[13]},8,["disabled"])]),default:t(()=>[S(" "+d(A.$t("convertedImageDataUrlTooltip")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["name"])]),_:1},512),n(e(Ee),{bordered:!1,onClick:L[9]||(L[9]=Z=>ne(1)),disabled:!e(T),class:nt({"thumb-arrow":!0,next:!0,pale:!e(T)}),title:A.$t("Next")},{icon:t(()=>[n(X,{size:"30"},{default:t(()=>[n(e(za))]),_:1})]),_:1},8,["disabled","class","title"])]),_:1}),A.isSingle?ue("",!0):(C(),ee(m,{key:0,justify:"center",align:"center",wrap:!1,size:4},{default:t(()=>[n(_e,{value:h.value,"onUpdate:value":L[10]||(L[10]=Z=>h.value=Z),tooltip:!1,step:1,min:1,max:a.length,keyboard:!1,class:"index-slider"},null,8,["value","max"]),n(m,{class:"index",align:"center",justify:"center",wrap:!1,size:3},{default:t(()=>[n(m,null,{default:t(()=>[S(d(e(c)("status.index"))+":",1)]),_:1}),n(m,{justify:"end",align:"center",class:"counter"},{default:t(()=>[S(d(h.value),1)]),_:1}),n(m,null,{default:t(()=>L[14]||(L[14]=[S("/")])),_:1,__:[14]}),n(m,{justify:"start",align:"center",class:"counter"},{default:t(()=>[S(d(a.length),1)]),_:1})]),_:1})]),_:1}))]),_:1},512)]),_:1},8,["style"])}}}),$s=Be(Cs,[["__scopeId","data-v-1394ec38"]]),Es={key:0},Fs={style:{}},Ps={key:1,style:{width:"106px",height:"80px",opacity:"0.15",border:"1px solid gray"}},Os=we({__name:"status.progress",props:{processing:{type:Boolean},successPerc:{},elapsedTime:{},threads:{},fileType:{},shrink:{},zipSize:{},inputTotalSize:{},outputTotalSize:{},rateColor:{},difColor:{},totalSizeDifStr:{},thumbnail:{},opened:{type:Boolean}},setup(i){const r=i,s=w(null),l={W:110,H:80};let a;return Ie(()=>[r.thumbnail,r.opened],()=>{if(!r.thumbnail||!r.opened||r.thumbnail===a||!s.value)return;const{width:o,height:u}=Jo(r.thumbnail,{width:l.W,height:l.H});s.value.width=o,s.value.height=u,s.value.style.width=o+"px",s.value.style.height=u+"px",r.thumbnail instanceof HTMLImageElement?s.value.getContext("2d").drawImage(r.thumbnail,0,0,o,u):(s.value.getContext("bitmaprenderer").transferFromImageBitmap(r.thumbnail),a=r.thumbnail,r.thumbnail.close())}),(o,u)=>{const c=kt,g=Se,v=Ia,_=dt;return C(),ee(_,{name:"progress",style:{"white-space":"nowrap"}},{header:t(({collapsed:x})=>[n(g,{align:"center"},{default:t(()=>[S(d(o.$t("status.Progress"))+" ",1),x?(C(),K(Oe,{key:0},[S(" ("+d(o.successPerc|0)+"%) ",1)],64)):ue("",!0),Ze(n(c,{size:16},null,512),[[We,o.processing&&!r.opened]])]),_:2},1024)]),default:t(()=>[n(g,{justify:"center",align:"center",size:0,wrap:!1,style:{"white-space":"nowrap","margin-top":"-1em","padding-bottom":"5px"}},{default:t(()=>[u[0]||(u[0]=b("div",{class:"grow"},null,-1)),n(g,{justify:"center",class:"grow",wrap:!1,style:{"z-index":"1"}},{default:t(()=>[n(g,{vertical:"",justify:"center",class:"left-column"},{default:t(()=>[n(v,{"tabular-nums":"",label:o.$t("status.elapsedTime")},{default:t(()=>[n(g,null,{default:t(()=>[S(d(o.elapsedTime),1)]),_:1})]),_:1},8,["label"]),n(v,{"tabular-nums":"",label:o.$t("status.multiThreading")},{default:t(()=>[n(g,{style:pe({color:o.threads?"":"red",fontSize:"0.7rem"})},{default:t(()=>[S(d(o.threads?o.$rt("{n} @:threads",o.threads):o.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(v,{"tabular-nums":"",label:o.$t("status.outputSettings")},{default:t(()=>[n(g,{vertical:"",justify:"end",style:{"font-size":"0.6rem","line-height":"0.6rem"}},{default:t(()=>[b("div",null,d(o.$t("settings.imageType"))+": "+d(o.fileType),1),o.shrink?(C(),K("div",Es,[S(d(o.$t("status.Shrinking"))+": ",1),b("span",Fs,d(o.shrink[0])+"√ó"+d(o.shrink[1]),1)])):ue("",!0),b("div",null,"Zip: "+d(o.zipSize)+"MB",1)]),_:1})]),_:1},8,["label"])]),_:1}),dn(o.$slots,"center",{},void 0,!0),n(g,{vertical:"",style:{height:"100%"},justify:"center",class:"right-column"},{default:t(()=>[n(v,{"tabular-nums":"",label:o.$t("status.inputSize")},{default:t(()=>[n(g,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[S(d((o.inputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(v,{"tabular-nums":"",label:o.$t("status.outputSize")},{default:t(()=>[n(g,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[S(d((o.outputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(v,{"tabular-nums":"",label:o.$t("status.outInRate")},{default:t(()=>[n(g,{vertical:"",align:"end",justify:"start",style:{"font-size":"0.8em","font-family":"v-mono","line-height":"50%"}},{default:t(()=>[b("span",{style:pe({color:o.rateColor,fontSize:"larger"})},"√ó "+d((o.outputTotalSize/o.inputTotalSize||1).toFixed(2)),5),b("span",{style:pe({color:o.difColor})},"("+d(o.totalSizeDifStr)+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:3}),n(g,{class:"thumb-container",align:"center",style:{position:"relative"}},{default:t(()=>[n(g,{justify:"center",align:"center",class:"grow thumbnail",style:pe({width:l.W+"px",height:l.H+"px"})},{default:t(()=>[n(Ge,{name:"fade",mode:"out-in"},{default:t(()=>[o.processing?(C(),K("canvas",{key:0,ref_key:"thumbcanvas",ref:s,width:"106",height:"80",class:"thumb-canvas"},null,512)):(C(),K("div",Ps))]),_:1})]),_:1},8,["style"])]),_:1})]),_:3,__:[0]})]),_:3})}}}),Us=Be(Os,[["__scopeId","data-v-eecf6b58"]]),Ms={class:"status-table"},Rs={class:"started"},js={class:"mini-counter"},Ds={class:"failure"},Ns={class:"mini-counter"},Bs={colspan:"2"},Zs={class:"completed"},Ws={class:"main-counter"},Hs={class:"total"},Vs={class:"main-counter"},qs=we({__name:"status.progress-center",props:{processing:{type:Boolean},interval:{},statusColor:{},success:{},successTo:{},successFrom:{},index:{},length:{},failure:{},retried:{},successPercTo:{},successPercFrom:{}},setup(i){const r=i,s=xt(),l=w(s.value.successColor),a=w(!1);return Ie(()=>r.processing,o=>{o||(r.success===r.length?a.value=!0:l.value=s.value.errorColor)}),(o,u)=>{const c=Ye,g=ke,v=Aa,_=Se,x=vn;return C(),ee(x,{type:"multiple-circle","stroke-width":2,percentage:[o.successTo/o.length*100|0,o.index/o.length*100|0],color:[e(s).successColor,o.statusColor],"rail-style":[{stroke:e(l),opacity:.3}],style:{width:"12em"}},{default:t(()=>[n(_,{vertical:"",align:"center",justify:"center",size:0,style:{"white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:t(()=>[b("table",Ms,[b("tbody",null,[b("tr",Rs,[b("td",null,d(o.$t("status.started"))+":",1),b("td",js,[n(c,{trigger:"hover",style:pe({color:e(s).infoColor}),placement:"left"},{trigger:t(()=>[b("span",{style:pe({color:e(s).infoColor})},d(o.index.toLocaleString("en-us")),5)]),default:t(()=>[S(" "+d(o.$t("status.progressStarted"))+" ("+d(o.index.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),b("tr",Ds,[b("td",null,d(o.$t("status.failure"))+":",1),b("td",Ns,[n(c,{trigger:"hover",style:pe({color:e(s).errorColor}),placement:"left"},{trigger:t(()=>[b("span",{style:pe({color:e(s).errorColor})},d(o.failure.toLocaleString("en-us")),5)]),default:t(()=>[S(" "+d(o.$t("status.progressErrors"))+" ("+d(o.failure.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"]),o.retried>0?(C(),ee(c,{key:0,trigger:"hover",style:pe({color:e(s).warningColor}),placement:"left"},{trigger:t(()=>[b("span",{style:pe({color:e(s).warningColor})}," ("+d(o.retried.toLocaleString("en-us"))+") ",5)]),default:t(()=>[S(" "+d(o.$t("status.progressRetries"))+" ("+d(o.retried.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):ue("",!0)])]),b("tr",null,[b("td",Bs,[n(_,{size:0,align:"center",justify:"center",style:pe({color:o.processing?o.statusColor:e(l)}),wrap:!1,class:"percent"},{default:t(()=>[e(a)?(C(),ee(g,{key:0,component:e(Sa)},null,8,["component"])):ue("",!0),n(v,{duration:o.interval*3|0,from:o.successPercFrom|0,to:o.successPercTo|0,active:!0},null,8,["duration","from","to"]),u[0]||(u[0]=S("% "))]),_:1,__:[0]},8,["style"])])]),b("tr",Zs,[b("td",null,d(o.$t("status.success"))+":",1),b("td",Ws,[n(c,{trigger:"hover",duration:0,delay:0,style:pe({color:e(s).successColor}),placement:"bottom"},{trigger:t(()=>[b("span",{style:pe({color:e(s).successColor})},[n(v,{duration:o.interval*3|0,from:o.successFrom,to:o.successTo,active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:t(()=>[S(" "+d(o.$t("status.progressSuccess"))+" ("+d(o.successTo.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),b("tr",Hs,[b("td",null,d(o.$t("status.all"))+":",1),b("td",Vs,[n(c,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:t(()=>[S(d(o.length.toLocaleString("en-us")),1)]),default:t(()=>[S(" "+d(o.$t("status.progressTotal"))+" ("+d(o.length.toLocaleString("en-us"))+") ",1)]),_:1})])])])])]),_:1})]),_:1},8,["percentage","color","rail-style"])}}}),Gs={key:0,class:"log-table",ref:"table"},Ks={class:"log-tr label"},Qs=["title"],Ys={style:{"min-width":"7em"},class:"log-th"},Xs={style:{"padding-left":"2em"},class:"log-th"},Js=["data-index-loglist"],ei={class:"log-td"},ti={class:"log-td"},ni={class:"log-td"},oi={class:"log-td"},ai={key:0,class:"log-td log-extra",style:{"padding-left":"0.5em"}},li={key:0},si={key:1,style:{color:"blue"}},ii={key:1},on=2,an=3e3,Ct=80,ri=100,ui=we({__name:"status.log",props:ot({processing:{type:Boolean},opened:{type:Boolean},previewCollapsed:{type:Boolean},logs:{},imageIndex:{}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},"auto-scroll":{type:Boolean,required:!1},"auto-scrollModifiers":{},order:{required:!1,default:"processed"},orderModifiers:{}}),emits:ot(["open-preview","change-index"],["update:expanded","update:auto-scroll","update:order"]),setup(i,{emit:r}){const{t:s}=Ne(),l=i,a=Pe(i,"expanded"),o=Pe(i,"auto-scroll"),u=r;tt("table");const c=tt("tbody"),g=w(),v=w(null),_=w(40),x=Te(()=>a.value?_.value:Ct),p=w(Ct),h=Te(()=>{let m=l.logs;switch(y.value){case"success":m=m.filter(I=>I.completed);break;case"error":m=m.filter(I=>!I.completed);break}return m}),f=vs(!1),O=w([{type:"group",label:()=>s("status.sort"),key:"sort",children:[{label:()=>s("status.sortByStart"),value:"processed"},{label:()=>s("status.sortByCompletion"),value:"zipped"},{label:()=>s("status.sortByName"),value:"name"},{label:()=>s("status.sortBySize"),value:"size"},{label:()=>s("status.sortByOutputSize"),value:"outputsize"},{label:()=>s("status.sortByStatus"),value:"status"}]}]),F=Pe(i,"order");Ie(F,()=>{Fe()});const z=[{label:()=>s("status.showAll"),value:""},{label:()=>s("status.showOnlySuccess"),value:"success"},{label:()=>s("status.showOnlyError"),value:"error"}],y=w(z[0].value);let E;Re(()=>{E=$a(),Q(),window.addEventListener("resize",()=>Q());const m=new ResizeObserver(()=>Q());m.observe(E.parent.parent.vnode.el),qe(()=>{window.removeEventListener("resize",()=>Q()),m.disconnect()})}),qe(()=>{clearTimeout(P),clearTimeout(se),clearTimeout(ge)});let D=0;Ie(()=>l.imageIndex,m=>W(m));async function W(m){var Z;const I=m||l.imageIndex;let q=h.value.findIndex(re=>re.zippedIndex===I);q===-1&&(q=I);const _e=q<=Y.value,ve=q>Y.value+ce.value;if(_e||ve){const re=q*ie.value-(ve?x.value:0);(Z=g.value)==null||Z.scrollTo({behavior:"instant",top:re,left:U}),await Ce(),B(!0),await Ce()}Ce(()=>{var he,$e;let re=v.value;re&&(D>q&&(re=re.previousSibling||re,re instanceof HTMLElement||((he=g.value)==null||he.scrollTo(U,0),re=null)),($e=re==null?void 0:re.scrollIntoView)==null||$e.call(re,{behavior:"instant",block:"nearest"}),D=q)})}Ie(()=>l.opened,m=>{Ce(()=>{m&&(W(),B())})});let P;const M=w(document.documentElement.clientHeight),T=w(100);function Q(){clearTimeout(P),P=setTimeout(()=>{if(!l.opened||!g.value)return;const m=g.value.$parent.$el.offsetHeight,I=window.innerHeight-E.parent.parent.parent.parent.parent.vnode.el.offsetHeight-8,q=Math.min(ie.value*Math.max(5,l.logs.length+2),Math.max(200,m+I));M.value=document.documentElement.clientHeight,T.value=Math.min(ie.value*Math.max(5,l.logs.length),Math.max(Ct,q)),l.opened&&(_.value=Math.max(q,p.value))},100)}function ae(){j(!0),Q(),f.value=!0}let ge=0,Ae=!1;function j(m=!1){if(!Ae){if(ge){Ae=!0;return}Ce(()=>{!m&&!o.value||(g.value.scrollTo({behavior:"instant",top:l.logs.length*50,left:U}),ge=window.setTimeout(()=>{ge=0,Ae&&(Ae=!1,j())},ri))})}}const $=w({height:"0px"}),H=w({height:"0px"}),Y=w(0),ce=Te(()=>x.value/ie.value+on*2|0),ie=w(15);let de=0,se=0,Le=0,V=-999,R=-1;function B(m){const I=Date.now();if(m!==!0){if(se)return;if(I-Le<30){se=window.setTimeout(()=>{se=0,B()},30-(I-Le));return}}Le=I,de||(de=c.value.rows[1].offsetHeight,ie.value=de);const q=h.value.length,ve=g.value.scrollbarInstRef.containerRef.scrollTop;if(!m&&q===R&&Math.abs(ve-V)<ie.value*.5)return;V=ve,R=q;const Z=Math.max(0,(ve/ie.value|0)-on);Y.value=Z,$.value.height=Z*ie.value+"px",H.value.height=Math.max(0,q-(Z+ce.value))*ie.value+"px"}function ne(){var m;(m=g.value)==null||m.scrollTo(0,0),B()}Ie(()=>l.logs,()=>{l.opened&&(Ce(B),o.value&&j(),me())}),Ie(()=>l.opened,m=>{m&&B()});let oe=0,le=0;function me(){if(F.value==="processed"||!F.value)return;const m=Date.now();if(m-le<an){if(oe)return;oe=window.setTimeout(me,an-(m-le));return}oe=0,le=m,Fe()}function Fe(){switch(F.value){case"zipped":l.logs.sort((m,I)=>m.zippedIndex-I.zippedIndex);break;case"status":l.logs.sort((m,I)=>m.command>I.command?1:-1);break;case"name":l.logs.sort((m,I)=>m.path>I.path?1:-1);break;case"size":l.logs.sort((m,I)=>m.size-I.size);break;case"outputsize":l.logs.sort((m,I)=>m.outputSize-I.outputSize);break;case"processed":default:l.logs.sort((m,I)=>m.index-I.index);break}}function Ue(m){const I=l.logs,q=I.findIndex($e=>$e.zippedIndex===l.imageIndex);let _e=0,ve=1;switch(m.code){case"ArrowUp":_e=-1;break;case"ArrowDown":_e=1;break;case"PageUp":_e=-1,ve=x.value/ie.value-1|0;break;case"PageDown":_e=1,ve=x.value/ie.value-1|0;break;case"Enter":case"NumpadEnter":if(q>=0&&l.previewCollapsed){Ce(()=>u("open-preview")),m.stopPropagation(),m.preventDefault();return}break;default:return}let Z=q,re=-1;const he=I.length;do{if(Z+=_e,Z<0||Z>he-1||Z===q)break;if(I[Z].completed){if(re=Z,--ve>0)continue;break}}while(!0);if(re>=0){const $e=I[re];u("change-index",!0,$e.path,$e.fileId,$e.zippedIndex),m.preventDefault()}}let be=-1,fe=-1,U=0,G=!1;function A(m){var _e,ve;if(B(),G){G=!1;return}const{scrollLeft:I=0,scrollTop:q=0}=(ve=(_e=g.value)==null?void 0:_e.scrollbarInstRef)==null?void 0:ve.containerRef;(I!==be||be<0)&&(q===fe||fe<0)&&(U=I),be=I,fe=q,Ce(()=>{var re,he;G=!0;const Z=(he=(re=g.value)==null?void 0:re.scrollbarInstRef)==null?void 0:he.containerRef;Z&&(Z.scrollLeft=U)})}function L(m){o.value=!1}function X(m,I){var $e,Xe;const _e=(Xe=($e=m.target.closest("tr"))==null?void 0:$e.dataset)==null?void 0:Xe.indexLoglist;if(!/^\d+$/.test(_e))return;const{completed:ve,path:Z,fileId:re,zippedIndex:he}=h.value[_e];ve&&(l.imageIndex!==he&&u("change-index",ve,Z,re,he),I&&u("open-preview"))}return(m,I)=>{const q=Se,_e=ke,ve=It,Z=hn,re=xe,he=Tt,$e=Ye,Xe=dt;return C(),ee(Xe,{name:"log",style:{"white-space":"nowrap"}},{header:t(()=>[n(q,{align:"center",wrap:!1},{default:t(()=>[S(d(m.$t("status.Log")),1)]),_:1})]),"header-extra":t(()=>[Ze(n(q,{align:"center",justify:"end",wrap:!0,style:{"margin-top":"0.2em","margin-left":"0.5em"}},{default:t(()=>[n(ve,{value:F.value,"onUpdate:value":[I[0]||(I[0]=ye=>F.value=ye),Fe],options:e(O),style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1,size:"tiny"},{arrow:t(()=>[n(_e,{component:e(La)},null,8,["component"])]),_:1},8,["value","options"]),n(ve,{value:e(y),"onUpdate:value":[I[1]||(I[1]=ye=>je(y)?y.value=ye:null),I[2]||(I[2]=ye=>ne())],options:z,placeholder:m.$t("status.filterLogSelect"),size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1},{arrow:t(()=>[n(_e,{component:e(Ca)},null,8,["component"])]),_:1},8,["value","placeholder"]),n(Z,{key:"b",checked:o.value,"onUpdate:checked":[I[3]||(I[3]=ye=>o.value=ye),I[4]||(I[4]=ye=>ye&&j(!0))],size:"small",style:{"font-size":"0.9em"}},{default:t(()=>[S(d(m.$t("status.autoScroll")),1)]),_:1},8,["checked"]),n($e,{trigger:"hover",show:e(f),disabled:!a.value,placement:"top",delay:0,duration:1e3},{trigger:t(()=>[n(re,{style:{"max-width":"30em"},disabled:!0},{trigger:t(()=>[n(Z,{size:"small",checked:a.value,"onUpdate:checked":[I[5]||(I[5]=ye=>a.value=ye),ae],style:{"font-size":"0.9em"}},{default:t(()=>[S(d(m.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:t(()=>[S(d(m.$t("status.expandLog")),1)]),_:1})]),default:t(()=>[n(q,{wrap:!1,align:"center",style:{"font-size":"0.8em"}},{default:t(()=>[n(he,{value:e(p),"onUpdate:value":I[6]||(I[6]=ye=>je(p)?p.value=ye:null),onUpdateValue:I[7]||(I[7]=ye=>Q()),disabled:!a.value,"format-tooltip":ye=>`Log size: ${ye}`,tooltip:!0,step:1,min:e(T),max:e(M),style:{"z-index":"3",width:"100px"}},null,8,["value","disabled","format-tooltip","min","max"])]),_:1})]),_:1},8,["show","disabled"])]),_:1},512),[[We,l.opened]])]),default:t(()=>[n(q,{wrap:!1,align:"stretch",class:nt({"log-container":1,"expand-log":a.value}),style:pe({height:e(x)+"px"}),onKeydown:Ue,tabindex:"-1"},{default:t(()=>[n(e(mn),{ref_key:"scrollref",ref:g,distance:10,"x-scrollable":!0,onMousedownCapture:L,onWheel:I[9]||(I[9]=ye=>o.value=!1),onScroll:A,load:"handleLogLoad",trigger:"none",style:pe([{"z-index":"2","padding-right":"10px",height:"100%"},{height:e(x)+"px"}]),size:50},{default:t(()=>[l.opened?(C(),K("table",Gs,[b("thead",null,[b("tr",Ks,[b("th",{class:"log-th",title:m.$t("status.table.core")},"th",8,Qs),I[10]||(I[10]=b("th",{class:"log-th"},"no.",-1)),b("th",Ys,d(m.$t("status.table.status")),1),b("th",Xs,d(m.$t("status.table.details")),1),I[11]||(I[11]=b("th",{class:"log-th"},"size",-1))])]),b("tbody",{ref:"tbody",onClick:X,onDblclick:I[8]||(I[8]=ye=>X(ye,!0))},[b("tr",{style:pe(e($))},null,4),(C(!0),K(Oe,null,ut(e(h).slice(e(Y),e(Y)+e(ce)),({index:ye,key:na,command:oa,path:aa,core:Zt,zippedIndex:Wt,completed:la,fileId:gr,shrinked:sa,width:Ht,height:ia,outputWidth:ra,outputHeight:ua,size:ca,outputSize:Vt},qt)=>(C(),K("tr",{key:na,class:nt({"log-tr":1,completed:la,selected:m.imageIndex===Wt,stripe:(e(Y)+qt)%2}),ref_for:!0,ref:da=>{m.imageIndex===Wt&&(v.value=da)},"data-index-loglist":e(Y)+qt},[b("td",ei,d(Zt>=0?Zt+1:"-"),1),b("td",ti,d(ye+1),1),b("td",ni,d(oa),1),b("td",oi,d(aa),1),Ht?(C(),K("td",ai,[S(d(`[${Ht}√ó${ia}] (${e(He)(ca,0)})`)+" ",1),Vt?(C(),K("span",li,[I[12]||(I[12]=S(" ‚Üí ")),b("span",null," ("+d(e(He)(Vt,0))+") ",1)])):ue("",!0),sa?(C(),K("span",si,d(` [${ra}√ó${ua}]`),1)):ue("",!0)])):(C(),K("td",ii))],10,Js))),128)),b("tr",{style:pe(e(H))},null,4)],544)],512)):ue("",!0),I[13]||(I[13]=b("div",{style:{height:"1em"}},null,-1))]),_:1,__:[13]},8,["style"])]),_:1},8,["class","style"])]),_:1})}}}),ci={class:"container"},di={__name:"zipicon",setup(i){return(r,s)=>(C(),K("span",ci,[n(e(ke),null,{default:t(()=>[n(e(Ft))]),_:1}),s[0]||(s[0]=b("span",{class:"text"},"ZIP",-1))]))}},pi=Be(di,[["__scopeId","data-v-8b8df2f0"]]),fi=["innerHTML"],gi={style:{margin:"1px"}},mi=["href","download","onClick"],vi={key:0,style:{position:"relative"}},hi=["href","download"],_i=["href","download"],yi={key:0,style:{margin:"1px"}},wi=["href","download","onClick"],bi=we({__name:"status.result",props:{processing:{type:Boolean},listLength:{},zippingFlag:{type:Boolean},converted:{},success:{},zippedTotalCount:{},zippedTotalSize:{},baseZipName:{},zips:{},unconvertedListText:{},unconvertedFileCount:{},unconvertedTotalSize:{},failedZips:{},failedZipDone:{type:Boolean},failedToCreateFailedZip:{type:Boolean},failedFileZippedCount:{},imgUrl:{},imgName:{},type:{}},emits:["all-zips-clicked","demand-zip-errors"],setup(i,{emit:r}){const s=ct(),{t:l}=Ne(),a=xt(),o=i,u=r,c=w(!1),g=w([]),v=w([]),_=w(void 0),x=Te(()=>[{key:"open",label:l("status.openFailedList"),icon:()=>J(ke,()=>J(_n)),onSelect(){f()}},{key:"download",label:l("status.saveFailedList"),icon:()=>J(ke,()=>J(Ea)),onSelect(){f(!0)}},{key:"zip",label:`${l("status.zipFailedList")}`+(o.failedZipDone?`(‚úî${l("status.done")})`:""),icon:()=>J(kt,{show:c.value&&!o.failedZipDone,size:"small"},()=>J(ke,()=>J(Ft))),disabled:c.value,onSelect(k){return c.value=!0,u("demand-zip-errors"),!1}}]);Ie([()=>o.zips.length,()=>o.failedZips.length],()=>{{g.value.length>o.zips.length&&(g.value.length=0);let k=0;const O=o.zips.length===1&&o.zippedTotalCount===o.listLength;for(let F=g.value.length;F<o.zips.length;F++){const z=o.zips[F],y=o.baseZipName+(O?"":"-"+String(F+1).padStart(2,"0"))+".zip";k+=z.size,g.value[F]={url:z.url,size:z.size,number:O?0:F+1,sizeByUnit:He(z.size),name:y,count:z.count,clicked:!1}}}{v.value.length>o.failedZips.length&&(v.value.length=0);let k=0;const O=o.failedZipDone&&o.failedZips.length===1;for(let F=v.value.length;F<o.failedZips.length;F++){const z=o.failedZips[F],y=o.baseZipName+"-error"+(O?"":"-"+String(F+1).padStart(2,"0"))+".zip";k+=z.size,v.value[F]={url:z.url,size:z.size,number:O?0:F+1,sizeByUnit:He(z.size),name:y,count:z.count,clicked:!1}}}});function p(k,O=!1){const{url:F,name:z}=k;if(O){const y=document.createElement("a");y.href=F,y.download=z,y.click()}k.clicked||(k.clicked=!0,o.processing||g.value.every(y=>y.clicked)&&u("all-zips-clicked"))}async function h(k){if(o.zippingFlag){if(g.value.length>=2&&!await new Promise((z,y)=>s.warning({title:l("Download"),content:l("status.confirmDownloadMessage",[g.value.length]),positiveText:"OK",negativeText:l("cancel"),onPositiveClick:()=>z(!0),onNegativeClick:()=>y()})))return;const O=g.value;for(const F of O)p(F,!0)}}function f(k=!1){const O=new Blob([o.unconvertedListText],{type:"text/plain;charset=utf8"}),F=URL.createObjectURL(O),z=document.createElement("a");z.href=F,z.target="_blank",k&&(z.download=o.baseZipName+"-error.txt"),z.click()}return(k,O)=>{const F=vn,z=Ye,y=Ee,E=Se,D=pi,W=Rt,P=Fa,M=dt;return C(),ee(M,{name:"output",style:{"white-space":"nowrap"},disabled:""},{header:t(()=>[b("span",{style:{color:"black"},innerHTML:k.$t("status.Output")},null,8,fi)]),default:t(()=>[n(E,{wrap:!1,vertical:"",style:{"margin-top":"-1.3em"}},{default:t(()=>[n(E,{justify:"center"},{default:t(()=>[Ze(n(E,{vertical:"",align:"center"},{default:t(()=>[n(z,{placement:"left"},{trigger:t(()=>[n(F,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":o.zippedTotalCount===k.listLength?"white":"green",processing:o.processing,percentage:o.zippedTotalCount/k.listLength*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[b("span",gi,d(o.zippedTotalCount/k.listLength*100|0)+"% "+d(k.$t("status.zippingProgress"))+" ("+d(o.zippedTotalCount)+"/"+d(o.converted)+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[S(" "+d(k.$t("status.zippingProgress"))+" ("+d(o.zippedTotalCount/o.listLength*100|0)+"%) ",1)]),_:1}),e(g).length>=2||o.processing?(C(),ee(Yt,{key:0,name:"zips",class:"zip-buttons-parent",tag:"div"},{default:t(()=>[(C(!0),K(Oe,null,ut(e(g),(T,Q)=>(C(),K("span",{key:Q},[n(z,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[b("a",{href:T.url,download:T.name,class:"in-button-anchor",onClick:ae=>p(T)},[n(y,{class:"zip-button",size:"tiny",color:T.clicked?"#050":"lime","text-color":T.clicked?"gray":"white",onClick:et(ae=>p(T),["stop"]),round:""},{default:t(()=>[n(e(ke),{size:"tiny"},{default:t(()=>[n(e(Ft))]),_:1}),S("ZIP"+d(T.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,mi)]),default:t(()=>[b("div",{style:pe({color:e(a).successColor})},[b("div",null,"ZIP "+d(T.number||"")+" ("+d(k.$t("success"))+")",1),b("div",null,d(T.name),1),b("div",null,d(T.sizeByUnit),1),b("div",null,d(k.$rt("{n} @:files",T.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):ue("",!0)]),_:1},512),[[We,k.zippingFlag]])]),_:1}),n(Ge,null,{default:t(()=>[Ze(n(E,{justify:"center",align:"center"},{default:t(()=>[n(z,{trigger:"hover",duration:0,delay:0,placement:"left",style:pe({color:"white",backgroundColor:e(a).successColor}),"arrow-style":{backgroundColor:e(a).successColor}},{trigger:t(()=>[n(Ge,{name:"save"},{default:t(()=>[k.success>0?(C(),K("span",vi,[n(W,{value:k.zippingFlag?o.zippedTotalCount.toLocaleString("en-us"):o.type.replace(/\(.+\)/,""),color:e(a).successColorHover,offset:[-20,-3]},{default:t(()=>[k.zippingFlag?(C(),ee(y,{key:0,size:"medium",onClick:h,color:e(a).successColor,round:""},{default:t(()=>[e(g).length?(C(),K("a",{key:0,href:e(g)[0].url,download:e(g)[0].name,class:"in-button-anchor",onClick:O[0]||(O[0]=et(()=>{},["prevent"]))},[n(D),S(" √ó "+d(e(g).length)+" "+d(k.$t("status.saveAll")),1)],8,hi)):ue("",!0)]),_:1},8,["color"])):(C(),K("a",{key:1,href:o.imgUrl,download:o.imgName,class:"in-button-anchor"},[n(y,{size:"medium",color:e(a).successColor,round:""},{default:t(()=>[n(e(ke),{size:"tiny",component:e(yn)},null,8,["component"]),S(" "+d(k.$t("save")),1)]),_:1},8,["color"])],8,_i))]),_:1},8,["value","color"])])):ue("",!0)]),_:1})]),default:t(()=>[o.listLength>=2?(C(),K(Oe,{key:0},[b("div",null,d(e(l)("success"))+": "+d(k.zippedTotalCount.toLocaleString()),1),b("div",null,d(e(l)("status.totalSize"))+": "+d(e(He)(o.zippedTotalSize)),1),b("div",null,"ZIP √ó "+d(e(g).length),1),b("div",null,d(e(l)("status.saveAllZipsTooltip")),1)],64)):(C(),K(Oe,{key:1},[S(d(k.$t("status.downloadConvertedImage",e(g).length)),1)],64))]),_:1},8,["style","arrow-style"]),!o.processing&&o.success!==k.listLength?(C(),ee(P,{key:0,options:e(x),onSelect:O[1]||(O[1]=(T,Q)=>{var ae;return(ae=e(x).find(({key:ge})=>T===ge))==null?void 0:ae.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:t(()=>[n(z,{show:e(_),duration:0,delay:0,placement:"right",style:pe({color:"white",backgroundColor:e(a).errorColor}),"arrow-style":{backgroundColor:e(a).errorColor}},{trigger:t(()=>[n(W,{value:o.unconvertedFileCount.toLocaleString(),color:e(a).errorColorHover,offset:[-0,-3]},{default:t(()=>[n(y,{size:"small",color:e(a).errorColor},{default:t(()=>[n(e(ke),{size:"medium",style:{"vertical-align":"middle"},component:e(Pa)},null,8,["component"])]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:t(()=>[b("div",null,[b("div",null,d(e(l)("failed"))+": "+d(o.unconvertedFileCount.toLocaleString()),1),b("div",null,d(e(l)("status.totalSize"))+": "+d(e(He)(o.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])):ue("",!0)]),_:1},512),[[We,!o.processing]])]),_:1}),n(Ge,{name:"zipcontainer"},{default:t(()=>[Ze(n(E,{vertical:"",align:"center"},{default:t(()=>[n(z,{placement:"left"},{trigger:t(()=>[n(F,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":o.failedFileZippedCount===o.unconvertedFileCount?"white":"#500",processing:e(c)&&!o.failedZipDone&&!o.failedToCreateFailedZip,percentage:o.failedFileZippedCount/o.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[o.failedToCreateFailedZip?(C(),K("div",{key:1,style:pe({color:e(a).errorColor})},d(k.$t("status.failureZippingFailedFiles")),5)):(C(),K("span",yi,d(o.failedFileZippedCount/o.unconvertedFileCount*100|0)+"% "+d(k.$t("status.zipped"))+" ("+d(o.failedFileZippedCount)+"/"+d(o.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[S(" "+d(k.$t("status.zippingProgress"))+" ("+d(o.failedFileZippedCount/o.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(Yt,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(C(!0),K(Oe,null,ut(e(v),(T,Q)=>(C(),K("span",{key:Q},[n(z,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[b("a",{href:T.url,download:T.name,class:"in-button-anchor",onClick:ae=>p(T)},[n(y,{class:"zip-button",size:"tiny",color:T.clicked?"#551122":"#F00","text-color":T.clicked?"gray":"white",onClick:et(ae=>p(T),["stop"]),round:""},{default:t(()=>[n(e(ke),{size:"tiny",component:e(Oa)},null,8,["component"]),S("ZIP"+d(T.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,wi)]),default:t(()=>[b("div",{style:pe({color:e(a).errorColor})},[b("div",null,"ZIP "+d(T.number||"")+" ("+d(k.$t("failed"))+")",1),b("div",null,d(T.name),1),b("div",null,d(T.sizeByUnit),1),b("div",null,d(k.$rt("{n} @:files",T.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1},512),[[We,e(c)]])]),_:1})]),_:1})]),_:1})}}}),zi=Be(bi,[["__scopeId","data-v-1d58375d"]]),ki=we({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image","delete-image"],setup(i,{expose:r,emit:s}){const l={itemMargin:"1px",titlePadding:"2px",titleFontSize:"0.8rem"},{t:a}=Ne(),o=xt(),u=i,c=s;r({cleanup:fe});const g=w(!1),v=w([]),_=w(!1),x=w(!1),p=w([0,0]),h=w([0,0]),f=w([0,0]),k=w([0,0]),O=w([0,0]),F=w([0,0]),z=w(0),y=w(0),E=w([0,0]),D=w(0),W=w(o.value.infoColor),P=w("#000000"),M=w("#000000"),T=w(0),Q=w(0),ae=w(""),ge=w("00:00:00"),Ae=w(null),j=w(["progress","log","output"]),$=U=>j.value.includes(U),H=U=>j.value.push(U),Y=U=>{const G=j.value.findIndex(A=>A===U);G>=0&&j.value.splice(G,1)},ce=Te(()=>j.value.includes("log")),ie=Te(()=>j.value.includes("progress")),de=w(!1),se=w(!0),Le=w("processed"),V=zt({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:0,various:{shrinked:!1}}),R=tt("body"),B=tt("imageViewer");Re(()=>{Ie(u.status,()=>me(),{deep:!1});let U=0;const G=()=>{if(U)return;const A=Date.now();ge.value="00:00:00",U=window.setInterval(()=>{const L=(Date.now()-A)/1e3;ge.value=`${String(L/3600|0).padStart(2,"0")}:${String(L/60%60|0).padStart(2,"0")}:${String(L%60|0).padStart(2,"0")}`},300)};G(),x.value=!0,Ie(()=>u.processing,(A,L)=>{A||Fe(),A?(G(),v.value.length=0,g.value=!1,_.value=!1):(clearInterval(U),U=0)}),qe(()=>{clearInterval(U),clearTimeout(le)}),vt(()=>clearInterval(U))}),qe(()=>{fe()}),vt(()=>{clearTimeout(le)});const ne=u.interval||100;let oe=!1,le=0;function me(){if(oe)return;if(le){oe=!0;return}le=window.setTimeout(()=>{le=0,oe&&(oe=!1,me())},ne);const U=u.status;g.value=U.length>=2,h.value[1]=h.value[0],h.value[0]=U.startedCount,f.value[1]=f.value[0],f.value[0]=U.success,k.value[1]=k.value[0],k.value[0]=U.failure,O.value[1]=O.value[0],O.value[0]=U.done,F.value[1]=F.value[0],F.value[0]=U.converted,z.value=U.retried,y.value=U.length,E.value[1]=E.value[0],E.value[0]=U.zippedTotalCount,T.value=U.inputTotalSize,Q.value=U.outputTotalSize,D.value=U.failedFileZippedCount;const G=Q.value-T.value;ae.value=(G>=0?"+ ":"")+He(G);const A=Q.value/T.value,L=(256|Math.min(255,Math.max(0,A-1.5)*255|0)).toString(16).substring(1);P.value="#"+L+"0000";const X=1024*1024,m=(256|Math.min(255,Math.max(0,G/1024/X)*255|0)).toString(16).substring(1);M.value="#"+m+"0000",p.value[1]=p.value[0],p.value[0]=f.value[0]/y.value*100,(ce.value||!u.processing)&&(v.value=v.value.concat(U.logs),U.logs.length=0),Ae.value=U.thumbnail,u.processing?W.value=k.value[0]?o.value.errorColor:z.value?o.value.warningColor:o.value.infoColor:x.value=!1,U.convertedImageUrl!==V.url&&(V.url=U.convertedImageUrl,V.name=U.convertedImageName,V.dataUrl=U.convertedImageDataUrl,V.size=U.convertedImageSize||U.outputTotalSize,V.originalSize=U.convertedImageOrgSize,V.originalName=U.convertedImageOrgName,V.index=U.convertedImageIndex,V.originalUrl=U.convertedImageOrgUrl,V.various={shrinked:U.convertedImageShrinked})}function Fe(){const U=u.status;W.value=u.status.success===u.status.length?o.value.successColor:o.value.errorColor,Le.value==="processed"&&(Le.value="zipped"),U.success>0&&(se.value&&(Y("log"),de.value=!0),H("preview"))}async function Ue(U,G,A,L){var m;if(!U)return;const X=L;$("preview")||(H("preview"),await Ce()),(m=B.value)==null||m.changeIndex(X+1),await Ce(()=>{var I;try{(I=B.value)==null||I.$el.scrollIntoView({behavior:"instant",block:"nearest"})}catch{}})}const be=w(!1);function fe(){be.value=!0,URL.revokeObjectURL(V.url),URL.revokeObjectURL(V.originalName),V.originalUrl="",V.url="",V.index=0,u.status.logs.length=0,v.value.length=0}return(U,G)=>{const A=Se,L=dt,X=wn;return C(),ee(A,{ref_key:"body",ref:R,vertical:"",justify:"center"},{default:t(()=>[n(X,{"display-directive":"show","trigger-areas":["arrow","main"],"expanded-names":e(j),"onUpdate:expandedNames":G[7]||(G[7]=m=>je(j)?j.value=m:null),"theme-overrides":l},{default:t(()=>[n(Us,{processing:e(x),"elapsed-time":e(ge),"success-perc":e(p)[0],"input-total-size":e(T),"output-total-size":e(Q),"file-type":u.status.type,shrink:u.status.shrink,threads:u.status.threads,"zip-size":u.status.zipSize,"rate-color":e(P),"dif-color":e(M),"total-size-dif-str":e(ae),thumbnail:e(Ae),opened:e(ie)},{center:t(()=>[e(be)?ue("",!0):(C(),ee(qs,{key:0,index:e(h)[0],success:e(f)[0],length:U.status.length,"success-to":e(f)[0],"success-from":e(f)[1],failure:e(k)[0],"success-perc-to":e(p)[0],"success-perc-from":e(p)[1],retried:e(z),processing:e(x),interval:e(ne),"status-color":e(W),class:"center-column"},null,8,["index","success","length","success-to","success-from","failure","success-perc-to","success-perc-from","retried","processing","interval","status-color"]))]),_:1},8,["processing","elapsed-time","success-perc","input-total-size","output-total-size","file-type","shrink","threads","zip-size","rate-color","dif-color","total-size-dif-str","thumbnail","opened"]),n(ui,{processing:e(x),"image-index":e(V).index,opened:e(ce),"preview-collapsed":$("preview"),logs:e(v),expanded:e(de),"onUpdate:expanded":G[0]||(G[0]=m=>je(de)?de.value=m:null),"auto-scroll":e(se),"onUpdate:autoScroll":G[1]||(G[1]=m=>je(se)?se.value=m:null),order:e(Le),onChangeIndex:Ue,onOpenPreview:G[2]||(G[2]=m=>{var I;return(I=e(B))==null?void 0:I.openPreview()}),name:"log",style:{"white-space":"nowrap"}},null,8,["processing","image-index","opened","preview-collapsed","logs","expanded","auto-scroll","order"]),n(L,{title:U.$t("status.PreviewImage"),name:"preview",style:{"white-space":"nowrap"},disabled:!(e(f)[0]>0)},{default:t(()=>[n(A,{justify:"center",align:"center",vertical:"",style:{"margin-top":"-1em"}},{default:t(()=>[n($s,{"_v-else-if":"imageViewerStarted && status.success > 0 /*&& (props.status.threads || !zippingFlag)*/ && !cleaningUp",ref_key:"imageViewer",ref:B,url:e(V).url,size:e(V).size,"original-url":e(V).originalUrl,"original-size":e(V).originalSize,name:e(V).name,originalName:e(V).originalName,length:e(f)[0],index:e(V).index,"various-info":e(V).various,"is-single":!e(g),onDemandImage:G[3]||(G[3]=m=>c("demand-image",m)),on_deleteImage:G[4]||(G[4]=m=>c("delete-image",m)),_close:"imageViewerStarted=false"},null,8,["url","size","original-url","original-size","name","originalName","length","index","various-info","is-single"])]),_:1})]),_:1},8,["title","disabled"]),n(zi,{processing:e(x),"list-length":e(y),zippingFlag:e(g),zips:u.status.zips,"img-url":e(V).url,"img-name":e(V).name,success:e(f)[0],failure:e(k)[0],done:e(O)[0],converted:e(F)[0],retried:e(z),"zipped-total-count":e(E)[0],"zipped-total-size":u.status.zippedTotalSize,"base-zip-name":u.status.baseZipName,"failed-file-zipped-count":e(D),"failed-to-create-failed-zip":u.status.failedToCreateFailedZip,"failed-zip-done":u.status.failedZipDone,"failed-zips":u.status.failedZips,"unconverted-file-count":u.status.unconvertedFileCount,"unconverted-list-text":u.status.unconvertedListText,"unconverted-total-size":u.status.unconvertedTotalSize,type:u.status.type,onAllZipsClicked:G[5]||(G[5]=m=>c("all-zips-clicked")),onDemandZipErrors:G[6]||(G[6]=m=>c("demand-zip-errors"))},null,8,["processing","list-length","zippingFlag","zips","img-url","img-name","success","failure","done","converted","retried","zipped-total-count","zipped-total-size","base-zip-name","failed-file-zipped-count","failed-to-create-failed-zip","failed-zip-done","failed-zips","unconverted-file-count","unconverted-list-text","unconverted-total-size","type"])]),_:1},8,["expanded-names"])]),_:1},512)}}}),xi=Be(ki,[["__scopeId","data-v-c1f4b108"]]),Ti=["innerHTML"],Ii=we({__name:"converter",props:ot({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},threads:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:ot(["start","end"],["update:showNote"]),setup(i,{emit:r}){Qe(Ve);const{t:s}=Ne(),l=ct(),a=Ua(),o=10,u=navigator.hardwareConcurrency,c=typeof OffscreenCanvas=="function",g=100,v=i,_=Pe(i,"showNote"),x=r,p=w(!1),h=w(!1),f=w(!1),k=w(!1),O=w(!1),F=w(()=>"initializing"),z=w("info"),y=zt(Y()),E=tt("stat"),D=w(0);let W=!1,P=()=>{},M,T=0,Q=!1;Ie(()=>v.input,R=>{R!=null&&R.length&&ie(R)}),Ie(k,R=>{document.body.style.overflowY=R?"hidden":"auto"}),Re(async()=>{await Le(),V()});async function ae(){let R=!0;if(T>o*1e3&&!Q&&y.success>0&&(R=!1,await new Promise(B=>{l.warning({title:s("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:s("close"),negativeText:s("back"),onPositiveClick:()=>R=!0,onAfterLeave:B,content:s("confirmCloseDialog")})})),!R)return!1;a.destroyAll(),k.value=!1,_.value=!1}function ge(R){M==null||M(R)}function Ae(R){Lt==null||Lt(R)}function j(){!h.value&&p.value?h.value=!0:ae()}function $(){ie(v.input)}let H=w(()=>{});function Y(R){const B={logs:[],ziplogs:[],startedCount:0,converted:0,success:0,failure:0,retried:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",convertedImageOrgUrl:"",convertedImageIndex:-1,convertedImageShrinked:!1,zipSize:v.maxZipSizeMB,shrink:N.multithread&&N.shrinkImage?[N.maxWidth,N.maxHeight]:void 0,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1};return Object.assign(R||{},B)}function ce(){O.value=!1,URL.revokeObjectURL(y.convertedImageUrl),URL.revokeObjectURL(y.convertedImageOrgUrl);for(const R of y.zips)URL.revokeObjectURL(R.url);y.zips.length=0;for(const R of y.failedZips)URL.revokeObjectURL(R.url);y.failedZips.length=0,Y(y),P(),P=()=>{},M=null,Q=!1,f.value=!1,h.value=!1}async function ie(R){if(p.value){l.error({title:"Busy",positiveText:"OK",content:s("interfered")});return}k.value&&(D.value^=1);let B=R.concat();Y(y),ce(),k.value=!0,O.value=!0,p.value=!0,y.processing=!0,z.value="info",F.value=()=>s("processing");const ne=new Set,oe=v.format,le=v.quality,me=[...oe.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),Fe=se(oe,le,B[0].webkitRelativePath);y.length=B.length,y.baseZipName=Fe,y.type=oe.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(oe)?" ("+le+")":""),y.threads=W?0:v.threads;const Ue=Date.now();x("start");let be,fe,U;if(!W&&v.threads>=2?(M=ps,U=await os({files:B,completedFileIdSet:ne,ConvStats:y,canceled:h,props:v,imageType:oe,quality:le,outputExt:me,format:oe,message:a})):(M=_s,U=await hs(B,ne,v,h,y)),{exception:fe,callbackToGenerateFailedZips:be,callbackToClearConverter:P}=U,fe){let G;switch(fe.message){case"worker-load-error":G=s("errMsgWorkerLoadError");break;default:G="unexpected error"}l.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:()=>J("div",[J("p",G),J(Ee,{onClick(){location.reload()}},s("Reload"))])})}if(y.success===y.length?(z.value="success",F.value=()=>s("completed")):(z.value="error",F.value=()=>h.value?s("aborted"):s("incomplete")),ne.size!==B.length){const G=de(R,ne);H.value=()=>{!G||!G.length||be(G)}}p.value=!1,y.processing=!1,f.value=!0,B.length=0,T=Date.now()-Ue,x("end")}function de(R,B){const ne=[],oe=[];let le=0;for(const me of R)B.has(me._id)||(ne.push(me),oe.push(me.webkitRelativePath||me.relativePath||me.name),le+=me.size);return oe.length&&(y.unconvertedListText=oe.join(`
`),y.unconvertedFileCount=ne.length,y.unconvertedTotalSize=le),ne}function se(R,B,ne){var Ue;const oe=new Date;R=R.replace(/^image\//,"").toLowerCase();const le=N.useFolderNameForZip&&((Ue=String(ne).match(/^\/?([^/]+)\//))==null?void 0:Ue[1])||"avif2jpg",me=`
    ${oe.getFullYear().toString().substring(2)}
    ${String((oe.getMonth()+1)*100+oe.getDate()).padStart(4,"0")}
    ${String(oe.getHours()*1e4+oe.getMinutes()*100+oe.getSeconds()).padStart(6,"0")}
    -
    ${R+(/jpe?g|webp/i.test(R)?B:"")}
  `.replace(/\s/g,"");return`${le}-${me}`.replace(/\s+/g," ")}async function Le(){const R="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",B=document.createElement("img"),ne=ea(B).then(()=>!0,()=>!1);B.src=R,await ne||l.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:s("avifUnsupported")})}function V(){(!c||u<2||!Promise.any)&&(W=!0),W&&(Me.value=0)}return(R,B)=>{var be;const ne=ke,oe=Rt,le=xe,me=Se,Fe=kt,Ue=Ot;return C(),K(Oe,null,[!e(p)&&((be=v.input)!=null&&be.length)?(C(),ee(me,{key:0,justify:"center",align:"center",style:{"margin-top":"0.4em"}},{default:t(()=>[n(le,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:t(()=>{var fe;return[n(oe,{value:((fe=R.input)==null?void 0:fe.length)||0,offset:[-12,-5],color:"#99999966"},{default:t(()=>[n(e(Ee),{onClick:$,round:"",size:"medium"},{icon:t(()=>[n(ne,{size:"1.2em",color:"#CCCCCC"},{default:t(()=>[n(e(Ma))]),_:1})]),default:t(()=>[S(" "+d(e(s)("convertAgain")),1)]),_:1})]),_:1},8,["value"])]}),default:t(()=>{var fe;return[b("div",{innerHTML:e(s)("reconvertTip",(fe=v.input)==null?void 0:fe.length)},null,8,Ti)]}),_:1})]),_:1})):ue("",!0),n(Ue,{ref:"processingModal","display-directive":"show",show:e(k),"onUpdate:show":B[2]||(B[2]=fe=>je(k)?k.value=fe:null),closable:e(f),"close-on-esc":!1,preset:"dialog",onClick:B[3]||(B[3]=fe=>{e(a).destroyAll()}),onMaskClick:B[4]||(B[4]=fe=>{e(a).destroyAll()}),onClose:ae,onEsc:j,title:e(F),type:e(z),"mask-closable":!1,onAfterLeave:ce,onBeforeLeave:B[5]||(B[5]=fe=>{e(E).cleanup()}),class:"processing-dialog"},{default:t(()=>[n(me,{vertical:"",style:{"flex-grow":"1"}},{default:t(()=>[e(O)?(C(),ee(xi,{ref_key:"stat",ref:E,key:e(D),processing:e(p),status:e(y),interval:g,onAllZipsClicked:B[0]||(B[0]=fe=>je(Q)?Q.value=!0:Q=!0),onDemandZipErrors:e(H),onDemandImage:ge,onDeleteImage:Ae},null,8,["processing","status","onDemandZipErrors"])):ue("",!0),n(me,{justify:"end",align:"center",wrap:!1},{default:t(()=>[e(p)?(C(),ee(e(Ee),{key:0,disabled:e(h),ref:"cancelbutton",round:"",size:"large",onClick:B[1]||(B[1]=fe=>h.value=!0)},{default:t(()=>[n(Fe,{show:e(h)&&!e(f),size:"small"},{default:t(()=>[S(d(e(s)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):e(f)?(C(),ee(e(Ee),{key:1,onClick:ae,round:"",size:"large"},{default:t(()=>[S(d(e(s)("close")),1)]),_:1})):ue("",!0)]),_:1})]),_:1})]),_:1},8,["show","closable","title","type"])],64)}}}),Si={class:"container-1"},Ai={style:{color:"gray",padding:"0.2em","font-size":"smaller","text-align":"center"}},Li=["innerHTML"],Ci={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},$i=we({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(i,{emit:r}){Qe(Ve);const s=i,l=r,a=Ra(),o=w(!1),u=w(0),c=w("");Re(()=>{g(s.dropTarget||document)});function g(_){document.ondragstart=x=>x.preventDefault(),document.ondragover=x=>x.preventDefault(),_.ondrop=async x=>{var h;if(x.preventDefault(),o.value||s.forbidden)return;o.value=!0,u.value=0,c.value="";let p;try{const f=[...x.dataTransfer.items].map(k=>k.webkitGetAsEntry());a.start(),p=await v(f),a.finish()}catch{p=[...((h=x.dataTransfer)==null?void 0:h.files)??[]],a.error()}o.value&&(o.value=!1,l("drop",p))}}async function v(_,x){x=x||[];for(const p of _)if(p.isFile){const h=await new Promise(f=>p.file(k=>f(k)));Object.defineProperty(h,"webkitRelativePath",{value:p.fullPath}),x.push(h),u.value++}else if(p.isDirectory){c.value=p.fullPath;const h=p.createReader();do{const f=await new Promise(k=>h.readEntries(O=>k(O)));if(!f.length)break;await v(f,x)}while(!0)}return x}return(_,x)=>{const p=xe,h=Se,f=Ot;return C(),K("div",Si,[n(p,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"right"},{trigger:t(()=>[b("div",Ai," ("+d(_.$t("droptargetLabel"))+") ",1)]),default:t(()=>[b("h3",{innerHTML:_.$t("droptargetTooltip"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,Li)]),_:1}),n(f,{show:e(o),"onUpdate:show":x[0]||(x[0]=k=>je(o)?o.value=k:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":_.$t("cancel")},{default:t(()=>[n(h,{vertical:"",align:"center"},{default:t(()=>[b("div",Ci,d(e(c)),1),b("div",null,"found "+d(e(u))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])])}}}),Ei=Be($i,[["__scopeId","data-v-9fe916dd"]]),Fi={class:"container-1"},Pi={class:"container-2"},Oi=["innerHTML"],Ui=["innerHTML"],Mi={style:{"white-space":"nowrap"}},Ri={style:{"padding-left":"1em"}},ji=["innerHTML"],Di=["accept"],Ni=we({__name:"file-selector",props:ot({target:{},userExtensions:{},forbidden:{type:Boolean}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:ot(["input","click","cancel","on-change-accept","update:target","update:userExtensions"],["update:expanded","update:disableNotifyingFolderSelect"]),setup(i,{emit:r}){const s=ct(),{t:l}=Ne(),a=Qe(Ve),o=["avif_only","all_images","all_files","edit_type"],u=[];for(const $ of o)u.push({label:()=>l("fileTypeRadioOptions."+$),value:$});const c=({node:$,option:H})=>J(xe,{placement:"right"},{trigger:()=>$,default:()=>Q(H.value).replace(/,/g,", ")}),g=i,v=r,_=w(0),x=w(!1),p=w(!1),h=Te(()=>Q(O.value)),f=Te(()=>F.value.split(",").every(H=>/^\s*(\.[\w\-]+)*\s*$/.test(H))?"success":"error"),k=Te(()=>!g.forbidden&&!p.value);Pe(i,"expanded");const O=Te({get:()=>o.indexOf(g.target)>=0?g.target:o[0],set:$=>{v("update:target",$)}}),F=Te({get:()=>g.userExtensions,set:$=>{v("update:userExtensions",$)}}),z=Pe(i,"disableNotifyingFolderSelect"),y=w(null),E=w(null),D=w(T());Ie(O,$=>{v("on-change-accept",h.value)}),Re(()=>{});async function W($){if(v("click"),$===E.value&&!z.value){let H=!1;if(await new Promise(Y=>{s.info({title:l("loadfolderNotifyingTitle"),positiveText:l("Continue"),negativeText:l("Cancel"),onAfterLeave:()=>Y(H),onPositiveClick:()=>H=!0,content:()=>J("div",[J("p",{},l("loadfolderNotifyingMessageTerm1")),J("div",[J(fn,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/dist//notification-folder.png"})]),J("p",{},l("loadfolderNotifyingMessageTerm2")),J("p",[J(hn,{onUpdateChecked:ce=>z.value=ce,checked:z.value},()=>l("checkboxTextDontShowThis"))])])})}),!H){z.value=!1,v("cancel");return}}$.click()}function P(){v("cancel")}function M($){const Y=[...$.target.files];y.value.value="",E.value.value="",ge(Y)}function T(){return"webkitdirectory"in document.createElement("input")}function Q($){switch($){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico, .svg";case"edit_type":return F.value;case"all_files":default:return".*"}}async function ae($){const H=String(h.value).toLowerCase().replace(/\s+/g,"");if(H&&h.value!==".*"){const Y=H.split(",");$=$.filter(ce=>Y.includes(ce.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),$.length||(await new Promise(ce=>{s.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:ce,content:()=>J("div",[J(gn,{description:"NO IMAGES"}),`${l("noimage")}`,J("br"),h.value])})}),P())}return $}async function ge($){p.value=!0,$=await ae($),_.value=$.length,$.length>0&&v("input",j($)),p.value=!1}let Ae=0;function j($){const H=[];for(const Y of $)Y.hasOwnProperty("_id")||Object.defineProperty(Y,"_id",{value:Ae++}),H.push(Y);return H}return($,H)=>{const Y=ke,ce=Ee,ie=Se,de=It,se=ja,Le=kn,V=Ye;return C(),K(Oe,null,[b("div",Fi,[b("div",Pi,[n(ie,{vertical:"",align:"center",justify:"center",inline:"",size:"large"},{default:t(()=>[n(ie,{align:"center",justify:"space-around",class:"main-buttons"},{default:t(()=>[n(ie,{vertical:"",align:"stretch",justify:"center"},{default:t(()=>[n(e(xe),{to:!1,"display-directive":"show",show:e(a).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(a).LANDSCAPE.value?"right":"top",duration:0,delay:0,"z-index":10},{trigger:t(()=>[n(ce,{disabled:!e(k),size:"large",onClick:H[0]||(H[0]=R=>W(e(y))),round:"",style:{width:"100%","background-color":"white","font-size":"1.5em"}},{icon:t(()=>[n(Y,{size:"large",color:"gray"},{default:t(()=>[n(e(bn))]),_:1})]),default:t(()=>[S(" "+d($.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[b("div",{innerHTML:$.$t("loadbuttontooltip")},null,8,Oi)]),_:1},8,["show","placement"]),!e(a).IS_SP&&e(D)||e(a).SSR?(C(),K(Oe,{key:0},[n(e(xe),{to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:e(a).showTooltipsBeforeMounted.value},{trigger:t(()=>[n(ce,{disabled:!e(k),size:"large",onClick:H[1]||(H[1]=R=>W(e(E))),round:"",style:{width:"100%","background-color":"white","font-size":"1.5em"}},{icon:t(()=>[n(Y,{size:"large",color:"gray"},{default:t(()=>[n(e(zn))]),_:1})]),default:t(()=>[S(" "+d($.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[b("div",{innerHTML:$.$t("loadfoldertooltip")},null,8,Ui)]),_:1},8,["show"]),e(a).IS_SP?ue("",!0):(C(),ee(Ei,{key:0,onDrop:ge,forbidden:!e(k),_class:"drop-target"},null,8,["forbidden"]))],64)):ue("",!0)]),_:1})]),_:1}),n(ie,{vertical:""},{default:t(()=>[n(ie,{wrap:e(a).IS_SP,align:"center",justify:"stretch"},{default:t(()=>[n(e(xe),{to:!1,"display-directive":"show",trigger:"hover","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:e(a).showTooltipsBeforeMounted.value},{trigger:t(()=>[b("span",Mi,d($.$t("TargetFileTypeExt"))+": ",1)]),default:t(()=>[S(d($.$t("TargetFileTypeExtTooltip")),1)]),_:1},8,["show"]),n(e(xe),{"keep-alive-on-hover":!1,placement:"right",style:{"max-width":"200px"},duration:0,delay:0},{trigger:t(()=>[n(de,{trigger:"click",width:"trigger",size:"small",value:e(O),"onUpdate:value":H[2]||(H[2]=R=>je(O)?O.value=R:null),options:u,"render-option":c,"consistent-menu-width":!1},null,8,["value"])]),default:t(()=>[S(" "+d(Q(e(O)).replace(/,/g,", ")),1)]),_:1})]),_:1},8,["wrap"]),e(O)==="edit_type"?(C(),ee(e(xe),{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:e(x),duration:0,delay:0},{trigger:t(()=>[b("div",Ri,[n(V,{trigger:"manual",placement:"right-end",show:e(O)==="edit_type"&&e(f)!=="success"&&!!e(x)},{trigger:t(()=>[n(se,{value:e(F),"onUpdate:value":H[3]||(H[3]=R=>je(F)?F.value=R:null),status:e(f),disabled:e(O)!=="edit_type",onFocus:H[4]||(H[4]=R=>x.value=!0),onBlur:H[5]||(H[5]=R=>x.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:t(()=>[n(Le,{type:"error","show-icon":!0,title:"Validation error"},{default:t(()=>H[6]||(H[6]=[S(" Please correct the extension list."),b("br",null,null,-1),b("ul",null,[b("li",null,"Each extension must begin with a period. "),b("li",null,"Separate each extension with a comma. "),b("li",null,"Use alphameric characters.")],-1)])),_:1,__:[6]})]),_:1},8,["show"])])]),default:t(()=>[b("span",{innerHTML:$.$t("editAcceptTypes")},null,8,ji)]),_:1},8,["show"])):ue("",!0)]),_:1})]),_:1})])]),b("input",{ref_key:"fileinput",ref:y,onInput:M,onCancel:P,type:"file",multiple:"",accept:e(h),style:{display:"none"}},null,40,Di),b("input",{ref_key:"folderinput",ref:E,webkitdirectory:"",directory:"",onInput:M,onCancel:P,type:"file",style:{display:"none"}},null,544)],64)}}}),Bi=Be(Ni,[["__scopeId","data-v-39d6b70b"]]),Zi={style:{"white-space":"nowrap"}},Wi=we({__name:"settings-output",props:{quality:{},format:{}},emits:["update:format","update:quality"],setup(i,{emit:r}){const s=i,l=r,{t:a}=Ne(),o=Qe(Ve),u=w([]),c=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],g=Te({get:()=>s.format,set:f=>{f=p(f),l("update:format",f)}}),v=Te({get:()=>s.quality,set:f=>{l("update:quality",f)}}),_=Te(()=>/png|bmp/i.test(g.value)),x=w(null);Re(()=>{h()});function p(f){return u.value.indexOf(f)<0&&(f=u.value[0]),f}function h(){for(const f of c)x.value.toDataURL(f).indexOf(f)>=0&&u.value.push(f);u.value.length===0&&u.value.push(c[0])}return(f,k)=>{const O=ke,F=It,z=Se,y=xe,E=Tt,D=xn;return C(),K(Oe,null,[n(z,{justify:"center",class:"body"},{default:t(()=>[n(z,{vertical:""},{default:t(()=>[n(y,{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(o).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(z,{align:"center",wrap:!1},{default:t(()=>[n(O,null,{default:t(()=>[n(e(bn))]),_:1}),S(d(e(a)("settings.imageType"))+": ",1),n(F,{value:g.value,"onUpdate:value":k[0]||(k[0]=W=>g.value=W),options:u.value.map(W=>({value:W,label:W})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:t(()=>[S(" "+d(e(a)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(y,{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(o).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(z,{align:"center"},{default:t(()=>[n(z,{align:"start",wrap:!1},{default:t(()=>[n(O,null,{default:t(()=>[n(e(yn))]),_:1}),b("span",Zi,d(e(a)("settings.quality"))+":",1),n(z,{align:"center",justify:"space-between"},{default:t(()=>[n(E,{tooltip:!1,value:v.value,"onUpdate:value":k[1]||(k[1]=W=>v.value=W),step:1,style:{width:"120px"},disabled:_.value},null,8,["value","disabled"]),n(D,{onBlur:k[2]||(k[2]=W=>v.value??(v.value=0)),value:v.value,"onUpdate:value":k[3]||(k[3]=W=>v.value=W),step:"1",min:"0",max:"100",disabled:_.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:t(()=>[S(" "+d(e(a)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1})]),_:1}),b("canvas",{ref_key:"canvas",ref:x,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),Hi=Be(Wi,[["__scopeId","data-v-060333f5"]]),Vi={style:{width:"4em","text-align":"left"}},qi={style:{width:"4em","text-align":"left"}},$t=100,ln=2e3,sn=4096,rn=4096,Gi=100,Ki=100,Qi=we({__name:"settings-adv",props:{expanded:{type:Boolean,required:!1},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}},emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(i){const r=Qe(Ve),s={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},l=Pe(i,"expanded"),a=Pe(i,"multithread"),o=Pe(i,"threadCount"),u=Pe(i,"maxZipSize"),c=Pe(i,"retainExt"),g=Pe(i,"useFolderNameForZip"),v=Pe(i,"shrinkImage"),_=Pe(i,"maxWidth"),x=Pe(i,"maxHeight");Ie(Me,h=>{h>1||(a.value=!1),o.value>h&&(o.value=h)},{immediate:!0});const p=Te(()=>a.value&&Me.value>1);return Re(()=>{Me.value>1&&typeof o.value>"u"&&(o.value=Math.max(Me.value,2))}),(h,f)=>{const k=ke,O=Ee,F=Ba,z=Se,y=Tt,E=xn,D=dt,W=wn;return C(),ee(z,{justify:"center"},{default:t(()=>[n(W,{"display-directive":"show","default-expanded-names":l.value?["collapitem"]:"","on-update:expanded-names":P=>l.value=!!String(P),"trigger-areas":["arrow","main"],class:nt(["settings-body",l.value?"expand-adv-settings":""])},Da({arrow:t(()=>[n(k,{style:pe(l.value&&{top:"8px"})},{default:t(()=>[n(e(Ha))]),_:1},8,["style"]),n(k,null,{default:t(()=>[n(e(Va))]),_:1})]),default:t(()=>[n(D,{title:h.$t("settings.advancedSettings"),name:"collapitem"},{default:t(()=>[n(z,{vertical:"",style:{"padding-left":"2em"}},{default:t(()=>[n(e(xe),at(lt(s)),{trigger:t(()=>[n(z,{vertical:""},{default:t(()=>[n(z,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",disabled:!e(Me),style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[1]||(f[1]=P=>a.value=!a.value)},{icon:t(()=>[n(k,null,{default:t(()=>[n(e(Na))]),_:1})]),default:t(()=>[S(" "+d(h.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(F,{value:a.value,"onUpdate:value":f[2]||(f[2]=P=>a.value=P),disabled:!e(Me),size:"small"},null,8,["value","disabled"])]),_:1}),n(z,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(y,{value:o.value,"onUpdate:value":f[3]||(f[3]=P=>o.value=P),disabled:!e(Me)||!a.value,step:1,min:2,max:e(Me),style:{width:"120px"}},null,8,["value","disabled","max"]),n(E,{onBlur:f[4]||(f[4]=P=>o.value??(o.value=2)),size:"tiny",value:o.value,"onUpdate:value":f[5]||(f[5]=P=>o.value=P),disabled:!e(Me)||!a.value,step:1,min:2,max:e(Me),style:{width:"10em"}},{suffix:t(()=>[S(d(h.$t("threads",o.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[S(" "+d(h.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(e(xe),at(lt(s)),{trigger:t(()=>[n(z,{vertical:""},{default:t(()=>[n(z,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:t(()=>[n(k,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Za))]),_:1})]),default:t(()=>[S(" "+d(h.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(z,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(y,{tooltip:!1,value:u.value,"onUpdate:value":f[6]||(f[6]=P=>u.value=P),step:1,min:$t,max:ln,style:{width:"120px"}},null,8,["value"]),n(E,{onBlur:f[7]||(f[7]=P=>u.value??(u.value=$t)),size:"tiny",value:u.value,"onUpdate:value":f[8]||(f[8]=P=>u.value=P),step:"1",min:$t,max:ln,style:{width:"10em"}},{suffix:t(()=>f[21]||(f[21]=[S("(MB)")])),_:1},8,["value"])]),_:1})]),_:1})]),default:t(()=>[S(" "+d(h.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(e(xe),at(lt(s)),{trigger:t(()=>[n(z,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[9]||(f[9]=P=>g.value=!g.value)},{icon:t(()=>[n(k,null,{default:t(()=>[n(e(zn))]),_:1})]),default:t(()=>[S(" "+d(h.$t("settings.useFolderNameForZip")),1)]),_:1}),n(F,{value:g.value,"onUpdate:value":f[10]||(f[10]=P=>g.value=P),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[S(" "+d(h.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(e(xe),at(lt(s)),{trigger:t(()=>[n(z,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[11]||(f[11]=P=>c.value=!c.value)},{icon:t(()=>[n(k,null,{default:t(()=>[n(e(_n))]),_:1})]),default:t(()=>[S(" "+d(h.$t("settings.retainOriginalExtension")),1)]),_:1}),n(F,{value:c.value,"onUpdate:value":f[12]||(f[12]=P=>c.value=P),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[S(" "+d(h.$t("settings.retainExtTooltip")),1)]),_:1},16),n(e(xe),at(lt(s)),{trigger:t(()=>[n(z,{vertical:""},{default:t(()=>[n(z,{wrap:!1,align:"center"},{default:t(()=>[n(O,{disabled:!p.value,text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[13]||(f[13]=P=>v.value=!v.value)},{icon:t(()=>[n(k,null,{default:t(()=>[n(e(Wa))]),_:1})]),default:t(()=>[S(" "+d(h.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(F,{disabled:!p.value,value:v.value,"onUpdate:value":f[14]||(f[14]=P=>v.value=P),size:"small"},null,8,["disabled","value"])]),_:1}),n(z,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(y,{value:_.value,"onUpdate:value":f[15]||(f[15]=P=>_.value=P),disabled:!v.value||!p.value,step:1,min:Gi,max:sn,style:{width:"120px"}},null,8,["value","disabled"]),n(E,{size:"tiny",onBlur:f[16]||(f[16]=P=>_.value??(_.value=8)),value:_.value,"onUpdate:value":f[17]||(f[17]=P=>_.value=P),disabled:!v.value||!p.value,step:1,min:8,max:sn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[b("span",Vi,d(h.$t("width")),1)]),suffix:t(()=>f[22]||(f[22]=[S("px")])),_:1},8,["value","disabled","max"])]),_:1}),n(z,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(y,{value:x.value,"onUpdate:value":f[18]||(f[18]=P=>x.value=P),disabled:!v.value||!p.value,step:1,min:Ki,max:rn,style:{width:"120px"}},null,8,["value","disabled"]),n(E,{size:"tiny",onBlur:f[19]||(f[19]=P=>x.value??(x.value=8)),value:x.value,"onUpdate:value":f[20]||(f[20]=P=>x.value=P),disabled:!v.value||!p.value,step:1,min:8,max:rn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[b("span",qi,d(h.$t("height")),1)]),suffix:t(()=>f[23]||(f[23]=[S("px")])),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[S(" "+d(h.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1},8,["title"])]),_:2},[l.value?{name:"header-extra",fn:t(()=>[n(e(xe),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(O,{onClick:e(il),size:"tiny",style:{"font-size":"xx-small"}},{default:t(()=>[S(d(h.$t("reset")),1)]),_:1},8,["onClick"])]),default:t(()=>[S(" "+d(h.$t("settings.resetButtonTooltip")),1)]),_:1}),e(r).IS_DEV?(C(),K("button",{key:0,onClick:f[0]||(f[0]=P=>e(rl)())},"delcfg")):ue("",!0)]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1})}}}),Yi=Be(Qi,[["__scopeId","data-v-31f045db"]]),Xi={},Ji={style:{color:"gray","padding-left":"20px"}},er=["innerHTML"];function tr(i,r){const s=pn,l=Se;return C(),ee(l,{vertical:"",justify:"end"},{default:t(()=>[n(s,{style:{margin:"0px"}}),n(l,{justify:"center"},{default:t(()=>[b("ul",Ji,[(C(!0),K(Oe,null,ut(i.$tm("descriptions"),a=>(C(),K("li",{key:a,style:{"text-align":"left"},innerHTML:a},null,8,er))),128))])]),_:1})]),_:1})}const nr=Be(Xi,[["render",tr]]);function or(i={}){const{immediate:r=!1,onNeedRefresh:s,onOfflineReady:l,onRegistered:a,onRegisteredSW:o,onRegisterError:u}=i;let c,g,v;const _=async(p=!0)=>{await g,v==null||v()};async function x(){if("serviceWorker"in navigator){if(c=await ze(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/avif2jpeg/dist/sw.js",{scope:"/avif2jpeg/dist/",type:"classic"})).catch(p=>{u==null||u(p)}),!c)return;v=()=>{c==null||c.messageSkipWaiting()};{let p=!1;const h=()=>{p=!0,c==null||c.addEventListener("controlling",f=>{f.isUpdate&&window.location.reload()}),s==null||s()};c.addEventListener("installed",f=>{typeof f.isUpdate>"u"?typeof f.isExternal<"u"&&f.isExternal?h():!p&&(l==null||l()):f.isUpdate||l==null||l()}),c.addEventListener("waiting",h)}c.register({immediate:r}).then(p=>{o?o("/avif2jpeg/dist/sw.js",p):a==null||a(p)}).catch(p=>{u==null||u(p)})}}return g=x(),_}function ar(i={}){const{immediate:r=!0,onNeedRefresh:s,onOfflineReady:l,onRegistered:a,onRegisteredSW:o,onRegisterError:u}=i,c=w(!1),g=w(!1);return{updateServiceWorker:or({immediate:r,onNeedRefresh(){c.value=!0,s==null||s()},onOfflineReady(){g.value=!0,l==null||l()},onRegistered:a,onRegisteredSW:o,onRegisterError:u}),offlineReady:g,needRefresh:c}}const lr={style:{"line-height":"0px"}},sr=["innerHTML"],ir={class:"message"},rr={key:0},ur=we({__name:"PWAPrompt",setup(i){const r=w(null),s=w("unknown"),l=w(),a=w(navigator.onLine);window.addEventListener("beforeinstallprompt",p=>{p.preventDefault(),r.value=p,l.value=!1}),window.addEventListener("appinstalled",p=>{g()}),window.addEventListener("online",()=>{a.value=!0}),window.addEventListener("offline",()=>{a.value=!1});const{offlineReady:o,needRefresh:u,updateServiceWorker:c}=ar({onOfflineReady(){},async onNeedRefresh(){const p=await fetch(location.origin+"/avif2jpeg/dist/version.txt",{cache:"no-store"});if(p.status!==200)return;const h=await p.text();h&&(s.value=h)},onRegisterError(p){}});Re(()=>{setTimeout(()=>{l.value===void 0&&(l.value=!0),l.value},100)});function g(){var p;(p=navigator.serviceWorker)==null||p.ready.then(h=>{var f;l.value||((f=h.active)==null||f.postMessage("app-installed"),l.value=!0)})}async function v(){if(r.value&&a){r.value.prompt();const p=await r.value.userChoice;r.value=null,p.outcome==="accepted"&&g()}}async function _(){o.value=!1,u.value=!1,r.value=null}async function x(){_(),await c()}return(p,h)=>{const f=ke,k=Se,O=xe,F=Ee,z=kn;return C(),K("div",lr,[l.value?(C(),ee(O,{key:0,placement:"bottom"},{trigger:t(()=>[n(k,{id:"app-installed",align:"center",size:1},{default:t(()=>[n(f,{component:e(Xt)},null,8,["component"]),h[0]||(h[0]=S("PWA "))]),_:1,__:[0]})]),default:t(()=>[S(d(p.$t("PWAInstalledTooltip")),1)]),_:1})):r.value&&!e(u)?(C(),ee(O,{key:1,placement:"bottom","keep-alive-on-hover":!0,style:{"max-width":"40vw"},delay:300,duration:150,"z-index":10},{trigger:t(()=>[n(F,{onClick:v,size:"tiny"},{icon:t(()=>[n(f,{component:e(Xt)},null,8,["component"])]),default:t(()=>[S(" "+d(p.$t("installAsApp")),1)]),_:1})]),default:t(()=>[b("div",{id:"pwa-tooltip",innerHTML:p.$t("PWAinstallAsAppTooltip")},null,8,sr)]),_:1})):ue("",!0),n(Ge,null,{default:t(()=>[e(u)?(C(),ee(z,{key:0,title:s.value,type:"info",closable:"",class:"pwa-toast"},{default:t(()=>[b("p",ir,[S(d(p.$t("PWAUpdateMessage"))+" ",1),e(u)?(C(),K("span",rr)):ue("",!0)]),n(k,{size:8},{default:t(()=>[e(u)?(C(),ee(F,{key:0,onClick:x,round:"",type:"primary",size:"small"},{default:t(()=>[S(d(p.$t("Reload")),1)]),_:1})):ue("",!0),n(F,{onClick:_,round:"",size:"small"},{default:t(()=>[S(d(p.$t("close")),1)]),_:1})]),_:1})]),_:1},8,["title"])):ue("",!0)]),_:1})])}}}),cr=["innerHTML"],dr=we({__name:"switch-lang",props:{delay:{}},emits:["ready","lang-ready","lang-change","lang-path-change"],async setup(i,{emit:r}){let s,l;const a=Qe(Ve),o=Mt(),{locale:u,t:c}=Ne(),g=ct(),v=i,_=r,x=Object.entries(Zl).map(([z,y])=>({label:y,value:z}));x.sort((z,y)=>{const E=z.label,D=y.label;return E>D?1:E<D?-1:0}),Re(()=>{o.afterEach((z,y,E)=>{f(),a.switchToolTipVisibility()})}),[s,l]=qa(()=>f()),await s,l(),p(),_("ready");function p(){const z="/avif2jpeg/dist/",y=[];for(const E of it){if(o.currentRoute.value.path.includes(E))continue;const D={rel:"alternate",hreflang:E,href:z+E};y.push(D)}y.push({rel:"alternate",hreflang:"x-default",href:z}),Ga({title:c("title"),meta:[{property:"og:title",content:c("title")},{property:"og:description",content:c("metaDescription")}],link:[...y]})}async function h(z){if(z!==u.value||ht.global.availableLocales.indexOf(z)===-1){if(_("lang-change",z),await ms(v.delay),!await Wl(z))return g.error({title:c("Failed to get language file"),positiveText:"OK",content:()=>J("div",[`lang: ${z}`])}),_("lang-ready",""),!1;u.value=z,document.title=c("title"),document.documentElement.lang=z,await Ce()}return _("lang-ready",z),!0}async function f(){var E;const y=((E=(o.currentRoute.value.path||"").match(/([^/]+)\/?$/))==null?void 0:E[1])||"";y&&it.includes(y)?await h(y)&&_("lang-path-change",y):await k()}async function k(){const z=O().toLowerCase(),y=z.split(/[-_]/)[0];if(it.includes(y)){let E=y;if(y==="zh")switch(z){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":E="zh-hant"}await h(E)}}function O(){const z=window.navigator;return z.language||z.userLanguage||z.browserLanguage}function F(z){const y=z?z+"/":"";o.push("/"+y)}return(z,y)=>{const E=ke,D=Ut("router-link"),W=xe,P=It,M=Se;return C(),ee(M,{align:"center",size:2},{default:t(()=>[e(o).currentRoute.value.path!=="/"?(C(),ee(W,{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"left",duration:0,delay:50},{trigger:t(()=>[n(D,{to:"/",onClick:y[0]||(y[0]=T=>_("lang-path-change","")),style:{color:"gray","line-height":"0px","font-size":"1.2em"}},{default:t(()=>[n(E,{component:e(Ka)},null,8,["component"])]),_:1})]),default:t(()=>[S(d(e(c)("selectLangCloseTooltip")),1)]),_:1})):ue("",!0),n(W,{to:!1,trigger:"hover","keep-alive-on-hover":!1,placement:e(a).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:t(()=>[n(P,{ref:"langselect",size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,options:e(x),"_v-model:value":"locale",value:e(u),"onUpdate:value":F},{arrow:t(()=>[n(E,null,{default:t(()=>[n(e(Qa))]),_:1})]),_:1},8,["options","value"])]),default:t(()=>[b("div",{innerHTML:z.$t("selectLanguage")},null,8,cr)]),_:1},8,["placement"])]),_:1})}}}),Ve=Symbol("global variables"),pr=we({__name:"Avif2Jpeg",emits:["ready"],setup(i,{emit:r}){const{t:s,locale:l}=Ne(),a=200,o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),u=!1,c=w(null);w(0);let g=w(void 0);const v=w(!0),_=w(!1),x=w(!1),p=w(!1),h=w(!0);w(!1);const f=w(!1);Ja(Ve,{showTooltipsBeforeMounted:g,LANDSCAPE:v,IS_SP:o,IS_DEV:u,switchToolTipVisibility:E,SSR:!1}),Re(()=>{D(),window.addEventListener("resize",D),E(),setTimeout(()=>x.value=!0,3e3)}),vt(()=>{window.removeEventListener("resize",D)});function k(){var Q;!((Q=cn().path.match(/[^/]+(?=\/?$)/))==null?void 0:Q[0])&&N.lang&&Mt().push("/"+N.lang)}let O=0;function F(){p.value=!1,O=Date.now()}function z(M){N.lang=M}function y(){const M=h.value?0:Math.max(0,a-(Date.now()-O));h.value=!1,Ce(()=>{setTimeout(()=>p.value=!0,M)})}async function E(){}function D(){const M=document.body.clientWidth,T=document.body.clientHeight;v.value=M*.75>T||M>900}function W(M){c.value=M}function P(M){f.value=M}return(M,T)=>{const Q=Ut("ClientOnly"),ae=Se,ge=ke,Ae=Ye;return C(),ee(ae,{vertical:"",align:"stretch",class:"avif2jpeg"},{default:t(()=>[n(Vl,null,{"lang-switch":t(()=>[(C(),ee(Ya,null,{default:t(()=>[n(dr,{onLangChange:F,onLangReady:y,onLangPathChange:z,onReady:k,delay:e(h)?0:a},null,8,["delay"])]),_:1}))]),_:1}),n(Q,null,{default:t(()=>[n(ur)]),_:1}),n(Ge,{name:"fade"},{default:t(()=>[Ze(n(ae,{vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:t(()=>[n(ae,{justify:"space-around",vertical:"",style:{height:"100%"}},{default:t(()=>[n(Kl),n(ae,{justify:"center"},{default:t(()=>[n(Bi,{target:e(N).acceptTypeValue,"onUpdate:target":T[0]||(T[0]=j=>e(N).acceptTypeValue=j),userExtensions:e(N).editedAcceptTypes,"onUpdate:userExtensions":T[1]||(T[1]=j=>e(N).editedAcceptTypes=j),"disable-notifying-folder-select":e(N).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":T[2]||(T[2]=j=>e(N).disableNotifyingFolderSelect=j),forbidden:e(_),onInput:W,onClick:T[3]||(T[3]=j=>P(!0)),onCancel:T[4]||(T[4]=j=>P(!1))},null,8,["target","userExtensions","disable-notifying-folder-select","forbidden"])]),_:1}),n(Ii,{input:e(c),format:e(N).imageFormat,quality:e(N).imageQuality,"retain-extension":e(N).retainExtension,maxZipSizeMB:e(N).maxZipSizeMB,threads:e(N).multithread?e(N).threadCount:0,"show-note":e(f),"onUpdate:showNote":T[5]||(T[5]=j=>je(f)?f.value=j:null),onStart:T[6]||(T[6]=j=>_.value=!0),onEnd:T[7]||(T[7]=j=>_.value=!1)},{"lang-switch":t(()=>T[18]||(T[18]=[])),_:1},8,["input","format","quality","retain-extension","maxZipSizeMB","threads","show-note"]),n(ae,{vertical:"",align:"center"},{default:t(()=>[n(Ae,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(ge,{size:"5vh",color:"#DADADA",style:{margin:"0px"}},{default:t(()=>[n(e(Xa))]),_:1})]),default:t(()=>[T[19]||(T[19]=b("span",null,"CONVERT TOüëá",-1))]),_:1,__:[19]})]),_:1}),n(ae,{vertical:"",align:"center"},{default:t(()=>[n(Hi,{format:e(N).imageFormat,"onUpdate:format":T[8]||(T[8]=j=>e(N).imageFormat=j),quality:e(N).imageQuality,"onUpdate:quality":T[9]||(T[9]=j=>e(N).imageQuality=j)},null,8,["format","quality"]),n(Yi,{"retain-ext":e(N).retainExtension,"onUpdate:retainExt":T[10]||(T[10]=j=>e(N).retainExtension=j),"use-folder-name-for-zip":e(N).useFolderNameForZip,"onUpdate:useFolderNameForZip":T[11]||(T[11]=j=>e(N).useFolderNameForZip=j),"max-zip-size":e(N).maxZipSizeMB,"onUpdate:maxZipSize":T[12]||(T[12]=j=>e(N).maxZipSizeMB=j),multithread:e(N).multithread,"onUpdate:multithread":T[13]||(T[13]=j=>e(N).multithread=j),"thread-count":e(N).threadCount,"onUpdate:threadCount":T[14]||(T[14]=j=>e(N).threadCount=j),"shrink-image":e(N).shrinkImage,"onUpdate:shrinkImage":T[15]||(T[15]=j=>e(N).shrinkImage=j),"max-width":e(N).maxWidth,"onUpdate:maxWidth":T[16]||(T[16]=j=>e(N).maxWidth=j),"max-height":e(N).maxHeight,"onUpdate:maxHeight":T[17]||(T[17]=j=>e(N).maxHeight=j)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","multithread","thread-count","shrink-image","max-width","max-height"])]),_:1}),n(nr)]),_:1})]),_:1},512),[[We,e(p)]])]),_:1})]),_:1})}}}),fr={key:0,style:{"text-align":"center"}},Bt=we({__name:"App",setup(i){const r={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{},Image:{toolbarColor:"#00000099"}},s=w(!0);return Re(()=>{s.value=!1}),(l,a)=>{const o=ol,u=nl,c=tl,g=el,v=al;return C(),K(Oe,null,[e(s)?(C(),K("div",fr," Rendering the page‚Ä¶ please wait. ")):ue("",!0),n(v,{"theme-overrides":r,style:{width:"100%",height:"100%"}},{default:t(()=>[n(g,null,{default:t(()=>[n(c,{placement:"top-left",closable:!0,max:50},{default:t(()=>[n(u,null,{default:t(()=>[n(o,null,{default:t(()=>[n(pr,{class:nt({hide:e(s)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}}),ta=[{path:"/",name:"Home",component:Bt}];for(const i of it)ta.push({path:"/"+i+"/",strict:!0,name:i,component:Bt});ll(Bt,{routes:ta,base:"/avif2jpeg/dist/"},({app:i,router:r,routes:s,isClient:l,initialState:a})=>{i.use(ht)});
