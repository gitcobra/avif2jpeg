var Zo=Object.defineProperty;var Vo=(l,i,s)=>i in l?Zo(l,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[i]=s;var tt=(l,i,s)=>Vo(l,typeof i!="symbol"?i+"":i,s);import{r as w,a as zt,d as Te,i as Je,c as ie,o as P,_ as Ie,u as e,w as t,b as A,t as d,e as n,f as Ho,N as ye,L as Wo,g as se,B as Le,h as Ut,j as v,F as Ee,k as ct,l as qo,m as X,n as Go,p as Ko,q as Fe,s as me,v as sn,x as rn,y as un,z as Ae,A as be,C as Ce,D as Ft,E as Ot,G as He,H as Ge,I as Yo,J as Qo,K as je,M as xt,O as de,P as Qe,T as Xe,Q as dn,R as Be,S as Mt,U as It,V as Rt,W as nt,X as Re,Y as vt,Z as Xo,$ as ot,a0 as Jo,a1 as qt,a2 as Gt,a3 as cn,a4 as et,a5 as ea,a6 as At,a7 as ta,a8 as na,a9 as Nt,aa as oa,ab as Kt,ac as pn,ad as aa,ae as la,af as at,ag as $e,ah as sa,ai as jt,aj as Tt,ak as ia,al as De,am as ra,an as fn,ao as gn,ap as ua,aq as mn,ar as da,as as Yt,at as vn,au as ca,av as pa,aw as fa,ax as ga,ay as ma,az as va,aA as Bt,aB as hn,aC as ha,aD as _a,aE as _n,aF as wa,aG as it,aH as rt,aI as ya,aJ as ba,aK as ka,aL as za,aM as xa,aN as Ia,aO as Aa,aP as Ta,aQ as Sa,aR as La,aS as Ca,aT as $a,aU as Ea,aV as Fa,aW as Oa,aX as Pa,aY as Ua,aZ as Ma}from"./vendor-CMlg4H3Z.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const f of a.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&p(f)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function p(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();const Pe=w(navigator.hardwareConcurrency?Math.min(navigator.hardwareConcurrency,12):0),ut={threadCount:{min:2,max:Math.max(2,Pe.value)}},Ra={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:Pe.value,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1},V=zt(wn({}));function Na(){wn(V)}function wn(l){return Object.assign(l,Ra)}const yn="avif2jpeg",Lt=JSON.parse(localStorage.getItem(yn)||"{}");for(const l in V)if(Lt.hasOwnProperty(l)&&Lt[l]!==void 0){let i=Lt[l];ut.hasOwnProperty(l)&&(ut[l].min>i&&(i=ut[l].min),ut[l].max<i&&(i=ut[l].max)),V[l]=i}const ja=()=>{const l={};for(const i in V)l[i]=V[i];localStorage.setItem(yn,JSON.stringify(l))};window.addEventListener("beforeunload",ja);const Ba=Te({__name:"github",setup(l){const i=Je(Ye);return(s,p)=>{const o=ye,a=Ho,f=Ie;return P(),ie(f,{to:!1,"display-directive":"show",show:e(i).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(a,{href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-size":"small","font-weight":"bolder"}},{default:t(()=>[n(o,null,{default:t(()=>[n(e(Wo))]),_:1}),p[0]||(p[0]=A("GitHub"))]),_:1})]),default:t(()=>[A(" "+d(s.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),Da=["href"],Za=Te({__name:"licenses",setup(l){const i=w(!1),s={Vue:"https://github.com/vuejs/core/blob/main/LICENSE",Vite:"https://github.com/vitejs/vite/blob/main/LICENSE","Vite SSG":"https://github.com/antfu/vite-ssg/blob/main/LICENSE","Naive UI":"https://github.com/TuSimple/naive-ui/blob/main/LICENSE",Ionicons:"https://github.com/ionic-team/ionicons/blob/main/LICENSE"};return(p,o)=>{const a=Le;return P(),se(Ee,null,[n(a,{text:"",onClick:o[0]||(o[0]=f=>i.value=!0),style:{color:"black","font-size":"small"}},{default:t(()=>o[2]||(o[2]=[A("Licenses")])),_:1}),n(e(Ut),{preset:"dialog",ref:"dialog",show:i.value,"onUpdate:show":o[1]||(o[1]=f=>i.value=f),"positive-text":"OK",title:"Licenses"},{default:t(()=>[o[3]||(o[3]=v("h3",null,"Used Framework and Libraries",-1)),v("ul",null,[(P(),se(Ee,null,ct(s,(f,c)=>v("li",null,[v("a",{href:f},d(c),9,Da)])),64))])]),_:1},8,["show"])],64)}}}),Va=1,Ha=10,Wa=10,qa="",ft={major:Va,minor:Ha,build:Wa,tag:qa},Ga={style:{"font-size":"x-small","user-select":"none"}},Ka=Te({__name:"version",setup(l){const i=["0.0.118"],s=`${ft.major}.${ft.minor}.${ft.build}${ft.tag}`,p=i.map(c=>({label:`v${c}`,key:c,value:c}));function o(c){const{key:b,label:h}=c,_=f(b),y=X("a",{href:_},h),g=X("div",null,y);return X("div",null,g)}function a(c){location.href=f(c)}function f(c){return`/avif2jpeg/old/${c}/`}return(c,b)=>{const h=qo;return P(),ie(h,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:e(p),"render-label":o,"onUpdate:value":a},{header:t(()=>[v("span",Ga,d(c.$t("previousVersion")),1)]),default:t(()=>[v("span",{style:{cursor:"pointer"}},"v"+d(s))]),_:1},8,["options"])}}}),Ya=Te({__name:"header",setup(l){const i=Go();return(s,p)=>{const o=Ko("router-link"),a=Fe,f=rn;return P(),ie(a,{vertical:"",justify:"start"},{default:t(()=>[n(a,{justify:"space-between",align:"center",wrap:!1},{default:t(()=>[n(a,{align:"center"},{default:t(()=>[n(Ba),n(Ka),n(Za),n(a,{style:{"font-size":"small"}},{default:t(()=>[e(i).path!=="/"?(P(),ie(o,{key:0,to:"/"},{default:t(()=>p[0]||(p[0]=[A("HOME")])),_:1})):me("",!0)]),_:1})]),_:1}),n(a,{align:"end",style:{"font-size":"x-small"}},{default:t(()=>[sn(s.$slots,"lang-switch")]),_:3})]),_:3}),n(f,{style:{margin:"0px"}})]),_:3})}}}),Qa={style:{padding:"0px",margin:"0px","text-align":"center"}},Xa=Te({__name:"title",setup(l){const i=un();return Ae(()=>{const s=i.currentRoute.value.path||"";return!String(s.match(new RegExp("(?<=^\\/)[^/]+"))||"")}),(s,p)=>{const o=Fe;return P(),ie(o,{align:"center",justify:"center",style:{margin:"0px"}},{default:t(()=>[v("h1",Qa,d(s.$t("title")),1)]),_:1})}}}),Qt=new Set,Ja=new Set,el=new Set,ht=new Map;function tl(l){const i=ht.get(l);if(!i){console.warn("the worker was already released.",l.id);return}ht.delete(l),i(),gt==null||gt(),gt=null}function nl(){for(const l of ht.keys())tl(l)}let gt=null;function bn(){nl();for(const l of Qt)l.onmessage=null,l.terminate();Qt.clear(),Ja.clear(),el.clear(),ht.clear()}function ol(l){return new Worker("/avif2jpeg/dist/assets/worker.zip-BpG-kYFu.js",{name:l==null?void 0:l.name})}function al(l){return new Worker("/avif2jpeg/dist/assets/worker.loader-hdSA9Vyi.js",{name:l==null?void 0:l.name})}const ll=1e3*10;let Ke;const Me=new Map,_t=new Map,wt=new Map;let Dt,ee,Zt,yt,mt,kn,zn,xn,In,pt;function Ct(l){if({files:mt,completedFileIdSet:Dt,ConvStats:ee,canceled:Zt,props:yt,format:kn,quality:zn,outputExt:xn,imageType:In,message:pt}=l||{},Ke=null,Me.clear(),_t.clear(),wt.clear(),_t.clear(),wt.clear(),l)for(const s in l)delete l[s]}async function sl(l){Ct(l),Dt.clear();let i;try{i=await il()}catch{return Ct(),{exception:new Error("worker-load-error"),callbackToClearConverter:new Function,callbackToGenerateFailedZips:new Function}}const[s,p]=i;Ke=p;const o=new Promise(g=>{p.onmessage=u=>{const I=u.data,{action:O}=I;switch(O){case"squeeze-zip":case"zip-squeeze-error":g(void 0);break}}}),a=new Promise(g=>{s.onmessage=u=>{const{data:{action:I}}=u;I==="end-convert"&&g()}}),f=mt.map(g=>g._id);mt.forEach(g=>_t.set(g._id,g));const c=be(Zt,g=>{if(!g)return;c();const u={action:"cancel-convert"};s.postMessage(u)}),b={action:"start-convert",list:mt,fileIdList:f,outputQuality:zn,outputType:kn,threads:yt.threads,maxSize:V.shrinkImage?{width:V.maxWidth,height:V.maxHeight}:null};s.postMessage(b),await a,console.log("end loader worker"),p.postMessage({action:"squeeze"}),await o,console.log("end zip worker"),c();const h=()=>{bn(),p.onmessage=null,p.terminate(),s.onmessage=null,s.terminate(),Ct()};let _=!1;return{callbackToClearConverter:h,callbackToGenerateFailedZips:async g=>{_||(_=!0,await vl(g,p,{},ee))}}}async function il(){bn();const l=new al,i=new ol,s=new Promise((f,c)=>{const b=u=>{i.removeEventListener("message",y),l.removeEventListener("message",y),clearTimeout(g),u?(console.log("workers are avialble"),f(u)):(console.error("couldn't get responses from workers"),c(u))};let h=!1,_=!1;const y=u=>{u.target===i&&(console.log("got a message from zip worker"),h=!0),u.target===l&&(console.log("got a message from loader worker"),_=!0),h&&_&&b(!0)};let g=0;i.addEventListener("message",y),l.addEventListener("message",y),g=window.setTimeout(()=>b(!1),ll)}),{port1:p,port2:o}=new MessageChannel,a={action:"set-zip-port"};return i.postMessage({action:"set-port-loader"},[p]),l.postMessage(a,[o]),console.log("test workers' availability"),await s,i.postMessage({action:"set-config",zipSize:yt.maxZipSizeMB*1024*1024,keepExt:yt.retainExtension,outputExt:xn,imageType:In}),l.addEventListener("message",ul),i.addEventListener("message",rl),[l,i]}const rl=l=>{const i=l.data,{action:s}=i;switch(s){case"add-zip-completed":{const{fileId:f,entireIndex:c,storedPath:b}=i;return}case"respond-image":{const{url:f,index:c,path:b,size:h,fileId:_}=i;ee.convertedImageUrl=f,ee.convertedImageSize=h,ee.convertedImageIndex=c,ee.convertedImageName=b;let y="",g=0,u="";const I=Me.get(_);if(_>=0){const O=_t.get(_);y=URL.createObjectURL(O),g=O.size,u=O.webkitRelativePath||O.name}ee.convertedImageOrgUrl=y,ee.convertedImageOrgSize=g,ee.convertedImageOrgName=u,ee.convertedImageShrinked=I==null?void 0:I.shrinked;return}case"respond-delete":{const{index:f,success:c,fileId:b}=i;Me.get(b).command="❌deleted",Me.get(b).completed=!1;return}}switch(s){case"error-push-filelist-zip":const{path:f}=i;ee.failedZipDone=!0,pt.error(`an error occurred "${f}"`,{duration:3e3});return}const{size:p,count:o}=i,a="url"in l.data?l.data.url:"";switch(s){case"push-zip":ee.zips.push({url:a,size:p,count:o}),ee.zippedTotalCount+=o,ee.zippedTotalSize+=p;break;case"squeeze-zip":o>0&&(ee.zips.push({url:a,size:p,count:o}),ee.zippedTotalCount+=o,ee.zippedTotalSize+=p);break;case"push-filelist":ee.failedFileZippedCount++;break;case"squeeze-filelist-zip":ee.failedZipDone=!0;case"push-filelist-zip":console.log("push-filelist-zip",o),ee.failedZips.push({url:a,size:p,count:o}),console.log(o);break;case"zip-error":case"zip-squeeze-error":ee.zippingErrorCount+=o;break}},ul=l=>{l.target;const{data:i}=l,{action:s}=i;switch(s){case"list-start":break;case"list-end":break;case"file-start":{const{index:p,path:o,fileId:a}=i;cl(p,o,a);break}case"file-load":{const{thumbnail:p,width:o,height:a,fileId:f,workerId:c,inputsize:b}=i,h=Me.get(f);h.core=c,h.command="🖼️loaded",h.width=o,h.height=a,h.size=b,p&&(ee.thumbnail=p);break}case"file-converted":{const{index:p,path:o,fileId:a,shrinked:f,outputWidth:c,outputHeight:b,outputsize:h}=i,_=Me.get(a);_.command="🔃converted",_.shrinked??(_.shrinked=f),_.outputWidth=c,_.outputHeight=b,_.outputSize=h,ee.converted++;break}case"file-completed":{const{inputsize:p,outputsize:o,fileId:a,entireIndex:f,storedPath:c}=i,b=Me.get(a);b&&(b.command="✅completed",b.completed=!0,b.fileId=a),ee.inputTotalSize+=p,ee.outputTotalSize+=o,ee.done++,ee.success++,Dt.add(a),b.zippedIndex=f,ee.ziplogs[f]={fileId:a,storedPath:c};break}case"file-retry":{const{index:p,path:o,fileId:a}=i;pl(p,o,a);break}case"file-error":{const{index:p,path:o,fileId:a}=i;fl(p,o,a);break}case"file-canceled":{const{fileId:p,path:o}=i;gl(p);break}}};let dl=0;function cl(l,i,s){const p={key:dl++,core:-1,index:l,path:i,command:"➡️started"};Me.set(s,p),ee.logs.push(p),wt.has(s)?console.warn(`retry "${i}".`):Zt.value||ee.startedCount++}function pl(l,i,s){const p=Me.get(s);p.command="⚠️retrying",p.error=!0,pt.warning(`retrying "${i}"`,{duration:3e3}),ee.retried++,wt.set(s,1)}function fl(l,i,s){console.error(`failed to load "${i}". the image may be corrupted or cannot be read by some reason.`);const p=Me.get(s);ee.done++,ee.failure++,p.command="❗failed",p.error=!0,pt.error(`failed to load "${i}"`,{duration:5e3})}function gl(l){const i=Me.get(l);ee.done++,ee.failure++,i.command="❗canceled",i.error=!0}function ml(l){Ke==null||Ke.postMessage({action:"request-image",index:l})}function $t(l){Ke==null||Ke.postMessage({action:"delete-image",index:l})}async function vl(l,i,s,p){let o=0;for(const a of l){const f=(a.webkitRelativePath||a.name).replace(/^\//,"");if(p.failedZipDone)break;if(s.value)return;o-p.failedFileZippedCount>20&&await new Promise(c=>setTimeout(c,10)),i.postMessage({action:"add-filelist",file:a,path:f}),o++}if(p.failedZipDone){pt.error("Zipping error files was aborted",{duration:5e3});return}i.postMessage({action:"squeeze-filelist"})}function Ne(l,i=2){const s=Math.sign(l);l=Math.abs(l);const p=["Bytes","KB","MB","GB"],o=l?Math.floor(Math.log(l)/Math.log(1024)):0;return`${(l/Math.pow(1024,o)*s).toFixed(i)}${p[o]}`}function An(l,i=100,s=!1){i=typeof i=="number"?{width:i,height:i}:i;const{width:p,height:o}=i;let{width:a,height:f}=l;const c=a/f,b=p/o;return c>=b?(a=s?Math.min(p,a):p,f=a/c|0):(f=s?Math.min(o,f):o,a=f*c|0),{width:a,height:f}}class hl{constructor(){tt(this,"_currentFileCount",0);tt(this,"_currentZipIndex",0);tt(this,"_totalFileCount",0);tt(this,"_zipLengthSumList",[]);tt(this,"_pathBank",{})}increase(i){return i&&(this._pathBank[i]=[this._zipLengthSumList.length,this._currentFileCount]),this._currentFileCount++,this._totalFileCount++}split(){this._zipLengthSumList.push(this._totalFileCount),this._currentZipIndex++,this._currentFileCount=0}get(i){if(typeof i=="number"){let s=this._zipLengthSumList.findIndex((a,f)=>i<a);s===-1&&(s=this._zipLengthSumList.length);const p=this._zipLengthSumList[s-1]||0,o=i-p;return[s,o]}else{const s=this._pathBank[String(i)];if(s)return s}return null}getZipIndex(){return this._currentZipIndex}getIndex(){return this._totalFileCount}}function _l(l){return new Promise(i=>setTimeout(i,l))}function wl(l,i=0){const s=w(l);return be(s,p=>{p!==void 0&&Ce(()=>{setTimeout(()=>s.value=void 0,i)})},{immediate:!0}),s}let dt;async function yl(l,i,s,p,o){let a="";const f=document.createElement("canvas"),c=f.getContext("2d");let b=new Ft;const h=[b],_=new hl,y=s.format,g=s.quality/100,u=[...y.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),I=l.length,O=s.maxZipSizeMB*1024*1024;let S=0,F=null,j="",T="",Z=0,B=0,m=0,J=0,W=0,he=!1;dt=E=>{const[N,Y]=_.get(E),ce=h[N],re=ce.get(Y,y);o.convertedImageIndex=E,o.convertedImageName=ce.getPathByIndex(Y),o.convertedImageUrl=URL.createObjectURL(re),o.convertedImageSize=re.size;let ge="",pe=0,ke="";const H=M[E];ge=URL.createObjectURL(H),pe=H.size,ke=H.webkitRelativePath||H.name,o.convertedImageOrgUrl=ge,o.convertedImageOrgSize=pe,o.convertedImageOrgName=ke};const M=[];for(const E of l){if(p.value)break;const N=E.name;let Y="";const ce=E.size,re=(E.webkitRelativePath||E.relativePath||N).replace(/^\//,""),ge=document.createElement("img"),pe={key:m++,core:-1,index:S++,path:re,command:"➡️start"};o.startedCount=S,o.logs.push(pe),o.logs.length-1,a&&(URL.revokeObjectURL(a),a=""),a=URL.createObjectURL(E),T=a,Z=E.size,ge.src=a;const ke=await Tn(ge).then(()=>!0).catch(()=>!1);if(!ge.complete||!ke||p.value){o.done++,o.failure++,pe.command="❗failed";continue}const H=ge.width,R=ge.height;f.width=H,f.height=R,c.drawImage(ge,0,0,H,R,0,0,H,R),pe.command="🖼️imgload",o.thumbnail=ge;const D=await new Promise(ae=>{const z=x=>{F=x,ae(x)};f.toBlob(z,y,g)});if(p.value)break;if(!D){console.log("failed to toBlob",N),o.failure++;continue}B=D.size,o.converted++;let te="";if(W+B>=O){try{await b.wait(),te=await b.url()}catch(ae){he=!0,console.warn(ae.message,W),alert("memory problem occurred");break}o.zips.push({url:te,size:W,count:J}),o.zippedTotalCount+=J,o.zippedTotalSize+=W,W=0,J=0,_.split(),b=new Ft,h.push(b)}W+=B;const oe=re||N;for(let ae=1;ae<255&&(Y=oe.replace(s.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(ae>1?`(${ae})`:"")+"."+u,!!b.has(Y));ae++);o.done++;try{J++,b.add(Y,D)}catch(ae){console.error(ae.message);continue}_.increase(),M.push(E),o.inputTotalSize+=ce,o.outputTotalSize+=B,o.ziplogs.push({fileId:E._id,storedPath:Y}),j=Y,pe.zippedIndex=o.success,o.success++,pe.command="✅completed",pe.completed=!0,pe.fileId=E._id,i.add(E._id)}if(o.success>0)if(I===1)F&&(o.convertedImageIndex=0,o.convertedImageName=j.replace(/^.*\/(?=[^/]+$)/,"").replace(s.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+u,o.convertedImageUrl=URL.createObjectURL(F),o.convertedImageOrgUrl=T,o.convertedImageOrgSize=Z);else try{if(he)throw new Error("terminated zipping process for memory problems");await b.wait();const E=await b.url();o.zips.push({url:E,count:J,size:W}),o.zippedTotalCount+=J,o.zippedTotalSize+=W}catch(E){console.error(E.message)}const fe={value:!1},_e=()=>{fe.value=!0,h.forEach(E=>E.clear()),h.length=0,M.length=0,dt=null};let Se=!1;return{callbackToClearConverter:_e,callbackToGenerateFailedZips:async E=>{Se||(Se=!0,kl(E,O,o,fe))}}}function bl(l){dt==null||dt(l)}async function kl(l,i,s,p){let o=0,a=0,f=new Ft;for(let c=0;c<l.length;c++){const b=l[c],h=(b.webkitRelativePath||b.name).replace(/^\//,"");if(p.value)return;try{await f.add(h,b)}catch{alert(`an error occurred during access to "${h}"`);break}if(a+=b.size,o++,s.failedFileZippedCount++,a>=i||c===l.length-1){await f.zip();const _=await f.url();s.failedZips.push({url:_,size:a,count:o}),f.clear(),a=0,o=0}}s.failedZipDone=!0}function Tn(l){if(typeof l.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((i,s)=>{l.onload=i,l.onerror=s})}const We=(l,i)=>{const s=l.__vccOpts||l;for(const[p,o]of i)s[p]=o;return s},zl={class:"container"},xl={__name:"zipicon",setup(l){return(i,s)=>(P(),se("span",zl,[n(e(ye),null,{default:t(()=>[n(e(Ot))]),_:1}),s[0]||(s[0]=v("span",{class:"text"},"ZIP",-1))]))}},Il=We(xl,[["__scopeId","data-v-8b8df2f0"]]),Al=["href","download","title"],Tl='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',Sl=Te({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean},hidden:{type:Boolean}},emits:["load","error","next","prev"],setup(l,{expose:i,emit:s}){const{t:p}=He(),o=l,a=s,f=w();w();const c=w(!0),b=w(""),h=w(o.width||100),_=w(o.height||100),y=w(!1),g=zt({width:h.value+"px",height:_.value+"px",minWidth:"50px",minHeight:"50px"});Ge(()=>{var T,Z,B;(Z=(T=f.value)==null?void 0:T.previewInstRef)==null||Z.setPreviewSrc(Tl),URL.revokeObjectURL((((B=f.value)==null?void 0:B.imageRef)||{}).src),f.value=null});const u=w(!0);Yo(()=>{u.value=!1}),Qo(()=>{u.value=!0}),be(o,(T,Z)=>{g.width=(o.width||100)+"px",g.height=(o.height||100)+"px"}),be(()=>o.src,(T,Z)=>{u.value&&S(T)},{immediate:!0}),i({download:F,openPreview:j,active:u});async function I(T){const Z=T.target,B=Z.naturalWidth,m=Z.naturalHeight,{width:J,height:W}=An({width:B,height:m},{width:o.maxWidth||100,height:o.maxHeight||100},o.expand);h.value=J,_.value=W,a("load",{src:Z.src,width:B,height:m}),c.value=!1,await new Promise(he=>setTimeout(he,100)),!c.value&&(y.value=!0)}function O(T){const Z=T.target;a("error",Z.src)}async function S(T){c.value=!0,y.value=!1,b.value=T,console.log("changeSrc:",b.value)}function F(){const T=document.createElement("a");T.href=b.value,T.download=o.fileName,T.click()}function j(){var T;(T=f.value)==null||T.click()}return(T,Z)=>{const B=dn,m=Mt,J=Fe,W=xt;return je((P(),se("div",null,[n(e(Ie),null,{trigger:t(()=>[n(W,{show:e(c)||o.loading},{default:t(()=>[n(J,{justify:"center",align:"center",style:de(e(g))},{default:t(()=>[v("a",{"_v-show":"!(imgloading || props.loading)",href:e(b),onClick:Z[0]||(Z[0]=Qe(()=>{},["left","prevent"])),target:"_blank",download:o.fileName,title:o.fileName,style:{"line-height":"0px"}},[n(Xe,{mode:"in-out"},{default:t(()=>[je(n(B,{ref_key:"nImageRef",ref:f,"show-toolbar-tooltip":"",onLoad:I,onError:O,src:e(b),width:e(h),height:e(_),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[Be,e(y)]])]),_:1})],8,Al),e(c)||o.loading?(P(),ie(m,{key:0})):me("",!0)]),_:1},8,["style"])]),_:1},8,["show"])]),default:t(()=>[A(" "+d(o.fileName),1)]),_:1})],512)),[[Be,!T.hidden]])}}}),Xt=We(Sl,[["__scopeId","data-v-6c94d582"]]),Ll=["href","download","title"],Cl={class:"left-num"},$l={class:"right-num"},El=["href","download","title"],Fl={class:"left-num"},Ol={class:"right-num"},Pl=["href","download"],Ul=Te({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean},variousInfo:{}},emits:["demand-image","delete-image","close"],setup(l,{expose:i,emit:s}){const p=Je(Ye),o=l,a=s;i({download:R,cleanup:ve,openPreview:K,isPreviewing(){return J.value},changeIndex($){u.value=$}});const f=It(),{t:c}=He();Rt();const b=w(),h=w(),_=w(),y=nt("viewerItemContainer"),g=w(!0),u=w(Math.max(o.index,0)+1),I=w(1),O=w(1),S=w(""),F=w(""),j=w(1),T=w(1),Z=w(!1),B=w(!1),m=w(!1),J=Ae(()=>{var $,L;return(L=($=_.value)==null?void 0:$.previewInstRef)==null?void 0:L.displayed}),W=Ae(()=>{var $,L;return((L=($=_==null?void 0:_.value)==null?void 0:$.previewInstRef)==null?void 0:L.previewSrc)===S.value}),he=Ae(()=>u.value<o.length),M=Ae(()=>u.value>1),fe=w("viewer-item-init"),_e=w(0),Se=w(!0);w({width:"auto",height:"auto"});const Oe=w(!1);Re(()=>{document.body.addEventListener("keydown",pe),document.body.addEventListener("keydown",ge),ce(u.value-1),re()}),Ge(()=>{clearTimeout(E),document.body.removeEventListener("keydown",pe),document.body.removeEventListener("keydown",ge),Oe.value=!0}),vt(()=>{URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl)});let E=-1;be(u,($,L)=>{u.value<1||u.value>o.length||$===L||(clearTimeout(E),$>L?fe.value="viewer-item-next":fe.value="viewer-item-prev",E=setTimeout(()=>{o.index!==u.value-1&&(_e.value=g.value?_e.value:~_e.value,S.value=void 0,F.value=void 0,Se.value=!1,ce(u.value-1))},50))});let N="",Y="";be(()=>o.url,()=>{var k,U;let $="";o.index===0&&g.value?(g.value=!1,u.value=1,$=o.url):o.index===u.value-1?(g.value=!1,Z.value=!1,$=o.url):(URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl));const L=N,r=Y;if(URL.revokeObjectURL(L),URL.revokeObjectURL(r),N=o.url,Y=o.originalUrl,$){try{if((U=(k=_.value)==null?void 0:k.previewInstRef)!=null&&U.displayed){W.value?_.value.previewInstRef.setPreviewSrc($):_.value.previewInstRef.setPreviewSrc(o.originalUrl);try{const C=_.value.previewInstRef.displayed;_.value.previewInstRef.handleAfterLeave(),_.value.previewInstRef.displayed=C}catch(C){console.error(C)}}}catch{}S.value=$,F.value=o.originalUrl}},{immediate:!0});function ce($){Z.value=!0,B.value=!1,m.value=!1,Ce(()=>a("demand-image",$))}function re(){if(!p.IS_SP)return;let $=y.value.$el,L=0,r=0,k=0,U=0,C=0;const ne=xe=>{L=xe.touches[0].pageX,r=xe.touches[0].pageY,C=Date.now()};$.addEventListener("touchstart",ne);const ze=xe=>{k=xe.touches[0].pageX,U=xe.touches[0].pageY,Ue()};window.addEventListener("touchmove",ze);const q=()=>{Ue();const xe=k-L,qe=Math.abs(xe),lt=U-r,st=Math.abs(lt);qe<st||qe<30||te(xe>0?-1:1)};window.addEventListener("touchend",q);const Ue=()=>{const xe=Date.now();xe-C>500&&(L=k,r=U),C=xe};Ge(()=>{$.removeEventListener("touchstart",ne),window.removeEventListener("touchmove",ze),window.removeEventListener("touchend",q),$=null})}function ge($){var L,r,k,U;if($.key==="Escape")try{(r=(L=_.value)==null?void 0:L.previewInstRef)!=null&&r.displayed&&($.stopPropagation(),(U=(k=_.value)==null?void 0:k.previewInstRef)==null||U.toggleShow(!1))}catch{}}function pe($){switch($.code){case"ArrowRight":te(1);break;case"ArrowLeft":te(-1);break;case"Home":u.value=1;break;case"End":u.value=o.length;break;case"Space":case"Enter":if(!J.value)return;ae();break;case"ArrowUp":case"ArrowDown":default:return}$.stopPropagation(),$.preventDefault()}function ke({width:$,height:L}){I.value=$,O.value=L,B.value=!0}function H({width:$,height:L}){j.value=$,T.value=L,m.value=!0}function R(){W.value?b.value.download():h.value.download()}async function D($){try{const L=await fetch($).then(r=>r.blob()).then(r=>new Promise(k=>{const U=new FileReader;U.onload=k,U.readAsDataURL(r)})).then(r=>r.target.result);navigator.clipboard.writeText(L),f.info({title:c("copiedDataURLDialogTitle"),content:()=>X("div",[X("div",c("copiedDataURLMessage"))]),positiveText:"OK"})}catch(L){console.error(L),f.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function te($){$>0?u.value=Math.min(o.length,u.value+$)|0:$<0&&(u.value=Math.max(1,u.value+$)|0)}let oe="";const ae=()=>{var L,r,k,U;oe=(k=window.getComputedStyle((r=(L=_==null?void 0:_.value)==null?void 0:L.previewInstRef)==null?void 0:r.previewRef))==null?void 0:k.transform;const $=W.value;(U=_==null?void 0:_.value)==null||U.next(),Ce(()=>{var C;W.value===$&&((C=_==null?void 0:_.value)==null||C.next())})};function z(){try{Ce(()=>_.value.previewInstRef.previewRef.style.transform=oe)}catch{}}function x({nodes:$}){const L=X(Nt,{color:W.value?"green":"gray",offset:[-20,-12],value:W.value?c("status.Converted"):c("status.Original")},()=>X(Le,{round:!0,onClick(){ae()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>X(W.value?ta:na)}));$.next=X(Le,{onClick(){te(1)},disabled:!he.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>X(Gt)}),$.prev=X(Le,{onClick(){te(-1)},disabled:!M.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>X(oa)});try{const r=$.download.children;r.default=()=>c("save");const k=r.trigger();k.props.onClick=R,r.trigger=()=>k}catch{}return G(),[L,...Object.values($)]}const ue="#pathbox-"+String(Math.random()).substring(2);let le;function G(){var $,L,r;try{if(le=(r=(L=($=_.value)==null?void 0:$.previewInstRef)==null?void 0:L.previewWrapperRef)==null?void 0:r.parentNode,!le||le.querySelector(ue))return;let k=X("div",{id:ue,onMousedown:U=>{U.stopPropagation()},className:"__preview-injected-pathbox"+(W.value?" converted":"")},[X("div",`${String(u.value).padStart(String(o.length).length,"0")}/${String(o.length).padStart(String(o.length).length,"0")}`),X("div",Ne(W.value?o.size:o.originalSize,0)),X("div",W.value?o.name:o.originalName)]);Kt(k,le),k=null}catch(k){console.error(k)}}Ge(()=>{le&&(Kt(null,le),le=null)});function K(){b.value.openPreview()}function ve(){}return($,L)=>{const r=ye,k=Fe,U=cn,C=et,ne=At,ze=Xo;return P(),ie(k,{justify:"center",align:"center",vertical:"",style:de({visibility:g.value?"hidden":"visible"}),class:"body",ref:"body"},{default:t(()=>[n(ze,{ref_key:"nImageGroupRef",ref:_,"show-toolbar-tooltip":"","render-toolbar":x,onPreviewNext:z},{default:t(()=>[n(k,{wrap:!1,align:"center",justify:"center"},{default:t(()=>[n(e(Le),{onClick:L[0]||(L[0]=q=>te(-1)),disabled:!e(M),block:"",class:ot({"thumb-arrow":!0,pale:!e(M)}),title:$.$t("Prev")},{icon:t(()=>[n(r,{size:"30"},{default:t(()=>[n(e(Jo))]),_:1})]),_:1},8,["disabled","class","title"]),n(k,{justify:"center",ref_key:"viewerItemContainer",ref:y,class:"viewer-item-container"},{default:t(()=>[n(Xe,{name:fe.value},{default:t(()=>[(P(),ie(k,{vertical:"",key:_e.value,"_v-show":"viewerItemVisibility"},{default:t(()=>[n(k,{align:"center",wrap:!1},{default:t(()=>[n(k,{vertical:""},{default:t(()=>[n(k,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(k,{align:"center",justify:"center",vertical:"",class:"original-thumb"},{default:t(()=>[v("a",{href:$.originalUrl,onClick:L[4]||(L[4]=Qe(q=>{h.value.openPreview()},["prevent"])),download:$.originalName,title:$.originalName,class:"imglink"},[n(k,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(Xt,{ref:q=>{q!=null&&q.active&&(h.value=q)},src:F.value,width:1,"max-width":1,"max-height":1,loading:Z.value,"file-name":$.originalName,"allow-next":u.value<o.length,"allow-prev":u.value>1,onLoad:H,onNext:L[1]||(L[1]=q=>te(1)),onPrev:L[2]||(L[2]=q=>te(-1)),hidden:!0},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(k,{vertical:"",align:"center"},{default:t(()=>[n(k,{class:"imglink-label"},{default:t(()=>[A(d(e(c)("status.Original")),1)]),_:1}),n(k,{justify:"center",class:"img-size",wrap:!1},{default:t(()=>[v("span",Cl,d(m.value?j.value:"?"),1),L[11]||(L[11]=A(" × ")),v("span",$l,d(m.value?T.value:"?"),1)]),_:1}),n(k,{justify:"center"},{default:t(()=>[L[3]||(qt(-1,!0),(L[3]=n(k,null,{default:t(()=>[A(d(m.value?e(Ne)(o.originalSize,0):"?"),1)]),_:1})).cacheIndex=3,qt(1),L[3])]),_:1})]),_:1})]),_:1})],8,Ll)]),_:1}),n(k,{vertical:"",align:"center",style:{margin:"1em"},class:"original-thumb"},{default:t(()=>[n(r,{size:"20",color:"silver",component:e(Gt)},null,8,["component"])]),_:1}),v("a",{href:S.value,onClick:L[5]||(L[5]=Qe(q=>K(),["prevent"])),download:o.name,title:o.name,class:"imglink"},[n(k,{vertical:"",align:"center",justify:"center"},{default:t(()=>[n(k,{class:"imglink-label"},{default:t(()=>[A(d(e(c)("status.Converted")),1)]),_:1}),n(k,{vertical:"",align:"center",justify:"center",size:0},{default:t(()=>[n(k,{justify:"center"},{default:t(()=>{var q;return[n(k,{wrap:!1,style:de((q=o.variousInfo)!=null&&q.shrinked?{color:"blue"}:{}),class:"img-size"},{default:t(()=>[v("span",Fl,d(B.value?I.value:"?"),1),L[12]||(L[12]=A(" × ")),v("span",Ol,d(B.value?O.value:"?"),1)]),_:1},8,["style"])]}),_:1})]),_:1}),n(k,{justify:"center"},{default:t(()=>[A(d(B.value?e(Ne)(o.size,0):"?"),1)]),_:1})]),_:1})],8,El)]),_:1}),n(k,{ref:"fileNameContainer",justify:"center",align:"center",class:"pathbox",title:o.name},{default:t(()=>[n(U,{"x-scrollable":!0,trigger:"hover",style:{"text-align":"center","font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:t(()=>[A(d(B.value?o.name:"?"),1)]),_:1})]),_:1},8,["title"])]),_:1}),n(k,{vertical:""},{default:t(()=>[n(Xt,{ref:q=>{q!=null&&q.active&&(b.value=q)},src:S.value,width:142,"max-width":140,"max-height":100,loading:Z.value,"file-name":o.name,"allow-next":u.value<o.length,"allow-prev":u.value>1,onLoad:ke,onNext:L[6]||(L[6]=q=>te(1)),onPrev:L[7]||(L[7]=q=>te(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(k,{justify:"center",wrap:!0},{default:t(()=>[n(C,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[v("a",{href:o.url,ref:"saveImg",target:"_blank",download:o.name},[n(e(Le),{disabled:!B.value,round:"",size:"tiny"},{default:t(()=>[A(d($.$t("save")),1)]),_:1},8,["disabled"])],8,Pl)]),default:t(()=>[A(" "+d($.$t("save")),1)]),_:1}),n(C,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(e(Le),{disabled:!B.value,onClick:L[8]||(L[8]=q=>D(o.url)),round:"",size:"tiny"},{default:t(()=>L[13]||(L[13]=[A("DataURL")])),_:1},8,["disabled"])]),default:t(()=>[A(" "+d($.$t("convertedImageDataUrlTooltip")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["name"])]),_:1},512),n(e(Le),{onClick:L[9]||(L[9]=q=>te(1)),disabled:!e(he),block:"",class:ot({"thumb-arrow":!0,next:!0,pale:!e(he)}),title:$.$t("Next")},{icon:t(()=>[n(r,{size:"30"},{default:t(()=>[n(e(ea))]),_:1})]),_:1},8,["disabled","class","title"])]),_:1}),je(n(k,{style:{width:"100%"},wrap:!1},{default:t(()=>[n(ne,{value:u.value,"onUpdate:value":L[10]||(L[10]=q=>u.value=q),tooltip:!1,step:1,min:1,max:o.length,keyboard:!1,class:"index-slider"},null,8,["value","max"]),n(k,{class:"index",align:"center",justify:"center",wrap:!1,size:3},{default:t(()=>[n(k,null,{default:t(()=>[A(d(e(c)("status.index"))+":",1)]),_:1}),n(k,{justify:"end",align:"center",class:"counter"},{default:t(()=>[A(d(u.value),1)]),_:1}),n(k,null,{default:t(()=>L[14]||(L[14]=[A("/")])),_:1}),n(k,{justify:"start",align:"center",class:"counter"},{default:t(()=>[A(d(o.length),1)]),_:1})]),_:1})]),_:1},512),[[Be,!$.isSingle]])]),_:1},512)]),_:1},8,["style"])}}}),Ml=We(Ul,[["__scopeId","data-v-67f9ab1f"]]),Rl={class:"status-table"},Nl={class:"started"},jl={class:"mini-counter"},Bl={class:"failure"},Dl={class:"mini-counter"},Zl={colspan:"2"},Vl={class:"completed"},Hl={class:"main-counter"},Wl={class:"total"},ql={class:"main-counter"},Gl=Te({__name:"status.center-column",props:{processing:{type:Boolean},interval:{},statusColor:{},success:{},successTo:{},successFrom:{},index:{},length:{},failure:{},retried:{},successPercTo:{},successPercFrom:{}},setup(l){const i=l,s=Rt(),p=w(s.value.successColor),o=w(!1);return be(()=>i.processing,a=>{a||(i.success===i.length?o.value=!0:p.value=s.value.errorColor)}),(a,f)=>{const c=et,b=ye,h=la,_=Fe,y=pn;return P(),ie(y,{type:"multiple-circle","stroke-width":2,percentage:[a.successTo/a.length*100|0,a.index/a.length*100|0],color:[e(s).successColor,a.statusColor],"rail-style":[{stroke:e(p),opacity:.3}]},{default:t(()=>[n(_,{vertical:"",align:"center",justify:"center",size:0,style:{"font-family":"v-mono","white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:t(()=>[v("table",Rl,[v("tbody",null,[v("tr",Nl,[v("td",null,d(a.$t("status.started"))+":",1),v("td",jl,[n(c,{trigger:"hover",style:de({color:e(s).infoColor}),placement:"left"},{trigger:t(()=>[v("span",{style:de({color:e(s).infoColor})},d(a.index.toLocaleString("en-us")),5)]),default:t(()=>[A(" "+d(a.$t("status.progressStarted"))+" ("+d(a.index.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),v("tr",Bl,[v("td",null,d(a.$t("status.failure"))+":",1),v("td",Dl,[n(c,{trigger:"hover",style:de({color:e(s).errorColor}),placement:"left"},{trigger:t(()=>[v("span",{style:de({color:e(s).errorColor})},d(a.failure.toLocaleString("en-us")),5)]),default:t(()=>[A(" "+d(a.$t("status.progressErrors"))+" ("+d(a.failure.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"]),a.retried>0?(P(),ie(c,{key:0,trigger:"hover",style:de({color:e(s).warningColor}),placement:"left"},{trigger:t(()=>[v("span",{style:de({color:e(s).warningColor})}," ("+d(a.retried.toLocaleString("en-us"))+") ",5)]),default:t(()=>[A(" "+d(a.$t("status.progressRetries"))+" ("+d(a.retried.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):me("",!0)])]),v("tr",null,[v("td",Zl,[n(_,{size:0,align:"center",justify:"center",style:de({color:a.processing?a.statusColor:e(p)}),wrap:!1,class:"perc"},{default:t(()=>[e(o)?(P(),ie(b,{key:0,component:e(aa)},null,8,["component"])):me("",!0),n(h,{duration:a.interval*3|0,from:a.successPercFrom|0,to:a.successPercTo|0,active:!0},null,8,["duration","from","to"]),f[0]||(f[0]=A("% "))]),_:1},8,["style"])])]),v("tr",Vl,[v("td",null,d(a.$t("status.success"))+":",1),v("td",Hl,[n(c,{trigger:"hover",duration:0,delay:0,style:de({color:e(s).successColor}),placement:"bottom"},{trigger:t(()=>[v("span",{style:de({color:e(s).successColor})},[n(h,{duration:a.interval*3|0,from:a.successFrom,to:a.successTo,active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:t(()=>[A(" "+d(a.$t("status.progressSuccess"))+" ("+d(a.successTo.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),v("tr",Wl,[v("td",null,d(a.$t("status.all"))+":",1),v("td",ql,[n(c,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:t(()=>[A(d(a.length.toLocaleString("en-us")),1)]),default:t(()=>[A(" "+d(a.$t("status.progressTotal"))+" ("+d(a.length.toLocaleString("en-us"))+") ",1)]),_:1})])])])])]),_:1})]),_:1},8,["percentage","color","rail-style"])}}}),Kl={key:0,class:"log-table",ref:"table"},Yl={class:"log-tr label"},Ql=["title"],Xl={style:{"min-width":"7em"},class:"log-th"},Jl={style:{"padding-left":"2em"},class:"log-th"},es={ref:"tbody"},ts=["onClick","onDblclick"],ns={class:"log-td"},os={class:"log-td"},as={class:"log-td"},ls={class:"log-td"},ss={key:0,class:"log-td log-extra",style:{"padding-left":"0.5em"}},is={key:0},rs={key:1,style:{color:"blue"}},Jt=3,us=100,ds=Te({__name:"status.log",props:at({processing:{type:Boolean},opened:{type:Boolean},previewCollapsed:{type:Boolean},logs:{},imageIndex:{},thumbnail:{}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},order:{required:!1,default:"processed"},orderModifiers:{}}),emits:at(["open-preview","change-index"],["update:expanded","update:order"]),setup(l,{emit:i}){const{t:s}=He(),p={W:160,H:80},o=l,a=$e(l,"expanded"),f=i;nt("table");const c=nt("tbody"),b=w(),h=w(null),_=w(null),y=w(!0),g=w(80),u=w(200),I=Ae(()=>{let z=o.logs;switch(Z.value){case"success":z=z.filter(x=>x.completed);break;case"error":z=z.filter(x=>!x.completed);break}return z}),O=wl(!1),F=w([{type:"group",label:()=>s("status.sort"),key:"sort",children:[{label:()=>s("status.sortByStart"),value:"processed"},{label:()=>s("status.sortByCompletion"),value:"zipped"},{label:()=>s("status.sortByName"),value:"name"},{label:()=>s("status.sortBySize"),value:"size"},{label:()=>s("status.sortByOutputSize"),value:"outputsize"},{label:()=>s("status.sortByStatus"),value:"status"}]}]),j=$e(l,"order");be(j,oe);const T=[{label:()=>s("status.showAll"),value:""},{label:()=>s("status.showOnlySuccess"),value:"success"},{label:()=>s("status.showOnlyError"),value:"error"}],Z=w(T[0].value);Re(()=>{W=sa(),fe(),window.addEventListener("resize",fe);const z=new ResizeObserver(fe);z.observe(W.parent.parent.vnode.el),Ge(()=>{window.removeEventListener("resize",fe),z.disconnect()})}),Ge(()=>{B.close(),clearTimeout(J),clearTimeout(pe),clearTimeout(_e)});let B;be(()=>[o.thumbnail,o.opened],()=>{if(!o.thumbnail||!o.opened||o.thumbnail===B)return;const{width:z,height:x}=An(o.thumbnail,{width:p.W,height:p.H});_.value.width=z,_.value.height=x,_.value.style.width=z+"px",_.value.style.height=x+"px",o.thumbnail instanceof HTMLImageElement?_.value.getContext("2d").drawImage(o.thumbnail,0,0,z,x):(_.value.getContext("bitmaprenderer").transferFromImageBitmap(o.thumbnail),B=o.thumbnail,o.thumbnail.close())});let m=0;be(()=>o.imageIndex,async()=>{var G;const z=o.imageIndex;let x=I.value.findIndex(K=>K.zippedIndex===z);x===-1&&(x=z);const ue=x<Y.value,le=x>Y.value+ce.value;if(ue||le){const K=x*re-(le?g.value:0);(G=b.value)==null||G.scrollTo({behavior:"instant",top:K}),await Ce(),D(!0),await Ce()}Ce(()=>{var ve,$;let K=h.value;K&&(m>x&&(K=K.previousSibling||K,K instanceof HTMLElement||((ve=b.value)==null||ve.scrollTo(0,0),K=null)),($=K==null?void 0:K.scrollIntoView)==null||$.call(K,{behavior:"instant",block:"nearest"}),m=x)})});let J,W;const he=w(document.documentElement.clientHeight),M=w(10),fe=()=>{clearTimeout(J),J=setTimeout(()=>{const z=b.value.$parent.$el.offsetHeight,x=window.innerHeight-W.parent.parent.vnode.el.offsetHeight-8,ue=Math.max(100,z+x);he.value=document.documentElement.clientHeight,M.value=ue,!(!o.opened||!a.value)&&(g.value=Math.max(ue,u.value))},100)};let _e=0,Se=!1;function Oe(z=!1){if(!Se){if(_e){Se=!0;return}Ce(()=>{!z&&!y.value||(b.value.scrollTo({behavior:"instant",top:o.logs.length*50}),_e=window.setTimeout(()=>{_e=0,Se&&(Se=!1,Oe())},us))})}}const E=w({height:"0px"}),N=w({height:"0px"}),Y=w(0),ce=Ae(()=>g.value/re+Jt*2|0);let re=15,ge=0,pe=0,ke=0,H=-999,R=-1;function D(z){const x=Date.now();if(z!==!0){if(pe)return;if(x-ke<30){pe=window.setTimeout(()=>{pe=0,D()},30-(x-ke));return}}ke=x,ge||(ge=c.value.rows[1].offsetHeight,re=ge);const ue=I.value.length,G=b.value.scrollbarInstRef.containerRef.scrollTop;if(!z&&ue===R&&Math.abs(G-H)<re*.5)return;H=G,R=ue;const K=Math.max(0,(G/re|0)-Jt);Y.value=K,E.value.height=K*re+"px",N.value.height=Math.max(0,ue-(K+ce.value))*re+"px"}function te(){var z;(z=b.value)==null||z.scrollTo(0,0),D()}be(()=>o.logs,()=>{o.opened&&(Ce(D),y.value&&Oe())}),be(()=>o.opened,z=>{z&&D()});function oe(){switch(j.value){case"zipped":o.logs.sort((z,x)=>z.zippedIndex-x.zippedIndex);break;case"status":o.logs.sort((z,x)=>z.command>x.command?1:-1);break;case"name":o.logs.sort((z,x)=>z.path>x.path?1:-1);break;case"size":o.logs.sort((z,x)=>z.size-x.size);break;case"outputsize":o.logs.sort((z,x)=>z.outputSize-x.outputSize);break;case"processed":default:o.logs.sort((z,x)=>z.index-x.index);break}}function ae(z){const x=o.logs,ue=x.findIndex(L=>L.zippedIndex===o.imageIndex);let le=0,G=1;switch(z.code){case"ArrowUp":le=-1;break;case"ArrowDown":le=1;break;case"PageUp":le=-1,G=g.value/re|0;break;case"PageDown":le=1,G=g.value/re|0;break;case"Enter":if(ue>=0&&o.previewCollapsed){Ce(()=>f("open-preview")),z.stopPropagation(),z.preventDefault();return}break;default:return}let K=ue,ve=-1;const $=x.length;do{if(K+=le,K<0||K>$-1||K===ue)break;if(x[K].completed){if(ve=K,--G>0)continue;break}}while(!0);if(ve>=0){const L=x[ve];f("change-index",!0,L.path,L.fileId,L.zippedIndex),z.preventDefault()}}return(z,x)=>{const ue=xt,le=Fe,G=ye,K=Tt,ve=fn,$=Ie,L=At,r=et,k=Mt,U=jt;return P(),ie(U,{name:"log",style:{"white-space":"nowrap"}},{header:t(()=>[n(le,{align:"center",wrap:!1},{default:t(()=>[A(d(z.$t("status.Log")),1),je(n(ue,{size:16},null,512),[[Be,z.processing&&!o.opened]])]),_:1})]),"header-extra":t(()=>[je(n(le,{align:"center",justify:"end",wrap:!0,style:{"margin-top":"0.2em","margin-left":"0.5em"}},{default:t(()=>[n(K,{value:j.value,"onUpdate:value":[x[0]||(x[0]=C=>j.value=C),oe],options:e(F),style:{width:"auto","font-size":"smaller"},"consistent-menu-width":!1,"show-on-focus":!1,size:"tiny"},{arrow:t(()=>[n(G,{component:e(ia)},null,8,["component"])]),_:1},8,["value","options"]),n(K,{value:e(Z),"onUpdate:value":[x[1]||(x[1]=C=>De(Z)?Z.value=C:null),x[2]||(x[2]=C=>te())],options:T,placeholder:z.$t("status.filterLogSelect"),size:"tiny",style:{width:"auto","font-size":"smaller"},"consistent-menu-width":!1,"show-on-focus":!1},{arrow:t(()=>[n(G,{component:e(ra)},null,8,["component"])]),_:1},8,["value","placeholder"]),n(ve,{key:"b",checked:e(y),"onUpdate:checked":[x[3]||(x[3]=C=>De(y)?y.value=C:null),x[4]||(x[4]=C=>C&&Oe(!0))],size:"small",style:{"font-size":"smaller"}},{default:t(()=>[A(d(z.$t("status.autoScroll")),1)]),_:1},8,["checked"]),n(r,{trigger:"hover",show:e(O),disabled:!a.value,placement:"top",delay:0},{trigger:t(()=>[n($,{style:{"max-width":"30em"},disabled:!0},{trigger:t(()=>[n(ve,{size:"small",checked:a.value,"onUpdate:checked":[x[5]||(x[5]=C=>a.value=C),x[6]||(x[6]=C=>{C&&(Oe(!0),fe(),O.value=!0)})],style:{"font-size":"smaller"}},{default:t(()=>[A(d(z.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:t(()=>[A(d(z.$t("status.expandLog")),1)]),_:1})]),default:t(()=>[n(le,{wrap:!1,align:"center",style:{"font-size":"0.8rem"}},{default:t(()=>[n(L,{value:e(u),"onUpdate:value":x[7]||(x[7]=C=>De(u)?u.value=C:null),onUpdateValue:fe,disabled:!a.value,"format-tooltip":C=>`Log size: ${C}`,tooltip:!0,step:1,min:e(M),max:e(he),style:{"z-index":"3",width:"100px"}},null,8,["value","disabled","format-tooltip","min","max"])]),_:1})]),_:1},8,["show","disabled"])]),_:1},512),[[Be,o.opened]])]),default:t(()=>[n(le,{wrap:!1,align:"stretch",class:ot({"log-container":1,"expand-log":a.value}),style:de(a.value?{height:e(g)+"px"}:{height:"110px"}),onKeydown:ae,tabindex:"-1"},{default:t(()=>[n(e(cn),{ref_key:"scrollref",ref:b,distance:10,"x-scrollable":!0,onMousedownCapture:x[8]||(x[8]=C=>y.value=!1),onWheel:x[9]||(x[9]=C=>y.value=!1),onScroll:D,load:"handleLogLoad",trigger:"none",style:de([{"z-index":"2","padding-right":"10px",height:"100%"},a.value?{height:e(g)+"px"}:{}]),size:50},{default:t(()=>[o.opened?(P(),se("table",Kl,[v("thead",null,[v("tr",Yl,[v("th",{class:"log-th",title:z.$t("status.table.core")},"th",8,Ql),x[10]||(x[10]=v("th",{class:"log-th"},"no.",-1)),v("th",Xl,d(z.$t("status.table.status")),1),v("th",Jl,d(z.$t("status.table.details")),1),x[11]||(x[11]=v("th",{class:"log-th"},"size",-1))])]),v("tbody",es,[v("tr",{style:de(e(E))},null,4),(P(!0),se(Ee,null,ct(e(I).slice(e(Y),e(Y)+e(ce)),({index:C,key:ne,command:ze,path:q,core:Ue,zippedIndex:xe,completed:qe,fileId:lt,shrinked:st,width:Q,height:Ze,outputWidth:Ve,outputHeight:St,size:Bo,outputSize:Do},$i)=>(P(),se("tr",{key:ne,class:ot({"log-tr":1,completed:qe,selected:z.imageIndex===xe}),ref_for:!0,ref:Wt=>{z.imageIndex===xe&&(h.value=Wt)},onClick:Wt=>f("change-index",qe,q,lt,xe),onDblclick:()=>{z.imageIndex===xe&&f("open-preview")}},[v("td",ns,d(Ue>=0?Ue+1:"-"),1),v("td",os,d(C+1),1),v("td",as,d(ze),1),v("td",ls,d(q),1),Q?(P(),se("td",ss,[A(d(`[${Q}×${Ze}] (${e(Ne)(Bo,0)})`)+" ",1),Ve?(P(),se("span",is,[x[12]||(x[12]=A(" → ")),v("span",null," ("+d(e(Ne)(Do,0))+") ",1)])):me("",!0),st?(P(),se("span",rs,d(` [${Ve}×${St}]`),1)):me("",!0)])):me("",!0)],42,ts))),128)),v("tr",{style:de(e(N))},null,4)],512)],512)):me("",!0),x[13]||(x[13]=v("div",{style:{height:"1em"}},null,-1))]),_:1},8,["style"]),n(le,{style:de([{"align-self":"center",position:"absolute","z-index":"0","margin-top":"10px",right:"0.1em","line-height":"0px"},{width:p.W+"px",height:p.H+"px"}]),justify:"center",align:"center"},{default:t(()=>[n(ue,{size:"small",show:z.processing},{default:t(()=>[o.thumbnail===void 0?(P(),ie(k,{key:0,description:"EMPTY"})):me("",!0),je(v("canvas",{ref_key:"thumbcanvas",ref:_,width:"106",height:"80",style:de({border:"1px solid gray",filter:z.processing?"":"opacity(0.35)"})},null,4),[[Be,o.thumbnail!==void 0]])]),_:1},8,["show"])]),_:1},8,["style"])]),_:1},8,["class","style"])]),_:1})}}}),cs={key:0},ps={style:{}},fs=["innerHTML"],gs={style:{margin:"1px"}},ms=["href","download","onClick"],vs={key:0,style:{position:"relative"}},hs=["href","download"],_s=["href","download"],ws={key:0,style:{margin:"1px"}},ys=["href","download","onClick"],bs=Te({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image","delete-image"],setup(l,{expose:i,emit:s}){const p={itemMargin:"1px",titlePadding:"2px",titleFontSize:"0.8rem"},o=It(),{t:a}=He(),f=Rt(),c=l,b=s;i({cleanup:L});const h=w(!1),_=w([]),y=w(!1),g=w([]),u=w([]),I=w([0,0]),O=w([0,0]),S=w([0,0]),F=w([0,0]),j=w([0,0]),T=w([0,0]),Z=w(0),B=w(0),m=w([0,0]),J=w(f.value.infoColor),W=w("#000000"),he=w("#000000"),M=w(0),fe=w(0),_e=w(""),Se=w("00:00:00"),Oe=w(void 0),E=w(null),N=w(["progress","log","output"]),Y=r=>N.value.includes(r),ce=r=>N.value.push(r),re=r=>{const k=N.value.findIndex(U=>U===r);k>=0&&N.value.splice(k,1)},ge=Ae(()=>N.value.includes("log")),pe=w(!1),ke=w("processed"),H=zt({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:0,various:{shrinked:!1}}),R=nt("body"),D=nt("imageViewer");Re(()=>{be(c.status,()=>z(),{deep:!1});let r=0;const k=()=>{if(r)return;const U=Date.now();Se.value="00:00:00",r=window.setInterval(()=>{const C=(Date.now()-U)/1e3;Se.value=`${String(C/3600|0).padStart(2,"0")}:${String(C/60%60|0).padStart(2,"0")}:${String(C%60|0).padStart(2,"0")}`},300)};k(),be(()=>c.processing,(U,C)=>{U?(k(),_.value.length=0,h.value=!1,y.value=!1,g.value=[],u.value=[]):(clearInterval(r),r=0),c.processing||x()}),Ge(()=>{clearInterval(r),clearTimeout(ae)}),vt(()=>clearInterval(r))}),Ge(()=>{L()}),vt(()=>{clearTimeout(ae)}),be([()=>c.status.zips.length,()=>c.status.failedZips.length],()=>{const r=c.status;{g.value.length>r.zips.length&&(g.value.length=0);let k=0;const U=r.zips.length===1&&r.zippedTotalCount===r.length;for(let C=g.value.length;C<r.zips.length;C++){const ne=r.zips[C],ze=r.baseZipName+(U?"":"-"+String(C+1).padStart(2,"0"))+".zip";k+=ne.size,g.value[C]={url:ne.url,size:ne.size,number:U?0:C+1,sizeByUnit:Ne(ne.size),name:ze,count:ne.count,clicked:!1}}}{u.value.length>r.failedZips.length&&(u.value.length=0);let k=0;const U=r.failedZipDone&&r.failedZips.length===1;for(let C=u.value.length;C<r.failedZips.length;C++){const ne=r.failedZips[C],ze=r.baseZipName+"-error"+(U?"":"-"+String(C+1).padStart(2,"0"))+".zip";k+=ne.size,u.value[C]={url:ne.url,size:ne.size,number:U?0:C+1,sizeByUnit:Ne(ne.size),name:ze,count:ne.count,clicked:!1}}}});const te=c.interval||100;let oe=!1,ae=0;function z(){if(oe)return;if(ae){oe=!0;return}ae=window.setTimeout(()=>{ae=0,oe&&(oe=!1,z())},te);const r=c.status;h.value=r.length>=2,O.value[1]=O.value[0],O.value[0]=r.startedCount,S.value[1]=S.value[0],S.value[0]=r.success,F.value[1]=F.value[0],F.value[0]=r.failure,j.value[1]=j.value[0],j.value[0]=r.done,T.value[1]=T.value[0],T.value[0]=r.converted,Z.value=r.retried,B.value=r.length,m.value[1]=m.value[0],m.value[0]=r.zippedTotalCount,M.value=r.inputTotalSize,fe.value=r.outputTotalSize;const k=fe.value-M.value;_e.value=(k>=0?"+ ":"")+Ne(k);const U=fe.value/M.value,C=(256|Math.min(255,Math.max(0,U-1.5)*255|0)).toString(16).substring(1);W.value="#"+C+"0000";const ne=1024*1024,ze=(256|Math.min(255,Math.max(0,k/1024/ne)*255|0)).toString(16).substring(1);he.value="#"+ze+"0000",I.value[1]=I.value[0],I.value[0]=S.value[0]/B.value*100,(ge.value||!c.processing)&&(_.value=_.value.concat(r.logs),r.logs.length=0),E.value=r.thumbnail,c.processing&&(J.value=F.value[0]?f.value.errorColor:Z.value?f.value.warningColor:f.value.infoColor),r.convertedImageUrl!==H.url&&(H.url=r.convertedImageUrl,H.name=r.convertedImageName,H.dataUrl=r.convertedImageDataUrl,H.size=r.convertedImageSize||r.outputTotalSize,H.originalSize=r.convertedImageOrgSize,H.originalName=r.convertedImageOrgName,H.index=r.convertedImageIndex,H.originalUrl=r.convertedImageOrgUrl,H.various={shrinked:r.convertedImageShrinked})}function x(){const r=c.status;J.value=c.status.success===c.status.length?f.value.successColor:f.value.errorColor,pe.value||(re("log"),pe.value=!0),ke.value==="processed"&&(ke.value="zipped"),r.success>0&&ce("preview")}async function ue(r,k,U,C){var ze;if(!r)return;const ne=C;console.log(r,k,U,C,"completed, path, fileId, zippedIndex"),console.log(ne,c.status.ziplogs[ne]),Y("preview")||(ce("preview"),await Ce()),(ze=D.value)==null||ze.changeIndex(ne+1),await Ce(()=>{var q;try{(q=D.value)==null||q.$el.scrollIntoView({behavior:"instant",block:"nearest"})}catch{}})}const le=Ae(()=>[{key:"open",label:a("status.openFailedList"),icon:()=>X(ye,()=>X(gn)),onSelect(){ve()}},{key:"download",label:a("status.saveFailedList"),icon:()=>X(ye,()=>X(ua)),onSelect(){ve(!0)}},{key:"zip",label:`${a("status.zipFailedList")}`+(c.status.failedZipDone?`(✔${a("status.done")})`:""),icon:()=>X(xt,{show:y.value&&!c.status.failedZipDone,size:"small"},()=>X(ye,()=>X(Ot))),disabled:y.value,onSelect(r){return y.value=!0,b("demand-zip-errors"),!1}}]);function G(r,k=!1){const{url:U,name:C}=r;if(k){const ne=document.createElement("a");ne.href=U,ne.download=C,ne.click()}r.clicked||(r.clicked=!0,c.processing||g.value.every(ne=>ne.clicked)&&b("all-zips-clicked"))}async function K(){if(h.value){if(g.value.length>=2&&!await new Promise((U,C)=>o.warning({title:a("Download"),content:a("status.confirmDownloadMessage",[g.value.length]),positiveText:"OK",negativeText:a("cancel"),onPositiveClick:()=>U(!0),onNegativeClick:()=>C()})))return;const r=g.value;for(const k of r)G(k,!0)}else D.value.download()}function ve(r=!1){const k=new Blob([c.status.unconvertedListText],{type:"text/plain;charset=utf8"}),U=URL.createObjectURL(k),C=document.createElement("a");C.href=U,C.target="_blank",r&&(C.download=c.status.baseZipName+"-error.txt"),C.click()}const $=w(!1);function L(){$.value=!0,URL.revokeObjectURL(H.url),URL.revokeObjectURL(H.originalName),H.originalUrl="",H.url="",H.index=0,c.status.logs.length=0,_.value.length=0,u.value.length=0,g.value.length=0}return(r,k)=>{const U=Fe,C=da,ne=jt,ze=pn,q=et,Ue=Le,xe=Il,qe=Nt,lt=ca,st=mn;return P(),ie(U,{ref_key:"body",ref:R,vertical:"",justify:"center"},{default:t(()=>[n(st,{"display-directive":"show","trigger-areas":["arrow","main"],"expanded-names":e(N),"onUpdate:expandedNames":k[6]||(k[6]=Q=>De(N)?N.value=Q:null),"theme-overrides":p},{default:t(()=>[n(ne,{name:"progress",style:{"white-space":"nowrap"}},{header:t(({collapsed:Q})=>[n(U,null,{default:t(()=>[A(d(r.$t("status.Progress"))+" ",1),Q?(P(),se(Ee,{key:0},[A(" ("+d(e(I)[0]|0)+"%) ",1)],64)):me("",!0)]),_:2},1024)]),default:t(()=>[n(U,{justify:"center",align:"center",wrap:!1,style:{"white-space":"nowrap","margin-top":"-2em"}},{default:t(()=>[n(U,{vertical:"",justify:"center",class:"left-column"},{default:t(()=>[n(C,{"tabular-nums":"",label:r.$t("status.elapsedTime")},{default:t(()=>[n(U,null,{default:t(()=>[A(d(e(Se)),1)]),_:1})]),_:1},8,["label"]),n(C,{"tabular-nums":"",label:r.$t("status.multiThreading")},{default:t(()=>[n(U,{style:de({color:c.status.threads?"":"red",fontSize:"0.7rem"})},{default:t(()=>[A(d(c.status.threads?r.$rt("{n} @:threads",c.status.threads):r.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(C,{"tabular-nums":"",label:r.$t("status.outputSettings")},{default:t(()=>[n(U,{vertical:"",justify:"end",style:{"font-size":"0.6rem","line-height":"0.6rem"}},{default:t(()=>[v("div",null,d(r.$t("settings.imageType"))+": "+d(c.status.type),1),r.status.shrink?(P(),se("div",cs,[A(d(r.$t("status.Shrinking"))+": ",1),v("span",ps,d(r.status.shrink[0])+"×"+d(r.status.shrink[1]),1)])):me("",!0),v("div",null,"Zip: "+d(c.status.zipSize)+"MB",1)]),_:1})]),_:1},8,["label"])]),_:1}),e($)?me("",!0):(P(),ie(Gl,{key:0,index:e(O)[0],success:e(S)[0],length:r.status.length,"success-to":e(S)[0],"success-from":e(S)[1],failure:e(F)[0],"success-perc-to":e(I)[0],"success-perc-from":e(I)[1],retried:e(Z),processing:r.processing,interval:e(te),"status-color":e(J),class:"center-column"},null,8,["index","success","length","success-to","success-from","failure","success-perc-to","success-perc-from","retried","processing","interval","status-color"])),n(U,{vertical:"",style:{height:"100%"},justify:"center"},{default:t(()=>[n(C,{"tabular-nums":"",label:r.$t("status.inputSize")},{default:t(()=>[n(U,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[A(d((e(M)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(C,{"tabular-nums":"",label:r.$t("status.outputSize")},{default:t(()=>[n(U,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[A(d((e(fe)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(C,{"tabular-nums":"",label:r.$t("status.outInRate")},{default:t(()=>[n(U,{vertical:"",align:"end",justify:"start",style:{"font-size":"smaller","font-family":"v-mono","line-height":"50%"}},{default:t(()=>[v("span",{style:de({color:e(W),fontSize:"larger"})},"× "+d((e(fe)/e(M)||1).toFixed(2)),5),v("span",{style:de({color:e(he)})},"("+d(e(_e))+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:1})]),_:1}),n(ds,{processing:r.processing,"image-index":e(H).index,thumbnail:e(E),opened:e(ge),"preview-collapsed":Y("preview"),logs:e(_),expanded:e(pe),order:e(ke),onChangeIndex:ue,onOpenPreview:k[0]||(k[0]=Q=>{var Ze;return(Ze=e(D))==null?void 0:Ze.openPreview()}),name:"log",style:{"white-space":"nowrap"}},null,8,["processing","image-index","thumbnail","opened","preview-collapsed","logs","expanded","order"]),n(ne,{title:r.$t("status.PreviewImage"),name:"preview",style:{"white-space":"nowrap"},disabled:!(e(S)[0]>0)},{default:t(()=>[n(U,{justify:"center",align:"center",vertical:""},{default:t(()=>[n(Ml,{"_v-else-if":"imageViewerStarted && status.success > 0 /*&& (props.status.threads || !zippingFlag)*/ && !cleaningUp",ref_key:"imageViewer",ref:D,url:e(H).url,size:e(H).size,"original-url":e(H).originalUrl,"original-size":e(H).originalSize,name:e(H).name,originalName:e(H).originalName,length:e(S)[0],index:e(H).index,"various-info":e(H).various,"is-single":!e(h),onDemandImage:k[1]||(k[1]=Q=>b("demand-image",Q)),on_deleteImage:k[2]||(k[2]=Q=>b("delete-image",Q)),_close:"imageViewerStarted=false"},null,8,["url","size","original-url","original-size","name","originalName","length","index","various-info","is-single"])]),_:1})]),_:1},8,["title","disabled"]),n(ne,{name:"output",style:{"white-space":"nowrap"},disabled:""},{header:t(()=>[v("span",{style:{color:"black"},innerHTML:r.$t("status.Output")},null,8,fs)]),default:t(()=>[n(U,{wrap:!1,vertical:"",style:{"margin-top":"-1.3em"}},{default:t(()=>[e($)?me("",!0):(P(),ie(U,{key:0,justify:"center"},{default:t(()=>[je(n(U,{vertical:"",align:"center"},{default:t(()=>[n(q,{placement:"left"},{trigger:t(()=>[n(ze,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":e(m)[0]===e(B)?"white":"green",processing:r.processing,percentage:e(m)[0]/e(B)*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[v("span",gs,d(e(m)[0]/e(B)*100|0)+"% "+d(r.$t("status.zipped"))+" ("+d(e(m)[0])+"/"+d(e(T)[0])+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[A(" "+d(r.$t("status.zippingProgress"))+" ("+d(e(m)[0]/e(B)*100|0)+"%) ",1)]),_:1}),n(Xe,{name:"zipcontainer"},{default:t(()=>[e(g).length>=1||c.processing?(P(),ie(Yt,{key:0,name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(P(!0),se(Ee,null,ct(e(g),(Q,Ze)=>(P(),se("span",{key:Ze},[n(q,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[v("a",{href:Q.url,download:Q.name,class:"in-button-anchor",onClick:Ve=>G(Q)},[n(Ue,{class:"zip-button",size:"tiny",color:Q.clicked?"#050":"lime","text-color":Q.clicked?"gray":"white",onClick:Qe(Ve=>G(Q),["stop"]),round:""},{default:t(()=>[n(e(ye),{size:"tiny"},{default:t(()=>[n(e(Ot))]),_:1}),A("ZIP"+d(Q.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,ms)]),default:t(()=>[v("div",{style:de({color:e(f).successColor})},[v("div",null,"ZIP "+d(Q.number||"")+" ("+d(r.$t("success"))+")",1),v("div",null,d(Q.name),1),v("div",null,d(Q.sizeByUnit),1),v("div",null,d(r.$rt("{n} @:files",Q.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):me("",!0)]),_:1})]),_:1},512),[[Be,e(h)]])]),_:1})),n(Xe,null,{default:t(()=>[e($)?me("",!0):je((P(),ie(U,{key:0,justify:"center",align:"center"},{default:t(()=>[n(q,{trigger:"hover",duration:0,delay:0,placement:"left",style:de({color:"white",backgroundColor:e(f).successColor}),"arrow-style":{backgroundColor:e(f).successColor}},{trigger:t(()=>[n(Xe,{name:"save"},{default:t(()=>[e(S)[0]>0?(P(),se("span",vs,[n(qe,{value:e(h)?e(m)[0].toLocaleString("en-us"):c.status.type.replace(/\(.+\)/,""),color:e(f).successColorHover,offset:[-20,-3]},{default:t(()=>[n(Ue,{size:"medium",onClick:K,color:e(f).successColor,round:""},{default:t(()=>[e(h)?(P(),se(Ee,{key:0},[e(g).length?(P(),se("a",{key:0,href:e(g)[0].url,download:e(g)[0].name,class:"in-button-anchor",onClick:k[3]||(k[3]=Qe(()=>{},["prevent"]))},[n(xe),A(" × "+d(e(g).length)+" "+d(r.$t("status.saveAll")),1)],8,hs)):me("",!0)],64)):(P(),se("a",{key:1,href:e(H).url,download:e(H).name,class:"in-button-anchor",onClick:k[4]||(k[4]=Qe(()=>{},["prevent"]))},[n(e(ye),{size:"tiny"},{default:t(()=>[n(e(vn))]),_:1}),A(" "+d(r.$t("save")),1)],8,_s))]),_:1},8,["color"])]),_:1},8,["value","color"])])):me("",!0)]),_:1})]),default:t(()=>[r.status.length>=2?(P(),se(Ee,{key:0},[v("div",null,d(e(a)("success"))+": "+d(e(m)[0].toLocaleString()),1),v("div",null,d(e(a)("status.totalSize"))+": "+d(e(Ne)(r.status.zippedTotalSize)),1),v("div",null,"ZIP × "+d(e(g).length),1),v("div",null,d(e(a)("status.saveAllZipsTooltip")),1)],64)):(P(),se(Ee,{key:1},[A(d(r.$t("status.downloadConvertedImage",e(g).length)),1)],64))]),_:1},8,["style","arrow-style"]),n(lt,{"_v-if":"!processing && !(status.success === length)",options:e(le),onSelect:k[5]||(k[5]=(Q,Ze)=>{var Ve;return(Ve=e(le).find(({key:St})=>Q===St))==null?void 0:Ve.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:t(()=>[n(q,{show:e(Oe),duration:0,delay:0,placement:"right",style:de({color:"white",backgroundColor:e(f).errorColor}),"arrow-style":{backgroundColor:e(f).errorColor}},{trigger:t(()=>[n(qe,{value:r.status.unconvertedFileCount.toLocaleString(),color:e(f).errorColorHover,offset:[-0,-3]},{default:t(()=>[n(Ue,{size:"small",color:e(f).errorColor},{default:t(()=>[n(e(ye),{size:"medium",style:{"vertical-align":"middle"}},{default:t(()=>[n(e(pa))]),_:1})]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:t(()=>[v("div",null,[v("div",null,d(e(a)("failed"))+": "+d(r.status.unconvertedFileCount.toLocaleString()),1),v("div",null,d(e(a)("status.totalSize"))+": "+d(e(Ne)(r.status.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])]),_:1},512)),[[Be,!c.processing]])]),_:1}),n(Xe,{name:"zipcontainer"},{default:t(()=>[e($)?me("",!0):je((P(),ie(U,{key:0,vertical:"",align:"center"},{default:t(()=>[n(q,{placement:"left"},{trigger:t(()=>[n(ze,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":r.status.failedFileZippedCount===r.status.unconvertedFileCount?"white":"#500",processing:e(y)&&!r.status.failedZipDone&&!r.status.failedToCreateFailedZip,percentage:r.status.failedFileZippedCount/r.status.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[r.status.failedToCreateFailedZip?(P(),se("div",{key:1,style:de({color:e(f).errorColor})},d(r.$t("status.failureZippingFailedFiles")),5)):(P(),se("span",ws,d(r.status.failedFileZippedCount/r.status.unconvertedFileCount*100|0)+"% "+d(r.$t("status.zipped"))+" ("+d(r.status.failedFileZippedCount)+"/"+d(r.status.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[A(" "+d(r.$t("status.zippingProgress"))+" ("+d(r.status.failedFileZippedCount/r.status.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(Yt,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(P(!0),se(Ee,null,ct(e(u),(Q,Ze)=>(P(),se("span",{key:Ze},[n(q,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[v("a",{href:Q.url,download:Q.name,class:"in-button-anchor",onClick:Ve=>G(Q)},[n(Ue,{class:"zip-button",size:"tiny",color:Q.clicked?"#551122":"#F00","text-color":Q.clicked?"gray":"white",onClick:Qe(Ve=>G(Q),["stop"]),round:""},{default:t(()=>[n(e(ye),{size:"tiny"},{default:t(()=>[n(e(fa))]),_:1}),A("ZIP"+d(Q.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,ys)]),default:t(()=>[v("div",{style:de({color:e(f).errorColor})},[v("div",null,"ZIP "+d(Q.number||"")+" ("+d(r.$t("failed"))+")",1),v("div",null,d(Q.name),1),v("div",null,d(Q.sizeByUnit),1),v("div",null,d(r.$rt("{n} @:files",Q.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1},512)),[[Be,e(y)]])]),_:1})]),_:1})]),_:1})]),_:1},8,["expanded-names"])]),_:1},512)}}}),ks=We(bs,[["__scopeId","data-v-b297220f"]]),zs=["innerHTML"],xs=Te({__name:"converter",props:at({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},threads:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:at(["start","end"],["update:showNote"]),setup(l,{emit:i}){Je(Ye);const{t:s}=He(),p=It(),o=ga(),a=10,f=navigator.hardwareConcurrency,c=typeof OffscreenCanvas=="function",b=100,h=l,_=$e(l,"showNote"),y=i,g=w(!1),u=w(!1),I=w(!1),O=w(!1),S=w(!1),F=w(()=>"initializing"),j=w("info"),T=zt(Y()),Z=nt("stat"),B=w(0);let m=!1,J=()=>{},W,he=0,M=!1;be(()=>h.input,R=>{R!=null&&R.length&&re(R)}),be(O,R=>{document.body.style.overflowY=R?"hidden":"auto"}),Re(async()=>{await ke(),H()});async function fe(){let R=!0;if(he>a*1e3&&!M&&T.success>0&&(R=!1,await new Promise(D=>{p.warning({title:s("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:s("close"),negativeText:s("back"),onPositiveClick:()=>R=!0,onAfterLeave:D,content:s("confirmCloseDialog")})})),!R)return!1;o.destroyAll(),O.value=!1,_.value=!1}function _e(R){W==null||W(R),console.log(R,"demanded")}function Se(R){$t==null||$t(R),console.log(R,"delete")}function Oe(){!u.value&&g.value?u.value=!0:fe()}function E(){re(h.input)}let N=w(()=>{});function Y(R){const D={logs:[],ziplogs:[],startedCount:0,converted:0,success:0,failure:0,retried:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",convertedImageOrgUrl:"",convertedImageIndex:-1,convertedImageShrinked:!1,zipSize:h.maxZipSizeMB,shrink:V.multithread&&V.shrinkImage?[V.maxWidth,V.maxHeight]:void 0,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1};return Object.assign(R||{},D)}function ce(){S.value=!1,URL.revokeObjectURL(T.convertedImageUrl),URL.revokeObjectURL(T.convertedImageOrgUrl);for(const R of T.zips)URL.revokeObjectURL(R.url);T.zips.length=0;for(const R of T.failedZips)URL.revokeObjectURL(R.url);T.failedZips.length=0,Y(T),J(),J=()=>{},W=null,M=!1,I.value=!1,u.value=!1}async function re(R){if(g.value){p.error({title:"Busy",positiveText:"OK",content:s("interfered")});return}O.value&&(B.value^=1);let D=R.concat();Y(T),ce(),O.value=!0,S.value=!0,g.value=!0,T.processing=!0,j.value="info",F.value=()=>s("processing");const te=new Set,oe=h.format,ae=h.quality,z=[...oe.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),x=pe(oe,ae,D[0].webkitRelativePath);T.length=D.length,T.baseZipName=x,T.type=oe.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(oe)?" ("+ae+")":""),T.threads=m?0:h.threads;const ue=Date.now();y("start");let le,G,K;if(!m&&h.threads>=2?(W=ml,K=await sl({files:D,completedFileIdSet:te,ConvStats:T,canceled:u,props:h,imageType:oe,quality:ae,outputExt:z,format:oe,message:o})):(W=bl,K=await yl(D,te,h,u,T)),{exception:G,callbackToGenerateFailedZips:le,callbackToClearConverter:J}=K,G){let ve;switch(G.message){case"worker-load-error":ve=s("errMsgWorkerLoadError");break;default:ve="unexpected error"}p.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:()=>X("div",[X("p",ve),X(Le,{onClick(){location.reload()}},s("Reload"))])})}if(T.success===T.length?(j.value="success",F.value=()=>s("completed")):(j.value="error",F.value=()=>u.value?s("aborted"):s("incomplete")),te.size!==D.length){const ve=ge(R,te);N.value=()=>{!ve||!ve.length||le(ve)}}g.value=!1,T.processing=!1,I.value=!0,D.length=0,he=Date.now()-ue,y("end")}function ge(R,D){const te=[],oe=[];let ae=0;for(const z of R)D.has(z._id)||(te.push(z),oe.push(z.webkitRelativePath||z.relativePath||z.name),ae+=z.size);return oe.length&&(T.unconvertedListText=oe.join(`
`),T.unconvertedFileCount=te.length,T.unconvertedTotalSize=ae),te}function pe(R,D,te){var ue;const oe=new Date;R=R.replace(/^image\//,"").toLowerCase();const ae=V.useFolderNameForZip&&((ue=String(te).match(/^\/?([^/]+)\//))==null?void 0:ue[1])||"avif2jpg",z=`
    ${oe.getFullYear().toString().substring(2)}
    ${String((oe.getMonth()+1)*100+oe.getDate()).padStart(4,"0")}
    ${String(oe.getHours()*1e4+oe.getMinutes()*100+oe.getSeconds()).padStart(6,"0")}
    -
    ${R+(/jpe?g|webp/i.test(R)?D:"")}
  `.replace(/\s/g,"");return`${ae}-${z}`.replace(/\s+/g," ")}async function ke(){const R="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",D=document.createElement("img"),te=Tn(D).then(()=>!0,()=>!1);D.src=R,await te||p.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:s("avifUnsupported")})}function H(){(!c||f<2||!Promise.any)&&(m=!0),m&&(Pe.value=0)}return(R,D)=>{var le;const te=ye,oe=Nt,ae=Ie,z=Fe,x=xt,ue=Ut;return P(),se(Ee,null,[!e(g)&&((le=h.input)!=null&&le.length)?(P(),ie(z,{key:0,justify:"center",align:"center",style:{"margin-top":"0.4em"}},{default:t(()=>[n(ae,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:t(()=>{var G;return[n(oe,{value:((G=R.input)==null?void 0:G.length)||0,offset:[-12,-5],color:"#99999966"},{default:t(()=>[n(e(Le),{onClick:E,round:"",size:"medium"},{icon:t(()=>[n(te,{size:"1.2em",color:"#CCCCCC"},{default:t(()=>[n(e(ma))]),_:1})]),default:t(()=>[A(" "+d(e(s)("convertAgain")),1)]),_:1})]),_:1},8,["value"])]}),default:t(()=>{var G;return[v("div",{innerHTML:e(s)("reconvertTip",(G=h.input)==null?void 0:G.length)},null,8,zs)]}),_:1})]),_:1})):me("",!0),n(ue,{ref:"processingModal","display-directive":"show",show:e(O),"onUpdate:show":D[2]||(D[2]=G=>De(O)?O.value=G:null),closable:e(I),"close-on-esc":!1,preset:"dialog",onClick:D[3]||(D[3]=G=>{e(o).destroyAll()}),onMaskClick:D[4]||(D[4]=G=>{e(o).destroyAll()}),onClose:fe,onEsc:Oe,title:e(F),type:e(j),"mask-closable":!1,onAfterLeave:ce,onBeforeLeave:D[5]||(D[5]=G=>{e(Z).cleanup()}),class:"processing-dialog"},{default:t(()=>[n(z,{vertical:"",style:{"flex-grow":"1"}},{default:t(()=>[e(S)?(P(),ie(ks,{ref_key:"stat",ref:Z,key:e(B),processing:e(g),status:e(T),interval:b,onAllZipsClicked:D[0]||(D[0]=G=>De(M)?M.value=!0:M=!0),onDemandZipErrors:e(N),onDemandImage:_e,onDeleteImage:Se},null,8,["processing","status","onDemandZipErrors"])):me("",!0),n(z,{justify:"end",align:"center",wrap:!1},{default:t(()=>[n(z,{justify:"start",align:"center"},{default:t(()=>[sn(R.$slots,"lang-switch")]),_:3}),e(g)?(P(),ie(e(Le),{key:0,disabled:e(u),ref:"cancelbutton",round:"",size:"large",onClick:D[1]||(D[1]=G=>u.value=!0)},{default:t(()=>[n(x,{show:e(u)&&!e(I),size:"small"},{default:t(()=>[A(d(e(s)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):e(I)?(P(),ie(e(Le),{key:1,onClick:fe,round:"",size:"large",style:{"font-size":"small","margin-top":"1em"}},{default:t(()=>[A(d(e(s)("close")),1)]),_:1})):me("",!0)]),_:3})]),_:3})]),_:3},8,["show","closable","title","type"])],64)}}}),Is="/avif2jpeg/dist/avif.png",As={class:"container-1"},Ts={style:{position:"relative"}},Ss={style:{position:"absolute","font-size":"0.5em",right:"-3.5em",bottom:"-1.5em","white-space":"nowrap"}},Ls={style:{color:"#666666"}},Cs=["innerHTML"],$s={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},Es=Te({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(l,{emit:i}){Je(Ye);const s=l,p=i,o=va(),a=w(!1),f=w(0),c=w("");Re(()=>{b(s.dropTarget||document)});function b(_){document.ondragstart=y=>y.preventDefault(),document.ondragover=y=>y.preventDefault(),_.ondrop=async y=>{var u;if(y.preventDefault(),a.value||s.forbidden)return;a.value=!0,f.value=0,c.value="";let g;try{const I=[...y.dataTransfer.items].map(O=>O.webkitGetAsEntry());o.start(),g=await h(I),o.finish()}catch{g=[...((u=y.dataTransfer)==null?void 0:u.files)??[]],o.error()}a.value&&(a.value=!1,p("drop",g))}}async function h(_,y){y=y||[];for(const g of _)if(g.isFile){const u=await new Promise(I=>g.file(O=>I(O)));Object.defineProperty(u,"webkitRelativePath",{value:g.fullPath}),y.push(u),f.value++}else if(g.isDirectory){c.value=g.fullPath;const u=g.createReader();do{const I=await new Promise(O=>u.readEntries(S=>O(S)));if(!I.length)break;await h(I,y)}while(!0)}return y}return(_,y)=>{const g=ye,u=et,I=Fe,O=Ie,S=Ut;return P(),se("div",As,[n(O,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"bottom-end"},{trigger:t(()=>[n(I,{vertical:"",class:"container-2"},{default:t(()=>[n(I,{align:"center",wrap:!1,class:"container-3"},{default:t(()=>[n(I,{vertical:"",align:"center",wrap:!1,style:{"font-weight":"bold","font-size":"1em","line-height":"90%","white-space":"nowrap"}},{default:t(()=>[y[5]||(y[5]=v("span",null,"Drag & Drop",-1)),v("span",Ts,[y[4]||(y[4]=A(" AVIF Images ")),v("span",Ss,[y[3]||(y[3]=A(" or ")),n(u,{placement:"bottom-end"},{trigger:t(()=>[v("span",Ls,[n(g,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Bt))]),_:1}),y[1]||(y[1]=A(" Folders "))])]),default:t(()=>[y[2]||(y[2]=A(" You can drag and drop your local folders "))]),_:1})])])]),_:1}),n(I,null,{default:t(()=>y[6]||(y[6]=[v("img",{src:Is,class:"avif"},null,-1)])),_:1})]),_:1})]),_:1})]),default:t(()=>[v("h3",{innerHTML:_.$t("droptarget"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,Cs)]),_:1}),n(S,{show:e(a),"onUpdate:show":y[0]||(y[0]=F=>De(a)?a.value=F:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":_.$t("cancel")},{default:t(()=>[n(I,{vertical:"",align:"center"},{default:t(()=>[v("div",$s,d(e(c)),1),v("div",null,"found "+d(e(f))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])])}}}),Fs=We(Es,[["__scopeId","data-v-963c44a5"]]),Os={class:"container-1"},Ps={class:"container-2"},Us=["innerHTML"],Ms=["innerHTML"],Rs={style:{"white-space":"nowrap"}},Ns={style:{"padding-left":"1em"}},js=["innerHTML"],Bs=["accept"],Ds=Te({__name:"file-selector",props:at({target:{},userExtensions:{},forbidden:{type:Boolean}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:at(["input","click","cancel","on-change-accept","update:target","update:userExtensions"],["update:expanded","update:disableNotifyingFolderSelect"]),setup(l,{emit:i}){const s=It(),{t:p}=He(),o=Je(Ye),a=["avif_only","all_images","all_files","edit_type"],f=[];for(const E of a)f.push({label:()=>p("fileTypeRadioOptions."+E),value:E});const c=({node:E,option:N})=>X(Ie,{placement:"right"},{trigger:()=>E,default:()=>M(N.value).replace(/,/g,", ")}),b=l,h=i,_=w(0),y=w(!1),g=w(!1),u=Ae(()=>M(S.value)),I=Ae(()=>F.value.split(",").every(N=>/^\s*(\.[\w\-]+)*\s*$/.test(N))?"success":"error"),O=Ae(()=>!b.forbidden&&!g.value);$e(l,"expanded");const S=Ae({get:()=>a.indexOf(b.target)>=0?b.target:a[0],set:E=>{h("update:target",E)}}),F=Ae({get:()=>b.userExtensions,set:E=>{h("update:userExtensions",E)}}),j=$e(l,"disableNotifyingFolderSelect"),T=w(null),Z=w(null),B=w(he());be(S,E=>{h("on-change-accept",u.value)}),Re(()=>{});async function m(E){if(h("click"),E===Z.value&&!j.value){let N=!1;if(await new Promise(Y=>{s.info({title:p("loadfolderNotifyingTitle"),positiveText:p("Continue"),negativeText:p("Cancel"),onAfterLeave:()=>Y(N),onPositiveClick:()=>N=!0,content:()=>X("div",[X("p",{},p("loadfolderNotifyingMessageTerm1")),X("div",[X(dn,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/dist//notification-folder.png"})]),X("p",{},p("loadfolderNotifyingMessageTerm2")),X("p",[X(fn,{onUpdateChecked:ce=>j.value=ce,checked:j.value},()=>p("checkboxTextDontShowThis"))])])})}),!N){j.value=!1,h("cancel");return}}E.click()}function J(){h("cancel")}function W(E){const Y=[...E.target.files];T.value.value="",Z.value.value="",_e(Y)}function he(){return"webkitdirectory"in document.createElement("input")}function M(E){switch(E){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico";case"edit_type":return F.value;case"all_files":default:return".*"}}async function fe(E){const N=String(u.value).toLowerCase().replace(/\s+/g,"");if(N&&u.value!==".*"){const Y=N.split(",");E=E.filter(ce=>Y.includes(ce.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),E.length||(await new Promise(ce=>{s.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:ce,content:()=>X("div",[X(Mt,{description:"NO IMAGES"}),`${p("noimage")}`,X("br"),u.value])})}),J())}return E}async function _e(E){g.value=!0,E=await fe(E),_.value=E.length,E.length>0&&h("input",Oe(E)),g.value=!1}let Se=0;function Oe(E){const N=[];for(const Y of E)Y.hasOwnProperty("_id")||Object.defineProperty(Y,"_id",{value:Se++}),N.push(Y);return N}return(E,N)=>{const Y=ye,ce=Le,re=Fe,ge=Tt,pe=_a,ke=ha,H=et;return P(),se(Ee,null,[v("div",Os,[v("div",Ps,[n(re,{vertical:"",align:"center",justify:"center",inline:"",size:"large"},{default:t(()=>[n(re,{align:"center",justify:"space-around",class:"main-buttons"},{default:t(()=>[n(re,{vertical:"",align:"stretch",justify:"center"},{default:t(()=>[n(e(Ie),{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(o).LANDSCAPE.value?"right":"top",duration:0,delay:0,"z-index":10},{trigger:t(()=>[n(ce,{disabled:!e(O),size:"large",onClick:N[0]||(N[0]=R=>m(e(T))),round:"",style:{width:"100%","background-color":"white","font-size":"large"}},{icon:t(()=>[n(Y,{size:"large",color:"gray"},{default:t(()=>[n(e(hn))]),_:1})]),default:t(()=>[A(" "+d(E.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[v("div",{innerHTML:E.$t("loadbuttontooltip")},null,8,Us)]),_:1},8,["show","placement"]),!e(o).IS_SP&&e(B)||e(o).SSR?(P(),se(Ee,{key:0},[n(re,{align:"center",justify:"center",style:{color:"gray",margin:"0em"}},{default:t(()=>[A(d(E.$t("or")),1)]),_:1}),n(e(Ie),{to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:e(o).showTooltipsBeforeMounted.value},{trigger:t(()=>[n(ce,{disabled:!e(O),size:"large",onClick:N[1]||(N[1]=R=>m(e(Z))),round:"",style:{width:"100%","background-color":"white","font-size":"large"}},{icon:t(()=>[n(Y,{size:"large",color:"gray"},{default:t(()=>[n(e(Bt))]),_:1})]),default:t(()=>[A(" "+d(E.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[v("div",{innerHTML:E.$t("loadfoldertooltip")},null,8,Ms)]),_:1},8,["show"])],64)):me("",!0)]),_:1}),e(o).IS_SP?me("",!0):(P(),ie(Fs,{key:0,onDrop:_e,forbidden:!e(O),class:"drop-target"},null,8,["forbidden"]))]),_:1}),n(re,{vertical:""},{default:t(()=>[n(re,{wrap:e(o).IS_SP,align:"center",justify:"stretch"},{default:t(()=>[v("span",Rs,d(E.$t("TargetFileTypeExt"))+": ",1),n(e(Ie),{"keep-alive-on-hover":!1,placement:"right",style:{"max-width":"200px"},duration:0,delay:0},{trigger:t(()=>[n(ge,{trigger:"click",width:"trigger",size:"small",value:e(S),"onUpdate:value":N[2]||(N[2]=R=>De(S)?S.value=R:null),options:f,"render-option":c,"consistent-menu-width":!1},null,8,["value"])]),default:t(()=>[A(" "+d(M(e(S)).replace(/,/g,", ")),1)]),_:1})]),_:1},8,["wrap"]),e(S)==="edit_type"?(P(),ie(e(Ie),{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:e(y),duration:0,delay:0},{trigger:t(()=>[v("div",Ns,[n(H,{trigger:"manual",placement:"right-end",show:e(S)==="edit_type"&&e(I)!=="success"&&!!e(y)},{trigger:t(()=>[n(pe,{value:e(F),"onUpdate:value":N[3]||(N[3]=R=>De(F)?F.value=R:null),status:e(I),disabled:e(S)!=="edit_type",onFocus:N[4]||(N[4]=R=>y.value=!0),onBlur:N[5]||(N[5]=R=>y.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:t(()=>[n(ke,{type:"error","show-icon":!0,title:"Validation error"},{default:t(()=>N[6]||(N[6]=[A(" Please correct the extension list."),v("br",null,null,-1),v("ul",null,[v("li",null,"Each extension must begin with a period. "),v("li",null,"Separate each extension with a comma. "),v("li",null,"Use alphameric characters.")],-1)])),_:1})]),_:1},8,["show"])])]),default:t(()=>[v("span",{innerHTML:E.$t("editAcceptTypes")},null,8,js)]),_:1},8,["show"])):me("",!0)]),_:1})]),_:1})])]),v("input",{ref_key:"fileinput",ref:T,onInput:W,onCancel:J,type:"file",multiple:"",accept:e(u),style:{display:"none"}},null,40,Bs),v("input",{ref_key:"folderinput",ref:Z,webkitdirectory:"",directory:"",onInput:W,onCancel:J,type:"file",style:{display:"none"}},null,544)],64)}}}),Zs=We(Ds,[["__scopeId","data-v-946de019"]]),Vs={style:{"white-space":"nowrap"}},Hs=Te({__name:"settings-output",props:{quality:{},format:{}},emits:["update:format","update:quality"],setup(l,{emit:i}){const s=l,p=i,{t:o}=He(),a=Je(Ye),f=w([]),c=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],b=Ae({get:()=>s.format,set:I=>{I=g(I),p("update:format",I)}}),h=Ae({get:()=>s.quality,set:I=>{p("update:quality",I)}}),_=Ae(()=>/png|bmp/i.test(b.value)),y=w(null);Re(()=>{u()});function g(I){return f.value.indexOf(I)<0&&(I=f.value[0]),I}function u(){for(const I of c)y.value.toDataURL(I).indexOf(I)>=0&&f.value.push(I);f.value.length===0&&f.value.push(c[0])}return(I,O)=>{const S=ye,F=Tt,j=Fe,T=Ie,Z=At,B=_n;return P(),se(Ee,null,[n(j,{justify:"center",class:"body"},{default:t(()=>[n(j,{vertical:""},{default:t(()=>[n(T,{to:!1,"display-directive":"show",show:e(a).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(a).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(j,{align:"center",wrap:!1},{default:t(()=>[n(S,null,{default:t(()=>[n(e(hn))]),_:1}),A(d(e(o)("settings.imageType"))+": ",1),n(F,{value:b.value,"onUpdate:value":O[0]||(O[0]=m=>b.value=m),options:f.value.map(m=>({value:m,label:m})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:t(()=>[A(" "+d(e(o)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(T,{to:!1,"display-directive":"show",show:e(a).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(a).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(j,{align:"center"},{default:t(()=>[n(j,{align:"start",wrap:!1},{default:t(()=>[n(S,null,{default:t(()=>[n(e(vn))]),_:1}),v("span",Vs,d(e(o)("settings.quality"))+":",1),n(j,{align:"center",justify:"space-between"},{default:t(()=>[n(Z,{tooltip:!1,value:h.value,"onUpdate:value":O[1]||(O[1]=m=>h.value=m),step:1,style:{width:"120px"},disabled:_.value},null,8,["value","disabled"]),n(B,{onBlur:O[2]||(O[2]=m=>h.value??(h.value=0)),value:h.value,"onUpdate:value":O[3]||(O[3]=m=>h.value=m),step:"1",min:"0",max:"100",disabled:_.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:t(()=>[A(" "+d(e(o)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1})]),_:1}),v("canvas",{ref_key:"canvas",ref:y,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),Ws=We(Hs,[["__scopeId","data-v-060333f5"]]),qs={style:{width:"4em","text-align":"left"}},Gs={style:{width:"4em","text-align":"left"}},Et=100,en=2e3,tn=4096,nn=4096,Ks=100,Ys=100,Qs=Te({__name:"settings-adv",props:{expanded:{type:Boolean,required:!1},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}},emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(l){const i={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},s=$e(l,"expanded"),p=$e(l,"multithread"),o=$e(l,"threadCount"),a=$e(l,"maxZipSize"),f=$e(l,"retainExt"),c=$e(l,"useFolderNameForZip"),b=$e(l,"shrinkImage"),h=$e(l,"maxWidth"),_=$e(l,"maxHeight");be(Pe,g=>{g>1||(p.value=!1),o.value>g&&(o.value=g)},{immediate:!0});const y=Ae(()=>p.value&&Pe.value>1);return Re(()=>{Pe.value>1&&typeof o.value>"u"&&(o.value=Math.max(Pe.value,2))}),(g,u)=>{const I=ye,O=Le,S=ba,F=Fe,j=At,T=_n,Z=jt,B=mn;return P(),ie(F,{justify:"center"},{default:t(()=>[n(B,{"display-directive":"show","default-expanded-names":s.value?["collapitem"]:"","on-update:expanded-names":m=>s.value=!!String(m),"trigger-areas":["arrow","main"],class:ot(["settings-body",s.value?"expand-adv-settings":""])},wa({arrow:t(()=>[n(I,{style:de(s.value&&{top:"8px"})},{default:t(()=>[n(e(xa))]),_:1},8,["style"]),n(I,null,{default:t(()=>[n(e(Ia))]),_:1})]),default:t(()=>[n(Z,{title:g.$t("settings.advancedSettings"),name:"collapitem"},{default:t(()=>[n(F,{vertical:"",style:{"padding-left":"2em"}},{default:t(()=>[n(e(Ie),it(rt(i)),{trigger:t(()=>[n(F,{vertical:""},{default:t(()=>[n(F,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",disabled:!e(Pe),style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:u[0]||(u[0]=m=>p.value=!p.value)},{icon:t(()=>[n(I,null,{default:t(()=>[n(e(ya))]),_:1})]),default:t(()=>[A(" "+d(g.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(S,{value:p.value,"onUpdate:value":u[1]||(u[1]=m=>p.value=m),disabled:!e(Pe),size:"small"},null,8,["value","disabled"])]),_:1}),n(F,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(j,{value:o.value,"onUpdate:value":u[2]||(u[2]=m=>o.value=m),disabled:!e(Pe)||!p.value,step:1,min:2,max:e(Pe),style:{width:"120px"}},null,8,["value","disabled","max"]),n(T,{onBlur:u[3]||(u[3]=m=>o.value??(o.value=2)),size:"tiny",value:o.value,"onUpdate:value":u[4]||(u[4]=m=>o.value=m),disabled:!e(Pe)||!p.value,step:1,min:2,max:e(Pe),style:{width:"10em"}},{suffix:t(()=>[A(d(g.$t("threads",o.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[A(" "+d(g.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(e(Ie),it(rt(i)),{trigger:t(()=>[n(F,{vertical:""},{default:t(()=>[n(F,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:t(()=>[n(I,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(ka))]),_:1})]),default:t(()=>[A(" "+d(g.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(F,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(j,{tooltip:!1,value:a.value,"onUpdate:value":u[5]||(u[5]=m=>a.value=m),step:1,min:Et,max:en,style:{width:"120px"}},null,8,["value"]),n(T,{onBlur:u[6]||(u[6]=m=>a.value??(a.value=Et)),size:"tiny",value:a.value,"onUpdate:value":u[7]||(u[7]=m=>a.value=m),step:"1",min:Et,max:en,style:{width:"10em"}},{suffix:t(()=>u[20]||(u[20]=[A("(MB)")])),_:1},8,["value"])]),_:1})]),_:1})]),default:t(()=>[A(" "+d(g.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(e(Ie),it(rt(i)),{trigger:t(()=>[n(F,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:u[8]||(u[8]=m=>c.value=!c.value)},{icon:t(()=>[n(I,null,{default:t(()=>[n(e(Bt))]),_:1})]),default:t(()=>[A(" "+d(g.$t("settings.useFolderNameForZip")),1)]),_:1}),n(S,{value:c.value,"onUpdate:value":u[9]||(u[9]=m=>c.value=m),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[A(" "+d(g.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(e(Ie),it(rt(i)),{trigger:t(()=>[n(F,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:u[10]||(u[10]=m=>f.value=!f.value)},{icon:t(()=>[n(I,null,{default:t(()=>[n(e(gn))]),_:1})]),default:t(()=>[A(" "+d(g.$t("settings.retainOriginalExtension")),1)]),_:1}),n(S,{value:f.value,"onUpdate:value":u[11]||(u[11]=m=>f.value=m),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[A(" "+d(g.$t("settings.retainExtTooltip")),1)]),_:1},16),n(e(Ie),it(rt(i)),{trigger:t(()=>[n(F,{vertical:""},{default:t(()=>[n(F,{wrap:!1,align:"center"},{default:t(()=>[n(O,{disabled:!y.value,text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:u[12]||(u[12]=m=>b.value=!b.value)},{icon:t(()=>[n(I,null,{default:t(()=>[n(e(za))]),_:1})]),default:t(()=>[A(" "+d(g.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(S,{disabled:!y.value,value:b.value,"onUpdate:value":u[13]||(u[13]=m=>b.value=m),size:"small"},null,8,["disabled","value"])]),_:1}),n(F,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(j,{value:h.value,"onUpdate:value":u[14]||(u[14]=m=>h.value=m),disabled:!b.value||!y.value,step:1,min:Ks,max:tn,style:{width:"120px"}},null,8,["value","disabled"]),n(T,{size:"tiny",onBlur:u[15]||(u[15]=m=>h.value??(h.value=8)),value:h.value,"onUpdate:value":u[16]||(u[16]=m=>h.value=m),disabled:!b.value||!y.value,step:1,min:8,max:tn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[v("span",qs,d(g.$t("width")),1)]),suffix:t(()=>u[21]||(u[21]=[A("px")])),_:1},8,["value","disabled","max"])]),_:1}),n(F,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(j,{value:_.value,"onUpdate:value":u[17]||(u[17]=m=>_.value=m),disabled:!b.value||!y.value,step:1,min:Ys,max:nn,style:{width:"120px"}},null,8,["value","disabled"]),n(T,{size:"tiny",onBlur:u[18]||(u[18]=m=>_.value??(_.value=8)),value:_.value,"onUpdate:value":u[19]||(u[19]=m=>_.value=m),disabled:!b.value||!y.value,step:1,min:8,max:nn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[v("span",Gs,d(g.$t("height")),1)]),suffix:t(()=>u[22]||(u[22]=[A("px")])),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[A(" "+d(g.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1},8,["title"])]),_:2},[s.value?{name:"header-extra",fn:t(()=>[n(e(Ie),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(O,{onClick:e(Na),size:"tiny",style:{"font-size":"xx-small"}},{default:t(()=>[A(d(g.$t("reset")),1)]),_:1},8,["onClick"])]),default:t(()=>[A(" "+d(g.$t("settings.resetButtonTooltip")),1)]),_:1})]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1})}}}),Xs=We(Qs,[["__scopeId","data-v-661ec94b"]]),Js={},ei={style:{color:"gray","padding-left":"20px"}},ti=["innerHTML"];function ni(l,i){const s=rn,p=Fe;return P(),ie(p,{vertical:"",justify:"end"},{default:t(()=>[n(s,{style:{margin:"0px"}}),n(p,{justify:"center"},{default:t(()=>[v("ul",ei,[(P(!0),se(Ee,null,ct(l.$tm("descriptions"),o=>(P(),se("li",{key:o,style:{"text-align":"left"},innerHTML:o},null,8,ti))),128))])]),_:1})]),_:1})}const oi=We(Js,[["render",ni]]),ai="modulepreload",li=function(l){return"/avif2jpeg/dist/"+l},on={},we=function(i,s,p){let o=Promise.resolve();if(s&&s.length>0){let f=function(h){return Promise.all(h.map(_=>Promise.resolve(_).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),b=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));o=f(s.map(h=>{if(h=li(h),h in on)return;on[h]=!0;const _=h.endsWith(".css"),y=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${y}`))return;const g=document.createElement("link");if(g.rel=_?"stylesheet":ai,_||(g.as="script"),g.crossOrigin="",g.href=h,b&&g.setAttribute("nonce",b),document.head.appendChild(g),_)return new Promise((u,I)=>{g.addEventListener("load",u),g.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(f){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=f,window.dispatchEvent(c),!c.defaultPrevented)throw f}return o.then(f=>{for(const c of f||[])c.status==="rejected"&&a(c.reason);return i().catch(a)})},Sn="English",Ln="🇬🇧",Cn='AVIF to JPEG "Offline" Batch Converter',$n="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",En="Drag & Drop AVIF Images to Convert",Fn=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.'],On="Select your language",Pn="Choose Target File Extentions",Un={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},Mn="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",Rn="Load Images",Nn="Select your images from a dialog window.<br>*Multiple selection allowed.",jn="Load a Whole Folder",Bn=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,Dn="Converting images",Zn="Aborted",Vn="Some files failed to convert",Hn="Completed",Wn="Currently Busy",qn="No files with the extentions were found.",Gn="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",Kn="Cancel",Yn="Save",Qn="Close",Xn="Open",Jn="Re-convert",eo="Convert previous selected {n} @:files again",to="File | Files",no="thread | threads",oo="You have not saved the converted images yet.",ao="Data have not been saved",lo="Open Source",so="Open the converted image",io="Copied to clipboard",ro="The converted image was copied to your clipboard as DataURL.",uo="Copy the converted image as DataURL",co="Convert Again",po={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",showOnlyErrors:"Show only errors",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files",Shrinked:"Shrinked",Shrinking:"Shrinking",saveAll:"Save All",progressRetries:"Retrying files",success:"success",started:"started",total:"total",files:"files",failure:"failure",all:"all",filterLogSelect:"filter",showOnlySuccess:"Only successes",showOnlyError:"Only errors",showAll:"Show all",Progress:"Progress",PreviewImage:"Preview Images",Log:"Log",log:"Log",Output:"Output Results",expandLog:"expand log size",autoScroll:"auto-scroll",sortByStatus:"status",sort:"Sort list by",sortByName:"name",sortBySize:"size",sortByOutputSize:"size(output)",sortByStart:"starting order",sortByCompletion:"output order"},fo={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file"},go="Disabled",mo="Download",vo="Reset",ho="Back",_o="Failed",wo="Success",yo="Previous version",bo=`
Height`,ko="Width",zo="Don't show this message again",xo="About the warning when selecting a folder",Io="OK",Ao={},To="You must press the “Upload” button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",So="Continue",Lo="Cancel",Co="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",$o="This page may be an outdated version. Please reload the page.",Eo="Reload",Fo='If the conversion process frequently fails and an “Out of Memory” message appears, try reducing or disabling the number of "multi-threads" in the "Advanced Settings".',Oo="Next",Po="Previous",Uo="or",Mo="Target File Extensions",Ro={lang:Sn,flags:Ln,title:Cn,metaDescription:$n,droptarget:En,descriptions:Fn,selectLanguage:On,fileTypeRadioTitle:Pn,fileTypeRadioOptions:Un,editAcceptTypes:Mn,loadbutton:Rn,loadbuttontooltip:Nn,loadfolderbutton:jn,loadfoldertooltip:Bn,processing:Dn,aborted:Zn,incomplete:Vn,completed:Hn,interfered:Wn,noimage:qn,avifUnsupported:Gn,cancel:Kn,save:Yn,close:Qn,open:Xn,reconvert:Jn,reconvertTip:eo,files:to,threads:no,confirmCloseDialog:oo,confirmCloseDialogTitle:ao,githubOpenSource:lo,convertedImageUrlTooltip:so,copiedDataURLDialogTitle:io,copiedDataURLMessage:ro,convertedImageDataUrlTooltip:uo,convertAgain:co,status:po,settings:fo,disabled:go,Download:mo,reset:vo,back:ho,failed:_o,success:wo,previousVersion:yo,height:bo,width:ko,checkboxTextDontShowThis:zo,loadfolderNotifyingTitle:xo,OK:Io,loadfolderNotifyingMessage:Ao,loadfolderNotifyingMessageTerm2:To,Continue:So,Cancel:Lo,loadfolderNotifyingMessageTerm1:Co,errMsgWorkerLoadError:$o,Reload:Eo,annotationOutOfMemory:Fo,Next:Oo,Prev:Po,or:Uo,TargetFileTypeExt:Mo},si=Object.freeze(Object.defineProperty({__proto__:null,Cancel:Lo,Continue:So,Download:mo,Next:Oo,OK:Io,Prev:Po,Reload:Eo,TargetFileTypeExt:Mo,aborted:Zn,annotationOutOfMemory:Fo,avifUnsupported:Gn,back:ho,cancel:Kn,checkboxTextDontShowThis:zo,close:Qn,completed:Hn,confirmCloseDialog:oo,confirmCloseDialogTitle:ao,convertAgain:co,convertedImageDataUrlTooltip:uo,convertedImageUrlTooltip:so,copiedDataURLDialogTitle:io,copiedDataURLMessage:ro,default:Ro,descriptions:Fn,disabled:go,droptarget:En,editAcceptTypes:Mn,errMsgWorkerLoadError:$o,failed:_o,fileTypeRadioOptions:Un,fileTypeRadioTitle:Pn,files:to,flags:Ln,githubOpenSource:lo,height:bo,incomplete:Vn,interfered:Wn,lang:Sn,loadbutton:Rn,loadbuttontooltip:Nn,loadfolderNotifyingMessage:Ao,loadfolderNotifyingMessageTerm1:Co,loadfolderNotifyingMessageTerm2:To,loadfolderNotifyingTitle:xo,loadfolderbutton:jn,loadfoldertooltip:Bn,metaDescription:$n,noimage:qn,open:Xn,or:Uo,previousVersion:yo,processing:Dn,reconvert:Jn,reconvertTip:eo,reset:vo,save:Yn,selectLanguage:On,settings:fo,status:po,success:wo,threads:no,title:Cn,width:ko},Symbol.toStringTag,{value:"Module"})),ii="Arabic",ri="German",ui="English",di="Spanish",ci="Finnish",pi="French",fi="Hindi",gi="Indonesian",mi="Italian",vi="Japanese",hi="Korean",_i="Dutch",wi="Polish",yi="Portuguese",bi="Russian",ki="Turkish",zi="Ukrainian",xi="Chinese",Ii={ar:ii,de:ri,en:ui,es:di,fi:ci,fr:pi,hi:fi,id:gi,it:mi,ja:vi,ko:hi,nl:_i,pl:wi,pt:yi,ru:bi,tr:ki,uk:zi,"zh-hant":"Chinese(hant)",zh:xi},bt=[],No={en:Ro},Vt={},an=Object.assign({"./locales/ar.json":()=>we(()=>import("./ar-BgngyIMi.js"),[]),"./locales/de.json":()=>we(()=>import("./de-v3ueBOSV.js"),[]),"./locales/en.json":()=>we(()=>Promise.resolve().then(()=>si),void 0),"./locales/es.json":()=>we(()=>import("./es-C2cGdukK.js"),[]),"./locales/fi.json":()=>we(()=>import("./fi-5ZrKH-Ih.js"),[]),"./locales/fr.json":()=>we(()=>import("./fr-B1KRO7gm.js"),[]),"./locales/hi.json":()=>we(()=>import("./hi-BYS3b9Xc.js"),[]),"./locales/id.json":()=>we(()=>import("./id-Bh86-Owa.js"),[]),"./locales/it.json":()=>we(()=>import("./it-3HgfLRdM.js"),[]),"./locales/ja.json":()=>we(()=>import("./ja-BB7QLQ56.js"),[]),"./locales/ko.json":()=>we(()=>import("./ko-DEvhJkq-.js"),[]),"./locales/nl.json":()=>we(()=>import("./nl-BVb671a3.js"),[]),"./locales/pl.json":()=>we(()=>import("./pl-CUezuRiL.js"),[]),"./locales/pt.json":()=>we(()=>import("./pt-Cuc_8V_q.js"),[]),"./locales/ru.json":()=>we(()=>import("./ru-CTFfZQm7.js"),[]),"./locales/tr.json":()=>we(()=>import("./tr-DsQozz3L.js"),[]),"./locales/uk.json":()=>we(()=>import("./uk-x1nsBL4Z.js"),[]),"./locales/zh-hant.json":()=>we(()=>import("./zh-hant-COM0_YJO.js"),[]),"./locales/zh.json":()=>we(()=>import("./zh-Dxq2FLYG.js"),[])});var ln;for(const l in an){const i=(ln=l.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:ln[1];i&&(bt.push(i),!(i in No)&&(Vt[i]=an[l]))}let Pt=Ti();Pt in Vt||(Pt="en");const kt=Aa({legacy:!1,globalInjection:!0,locale:Pt,fallbackLocale:"en",messages:No,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Ai(l){if(kt.global.availableLocales.indexOf(l)>=0)return;const i=await Vt[l]();kt.global.setLocaleMessage(l,i),await Ce()}function Ti(){const l=location.pathname;return String(l.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Si=["innerHTML"],Li=Te({__name:"switch-lang",props:{delay:{}},emits:["lang-ready","lang-change"],async setup(l,{emit:i}){let s,p;const o=Je(Ye),a=un(),{locale:f,t:c}=He(),b=l,h=i,_=Object.entries(Ii).map(([S,F])=>({label:F,value:S}));_.sort((S,F)=>{const j=S.label,T=F.label;return j>T?1:j<T?-1:0}),Re(()=>{a.afterEach((S,F,j)=>{g(),o.switchToolTipVisibility()})}),[s,p]=Ta(()=>g()),await s,p();async function y(S){(S!==f.value||kt.global.availableLocales.indexOf(S)===-1)&&(h("lang-change",S),await _l(b.delay),await Ai(S),f.value=S,document.title=c("title"),await Ce()),h("lang-ready",S)}async function g(){const S=a.currentRoute.value.path||"",F=String(S.match(new RegExp("(?<=^\\/)[^/]+"))||"");F&&bt.includes(F)?(await y(F),f.value=F):await u()}async function u(){const S=I().toLowerCase(),F=S.split(/[-_]/)[0];if(bt.includes(F)){let j=F;if(F==="zh")switch(S){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":j="zh-hant"}await y(j)}}function I(){const S=window.navigator;return S.language||S.userLanguage||S.browserLanguage}function O(S){console.log(`changeRoute: ${a.currentRoute.value.fullPath} => ${S}`),a.push("/"+S+"/")}return(S,F)=>{const j=ye,T=Tt,Z=Ie;return P(),ie(Z,{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(o).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:t(()=>[n(T,{ref:"langselect",size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,options:e(_),"_v-model:value":"locale",value:e(f),"onUpdate:value":O},{arrow:t(()=>[n(j,null,{default:t(()=>[n(e(Sa))]),_:1})]),_:1},8,["options","value"])]),default:t(()=>[v("div",{innerHTML:S.$t("selectLanguage")},null,8,Si)]),_:1},8,["show","placement"])}}}),Ye=Symbol("global variables"),Ci=Te({__name:"Avif2Jpeg",emits:["ready"],setup(l,{emit:i}){const{t:s,locale:p}=He(),o=200,a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),f=w(null);w(0);let c=w(void 0);const b=w(!0),h=w(!1),_=w(!1),y=w(!1),g=w(!0),u=w(!1);$a(Ye,{showTooltipsBeforeMounted:c,LANDSCAPE:b,IS_SP:a,switchToolTipVisibility:F,SSR:!1}),Re(()=>{j(),window.addEventListener("resize",j),F(),setTimeout(()=>_.value=!0,3e3)}),vt(()=>{window.removeEventListener("resize",j)});let I=0;function O(){y.value=!1,I=Date.now()}function S(){const B=g.value?0:Math.max(0,o-(Date.now()-I));g.value=!1,Ce(()=>{setTimeout(()=>y.value=!0,B)})}async function F(){}function j(){const B=document.body.clientWidth,m=document.body.clientHeight;b.value=B*.75>m||B>900}function T(B){f.value=B}function Z(B){u.value=B}return(B,m)=>{const J=Fe,W=ye,he=et;return P(),ie(J,{vertical:"",align:"stretch",class:"avif2jpeg"},{default:t(()=>[n(Ya,null,{"lang-switch":t(()=>[(P(),ie(La,null,{default:t(()=>[n(Li,{onLangChange:O,onLangReady:S,delay:e(g)?0:o},null,8,["delay"])]),_:1}))]),_:1}),n(Xe,{name:"fade"},{default:t(()=>[je(n(J,{vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:t(()=>[n(J,{justify:"space-around",vertical:"",style:{height:"100%"}},{default:t(()=>[n(Xa),n(J,{justify:"center"},{default:t(()=>[n(Zs,{"_v-model:expanded":"UserSettings.expandExtButtons",target:e(V).acceptTypeValue,"onUpdate:target":m[0]||(m[0]=M=>e(V).acceptTypeValue=M),userExtensions:e(V).editedAcceptTypes,"onUpdate:userExtensions":m[1]||(m[1]=M=>e(V).editedAcceptTypes=M),"disable-notifying-folder-select":e(V).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":m[2]||(m[2]=M=>e(V).disableNotifyingFolderSelect=M),forbidden:e(h),onInput:T,onClick:m[3]||(m[3]=M=>Z(!0)),onCancel:m[4]||(m[4]=M=>Z(!1))},null,8,["target","userExtensions","disable-notifying-folder-select","forbidden"])]),_:1}),n(xs,{input:e(f),format:e(V).imageFormat,quality:e(V).imageQuality,"retain-extension":e(V).retainExtension,maxZipSizeMB:e(V).maxZipSizeMB,threads:e(V).multithread?e(V).threadCount:0,"show-note":e(u),"onUpdate:showNote":m[5]||(m[5]=M=>De(u)?u.value=M:null),onStart:m[6]||(m[6]=M=>h.value=!0),onEnd:m[7]||(m[7]=M=>h.value=!1),"_:multi-thread-count":"val => availableThreadCount = val"},{"lang-switch":t(()=>m[18]||(m[18]=[])),_:1},8,["input","format","quality","retain-extension","maxZipSizeMB","threads","show-note"]),n(J,{vertical:"",align:"center"},{default:t(()=>[n(he,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(W,{size:"5vh",color:"#DADADA",style:{margin:"0px"}},{default:t(()=>[n(e(Ca))]),_:1})]),default:t(()=>[m[19]||(m[19]=v("span",null,"CONVERT TO👇",-1))]),_:1})]),_:1}),n(J,{vertical:"",align:"center"},{default:t(()=>[n(Ws,{format:e(V).imageFormat,"onUpdate:format":m[8]||(m[8]=M=>e(V).imageFormat=M),quality:e(V).imageQuality,"onUpdate:quality":m[9]||(m[9]=M=>e(V).imageQuality=M)},null,8,["format","quality"]),n(Xs,{"retain-ext":e(V).retainExtension,"onUpdate:retainExt":m[10]||(m[10]=M=>e(V).retainExtension=M),"use-folder-name-for-zip":e(V).useFolderNameForZip,"onUpdate:useFolderNameForZip":m[11]||(m[11]=M=>e(V).useFolderNameForZip=M),"max-zip-size":e(V).maxZipSizeMB,"onUpdate:maxZipSize":m[12]||(m[12]=M=>e(V).maxZipSizeMB=M),"_v-model:expanded":"UserSettings.expandAdvSettings",multithread:e(V).multithread,"onUpdate:multithread":m[13]||(m[13]=M=>e(V).multithread=M),"thread-count":e(V).threadCount,"onUpdate:threadCount":m[14]||(m[14]=M=>e(V).threadCount=M),"_:thread-max":"availableThreadCount","shrink-image":e(V).shrinkImage,"onUpdate:shrinkImage":m[15]||(m[15]=M=>e(V).shrinkImage=M),"max-width":e(V).maxWidth,"onUpdate:maxWidth":m[16]||(m[16]=M=>e(V).maxWidth=M),"max-height":e(V).maxHeight,"onUpdate:maxHeight":m[17]||(m[17]=M=>e(V).maxHeight=M)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","multithread","thread-count","shrink-image","max-width","max-height"])]),_:1}),n(oi)]),_:1})]),_:1},512),[[Be,e(y)]])]),_:1})]),_:1})}}}),Ht=Te({__name:"App",setup(l){const i={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{},Image:{toolbarColor:"#00000099"}},s=w(!0);return Re(()=>{s.value=!1}),(p,o)=>{const a=Pa,f=Oa,c=Fa,b=Ea,h=Ua;return P(),ie(h,{"theme-overrides":i,style:{width:"100%",height:"100%"}},{default:t(()=>[n(b,null,{default:t(()=>[n(c,{placement:"top-left",closable:!0,max:50},{default:t(()=>[n(f,null,{default:t(()=>[n(a,null,{default:t(()=>[n(Ci,{class:ot({hide:e(s)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),jo=[{path:"/",name:"Home",component:Ht}];for(const l of bt)jo.push({path:"/"+l+"/",strict:!0,name:l,component:Ht});Ma(Ht,{routes:jo,base:"/avif2jpeg/dist/"},({app:l,router:i,routes:s,isClient:p,initialState:o})=>{l.use(kt)});
