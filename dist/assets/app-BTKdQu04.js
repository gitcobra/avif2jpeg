var Ea=Object.defineProperty;var Fa=(a,l,f)=>l in a?Ea(a,l,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[l]=f;var je=(a,l,f)=>Fa(a,typeof l!="symbol"?l+"":l,f);import{r as ut,d as be,i as qe,o as M,c as G,w as t,a as n,u as e,b as S,t as u,N as ye,_ as qt,e as ze,L as Ma,f as _,g as le,h,F as Te,j as He,B as xe,k as xt,l as Y,m as Oa,n as Ua,p as Le,q as kt,s as Gt,v as we,x as Pa,y as ke,z as _t,A as yt,C as At,D as zt,E as Fe,G as re,T as Ze,H as Kt,I as Qt,J as Be,K as Yt,M as Ge,O as We,P as dt,Q as Jt,R as $e,S as Xt,U as Xe,V as de,W as Na,X as Da,Y as Tt,Z as mt,$ as Ot,a0 as ot,a1 as Ra,a2 as en,a3 as It,a4 as ja,a5 as tn,a6 as Za,a7 as nn,a8 as vt,a9 as Ce,aa as et,ab as Ba,ac as Ha,ad as Wa,ae as Va,af as an,ag as on,ah as St,ai as Lt,aj as qa,ak as ln,al as Ga,am as Ka,an as tt,ao as Qa,ap as Ya,aq as Se,ar as Ja,as as Xa,at as eo,au as to,av as Ct,aw as no,ax as ao,ay as oo,az as lo,aA as sn,aB as io,aC as so,aD as rn,aE as un,aF as Ye,aG as Je,aH as ro,aI as uo,aJ as co,aK as po,aL as fo,aM as go,aN as mo,aO as vo,aP as ho,aQ as _o,aR as yo,aS as wo,aT as bo,aU as xo,aV as ko,aW as Ao,aX as zo,aY as To,aZ as Io}from"./vendor-DJshNPBh.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function f(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=f(s);fetch(s.href,r)}})();const So={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:void 0,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1},H=ut(dn({}));function Lo(){dn(H)}function dn(a){return Object.assign(a,So)}const cn="avif2jpeg",ht=JSON.parse(localStorage.getItem(cn)||"{}");for(const a in H)ht.hasOwnProperty(a)&&ht[a]!==void 0&&(H[a]=ht[a]);window.addEventListener("unload",()=>{const a={};for(const l in H)a[l]=H[l];localStorage.setItem(cn,JSON.stringify(a))});const Co=be({__name:"github",setup(a){const l=qe(Pe);return(f,o)=>{const s=ye,r=qt,i=ze;return M(),G(i,{to:!1,"display-directive":"show",show:e(l).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(r,{href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-size":"small","font-weight":"bolder"}},{default:t(()=>[n(s,null,{default:t(()=>[n(e(Ma))]),_:1}),S("GitHub")]),_:1})]),default:t(()=>[S(" "+u(f.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),$o=h("h3",null,"Used Framework and Libraries",-1),Eo=["href"],Fo=be({__name:"licenses",setup(a){const l=_(!1),f={Vue:"https://github.com/vuejs/core/blob/main/LICENSE",Vite:"https://github.com/vitejs/vite/blob/main/LICENSE","Vite SSG":"https://github.com/antfu/vite-ssg/blob/main/LICENSE","Naive UI":"https://github.com/TuSimple/naive-ui/blob/main/LICENSE",Ionicons:"https://github.com/ionic-team/ionicons/blob/main/LICENSE"};return(o,s)=>{const r=xe;return M(),le(Te,null,[n(r,{text:"",onClick:s[0]||(s[0]=i=>l.value=!0),style:{color:"black","font-size":"small"}},{default:t(()=>[S("Licenses")]),_:1}),n(e(xt),{preset:"dialog",ref:"dialog",show:l.value,"onUpdate:show":s[1]||(s[1]=i=>l.value=i),"positive-text":"OK",title:"Licenses"},{default:t(()=>[$o,h("ul",null,[(M(),le(Te,null,He(f,(i,p)=>h("li",null,[h("a",{href:i},u(p),9,Eo)])),64))])]),_:1},8,["show"])],64)}}}),Mo=1,Oo=7,Uo=15,Po="",it={major:Mo,minor:Oo,build:Uo,tag:Po},No={style:{"font-size":"x-small","user-select":"none"}},Do=be({__name:"version",setup(a){const l=["0.0.118"],f=`${it.major}.${it.minor}.${it.build}${it.tag}`,o=l.map(p=>({label:`v${p}`,key:p,value:p}));function s(p){const{key:z,label:k}=p,A=i(z),c=Y("a",{href:A},k),$=Y("div",null,c);return Y("div",null,$)}function r(p){location.href=i(p)}function i(p){return`/avif2jpeg/old/${p}/`}return(p,z)=>{const k=Oa;return M(),G(k,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:e(o),"render-label":s,"onUpdate:value":r},{header:t(()=>[h("span",No,u(p.$t("previousVersion")),1)]),default:t(()=>[h("span",{style:{cursor:"pointer"}},"v"+u(f))]),_:1},8,["options"])}}}),Ro=be({__name:"header",setup(a){return(l,f)=>{const o=Le,s=kt;return M(),G(o,{vertical:"",justify:"start"},{default:t(()=>[n(o,{justify:"space-between",style:{"box-sizing":"border-box",padding:"4px",margin:"0px"}},{default:t(()=>[n(o,{align:"start"},{default:t(()=>[n(Co),n(Do),n(o,{align:"center"},{default:t(()=>[n(Fo)]),_:1})]),_:1}),n(o,{align:"end",style:{"font-size":"x-small"}},{default:t(()=>[Ua(l.$slots,"lang-switch")]),_:3})]),_:3}),n(s,{style:{margin:"0px"}})]),_:3})}}}),jo={style:{padding:"0px",margin:"0px","text-align":"center"}},Zo={key:0},Bo=be({__name:"title",setup(a){const l=Gt(),f=we(()=>{const o=l.currentRoute.value.path||"";return!String(o.match(new RegExp("(?<=^\\/)[^/]+"))||"")});return(o,s)=>{const r=qt,i=Pa("router-link"),p=Le;return M(),G(p,{align:"center",justify:"center",style:{margin:"0px"}},{default:t(()=>[h("h1",jo,[e(f)?(M(),le("span",Zo,u(o.$t("title")),1)):(M(),G(i,{key:1,to:"../",custom:""},{default:t(({navigate:z,href:k})=>[n(r,{href:k,onClick:z,style:{color:"black","word-break":"keep-all","overflow-wrap":"break-word"}},{default:t(()=>[S(u(o.$t("title")),1)]),_:2},1032,["href","onClick"])]),_:1}))])]),_:1})}}}),Ho="/avif2jpeg/dist/outofmemory.png";function Wo(a){return new Worker("/avif2jpeg/dist/assets/worker.canvas-DtC2Nijb.js",{name:a==null?void 0:a.name})}let pn=0;class Vo extends Wo{constructor(){super(...arguments);je(this,"id",pn++)}release(){pt(this)}}const wt=[],Ve=new Set,nt=new Map,at=new Map,ct=new Set;function qo(a,l){const f=new Vo;wt.push(f);{const o=Promise.resolve(f);Ve.add(o),nt.set(f,o)}return f}function Go(a){const l=new Promise(f=>{at.set(a,f)});Ve.add(l),nt.set(a,l),ct.add(a)}async function Ko(){let a,l;do a=await Promise.any(Ve);while(ct.has(a));return l=nt.get(a),nt.delete(a),Ve.delete(l),Go(a),a}function pt(a){const l=at.get(a);l&&(at.delete(a),ct.delete(a),l(a))}function fn(){for(const a of at.keys())pt(a)}async function Ut(){return await Promise.all(Ve)}function Pt(){fn();for(const a of wt)a.terminate();wt.length=0,Ve.clear(),nt.clear(),at.clear(),ct.clear(),pn=0}function Qo(a){return new Worker("/avif2jpeg/dist/assets/worker.zip-D4CHLUmx.js",{name:a==null?void 0:a.name})}const Yo=1e3*10,Jo=1,Xo=10,el=1024*1024*4,tl=100;async function nl(a,l,f,o,s,r,i,p,z,k,A,c){const $=new Map,y=new Map,g=Math.min(f.threads-1,i.length);Pt();const m=new Qo,E=al(m,a,l,p,$);if(m.postMessage({action:"set-config",zipSize:f.maxZipSizeMB*1024*1024,keepExt:f.retainExtension,outputExt:A,imageType:c}),!await new Promise(R=>{const J=se=>{m.removeEventListener("message",R),clearTimeout(te),R(se)},j=()=>J(!0);let te=0;m.addEventListener("message",j),te=window.setTimeout(()=>J(!1),Yo)}))return{exception:new Error("worker-load-error"),callbackToClearConverter:()=>{},callbackToGenerateFailedZips:()=>{}};const x=ol(a,l,o,s,r,i,p,y,$);for(let R=0;R<g;R++){const J=qo();J.onmessage=x;const{port1:j,port2:te}=new MessageChannel;m.postMessage({action:"set-port"},[j]),J.postMessage({},[te])}const O=ke(l,R=>{R&&(O(),fn())});a.demandImage=R=>{m.postMessage({action:"request-image",index:R})};const b=i.length===1;let v=0,L=0,ee="",V=0;for(;V<i.length;){const R=await Ko();if(l.value){pt(R);break}const J=[];let j=!1;const te=i.length-V,se=Math.min(V+Math.max(Math.min(Xo,te/f.threads|0),1),i.length);let ve=0,oe=!1;const C=Date.now();for(C-L>tl&&(L=C,oe=!0);V<se&&!(ve>el);V++){const w=i[V],N=w._id;ve+=w.size,j=V===i.length-1,$.has(N)||$.set(N,w),J.push({index:V,file:w,fileId:N,outputPath:ee,type:z,quality:k/100,demandThumbnail:oe||j,isSingleImage:b,maxSize:H.shrinkImage?{width:H.maxWidth,height:H.maxHeight}:null,webkitRelativePath:w.webkitRelativePath}),w.webkitRelativePath||w.name,y.has(w)||(v++,a.index=v),oe=!1}if(R.postMessage(J),j&&(await Ut(),l.value))break}if(await Ut(),!l.value){let R;await new Promise(J=>{R=ke([()=>a.done,l],()=>{(a.done>=v||l.value)&&J(void 0)},{immediate:!0})}),R()}m.postMessage({action:"squeeze"}),await E,O();const ce={value:!1},U=()=>{ce.value=!0,Pt(),m.terminate()};let B=!1;return{callbackToClearConverter:U,callbackToGenerateFailedZips:async R=>{B||(B=!0,await ll(R,m,ce,a))}}}function al(a,l,f,o,s){return new Promise(i=>{a.onmessage=p=>{const z=p.data,{action:k}=z;if(k==="add-zip-completed"){const{fileId:y}=z;l.done++,l.success++,o.add(y);return}if(k==="respond-image"){const{url:y,index:g,path:m,size:E,fileId:T}=z;l.convertedImageUrl=y,l.convertedImageSize=E,l.convertedImageIndex=g,l.convertedImageName=m,l.convertedImageFileId=T;let x="",O=0,F="";if(T>=0){const b=s.get(T);x=URL.createObjectURL(b),O=b.size,F=b.name}l.convertedImageOrgUrl=x,l.convertedImageOrgSize=O,l.convertedImageOrgName=F;return}const{size:A,count:c}=z,$="url"in p.data?p.data.url:"";switch(k){case"push-zip":l.zips.push({url:$,size:A,count:c}),l.zippedTotalCount+=c,l.zippedTotalSize+=A;break;case"squeeze-zip":c>0&&(l.zips.push({url:$,size:A,count:c}),l.zippedTotalCount+=c,l.zippedTotalSize+=A),i(void 0);break;case"push-filelist":l.failedFileZippedCount++;break;case"squeeze-filelist-zip":l.failedZipDone=!0;case"push-filelist-zip":l.failedZips.push({url:$,size:A,count:c});break;case"zip-error":case"zip-squeeze-error":l.zippingErrorCount+=c,k==="zip-squeeze-error"&&i(void 0);break}}})}function ol(a,l,f,o,s,r,i,p,z,k,A,c){let $=0;const y=_(new Map),g=_(new Map);return E=>{const T=E.target,{data:x}=E,{action:O}=x;if(l.value)switch(O){case"file-canceled":a.done++;return}switch(O){case"list-start":break;case"file-start":{const{index:F,path:b,fileId:v}=x,L={key:$++,core:T.id,index:F,path:b,command:"➡️started"};y.value.set(T.id,L),a.logs.push(L);break}case"file-load":{const{thumbnail:F,width:b,height:v}=x;y.value.get(T.id).command="🖼️loaded",F&&(a.thumbnail=F);break}case"file-converted":{const{index:F,path:b,fileId:v}=x,L=y.value.get(T.id);L.command="🔃converted",g.value.set(v,L),a.converted++;break}case"file-completed":{const{inputsize:F,outputsize:b,fileId:v}=x;a.inputTotalSize+=F,a.outputTotalSize+=b;const L=g.value.get(v);L&&(L.command="✅completed",L.completed=!0);break}case"file-error":{const{index:F,path:b,fileId:v}=x,L=z.get(v);if(!L)throw new Error(`the file doesn't exist in the Map. "${v}":"${b}"`);const ee=p.get(L)||0,V=y.value.get(T.id);ee<Jo?(p.set(L,ee+1),r.push(L),V.command="⚠️retrying",V.error=!0,o.warning(`retrying "${b}"`,{duration:3e3})):(a.done++,a.failure++,V.command="❗failed",V.error=!0,s.error({content:`failed to load "${b}"`,duration:5e3}));break}case"file-canceled":{const{fileId:F,path:b}=x,v=g.value.get(F);a.done++,a.failure++,v.command="❗zip-aborted",v.error=!0;break}case"list-end":{pt(T);break}}}}async function ll(a,l,f,o){let s=0;for(const r of a){const i=(r.webkitRelativePath||r.name).replace(/^\//,"");if(f.value)return;s-o.failedFileZippedCount>20&&await new Promise(p=>setTimeout(p,10)),l.postMessage({action:"add-filelist",file:r,path:i}),s++}l.postMessage({action:"squeeze-filelist"})}function Ue(a,l=2){const f=Math.sign(a);a=Math.abs(a);const o=["Bytes","KB","MB","GB"],s=a?Math.floor(Math.log(a)/Math.log(1024)):0;return`${(a/Math.pow(1024,s)*f).toFixed(l)}${o[s]}`}function gn(a,l=100,f=!1){l=typeof l=="number"?{width:l,height:l}:l;const{width:o,height:s}=l;let{width:r,height:i}=a;const p=r/i,z=o/s;return p>=z?(r=f?Math.min(o,r):o,i=r/p|0):(i=f?Math.min(s,i):s,r=i*p|0),{width:r,height:i}}class il{constructor(){je(this,"_currentFileCount",0);je(this,"_totalFileCount",0);je(this,"_zipLengthSumList",[]);je(this,"_pathBank",{})}increase(l){l&&(this._pathBank[l]=[this._zipLengthSumList.length,this._currentFileCount]),this._currentFileCount++,this._totalFileCount++}split(){this._zipLengthSumList.push(this._totalFileCount),this._currentFileCount=0}get(l){if(typeof l=="number"){let f=this._zipLengthSumList.findIndex((r,i)=>l<r);f===-1&&(f=this._zipLengthSumList.length);const o=this._zipLengthSumList[f-1]||0,s=l-o;return[f,s]}else{const f=this._pathBank[String(l)];if(f)return f}return null}}async function sl(a,l,f,o,s,r){let i="";const p=document.createElement("canvas"),z=p.getContext("2d");let k=new _t;const A=[k],c=new il,$=o.format,y=o.quality/100,g=[...$.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),m=a.length,E=o.maxZipSizeMB*1024*1024;let T=0,x=null,O="",F="",b=0,v=0,L=0,ee=0,V=0,ce=!1;const U=[];r.demandImage=j=>{const[te,se]=c.get(j),ve=A[te];r.convertedImageIndex=j,r.convertedImageName=ve.getPathByIndex(se),r.convertedImageUrl=URL.createObjectURL(new Blob([ve.get(se)],{type:$}));let oe="",C=0,w="";const N=U[j];oe=URL.createObjectURL(N),C=N.size,w=N.name,r.convertedImageOrgUrl=oe,r.convertedImageOrgSize=C,r.convertedImageOrgName=w};for(const j of a){if(s.value)break;const te=j.name;let se="";const ve=j.size,oe=(j.webkitRelativePath||j.relativePath||te).replace(/^\//,""),C=document.createElement("img");T++;const w={key:L++,core:-1,index:T,path:oe,command:"➡️start"};r.index=T,r.logs.push(w),r.logs.length-1;let N;i&&(URL.revokeObjectURL(i),i=""),i=URL.createObjectURL(j),F=i,b=j.size,C.src=i;const I=await mn(C).then(()=>!0).catch(()=>!1);if(!C.complete||!I||s.value){r.done++,r.failure++,w.command="❗failed";continue}const P=C.width,D=C.height;if(p.width=P,p.height=D,z.drawImage(C,0,0,P,D,0,0,P,D),w.command="🖼️imgload",r.thumbnail=C,N=await new Promise(Q=>{const he=pe=>{x=pe,Q(pe==null?void 0:pe.arrayBuffer())};p.toBlob(he,$,y)}),s.value)break;if(!N){r.failure++;continue}v=N.byteLength,r.converted++;let X="";if(V+v>=E){try{X=k.url()}catch{ce=!0,alert("memory problem occurred");break}r.zips.push({url:X,size:V,count:ee}),r.zippedTotalCount+=ee,r.zippedTotalSize+=V,V=0,ee=0,c.split(),A.push(k),k=new _t}V+=v;const ie=oe||te;for(let Q=1;Q<255&&(se=ie.replace(o.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(Q>1?`(${Q})`:"")+"."+g,!!k.has(se));Q++);r.done++;try{ee++,k.add(se,N),c.increase(),U.push(j),r.inputTotalSize+=ve,r.outputTotalSize+=v}catch{continue}O=se,r.success++,w.command="✅completed",w.completed=!0,l.add(j._id)}if(r.success>0)if(m===1)x&&(r.convertedImageIndex=0,r.convertedImageName=O.replace(/^.*\/(?=[^/]+$)/,"").replace(o.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+g,r.convertedImageUrl=URL.createObjectURL(x),r.convertedImageOrgUrl=F,r.convertedImageOrgSize=b);else try{if(ce)throw new Error("terminated zipping process for memory problems");const j=k.url();r.zips.push({url:j,count:ee,size:V}),r.zippedTotalCount+=ee,r.zippedTotalSize+=V}catch{}const B={value:!1},q=()=>{B.value=!0,A.forEach(j=>j.clear()),A.length=0,U.length=0};let R=!1;return{callbackToClearConverter:q,callbackToGenerateFailedZips:async j=>{R||(R=!0,rl(j,E,r,B))}}}async function rl(a,l,f,o){let s=0,r=0,i=new _t;for(let p=0;p<a.length;p++){const z=a[p],k=(z.webkitRelativePath||z.name).replace(/^\//,"");if(o.value)return;if(await i.add(k,z),r+=z.size,s++,f.failedFileZippedCount++,r>=l||p===a.length-1){await i.zip();const A=i.url();f.failedZips.push({url:A,size:r,count:s}),i.clear(),r=0,s=0}}f.failedZipDone=!0}function mn(a){if(typeof a.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((l,f)=>{a.onload=l,a.onerror=f})}const Me=(a,l)=>{const f=a.__vccOpts||a;for(const[o,s]of l)f[o]=s;return f},ul=a=>(At("data-v-5dab19ad"),a=a(),zt(),a),dl={class:"container"},cl=ul(()=>h("span",{class:"text"},"ZIP",-1)),pl={__name:"zipicon",setup(a){return(l,f)=>(M(),le("span",dl,[n(e(ye),null,{default:t(()=>[n(e(yt))]),_:1}),cl]))}},fl=Me(pl,[["__scopeId","data-v-5dab19ad"]]),gl=["href","download","title"],ml=be({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean}},emits:["load","error","next","prev"],setup(a,{expose:l,emit:f}){Fe();const o=a,s=f;l({download:m,openPreview:E});const r=_(),i=_(!0),p=_(""),z=_(100),k=_(100),A=_(!1),c=ut({width:"100px",height:"100px",minWidth:"50px",minHeight:"50px"});ke(o,(T,x)=>{c.width=(o.width||100)+"px",c.height=(o.height||100)+"px"}),ke(()=>o.src,()=>{g(o.src)},{immediate:!0});async function $(T){const x=T.target,O=x.naturalWidth,F=x.naturalHeight,{width:b,height:v}=gn({width:O,height:F},{width:o.maxWidth||100,height:o.maxHeight||100},o.expand);z.value=b,k.value=v,s("load",{src:x.src,width:O,height:F}),i.value=!1,await new Promise(L=>setTimeout(L,100)),!i.value&&(A.value=!0)}function y(T){const x=T.target;s("error",x.src)}async function g(T){i.value=!0,A.value=!1,await new Promise(x=>setTimeout(x,150)),p.value=T}function m(){const T=document.createElement("a");T.href=p.value,T.download=o.fileName,T.click()}function E(){var T,x,O,F;try{(x=(T=r.value)==null?void 0:T.previewInstRef)==null||x.setPreviewSrc(o.src),(F=(O=r.value)==null?void 0:O.previewInstRef)==null||F.toggleShow(!0)}catch{}}return(T,x)=>{const O=Yt,F=Ge,b=We;return M(),G(e(ze),null,{trigger:t(()=>[n(b,{show:e(i)||o.loading},{default:t(()=>[n(F,{justify:"center",align:"center",style:re(e(c))},{default:t(()=>[h("a",{href:e(p),onClick:x[0]||(x[0]=Be(()=>{},["left","prevent"])),target:"_blank",download:o.fileName,title:o.fileName,style:{"line-height":"0px"}},[n(Ze,{mode:"in-out"},{default:t(()=>[Kt(n(O,{ref_key:"nImageRef",ref:r,"show-toolbar-tooltip":"","_:render-toolbar":"renderToolbar",onLoad:$,onError:y,src:e(p),width:e(z),height:e(k),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[Qt,e(A)]])]),_:1})],8,gl)]),_:1},8,["style"])]),_:1},8,["show"])]),default:t(()=>[S(" "+u(o.fileName),1)]),_:1})}}}),Nt=Me(ml,[["__scopeId","data-v-fc8adbf9"]]),vl={style:{"font-weight":"bold",color:"gray"}},hl={style:{"font-weight":"bold",color:"gray"}},_l=["href","download"],yl=["href"],wl={style:{"font-size":"0.8em"}},bl=be({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean}},emits:["demand-image"],setup(a,{expose:l,emit:f}){const o=a,s=f;l({download:R});const r=_(),i=_(),p=_(),z=dt(),{t:k}=Fe();Jt();const A=_(!0),c=_(1),$=_(1),y=_(1);_(0);const g=_(""),m=_(1),E=_(1),T=_(!1),x=_(!1),O=_(!1),F=we(()=>{var C,w;return((w=(C=p==null?void 0:p.value)==null?void 0:C.previewInstRef)==null?void 0:w.previewSrc)===g.value}),b=we(()=>c.value<o.length),v=we(()=>c.value>1);let L=-1;ke(c,()=>{c.value<1||c.value>o.length||(clearTimeout(L),L=setTimeout(()=>{o.index!==c.value-1&&(s("demand-image",c.value-1),T.value=!0,x.value=!1,O.value=!1)},100))}),ke(()=>o.index,()=>{var w,N;let C="";if(o.index===0&&A.value?(A.value=!1,c.value=1,C=o.url):o.index===c.value-1&&(T.value=!1,C=o.url),C){try{(N=(w=p.value)==null?void 0:w.previewInstRef)!=null&&N.displayed&&(F.value?p.value.previewInstRef.setPreviewSrc(C):p.value.previewInstRef.setPreviewSrc(o.originalUrl))}catch{}g.value=C}},{immediate:!0});let ee="",V="";ke(()=>o.url,()=>{if(o.url!==ee){const C=ee,w=V;setTimeout(()=>{URL.revokeObjectURL(C),URL.revokeObjectURL(w)},1e3),ee=o.url,V=o.originalUrl}o.isSingle&&(A.value=!1,g.value=o.url)}),$e(()=>{o.isSingle,s("demand-image",0),document.body.addEventListener("keydown",U),document.body.addEventListener("keydown",ce)}),Xt(()=>{document.body.removeEventListener("keydown",U),document.body.removeEventListener("keydown",ce)});function ce(C){var w,N,I,P;if(C.key==="Escape")try{(N=(w=p.value)==null?void 0:w.previewInstRef)!=null&&N.displayed&&(C.stopPropagation(),(P=(I=p.value)==null?void 0:I.previewInstRef)==null||P.toggleShow(!1))}catch{}}function U(C){var w,N;switch(C.key){case"ArrowRight":case"PageDown":j(1);break;case"ArrowLeft":case"PageUp":j(-1);break;case"ArrowUp":case"Home":c.value=1;break;case"ArrowDown":case"End":c.value=o.length;break;case" ":case"Enter":se();break;default:return}C.stopPropagation(),(N=(w=p.value)==null?void 0:w.previewInstRef)!=null&&N.displayed&&C.preventDefault()}function B({width:C,height:w}){$.value=C,y.value=w,x.value=!0}function q({width:C,height:w}){m.value=C,E.value=w,O.value=!0}function R(){F.value?r.value.download():i.value.download()}async function J(C){try{const w=await fetch(C).then(N=>N.blob()).then(N=>new Promise(I=>{const P=new FileReader;P.onload=I,P.readAsDataURL(N)})).then(N=>N.target.result);navigator.clipboard.writeText(w),z.info({title:k("copiedDataURLDialogTitle"),content:()=>Y("div",[Y("div",k("copiedDataURLMessage"))]),positiveText:"OK"})}catch{z.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function j(C){C>0&&c.value<o.length&&c.value++,C<0&&c.value>1&&c.value--}let te="";const se=()=>{var w,N,I,P,D,X;te=(I=window.getComputedStyle((N=(w=p==null?void 0:p.value)==null?void 0:w.previewInstRef)==null?void 0:N.previewRef))==null?void 0:I.transform;const C=F.value;(X=(D=(P=p==null?void 0:p.value)==null?void 0:P.previewInstRef)==null?void 0:D.handleSwitchNext)==null||X.call(D),Xe(()=>{var ie,Q,he;F.value===C&&((he=(Q=(ie=p==null?void 0:p.value)==null?void 0:ie.previewInstRef)==null?void 0:Q.handleSwitchNext)==null||he.call(Q))})};function ve(){try{Xe(()=>p.value.previewInstRef.previewRef.style.transform=te)}catch{}}function oe({nodes:C}){const w=Y(Tt,{color:F.value?"green":"gray",offset:[-20,-12],value:(F.value?k("status.Converted"):k("status.Original"))+" "+c.value},()=>Y(xe,{round:!0,onClick(){se()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>Y(F.value?Na:Da)}));C.next=Y(xe,{onClick(){j(1)},disabled:!b.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>Y(mt)}),C.prev=Y(xe,{onClick(){j(-1)},disabled:!v.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>Y(Ot)});try{const N=C.download.children;N.default=()=>k("save");const I=N.trigger();I.props.onClick=R,N.trigger=()=>I}catch{}return[w,...Object.values(C)]}return(C,w)=>{const N=Le,I=Ge,P=ye,D=ot,X=Ra,ie=en,Q=It,he=We;return M(),G(he,{size:"large",show:A.value},{default:t(()=>[n(I,{justify:"center",align:"center",vertical:"",style:re({visibility:A.value?"hidden":"visible"})},{default:t(()=>[n(I,{align:"center",wrap:!1},{default:t(()=>[n(X,{ref_key:"nImageGroupRef",ref:p,"show-toolbar-tooltip":"","render-toolbar":oe,onPreviewNext:ve},{default:t(()=>[n(I,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(I,{align:"center",justify:"center",vertical:""},{default:t(()=>[n(I,{align:"center",justify:"center",wrap:!1,style:{"font-size":"smaller"},class:"original-thumb"},{default:t(()=>[n(Nt,{ref_key:"thumbOrgRef",ref:i,src:C.originalUrl,width:100,"max-width":100,"max-height":80,loading:T.value,"file-name":C.originalName,"allow-next":c.value<o.length,"allow-prev":c.value>1,onLoad:q,onNext:w[0]||(w[0]=pe=>j(1)),onPrev:w[1]||(w[1]=pe=>j(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(N,{vertical:"",align:"center"},{default:t(()=>[h("span",vl,u(e(k)("status.Original")),1),n(N,{justify:"center",style:{"white-space":"nowrap","font-family":"v-mono"}},{default:t(()=>[S(u(String(m.value).padStart(4," "))+" × "+u(String(E.value).padStart(4," ")),1)]),_:1}),n(N,{justify:"center"},{default:t(()=>[S(u(e(Ue)(o.originalSize,0)),1)]),_:1})]),_:1})]),_:1})]),_:1}),n(I,{style:{margin:"1em"},class:"original-thumb"},{default:t(()=>[n(P,{size:"48",color:"silver"},{default:t(()=>[n(e(mt))]),_:1})]),_:1}),n(I,{vertical:"",align:"center",justify:"center"},{default:t(()=>[n(I,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(Nt,{ref_key:"thumbConvRef",ref:r,src:g.value,width:140,"max-width":140,"max-height":100,loading:T.value,"file-name":o.name,"allow-next":c.value<o.length,"allow-prev":c.value>1,onLoad:B,onNext:w[2]||(w[2]=pe=>j(1)),onPrev:w[3]||(w[3]=pe=>j(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(I,{vertical:"",align:"center"},{default:t(()=>[h("span",hl,u(e(k)("status.Converted")),1),n(I,{justify:"center",wrap:!0},{default:t(()=>[o.url?(M(),G(D,{key:0,"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:o.url,ref:"saveImg",target:"_blank",download:o.name},[n(e(xe),{round:"",size:"tiny"},{default:t(()=>[S(u(C.$t("save")),1)]),_:1})],8,_l)]),default:t(()=>[S(" "+u(C.$t("save")),1)]),_:1})):de("",!0),o.url?(M(),G(D,{key:1,"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:o.url,target:"_self"},[n(e(xe),{onClick:w[4]||(w[4]=Be(pe=>J(o.url),["left","prevent","stop"])),round:"",size:"tiny"},{default:t(()=>[S("DataURL")]),_:1})],8,yl)]),default:t(()=>[S(" "+u(C.$t("convertedImageDataUrlTooltip")),1)]),_:1})):de("",!0)]),_:1}),n(I,{justify:"center",style:{"white-space":"nowrap","font-family":"v-mono"}},{default:t(()=>[S(u(String($.value).padStart(4," "))+" × "+u(String(y.value).padStart(4," ")),1)]),_:1}),n(I,{justify:"center"},{default:t(()=>[S(u(e(Ue)(o.size,0)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),n(I,{ref:"fileNameContainer",justify:"center",style:{"max-width":"320px"},title:o.name},{default:t(()=>[n(ie,{"x-scrollable":!0,trigger:"hover",style:{"font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:t(()=>[S(u(o.name),1)]),_:1})]),_:1},8,["title"]),C.isSingle?de("",!0):(M(),G(I,{key:0,style:{"font-family":"v-mono"},align:"center"},{default:t(()=>[h("span",wl,u(e(k)("status.index"))+":",1),S(" "+u(c.value)+" / "+u(o.length),1)]),_:1})),C.isSingle?de("",!0):(M(),G(I,{key:1,align:"center",justify:"center"},{default:t(()=>[n(e(xe),{onClick:w[5]||(w[5]=pe=>j(-1)),disabled:!e(v),circle:!0,size:"small"},{icon:t(()=>[n(P,null,{default:t(()=>[n(e(Ot))]),_:1})]),_:1},8,["disabled"]),n(Q,{value:c.value,"onUpdate:value":w[6]||(w[6]=pe=>c.value=pe),tooltip:!1,step:1,min:1,max:o.length,style:{width:"180px"}},null,8,["value","max"]),n(e(xe),{onClick:w[7]||(w[7]=pe=>j(1)),disabled:!e(b),circle:!0,size:"small"},{icon:t(()=>[n(P,null,{default:t(()=>[n(e(mt))]),_:1})]),_:1},8,["disabled"])]),_:1}))]),_:1},8,["style"])]),_:1},8,["show"])}}}),xl=Me(bl,[["__scopeId","data-v-d568baaa"]]),kl={class:"log-table"},Al={class:"log-tr"},zl={class:"log-th"},Tl={class:"log-th"},Il={style:{"min-width":"7em"},class:"log-th"},Sl={style:{"padding-left":"2em"},class:"log-th"},Ll={class:"log-td"},Cl={class:"log-td"},$l={class:"log-td"},El={class:"log-td"},Fl={style:{margin:"1px"}},Ml=["href","download","onClick"],Ol={key:0,style:{position:"relative"}},Ul=["href","download"],Pl=["href","download"],Nl={key:0,style:{margin:"1px"}},Dl=["href","download","onClick"],Dt=99999,Rl=100,jl=be({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image"],setup(a,{emit:l}){const f=dt(),{t:o}=Fe(),s=Jt(),r={W:160,H:80},i=a,p=l,z=_(!1),k=_([]),A=_(!1),c=_([]),$=_([]),y=_([0,0]),g=_([0,0]),m=_([0,0]),E=_([0,0]),T=_([0,0]),x=_([0,0]),O=_(0),F=_([0,0]),b=_(s.value.infoColor),v=_("#000000"),L=_("#000000"),ee=_(0),V=_(0),ce=_(""),U=_("00:00:00");_(""),_("");const B=_(void 0),q=_(!1),R=_(!0),J=_(!1),j=we(()=>q.value?ve.value:se.value),te=_("16em"),se=_(5),ve=_(1e3),oe=_(!0),C=_(!1),w=ut({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:-1}),N=_(null),I=_(null),P=_(),D=_();$e(()=>{ke(i.status,()=>he(),{deep:!1}),ke([I,oe],()=>{if(!I.value||!oe.value)return;const{width:_e,height:Ae}=gn(I.value,{width:r.W,height:r.H});N.value.width=_e,N.value.height=Ae,N.value.style.width=_e+"px",N.value.style.height=Ae+"px",I.value instanceof HTMLImageElement?N.value.getContext("2d").drawImage(I.value,0,0,_e,Ae):(N.value.getContext("bitmaprenderer").transferFromImageBitmap(I.value),I.value=null,i.status.thumbnail=null)});let d=0;const W=()=>{if(d)return;const _e=Date.now();U.value="00:00:00",d=window.setInterval(()=>{const Ae=(Date.now()-_e)/1e3;U.value=`${String(Ae/3600|0).padStart(2,"0")}:${String(Ae/60%60|0).padStart(2,"0")}:${String(Ae%60|0).padStart(2,"0")}`},300)};W(),ke(()=>i.processing,(_e,Ae)=>{_e?(W(),k.value=[],z.value=!1,A.value=!1,c.value=[],$.value=[]):(clearInterval(d),he(),d=0),oe.value=!1,C.value=!0,i.processing||pe()});const ne=Ba();let K;const ae=()=>{clearTimeout(K),K=setTimeout(()=>{if(!oe.value||ue)return;const _e=P.value.$parent.$el.offsetHeight,Ae=window.innerHeight-ne.parent.parent.vnode.el.offsetHeight-8;te.value=Math.max(_e+Ae,50)+"px"},100)};ae(),window.addEventListener("resize",ae);const fe=new ResizeObserver(ae);fe.observe(ne.parent.parent.vnode.el);let ue=!1;ja(()=>{ue=!0,fe.disconnect(),clearInterval(d),clearTimeout(K),clearTimeout(Q),clearTimeout(Ke),window.removeEventListener("resize",ae)})}),ke([()=>i.status.zips.length,()=>i.status.failedZips.length],()=>{const d=i.status;{c.value.length>d.zips.length&&(c.value.length=0);let W=0;const ne=d.zips.length===1&&d.zippedTotalCount===d.length;for(let K=c.value.length;K<d.zips.length;K++){const ae=d.zips[K],fe=d.baseZipName+(ne?"":"-"+String(K+1).padStart(2,"0"))+".zip";W+=ae.size,c.value[K]={url:ae.url,size:ae.size,number:ne?0:K+1,sizeByUnit:Ue(ae.size),name:fe,count:ae.count,clicked:!1}}}{$.value.length>d.failedZips.length&&($.value.length=0);let W=0;const ne=d.failedZipDone&&d.failedZips.length===1;for(let K=$.value.length;K<d.failedZips.length;K++){const ae=d.failedZips[K],fe=d.baseZipName+"-error"+(ne?"":"-"+String(K+1).padStart(2,"0"))+".zip";W+=ae.size,$.value[K]={url:ae.url,size:ae.size,number:ne?0:K+1,sizeByUnit:Ue(ae.size),name:fe,count:ae.count,clicked:!1}}}});const X=i.interval||100;let ie=!1,Q=0;function he(){if(ie)return;if(Q){ie=!0;return}Q=window.setTimeout(()=>{Q=0,ie&&(ie=!1,he())},X);const d=i.status;z.value=d.length>=2,g.value[1]=g.value[0],g.value[0]=d.index,m.value[1]=m.value[0],m.value[0]=d.success,E.value[1]=E.value[0],E.value[0]=d.failure,T.value[1]=T.value[0],T.value[0]=d.done,x.value[1]=x.value[0],x.value[0]=d.converted,O.value=d.length,F.value[1]=F.value[0],F.value[0]=d.zippedTotalCount,ee.value=d.inputTotalSize,V.value=d.outputTotalSize;const W=V.value-ee.value;ce.value=(W>=0?"+ ":"")+Ue(W);const ne=V.value/ee.value,K=(256|Math.min(255,Math.max(0,ne-1.5)*255|0)).toString(16).substring(1);v.value="#"+K+"0000";const ae=1024*1024,fe=(256|Math.min(255,Math.max(0,W/1024/ae)*255|0)).toString(16).substring(1);if(L.value="#"+fe+"0000",y.value[1]=y.value[0],y.value[0]=m.value[0]/O.value*100,oe.value||!i.processing){const ue=d.logs.slice(-Dt);k.value.push(...ue);const _e=k.value.length-Dt;_e>0&&k.value.splice(0,_e),R.value&&ue.length&&lt(),k.value.length>ve.value&&(ve.value*=2)}d.logs.length=0,I.value=d.thumbnail,i.processing&&(b.value=E.value[0]?s.value.warningColor:s.value.infoColor),d.convertedImageUrl!==w.url&&(w.url=d.convertedImageUrl,w.name=d.convertedImageName,w.dataUrl=d.convertedImageDataUrl,w.size=d.convertedImageSize||d.outputTotalSize,w.originalSize=d.convertedImageOrgSize,w.originalName=d.convertedImageOrgName,w.index=d.convertedImageIndex,w.originalUrl=d.convertedImageOrgUrl)}function pe(){const d=i.status;b.value=i.status.success===i.status.length?s.value.successColor:s.value.errorColor,d.unconvertedFileCount>0,E.value[0]>0||(m.value[0],O.value)}const Ne=we(()=>[{key:"open",label:o("status.openFailedList"),icon:()=>Y(ye,()=>Y(tn)),onSelect(){De()}},{key:"download",label:o("status.saveFailedList"),icon:()=>Y(ye,()=>Y(Za)),onSelect(){De(!0)}},{key:"zip",label:`${o("status.zipFailedList")}`+(i.status.failedZipDone?`(✔${o("status.done")})`:""),icon:()=>Y(We,{show:A.value&&!i.status.failedZipDone,size:"small"},()=>Y(ye,()=>Y(yt))),disabled:A.value,onSelect(d){return A.value=!0,p("demand-zip-errors"),!1}}]);function ge(d,W=!1){const{url:ne,name:K}=d;if(W){const ae=document.createElement("a");ae.href=ne,ae.download=K,ae.click()}d.clicked||(d.clicked=!0,i.processing||c.value.every(ae=>ae.clicked)&&p("all-zips-clicked"))}async function Oe(){if(z.value){if(c.value.length>=2&&!await new Promise((ne,K)=>f.warning({title:o("Download"),content:o("status.confirmDownloadMessage",[c.value.length]),positiveText:"OK",negativeText:o("cancel"),onPositiveClick:()=>ne(!0),onNegativeClick:()=>K()})))return;const d=c.value;for(const W of d)ge(W,!0)}else D.value.download()}function De(d=!1){const W=new Blob([i.status.unconvertedListText],{type:"text/plain;charset=utf8"}),ne=URL.createObjectURL(W),K=document.createElement("a");K.href=ne,K.target="_blank",d&&(K.download=i.status.baseZipName+"-error.txt"),K.click()}let Ke=0,Ie=!1;function lt(d=!1){if(!Ie){if(Ke){Ie=!0;return}Xe(()=>{!d&&(!q.value||!R.value)||(P.value.scrollTo({behavior:d?"instant":"smooth",top:k.value.length*50}),Ke=window.setTimeout(()=>{Ke=0,Ie&&(Ie=!1,lt())},Rl))})}}return(d,W)=>{const ne=Le,K=Ha,ae=Wa,fe=ot,ue=Ge,_e=Va,Ae=an,ft=ze,Ta=on,Ia=St,Sa=Lt,La=kt,Qe=xe,Ca=fl,Ft=Tt,$a=qa;return M(),G(ue,{vertical:"",justify:"center"},{default:t(()=>[n(ne,{justify:"center",align:"center",wrap:!1,style:{"white-space":"nowrap"}},{default:t(()=>[n(ne,{vertical:"",justify:"center",class:"left-column"},{default:t(()=>[n(K,{"tabular-nums":"",label:d.$t("status.elapsedTime")},{default:t(()=>[n(ne,null,{default:t(()=>[S(u(e(U)),1)]),_:1})]),_:1},8,["label"]),n(K,{"tabular-nums":"",label:d.$t("status.multiThreading")},{default:t(()=>[n(ne,{style:re({color:i.status.threads?"":"red"})},{default:t(()=>[S(u(i.status.threads?d.$rt("{n} @:threads",i.status.threads):d.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(K,{"tabular-nums":"",label:d.$t("status.outputSettings")},{default:t(()=>[n(ne,{vertical:"",justify:"end",style:{"font-size":"smaller","line-height":"1em"}},{default:t(()=>[h("div",null,"Type: "+u(i.status.type),1),h("div",null,"Zip: "+u(i.status.zipSize)+"MB",1)]),_:1})]),_:1},8,["label"])]),_:1}),n(_e,{type:"multiple-circle","stroke-width":1,percentage:[e(m)[0]/e(O)*100|0,e(g)[0]/e(O)*100|0],color:[e(s).successColor,e(b)],"rail-style":[{stroke:d.processing?e(s).successColor:e(b),opacity:.3},{stroke:e(b),opacity:.3}],class:"center-column"},{default:t(()=>[n(ne,{vertical:"",align:"center",style:{"font-family":"v-mono","font-size":"xx-large","white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:t(()=>[h("span",{style:re({color:e(E)[0]?e(b):d.processing?e(s).successColor:e(b)})},[n(ae,{duration:e(X)*3|0,from:e(y)[1]|0,to:e(y)[0]|0,active:!0},null,8,["duration","from","to"]),S("% ")],4),n(ue,{wrap:!1,style:{border:"0px solid"}},{default:t(()=>[n(ue,{vertical:"",size:"small",justify:"end"},{default:t(()=>[n(ue,{justify:"end",wrap:!1},{default:t(()=>[e(E)[0]>0?(M(),G(fe,{key:0,trigger:"hover",duration:0,delay:0,style:re({color:e(s).errorColor}),placement:"left"},{trigger:t(()=>[h("span",{style:re({fontSize:"xx-small",color:e(s).errorColor,lineHeight:"0"})}," ("+u(e(E)[0].toLocaleString("en-us"))+") ",5)]),default:t(()=>[S(" "+u(d.$t("status.progressErrors"))+" ("+u(e(E)[0].toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):de("",!0),n(fe,{trigger:"hover",duration:0,delay:0,style:re({color:e(s).infoColor}),placement:"left"},{trigger:t(()=>[h("span",{style:re({fontSize:"xx-small",color:e(s).infoColor,lineHeight:"0"})},u(e(g)[0].toLocaleString("en-us")),5)]),default:t(()=>[S(" "+u(d.$t("status.progressStarted"))+" ("+u(e(g)[0].toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])]),_:1}),n(ue,{justify:"end"},{default:t(()=>[n(fe,{trigger:"hover",duration:0,delay:0,style:re({color:e(s).successColor}),placement:"bottom"},{trigger:t(()=>[h("span",{style:re({fontSize:"medium",color:e(s).successColor})},[n(ae,{duration:e(X)*3|0,from:e(m)[1],to:e(m)[0],active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:t(()=>[S(" "+u(d.$t("status.progressSuccess"))+" ("+u(e(m)[0].toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])]),_:1})]),_:1}),n(ue,{align:"end",style:{"font-size":"medium",border:"0px solid"}},{default:t(()=>[n(fe,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:t(()=>[S(" / "+u(e(O).toLocaleString("en-us")),1)]),default:t(()=>[S(" "+u(d.$t("status.progressTotal"))+" ("+u(e(O).toLocaleString("en-us"))+") ",1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["percentage","color","rail-style"]),n(ne,{vertical:"",style:{height:"100%"},justify:"center"},{default:t(()=>[n(K,{"tabular-nums":"",label:d.$t("status.inputSize")},{default:t(()=>[n(ne,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[S(u((e(ee)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(K,{"tabular-nums":"",label:d.$t("status.outputSize")},{default:t(()=>[n(ne,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[S(u((e(V)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(K,{"tabular-nums":"",label:d.$t("status.outInRate")},{default:t(()=>[n(ne,{vertical:"",align:"end",justify:"start",style:{"font-size":"xx-small","font-family":"v-mono","line-height":"50%"}},{default:t(()=>[h("span",{style:re({color:e(v),fontSize:"larger"})},"× "+u((e(V)/e(ee)||1).toFixed(2)),5),h("span",{style:re({color:e(L)})},"("+u(e(ce))+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:1}),n(Sa,{"display-directive":"show","trigger-areas":["arrow","main"],"default-expanded-names":"log-collapse","expanded-names":e(oe)?["log-collapse"]:[],"on-update:expanded-names":Z=>{oe.value=!!String(Z)}},{default:t(()=>[n(Ia,{title:"Log",name:"log-collapse",style:{"white-space":"nowrap"}},nn({header:t(()=>[n(ue,{align:"center",wrap:!1},{default:t(()=>[S(u(d.$t("status.log")),1),d.processing&&!e(oe)?(M(),G(e(We),{key:0,size:16})):de("",!0)]),_:1})]),default:t(()=>[n(ue,{wrap:!1,class:et({"log-container":1,"expand-log":e(q)}),align:"stretch",style:re(e(q)?{height:e(te),maxHeight:e(te)}:{})},{default:t(()=>[n(e(en),{ref_key:"scrollref",ref:P,"x-scrollable":!0,onMouseup:W[5]||(W[5]=Z=>R.value=!1),onWheel:W[6]||(W[6]=Z=>R.value=!1),trigger:"none",style:re([{"z-index":"2","padding-right":"10px","min-height":"7em"},{maxHeight:e(te)}]),size:50},{default:t(()=>[h("table",kl,[h("tr",Al,[h("th",zl,u(d.$t("status.table.core")),1),h("th",Tl,u(d.$t("status.table.index")),1),h("th",Il,u(d.$t("status.table.status")),1),h("th",Sl,u(d.$t("status.table.details")),1)]),(M(!0),le(Te,null,He((e(J)?e(k).filter(Z=>!Z.completed):e(k)).slice(-e(j)),({index:Z,key:Re,command:Ee,path:gt,core:Mt})=>(M(),le("tr",{key:Re,class:"log-tr"},[h("td",Ll,u(Mt>=0?Mt+1:"-"),1),h("td",Cl,u(Z+1),1),h("td",$l,u(Ee),1),h("td",El,u(gt),1)]))),128))])]),_:1},8,["style"]),n(ue,{style:re([{"align-self":"center",position:"absolute","z-index":"0","margin-top":"0.5em",right:"0.1em","line-height":"0px"},{width:r.W+"px",height:r.H+"px"}]),justify:"center",align:"center"},{default:t(()=>[n(e(We),{size:"small",show:d.processing},{default:t(()=>[i.status.thumbnail===void 0?(M(),G(Ta,{key:0,description:"EMPTY"})):de("",!0),Kt(h("canvas",{ref_key:"thumbcanvas",ref:N,width:"106",height:"80",style:re({border:"1px solid gray",filter:d.processing?"":"opacity(0.35)"})},null,4),[[Qt,i.status.thumbnail!==void 0]])]),_:1},8,["show"])]),_:1},8,["style"])]),_:1},8,["class","style"])]),_:2},[e(oe)?{name:"header-extra",fn:t(()=>[n(ue,{align:"center",wrap:!1},{default:t(()=>[n(vt,null,{default:t(()=>[n(Ae,{key:"a",checked:e(J),"onUpdate:checked":W[0]||(W[0]=Z=>Ce(J)?J.value=Z:null),size:"small",style:{"font-size":"smaller"},class:"hide-mobile"},{default:t(()=>[S(u(d.$t("status.filterSuccess")),1)]),_:1},8,["checked"]),e(q)?(M(),G(Ae,{key:"b",checked:e(R),"onUpdate:checked":[W[1]||(W[1]=Z=>Ce(R)?R.value=Z:null),W[2]||(W[2]=Z=>Z&&lt(!0))],size:"small",style:{"font-size":"smaller"}},{default:t(()=>[S(u(d.$t("status.autoScroll")),1)]),_:1},8,["checked"])):de("",!0)]),_:1}),n(ft,{style:{"max-width":"30em"}},{trigger:t(()=>[n(Ae,{size:"small",checked:e(q),"onUpdate:checked":[W[3]||(W[3]=Z=>Ce(q)?q.value=Z:null),W[4]||(W[4]=Z=>{R.value=Z,lt(!0)})],style:{"font-size":"smaller"}},{default:t(()=>[S(u(d.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:t(()=>[S(u(d.$t("status.expandLogTooltip")),1)]),_:1})]),_:1})]),key:"0"}:void 0]),1024)]),_:1},8,["expanded-names","on-update:expanded-names"]),n(La,{style:{margin:"0.2em"}}),n(ue,{wrap:!1,vertical:""},{default:t(()=>[n(ue,{justify:"center",align:"center",vertical:""},{default:t(()=>[h("div",{class:"singleimage",style:re({maxHeight:e(C)?"2000px":"100px"})},[!e(C)&&e(z)?(M(),G(Qe,{key:0,tertiary:"",type:"success",size:"small",disabled:!(d.status.success>0),onClick:W[7]||(W[7]=Z=>C.value=!0)},{default:t(()=>[S(u(d.$t("status.browseConvertedImages")),1)]),_:1},8,["disabled"])):d.status.success>0?(M(),G(xl,{key:1,ref_key:"imageViewer",ref:D,url:e(w).url,size:e(w).size,"original-url":e(w).originalUrl,"original-size":e(w).originalSize,name:e(w).name,originalName:e(w).originalName,length:i.status.success,index:e(w).index,"is-single":!e(z),onDemandImage:W[8]||(W[8]=Z=>p("demand-image",Z))},null,8,["url","size","original-url","original-size","name","originalName","length","index","is-single"])):de("",!0)],4)]),_:1}),n(ue,{justify:"center"},{default:t(()=>[e(z)?(M(),G(ue,{key:0,vertical:"",align:"center"},{default:t(()=>[n(fe,{placement:"left"},{trigger:t(()=>[n(_e,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":e(F)[0]===e(O)?"white":"green",processing:d.processing,percentage:e(F)[0]/e(O)*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[h("span",Fl,u(e(F)[0]/e(O)*100|0)+"% "+u(d.$t("status.zipped"))+" ("+u(e(F)[0])+"/"+u(e(x)[0])+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[S(" "+u(d.$t("status.zippingProgress"))+" ("+u(e(F)[0]/e(O)*100|0)+"%) ",1)]),_:1}),n(Ze,{name:"zipcontainer"},{default:t(()=>[e(c).length>=1||i.processing?(M(),G(vt,{key:0,name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(M(!0),le(Te,null,He(e(c),(Z,Re)=>(M(),le("span",{key:Re},[n(fe,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:Z.url,download:Z.name,class:"in-button-anchor",onClick:Ee=>ge(Z)},[n(Qe,{class:"zip-button",size:"tiny",color:Z.clicked?"#050":"lime","text-color":Z.clicked?"gray":"white",onClick:Be(Ee=>ge(Z),["stop"]),round:""},{default:t(()=>[n(e(ye),{size:"tiny"},{default:t(()=>[n(e(yt))]),_:1}),S("ZIP"+u(Z.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Ml)]),default:t(()=>[h("div",{style:re({color:e(s).successColor})},[h("div",null,"ZIP "+u(Z.number||"")+" ("+u(d.$t("success"))+")",1),h("div",null,u(Z.name),1),h("div",null,u(Z.sizeByUnit),1),h("div",null,u(d.$rt("{n} @:files",Z.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):de("",!0)]),_:1})]),_:1})):de("",!0)]),_:1}),n(Ze,null,{default:t(()=>[i.processing?de("",!0):(M(),G(ue,{key:0,justify:"center",align:"center"},{default:t(()=>[n(fe,{trigger:"hover",duration:0,delay:0,placement:"left",style:re({color:"white",backgroundColor:e(s).successColor}),"arrow-style":{backgroundColor:e(s).successColor}},{trigger:t(()=>[n(Ze,{name:"save"},{default:t(()=>[e(m)[0]>0?(M(),le("span",Ol,[n(Ft,{value:e(z)?e(F)[0].toLocaleString("en-us"):i.status.type.replace(/\(.+\)/,""),color:e(s).successColorHover,offset:[-20,-3]},{default:t(()=>[n(Qe,{size:"medium",onClick:Oe,color:e(s).successColor,round:""},{default:t(()=>[e(z)?(M(),le(Te,{key:0},[e(c).length?(M(),le("a",{key:0,href:e(c)[0].url,download:e(c)[0].name,class:"in-button-anchor",onClick:W[9]||(W[9]=Be(()=>{},["prevent"]))},[n(Ca),S(" × "+u(e(c).length)+" "+u(d.$t("save")),1)],8,Ul)):de("",!0)],64)):(M(),le("a",{key:1,href:e(w).url,download:e(w).name,class:"in-button-anchor",onClick:W[10]||(W[10]=Be(()=>{},["prevent"]))},[n(e(ye),{size:"tiny"},{default:t(()=>[n(e(ln))]),_:1}),S(" "+u(d.$t("save")),1)],8,Pl))]),_:1},8,["color"])]),_:1},8,["value","color"])])):de("",!0)]),_:1})]),default:t(()=>[d.status.length>=2?(M(),le(Te,{key:0},[h("div",null,u(e(o)("success"))+": "+u(e(F)[0].toLocaleString()),1),h("div",null,u(e(o)("status.totalSize"))+": "+u(e(Ue)(d.status.zippedTotalSize)),1),h("div",null,"ZIP × "+u(e(c).length),1),h("div",null,u(e(o)("status.saveAllZipsTooltip")),1)],64)):(M(),le(Te,{key:1},[S(u(d.$t("status.downloadConvertedImage",e(c).length)),1)],64))]),_:1},8,["style","arrow-style"]),!d.processing&&d.status.success!==e(O)?(M(),G($a,{key:0,options:e(Ne),onSelect:W[11]||(W[11]=(Z,Re)=>{var Ee;return(Ee=e(Ne).find(({key:gt})=>Z===gt))==null?void 0:Ee.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:t(()=>[n(fe,{show:e(B),duration:0,delay:0,placement:"right",style:re({color:"white",backgroundColor:e(s).errorColor}),"arrow-style":{backgroundColor:e(s).errorColor}},{trigger:t(()=>[n(Ft,{value:d.status.unconvertedFileCount.toLocaleString(),color:e(s).errorColorHover,offset:[-0,-3]},{default:t(()=>[n(Qe,{size:"small",color:e(s).errorColor},{default:t(()=>[n(e(ye),{size:"medium",style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Ga))]),_:1})]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:t(()=>[h("div",null,[h("div",null,u(e(o)("failed"))+": "+u(d.status.unconvertedFileCount.toLocaleString()),1),h("div",null,u(e(o)("status.totalSize"))+": "+u(e(Ue)(d.status.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])):de("",!0)]),_:1}))]),_:1}),n(Ze,{name:"zipcontainer"},{default:t(()=>[e(A)?(M(),G(ue,{key:0,vertical:"",align:"center"},{default:t(()=>[n(fe,{placement:"left"},{trigger:t(()=>[n(_e,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":d.status.failedFileZippedCount===d.status.unconvertedFileCount?"white":"#500",processing:e(A)&&!d.status.failedZipDone&&!d.status.failedToCreateFailedZip,percentage:d.status.failedFileZippedCount/d.status.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[d.status.failedToCreateFailedZip?(M(),le("div",{key:1,style:re({color:e(s).errorColor})},u(d.$t("status.failureZippingFailedFiles")),5)):(M(),le("span",Nl,u(d.status.failedFileZippedCount/d.status.unconvertedFileCount*100|0)+"% "+u(d.$t("status.zipped"))+" ("+u(d.status.failedFileZippedCount)+"/"+u(d.status.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[S(" "+u(d.$t("status.zippingProgress"))+" ("+u(d.status.failedFileZippedCount/d.status.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(vt,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(M(!0),le(Te,null,He(e($),(Z,Re)=>(M(),le("span",{key:Re},[n(fe,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:Z.url,download:Z.name,class:"in-button-anchor",onClick:Ee=>ge(Z)},[n(Qe,{class:"zip-button",size:"tiny",color:Z.clicked?"#551122":"#F00","text-color":Z.clicked?"gray":"white",onClick:Be(Ee=>ge(Z),["stop"]),round:""},{default:t(()=>[n(e(ye),{size:"tiny"},{default:t(()=>[n(e(Ka))]),_:1}),S("ZIP"+u(Z.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Dl)]),default:t(()=>[h("div",{style:re({color:e(s).errorColor})},[h("div",null,"ZIP "+u(Z.number||"")+" ("+u(d.$t("failed"))+")",1),h("div",null,u(Z.name),1),h("div",null,u(Z.sizeByUnit),1),h("div",null,u(d.$rt("{n} @:files",Z.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1})):de("",!0)]),_:1})]),_:1})]),_:1})}}}),Zl=Me(jl,[["__scopeId","data-v-5231d4a8"]]),Bl=["innerHTML"],Hl=h("p",null,[h("img",{width:"200",src:Ho})],-1),Wl={style:{"flex-grow":"1"}},Vl=be({__name:"converter",props:tt({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},threads:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:tt(["start","end","multi-thread-count"],["update:showNote"]),setup(a,{emit:l}){qe(Pe);const{t:f}=Fe(),o=dt(),s=Qa(),r=Ya(),i=10,p=navigator.hardwareConcurrency,z=typeof OffscreenCanvas=="function",k=300,A=a,c=Se(a,"showNote"),$=l,y=_(!1),g=_(!1),m=_(!1),E=_(0),T=_(!1),x=_(!1),O=_("initializing"),F=_("info"),b=ut(J());let v=!1,L=()=>{},ee=0,V=!1;ke(()=>A.input,I=>{I!=null&&I.length&&te(I)}),$e(async()=>{await w(),N()});async function ce(){let I=!0;ee>i*1e3&&!V&&b.success>0&&(I=!1,await new Promise(P=>{o.warning({title:f("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:f("close"),negativeText:f("back"),onPositiveClick:()=>I=!0,onAfterLeave:P,content:f("confirmCloseDialog")})})),I&&(r.destroyAll(),s.destroyAll(),T.value=!1,c.value=!1)}function U(I){b.demandImage(I)}function B(){!g.value&&y.value?g.value=!0:ce()}function q(){te(A.input)}let R=_(()=>{});function J(I){const P={logs:[],index:0,converted:0,success:0,failure:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",zipSize:A.maxZipSizeMB,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1,demandImage:()=>{}};return Object.assign(I||{},P)}function j(){x.value=!1,URL.revokeObjectURL(b.convertedImageUrl),URL.revokeObjectURL(b.convertedImageOrgUrl);for(const I of b.zips)URL.revokeObjectURL(I.url);b.zips.length=0;for(const I of b.failedZips)URL.revokeObjectURL(I.url);b.failedZips.length=0,J(b),L(),L=()=>{},V=!1,m.value=!1,g.value=!1}async function te(I){if(y.value){o.error({title:"Busy",positiveText:"OK",content:f("interfered")});return}let P=oe(I);J(b),j();const D={convertedImageBlob:null,convertedImageWidth:0,convertedImageHeight:0,convertedImageName:""};E.value++,T.value=!0,x.value=!0,y.value=!0,b.processing=!0,F.value="info",O.value=f("processing");const X=new Set,ie=A.format,Q=A.quality,he=[...ie.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),pe=C(ie,Q,P[0].webkitRelativePath);b.length=P.length,b.baseZipName=pe,b.type=ie.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(ie)?" ("+Q+")":""),b.threads=v?0:A.threads;const Ne=Date.now();$("start");const ge=P.concat();let Oe,De;if({exception:De,callbackToGenerateFailedZips:Oe,callbackToClearConverter:L}=!v&&A.threads>=2?await nl(b,g,A,D,s,r,ge,X,ie,Q,he,ie):await sl(ge,X,D,A,g,b),De){let Ie;switch(De.message){case"worker-load-error":Ie=f("errMsgWorkerLoadError");break;default:Ie="unexpected error"}o.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:()=>Y("div",[Y("p",Ie),Y(xe,{onClick(){location.reload()}},f("Reload"))])})}if(b.length,b.success===b.length?(F.value="success",O.value=f("completed")):(F.value="error",O.value=g.value?f("aborted"):f("incomplete")),X.size!==P.length){const Ie=se(P,X);R.value=()=>{!Ie||!Ie.length||Oe(Ie)}}y.value=!1,b.processing=!1,m.value=!0,ee=Date.now()-Ne,$("end")}function se(I,P){const D=[],X=[];let ie=0;for(const Q of I)P.has(Q._id)||(D.push(Q),X.push(Q.webkitRelativePath||Q.relativePath||Q.name),ie+=Q.size);return X.length&&(b.unconvertedListText=X.join(`
`),b.unconvertedFileCount=D.length,b.unconvertedTotalSize=ie),D}let ve=0;function oe(I){const P=[];for(const D of I)D.hasOwnProperty("_id")||Object.defineProperty(D,"_id",{value:ve++}),P.push(D);return P}function C(I,P,D){var he;const X=new Date;return I=I.replace(/^image\//,"").toLowerCase(),`${H.useFolderNameForZip&&((he=String(D).match(/^\/?([^/]+)\//))==null?void 0:he[1])||"avif2jpg"}-
    ${X.getFullYear().toString().substring(2)}
    ${String((X.getMonth()+1)*100+X.getDate()).padStart(4,"0")}
    ${String(X.getHours()*1e4+X.getMinutes()*100+X.getSeconds()).padStart(6,"0")}
    -
    ${I+(/jpe?g|webp/i.test(I)?P:"")}
  `.replace(/\s/g,"")}async function w(){const I="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",P=document.createElement("img"),D=mn(P).then(()=>!0,()=>!1);P.src=I,await D||o.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:f("avifUnsupported")})}function N(){(!z||p<2||!Promise.any)&&(v=!0),$("multi-thread-count",v?0:p)}return(I,P)=>{const D=ze,X=Le,ie=Ja,Q=Xa,he=We,pe=Ge,Ne=xt;return M(),le(Te,null,[n(X,{justify:"center",align:"center"},{default:t(()=>{var ge;return[!e(y)&&((ge=A.input)!=null&&ge.length)?(M(),G(D,{key:0,trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:t(()=>[n(e(xe),{onClick:q,round:""},{default:t(()=>[S(u(e(f)("convertAgain")),1)]),_:1})]),default:t(()=>{var Oe;return[h("div",{innerHTML:e(f)("reconvertTip",(Oe=A.input)==null?void 0:Oe.length)},null,8,Bl)]}),_:1})):de("",!0)]}),_:1}),n(Q,{show:e(T)||c.value,placement:"right","z-index":0,"mask-closable":"","on-mask-click":ge=>c.value=!1},{default:t(()=>[n(ie,{title:"Note"},{default:t(()=>[h("p",null,u(I.$t("annotationOutOfMemory")),1),Hl]),_:1})]),_:1},8,["show","on-mask-click"]),n(Ne,{ref:"processingModal",show:e(T),"onUpdate:show":P[2]||(P[2]=ge=>Ce(T)?T.value=ge:null),closable:e(m),"close-on-esc":!1,preset:"dialog","display-directive":"show",onClick:P[3]||(P[3]=ge=>{e(r).destroyAll(),e(s).destroyAll()}),onMaskClick:P[4]||(P[4]=ge=>{e(r).destroyAll(),e(s).destroyAll()}),onClose:ce,onEsc:B,title:e(O),type:e(F),"mask-closable":!1,"on-after-leave":j,class:"processing-dialog"},{default:t(()=>[n(pe,{vertical:"",style:{"flex-grow":"1"}},{default:t(()=>[h("div",Wl,[e(x)?(M(),G(Zl,{key:e(E),processing:e(y),status:e(b),interval:k,onAllZipsClicked:P[0]||(P[0]=ge=>Ce(V)?V.value=!0:V=!0),onDemandZipErrors:e(R),onDemandImage:U},null,8,["processing","status","onDemandZipErrors"])):de("",!0)]),n(pe,{justify:"end"},{default:t(()=>[e(y)?(M(),G(e(xe),{key:0,disabled:e(g),ref:"cancelbutton",round:"",size:"large",onClick:P[1]||(P[1]=ge=>g.value=!0)},{default:t(()=>[n(he,{show:e(g)&&!e(m),size:"small"},{default:t(()=>[S(u(e(f)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):e(m)?(M(),G(e(xe),{key:1,onClick:ce,round:"",size:"large",style:{"font-size":"small","margin-top":"1em"}},{default:t(()=>[S(u(e(f)("close")),1)]),_:1})):de("",!0)]),_:1})]),_:1})]),_:1},8,["show","closable","title","type"])],64)}}}),ql="/avif2jpeg/dist/avif.png",vn=a=>(At("data-v-892702c9"),a=a(),zt(),a),Gl={class:"container-1"},Kl=vn(()=>h("span",null,"Drag & Drop",-1)),Ql={style:{position:"relative"}},Yl={style:{position:"absolute","font-size":"0.5em",right:"-3.5em",bottom:"-1.5em","white-space":"nowrap"}},Jl={style:{color:"#666666"}},Xl=vn(()=>h("img",{src:ql,class:"avif"},null,-1)),ei=["innerHTML"],ti={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},ni=be({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(a,{emit:l}){qe(Pe);const f=a,o=l,s=eo(),r=_(!1),i=_(0),p=_("");$e(()=>{z(f.dropTarget||document)});function z(A){document.ondragstart=c=>c.preventDefault(),document.ondragover=c=>c.preventDefault(),A.ondrop=async c=>{var y;if(c.preventDefault(),r.value||f.forbidden)return;r.value=!0,i.value=0,p.value="";let $;try{const g=[...c.dataTransfer.items].map(m=>m.webkitGetAsEntry());s.start(),$=await k(g),s.finish()}catch{$=[...((y=c.dataTransfer)==null?void 0:y.files)??[]],s.error()}r.value&&(r.value=!1,o("drop",$))}}async function k(A,c){c=c||[];for(const $ of A)if($.isFile){const y=await new Promise(g=>$.file(m=>g(m)));Object.defineProperty(y,"webkitRelativePath",{value:$.fullPath}),c.push(y),i.value++}else if($.isDirectory){p.value=$.fullPath;const y=$.createReader();do{const g=await new Promise(m=>y.readEntries(E=>m(E)));if(!g.length)break;await k(g,c)}while(!0)}return c}return(A,c)=>{const $=ye,y=Le,g=ot,m=ze,E=xt;return M(),le(Te,null,[h("div",Gl,[n(m,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"left"},{trigger:t(()=>[n(y,{vertical:"",class:"container-2"},{default:t(()=>[n(y,{align:"center",wrap:!1,class:"container-3"},{default:t(()=>[n(y,{align:"center"},{default:t(()=>[n($,{size:"64",color:"white"},{default:t(()=>[n(e(to))]),_:1})]),_:1}),n(y,{vertical:"",align:"center",wrap:!1,style:{"font-weight":"bold","font-size":"1em","line-height":"90%","white-space":"nowrap"}},{default:t(()=>[Kl,h("span",Ql,[S(" AVIF Images "),h("span",Yl,[S(" or "),n(g,{placement:"bottom-end"},{trigger:t(()=>[h("span",Jl,[n($,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Ct))]),_:1}),S(" Folders ")])]),default:t(()=>[S(" You can drag and drop your local folders ")]),_:1})])])]),_:1}),n(y,null,{default:t(()=>[Xl]),_:1})]),_:1})]),_:1})]),default:t(()=>[h("h3",{innerHTML:A.$t("droptarget"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,ei)]),_:1})]),n(E,{show:e(r),"onUpdate:show":c[0]||(c[0]=T=>Ce(r)?r.value=T:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":A.$t("cancel")},{default:t(()=>[n(y,{vertical:"",align:"center"},{default:t(()=>[h("div",ti,u(e(p)),1),h("div",null,"found "+u(e(i))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])],64)}}}),ai=Me(ni,[["__scopeId","data-v-892702c9"]]),hn=a=>(At("data-v-dec671e4"),a=a(),zt(),a),oi={class:"container-1"},li={class:"container-2"},ii=["innerHTML"],si=["innerHTML"],ri={style:{"padding-left":"1em"}},ui=hn(()=>h("br",null,null,-1)),di=hn(()=>h("ul",null,[h("li",null,"Each extension must begin with a period. "),h("li",null,"Separate each extension with a comma. "),h("li",null,"Use alphameric characters.")],-1)),ci=["innerHTML"],pi=["accept"],fi=be({__name:"file-selector",props:tt({expanded:{type:Boolean},target:{},userExtensions:{},forbidden:{type:Boolean}},{disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:tt(["input","click","cancel","on-change-accept","update:target","update:userExtensions","update:expanded"],["update:disableNotifyingFolderSelect"]),setup(a,{emit:l}){const f=dt(),{t:o}=Fe(),s=qe(Pe),r=["avif_only","all_images","all_files","edit_type"],i=a,p=l,z=_(0),k=_(!1),A=_(!1),c=we(()=>V(m.value)),$=we(()=>E.value.split(",").every(q=>/^\s*(\.[\w\-]+)*\s*$/.test(q))?"success":"error"),y=we(()=>!i.forbidden&&!A.value),g=we({get:()=>i.expanded,set:B=>{p("update:expanded",B)}}),m=we({get:()=>r.indexOf(i.target)>=0?i.target:r[0],set:B=>{p("update:target",B)}}),E=we({get:()=>i.userExtensions,set:B=>{p("update:userExtensions",B)}}),T=Se(a,"disableNotifyingFolderSelect"),x=_(null),O=_(null),F=_(ee());ke(m,B=>{p("on-change-accept",c.value)}),$e(()=>{});async function b(B){if(p("click"),B===O.value&&!T.value){let q=!1;if(await new Promise(R=>{f.info({title:o("loadfolderNotifyingTitle"),positiveText:o("Continue"),negativeText:o("Cancel"),onAfterLeave:()=>R(q),onPositiveClick:()=>q=!0,content:()=>Y("div",[Y("p",{},o("loadfolderNotifyingMessageTerm1")),Y("div",[Y(Yt,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/dist//notification-folder.png"})]),Y("p",{},o("loadfolderNotifyingMessageTerm2")),Y("p",[Y(an,{onUpdateChecked:J=>T.value=J,checked:T.value},()=>o("checkboxTextDontShowThis"))])])})}),!q){T.value=!1,p("cancel");return}}B.click()}function v(){p("cancel")}function L(B){const R=[...B.target.files];x.value.value="",O.value.value="",U(R)}function ee(){return"webkitdirectory"in document.createElement("input")}function V(B){switch(B){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico";case"edit_type":return E.value;case"all_files":default:return".*"}}async function ce(B){const q=String(c.value).toLowerCase().replace(/\s+/g,"");if(q&&c.value!==".*"){const R=q.split(",");B=B.filter(J=>R.includes(J.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),B.length||(await new Promise(J=>{f.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:J,content:()=>Y("div",[Y(on,{description:"NO IMAGES"}),`${o("noimage")}`,Y("br"),c.value])})}),v())}return B}async function U(B){A.value=!0,B=await ce(B),z.value=B.length,B.length>0&&p("input",B),A.value=!1}return(B,q)=>{const R=ye,J=Tt,j=xe,te=ze,se=Le,ve=so,oe=no,C=ao,w=ot,N=oo,I=St,P=Lt;return M(),le(Te,null,[h("div",oi,[h("div",li,[n(se,{vertical:"",align:"center",justify:"center",inline:""},{default:t(()=>[n(se,{align:"center",justify:"space-around"},{default:t(()=>[n(J,{value:e(z),max:999,offset:[-8,0],color:"#999999",style:{"margin-right":"1em"}},{default:t(()=>[n(R,{size:"4em",color:"#CCCCCC"},{default:t(()=>[n(e(lo))]),_:1})]),_:1},8,["value"]),n(se,{vertical:"",align:"stretch",justify:"center"},{default:t(()=>[n(te,{to:!1,"display-directive":"show",show:e(s).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(s).LANDSCAPE.value?"right":"top",duration:0,delay:0,"z-index":10},{trigger:t(()=>[n(j,{disabled:!e(y),onClick:q[0]||(q[0]=D=>b(e(x))),round:"",style:{width:"100%","background-color":"white"}},{icon:t(()=>[n(R,{size:"large",color:"gray"},{default:t(()=>[n(e(sn))]),_:1})]),default:t(()=>[S(" "+u(B.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[h("div",{innerHTML:B.$t("loadbuttontooltip")},null,8,ii)]),_:1},8,["show","placement"]),!e(s).IS_SP&&e(F)||e(s).SSR?(M(),G(te,{key:0,to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:e(s).showTooltipsBeforeMounted.value},{trigger:t(()=>[n(j,{disabled:!e(y),onClick:q[1]||(q[1]=D=>b(e(O))),round:"",style:{width:"100%","background-color":"white"}},{icon:t(()=>[n(R,{size:"large",color:"gray"},{default:t(()=>[n(e(Ct))]),_:1})]),default:t(()=>[S(" "+u(B.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[h("div",{innerHTML:B.$t("loadfoldertooltip")},null,8,si)]),_:1},8,["show"])):de("",!0)]),_:1})]),_:1}),h("div",{class:et({"expand-ext-list-container":e(g)})},[n(P,{"display-directive":"show","expanded-names":e(g)?["extItem"]:"","on-update:expanded-names":D=>{g.value=!!(""+D)},class:et({"expand-ext-list":e(g)})},{"header-extra":t(()=>[n(R,{size:"large"},{default:t(()=>[n(e(io))]),_:1})]),default:t(()=>[n(I,{title:B.$t("fileTypeRadioTitle"),name:"extItem"},{default:t(()=>[n(N,{value:e(m),"onUpdate:value":q[5]||(q[5]=D=>Ce(m)?m.value=D:null),name:"filetyperadios",size:"small"},{default:t(()=>[n(se,{vertical:"",style:{"padding-left":"1em"}},{default:t(()=>[(M(),le(Te,null,He(r,D=>n(te,{key:D,trigger:"hover","keep-alive-on-hover":!1,"z-index":5,placement:"left",style:{"max-width":"200px"},duration:0,delay:0},{trigger:t(()=>[n(ve,{value:D},{default:t(()=>[S(u(B.$t("fileTypeRadioOptions."+D)),1)]),_:2},1032,["value"])]),default:t(()=>[S(" "+u(V(D).replace(/,/g,", ")),1)]),_:2},1024)),64)),n(te,{trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:e(k),duration:0,delay:0},{trigger:t(()=>[h("div",ri,[n(w,{trigger:"manual",placement:"right-end",show:e(m)==="edit_type"&&e($)!=="success"&&!!e(k)},{trigger:t(()=>[n(oe,{value:e(E),"onUpdate:value":q[2]||(q[2]=D=>Ce(E)?E.value=D:null),status:e($),disabled:e(m)!=="edit_type",onFocus:q[3]||(q[3]=D=>k.value=!0),onBlur:q[4]||(q[4]=D=>k.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:t(()=>[n(C,{type:"error","show-icon":!0,title:"Validation error"},{default:t(()=>[S(" Please correct the extension list."),ui,di]),_:1})]),_:1},8,["show"])])]),default:t(()=>[h("span",{innerHTML:B.$t("editAcceptTypes")},null,8,ci)]),_:1},8,["show"])]),_:1})]),_:1},8,["value"])]),_:1},8,["title"])]),_:1},8,["expanded-names","on-update:expanded-names","class"])],2),e(s).IS_SP?de("",!0):(M(),G(ai,{key:0,onDrop:U,forbidden:!e(y)},null,8,["forbidden"]))]),_:1})])]),h("input",{ref_key:"fileinput",ref:x,onInput:L,onCancel:v,type:"file",multiple:"",accept:e(c),style:{display:"none"}},null,40,pi),h("input",{ref_key:"folderinput",ref:O,webkitdirectory:"",directory:"",onInput:L,onCancel:v,type:"file",style:{display:"none"}},null,544)],64)}}}),gi=Me(fi,[["__scopeId","data-v-dec671e4"]]),mi={style:{"white-space":"nowrap"}},vi=be({__name:"settings-output",props:{quality:{},format:{}},emits:["update:format","update:quality"],setup(a,{emit:l}){const f=a,o=l,{t:s}=Fe(),r=qe(Pe),i=_([]),p=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],z=we({get:()=>f.format,set:g=>{g=$(g),o("update:format",g)}}),k=we({get:()=>f.quality,set:g=>{o("update:quality",g)}}),A=we(()=>/png|bmp/i.test(z.value)),c=_(null);$e(()=>{y()});function $(g){return i.value.indexOf(g)<0&&(g=i.value[0]),g}function y(){for(const g of p)c.value.toDataURL(g).indexOf(g)>=0&&i.value.push(g);i.value.length===0&&i.value.push(p[0])}return(g,m)=>{const E=ye,T=rn,x=Le,O=ze,F=It,b=un;return M(),le(Te,null,[n(x,{justify:"center"},{default:t(()=>[n(x,{vertical:""},{default:t(()=>[n(O,{to:!1,"display-directive":"show",show:e(r).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(r).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(x,{align:"center"},{default:t(()=>[n(E,null,{default:t(()=>[n(e(sn))]),_:1}),S(u(e(s)("settings.imageType"))+": ",1),n(T,{value:z.value,"onUpdate:value":m[0]||(m[0]=v=>z.value=v),options:i.value.map(v=>({value:v,label:v})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:t(()=>[S(" "+u(e(s)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(O,{to:!1,"display-directive":"show",show:e(r).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(r).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(x,{align:"center"},{default:t(()=>[n(x,{align:"start",wrap:!1},{default:t(()=>[n(E,null,{default:t(()=>[n(e(ln))]),_:1}),h("span",mi,u(e(s)("settings.quality"))+":",1),n(x,{align:"center",justify:"space-between"},{default:t(()=>[n(F,{tooltip:!1,value:k.value,"onUpdate:value":m[1]||(m[1]=v=>k.value=v),step:1,style:{width:"120px"},disabled:A.value},null,8,["value","disabled"]),n(b,{value:k.value,"onUpdate:value":m[2]||(m[2]=v=>k.value=v),step:"1",min:"0",max:"100",disabled:A.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:t(()=>[S(" "+u(e(s)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1})]),_:1}),h("canvas",{ref_key:"canvas",ref:c,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),hi={style:{width:"4em","text-align":"left"}},_i={style:{width:"4em","text-align":"left"}},Rt=100,jt=2e3,Zt=4096,Bt=4096,yi=100,wi=100,bi=be({__name:"settings-adv",props:tt({threadMax:{}},{expanded:{type:Boolean,required:!0},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}}),emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(a){const l={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},f=Se(a,"expanded"),o=Se(a,"multithread"),s=Se(a,"threadCount"),r=Se(a,"maxZipSize"),i=Se(a,"retainExt"),p=Se(a,"useFolderNameForZip"),z=Se(a,"shrinkImage"),k=Se(a,"maxWidth"),A=Se(a,"maxHeight"),c=a;ke([s,()=>c.threadMax],()=>{c.threadMax>1&&typeof s.value>"u"&&(s.value=c.threadMax)}),ke(()=>c.threadMax,()=>{c.threadMax>1||(o.value=!1)},{immediate:!0});const $=we(()=>o.value&&c.threadMax>1);return(y,g)=>{const m=ye,E=xe,T=ro,x=Ge,O=It,F=un,b=St,v=Lt;return M(),G(x,{justify:"center"},{default:t(()=>[n(v,{"display-directive":"show","default-expanded-names":f.value?["collapitem"]:"","on-update:expanded-names":L=>f.value=!!String(L),"trigger-areas":["arrow","main"],class:et(["settings-body",f.value?"expand-adv-settings":""])},nn({arrow:t(()=>[n(m,{style:re(f.value&&{top:"8px"})},{default:t(()=>[n(e(uo))]),_:1},8,["style"]),n(m,null,{default:t(()=>[n(e(co))]),_:1})]),default:t(()=>[n(b,{title:y.$t("settings.advancedSettings"),name:"collapitem"},{default:t(()=>[n(x,{vertical:"",style:{"padding-left":"2em"}},{default:t(()=>[n(e(ze),Ye(Je(l)),{trigger:t(()=>[n(x,{vertical:""},{default:t(()=>[n(x,{wrap:!1,align:"center"},{default:t(()=>[n(E,{text:"",disabled:!y.threadMax,style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[0]||(g[0]=L=>o.value=!o.value)},{icon:t(()=>[n(m,null,{default:t(()=>[n(e(po))]),_:1})]),default:t(()=>[S(" "+u(y.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(T,{value:o.value,"onUpdate:value":g[1]||(g[1]=L=>o.value=L),disabled:!y.threadMax,size:"small"},null,8,["value","disabled"])]),_:1}),n(x,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(O,{value:s.value,"onUpdate:value":g[2]||(g[2]=L=>s.value=L),disabled:!y.threadMax||!o.value,step:1,min:2,max:y.threadMax,style:{width:"120px"}},null,8,["value","disabled","max"]),n(F,{size:"tiny",value:s.value,"onUpdate:value":g[3]||(g[3]=L=>s.value=L),disabled:!y.threadMax||!o.value,step:1,min:2,max:y.threadMax,style:{width:"10em"}},{suffix:t(()=>[S(u(y.$t("threads",s.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[S(" "+u(y.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(e(ze),Ye(Je(l)),{trigger:t(()=>[n(x,{vertical:""},{default:t(()=>[n(x,{wrap:!1,align:"center"},{default:t(()=>[n(E,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:t(()=>[n(m,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(fo))]),_:1})]),default:t(()=>[S(" "+u(y.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(x,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(O,{tooltip:!1,value:r.value,"onUpdate:value":g[4]||(g[4]=L=>r.value=L),step:1,min:Rt,max:jt,style:{width:"120px"}},null,8,["value"]),n(F,{size:"tiny",value:r.value,"onUpdate:value":g[5]||(g[5]=L=>r.value=L),step:"1",min:Rt,max:jt,style:{width:"10em"}},{suffix:t(()=>[S("(MB)")]),_:1},8,["value"])]),_:1})]),_:1})]),default:t(()=>[S(" "+u(y.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(e(ze),Ye(Je(l)),{trigger:t(()=>[n(x,{wrap:!1,align:"center"},{default:t(()=>[n(E,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[6]||(g[6]=L=>p.value=!p.value)},{icon:t(()=>[n(m,null,{default:t(()=>[n(e(Ct))]),_:1})]),default:t(()=>[S(" "+u(y.$t("settings.useFolderNameForZip")),1)]),_:1}),n(T,{value:p.value,"onUpdate:value":g[7]||(g[7]=L=>p.value=L),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[S(" "+u(y.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(e(ze),Ye(Je(l)),{trigger:t(()=>[n(x,{wrap:!1,align:"center"},{default:t(()=>[n(E,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[8]||(g[8]=L=>i.value=!i.value)},{icon:t(()=>[n(m,null,{default:t(()=>[n(e(tn))]),_:1})]),default:t(()=>[S(" "+u(y.$t("settings.retainOriginalExtension")),1)]),_:1}),n(T,{value:i.value,"onUpdate:value":g[9]||(g[9]=L=>i.value=L),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[S(" "+u(y.$t("settings.retainExtTooltip")),1)]),_:1},16),n(e(ze),Ye(Je(l)),{trigger:t(()=>[n(x,{vertical:""},{default:t(()=>[n(x,{wrap:!1,align:"center"},{default:t(()=>[n(E,{disabled:!e($),text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[10]||(g[10]=L=>z.value=!z.value)},{icon:t(()=>[n(m,null,{default:t(()=>[n(e(go))]),_:1})]),default:t(()=>[S(" "+u(y.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(T,{disabled:!e($),value:z.value,"onUpdate:value":g[11]||(g[11]=L=>z.value=L),size:"small"},null,8,["disabled","value"])]),_:1}),n(x,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(O,{value:k.value,"onUpdate:value":g[12]||(g[12]=L=>k.value=L),disabled:!z.value||!e($),step:1,min:yi,max:Zt,style:{width:"120px"}},null,8,["value","disabled"]),n(F,{size:"tiny",value:k.value,"onUpdate:value":g[13]||(g[13]=L=>k.value=L),disabled:!z.value||!e($),step:1,min:8,max:Zt*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[h("span",hi,u(y.$t("width")),1)]),suffix:t(()=>[S("px")]),_:1},8,["value","disabled","max"])]),_:1}),n(x,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(O,{value:A.value,"onUpdate:value":g[14]||(g[14]=L=>A.value=L),disabled:!z.value||!e($),step:1,min:wi,max:Bt,style:{width:"120px"}},null,8,["value","disabled"]),n(F,{size:"tiny",value:A.value,"onUpdate:value":g[15]||(g[15]=L=>A.value=L),disabled:!z.value||!e($),step:1,min:8,max:Bt*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[h("span",_i,u(y.$t("height")),1)]),suffix:t(()=>[S("px")]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[S(" "+u(y.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1},8,["title"])]),_:2},[f.value?{name:"header-extra",fn:t(()=>[n(e(ze),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(E,{onClick:e(Lo),size:"tiny",style:{"font-size":"xx-small"}},{default:t(()=>[S(u(y.$t("reset")),1)]),_:1},8,["onClick"])]),default:t(()=>[S(" "+u(y.$t("settings.resetButtonTooltip")),1)]),_:1})]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1})}}}),xi=Me(bi,[["__scopeId","data-v-0da126eb"]]),ki={},Ai={style:{color:"gray","padding-left":"20px"}},zi=["innerHTML"];function Ti(a,l){const f=kt,o=Le;return M(),G(o,{vertical:"",justify:"end"},{default:t(()=>[n(f,{style:{margin:"0px"}}),n(o,{justify:"center"},{default:t(()=>[h("ul",Ai,[(M(!0),le(Te,null,He(a.$tm("descriptions"),s=>(M(),le("li",{key:s,style:{"text-align":"left"},innerHTML:s},null,8,zi))),128))])]),_:1})]),_:1})}const Ii=Me(ki,[["render",Ti]]),Si="modulepreload",Li=function(a){return"/avif2jpeg/dist/"+a},Ht={},me=function(l,f,o){let s=Promise.resolve();if(f&&f.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),p=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(f.map(z=>{if(z=Li(z),z in Ht)return;Ht[z]=!0;const k=z.endsWith(".css"),A=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${z}"]${A}`))return;const c=document.createElement("link");if(c.rel=k?"stylesheet":Si,k||(c.as="script"),c.crossOrigin="",c.href=z,p&&c.setAttribute("nonce",p),document.head.appendChild(c),k)return new Promise(($,y)=>{c.addEventListener("load",$),c.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${z}`)))})}))}function r(i){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=i,window.dispatchEvent(p),!p.defaultPrevented)throw i}return s.then(i=>{for(const p of i||[])p.status==="rejected"&&r(p.reason);return l().catch(r)})},_n="English",yn="🇬🇧",wn='AVIF to JPEG "Offline" Batch Converter',bn="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",xn="Drag & Drop AVIF Images to Convert",kn=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.'],An="Select your language",zn="Choose Target File Extentions",Tn={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},In="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",Sn="Load Images",Ln="Select your images from a dialog window.<br>*Multiple selection allowed.",Cn="Load a Whole Folder",$n=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,En="Converting images",Fn="Aborted",Mn="Some files failed to convert",On="Completed",Un="Currently Busy",Pn="No files with the extentions were found.",Nn="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",Dn="Cancel",Rn="Save",jn="Close",Zn="Open",Bn="Re-convert",Hn="Convert previous selected {n} @:files again",Wn="File | Files",Vn="thread | threads",qn="You have not saved the converted images yet.",Gn="Data have not been saved",Kn="Open Source",Qn="Open the converted image",Yn="Copied to clipboard",Jn="The converted image was copied to your clipboard as DataURL.",Xn="Copy the converted image as DataURL",ea="Convert Again",ta={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",expandLog:"Show entire log",autoScroll:"Auto scroll",showOnlyErrors:"Show only errors",log:"Log",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files"},na={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file"},aa="Disabled",oa="Download",la="Reset",ia="Back",sa="Failed",ra="Success",ua="Previous version",da=`
Height`,ca="Width",pa="Don't show this message again",fa="About the warning when selecting a folder",ga="OK",ma={},va="You must press the “Upload” button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",ha="Continue",_a="Cancel",ya="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",wa=`If the conversion process is frequently interrupted and an “Out of Memory” message appears, try reducing or disabling the number of multi-threads in the advanced settings.
If this problem has occurred only recently, a newer version of the browser may solve the problem.`,ba="This page may be an outdated version. Please reload the page.",xa="Reload",ka={lang:_n,flags:yn,title:wn,metaDescription:bn,droptarget:xn,descriptions:kn,selectLanguage:An,fileTypeRadioTitle:zn,fileTypeRadioOptions:Tn,editAcceptTypes:In,loadbutton:Sn,loadbuttontooltip:Ln,loadfolderbutton:Cn,loadfoldertooltip:$n,processing:En,aborted:Fn,incomplete:Mn,completed:On,interfered:Un,noimage:Pn,avifUnsupported:Nn,cancel:Dn,save:Rn,close:jn,open:Zn,reconvert:Bn,reconvertTip:Hn,files:Wn,threads:Vn,confirmCloseDialog:qn,confirmCloseDialogTitle:Gn,githubOpenSource:Kn,convertedImageUrlTooltip:Qn,copiedDataURLDialogTitle:Yn,copiedDataURLMessage:Jn,convertedImageDataUrlTooltip:Xn,convertAgain:ea,status:ta,settings:na,disabled:aa,Download:oa,reset:la,back:ia,failed:sa,success:ra,previousVersion:ua,height:da,width:ca,checkboxTextDontShowThis:pa,loadfolderNotifyingTitle:fa,OK:ga,loadfolderNotifyingMessage:ma,loadfolderNotifyingMessageTerm2:va,Continue:ha,Cancel:_a,loadfolderNotifyingMessageTerm1:ya,annotationOutOfMemory:wa,errMsgWorkerLoadError:ba,Reload:xa},Ci=Object.freeze(Object.defineProperty({__proto__:null,Cancel:_a,Continue:ha,Download:oa,OK:ga,Reload:xa,aborted:Fn,annotationOutOfMemory:wa,avifUnsupported:Nn,back:ia,cancel:Dn,checkboxTextDontShowThis:pa,close:jn,completed:On,confirmCloseDialog:qn,confirmCloseDialogTitle:Gn,convertAgain:ea,convertedImageDataUrlTooltip:Xn,convertedImageUrlTooltip:Qn,copiedDataURLDialogTitle:Yn,copiedDataURLMessage:Jn,default:ka,descriptions:kn,disabled:aa,droptarget:xn,editAcceptTypes:In,errMsgWorkerLoadError:ba,failed:sa,fileTypeRadioOptions:Tn,fileTypeRadioTitle:zn,files:Wn,flags:yn,githubOpenSource:Kn,height:da,incomplete:Mn,interfered:Un,lang:_n,loadbutton:Sn,loadbuttontooltip:Ln,loadfolderNotifyingMessage:ma,loadfolderNotifyingMessageTerm1:ya,loadfolderNotifyingMessageTerm2:va,loadfolderNotifyingTitle:fa,loadfolderbutton:Cn,loadfoldertooltip:$n,metaDescription:bn,noimage:Pn,open:Zn,previousVersion:ua,processing:En,reconvert:Bn,reconvertTip:Hn,reset:la,save:Rn,selectLanguage:An,settings:na,status:ta,success:ra,threads:Vn,title:wn,width:ca},Symbol.toStringTag,{value:"Module"})),$i="Chinese",Ei="Ukrainian",Fi="Turkish",Mi="Russian",Oi="Portuguese",Ui="Polish",Pi="Dutch",Ni="Korean",Di="Japanese",Ri="Italian",ji="Indonesian",Zi="Hindi",Bi="French",Hi="Spanish",Wi="English",Vi="German",qi="Arabic",Gi={zh:$i,"zh-hant":"Chinese(hant)",uk:Ei,tr:Fi,ru:Mi,pt:Oi,pl:Ui,nl:Pi,ko:Ni,ja:Di,it:Ri,id:ji,hi:Zi,fr:Bi,es:Hi,en:Wi,de:Vi,ar:qi},st=[],Aa={en:ka},$t={},Wt=Object.assign({"./locales/ar.json":()=>me(()=>import("./ar-DLZu9ubl.js"),[]),"./locales/de.json":()=>me(()=>import("./de-CNUg5Ibi.js"),[]),"./locales/en.json":()=>me(()=>Promise.resolve().then(()=>Ci),void 0),"./locales/es.json":()=>me(()=>import("./es-CrsuhTtQ.js"),[]),"./locales/fr.json":()=>me(()=>import("./fr-DeGnHJ5W.js"),[]),"./locales/hi.json":()=>me(()=>import("./hi-BA3LZ7gs.js"),[]),"./locales/id.json":()=>me(()=>import("./id-fmBzUe6Z.js"),[]),"./locales/it.json":()=>me(()=>import("./it-BW3e4zoU.js"),[]),"./locales/ja.json":()=>me(()=>import("./ja-BxiQ4Zk4.js"),[]),"./locales/ko.json":()=>me(()=>import("./ko-B8I5QOAs.js"),[]),"./locales/nl.json":()=>me(()=>import("./nl-58gtY7tV.js"),[]),"./locales/pl.json":()=>me(()=>import("./pl-BawPLRR2.js"),[]),"./locales/pt.json":()=>me(()=>import("./pt-DIvIz0A0.js"),[]),"./locales/ru.json":()=>me(()=>import("./ru-CKWNK5Qt.js"),[]),"./locales/tr.json":()=>me(()=>import("./tr-BHClc7lz.js"),[]),"./locales/uk.json":()=>me(()=>import("./uk-BGrZNfum.js"),[]),"./locales/zh-hant.json":()=>me(()=>import("./zh-hant-CWa6mvOr.js"),[]),"./locales/zh.json":()=>me(()=>import("./zh-DqTTpF8f.js"),[])});var Vt;for(const a in Wt){const l=(Vt=a.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:Vt[1];l&&(st.push(l),!(l in Aa)&&($t[l]=Wt[a]))}let bt=Qi();bt in $t||(bt="en");const rt=mo({legacy:!1,globalInjection:!0,locale:bt,fallbackLocale:"en",messages:Aa,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Ki(a){if(rt.global.availableLocales.indexOf(a)>=0)return;const l=await $t[a]();rt.global.setLocaleMessage(a,l),await Xe()}function Qi(){const a=location.pathname;return String(a.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Yi=["innerHTML"],Ji=be({__name:"switch-lang",emits:["lang-ready","lang-change"],async setup(a,{emit:l}){let f,o;const s=qe(Pe),r=Gt(),{locale:i,t:p}=Fe(),z=l,k=Object.entries(Gi).map(([m,E])=>({label:E,value:m}));k.sort((m,E)=>{const T=m.label,x=E.label;return T>x?1:T<x?-1:0}),$e(()=>{r.afterEach((m,E,T)=>{c(),s.switchToolTipVisibility()})}),Xt(async()=>{}),[f,o]=vo(()=>c()),await f,o();async function A(m){(m!==i.value||rt.global.availableLocales.indexOf(m)===-1)&&(z("lang-change",m),await Ki(m),i.value=m,document.title=p("title"),await Xe()),z("lang-ready",m)}async function c(){const m=r.currentRoute.value.path||"",E=String(m.match(new RegExp("(?<=^\\/)[^/]+"))||"");E&&st.includes(E)?(await A(E),i.value=E):await $()}async function $(){const m=y().toLowerCase(),E=m.split(/[-_]/)[0];if(st.includes(E)){let T=E;if(E==="zh")switch(m){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":T="zh-hant"}await A(T)}}function y(){const m=window.navigator;return m.language||m.userLanguage||m.browserLanguage}function g(m){r.push("/"+m+"/")}return(m,E)=>{const T=ye,x=rn,O=ze;return M(),G(O,{to:!1,"display-directive":"show",show:e(s).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(s).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:t(()=>[n(x,{ref:"langselect",size:"tiny",style:{width:"100%"},"consistent-menu-width":!1,options:e(k),"_v-model:value":"locale",value:e(i),"onUpdate:value":g},{arrow:t(()=>[n(T,null,{default:t(()=>[n(e(ho))]),_:1})]),_:1},8,["options","value"])]),default:t(()=>[h("div",{innerHTML:m.$t("selectLanguage")},null,8,Yi)]),_:1},8,["show","placement"])}}}),Xi=h("span",null,"CONVERT TO👇",-1),Pe=Symbol("global variables"),es=be({__name:"Avif2Jpeg",emits:["ready"],setup(a,{emit:l}){Fe();const f=l,o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),s=_(null),r=_(2);let i=_(void 0);const p=_(!0),z=_(!1),k=_(!1),A=_(!1),c=_(!1);_o(Pe,{showTooltipsBeforeMounted:i,LANDSCAPE:p,IS_SP:o,switchToolTipVisibility:T,SSR:!1}),$e(()=>{x(),window.addEventListener("resize",x),T(),setTimeout(()=>k.value=!0,3e3)});const $=200;let y=0,g=!0;function m(){A.value=!1,y=Date.now()}function E(){const b=g?0:Math.max(0,$-(Date.now()-y));g=!1,setTimeout(()=>A.value=!0,b),f("ready")}async function T(){}function x(){const b=document.body.clientWidth,v=document.body.clientHeight;p.value=b*.75>v||b>900}function O(b){s.value=b}function F(b){c.value=b}return(b,v)=>{const L=Le,ee=ye,V=ot,ce=Ge;return M(),G(ce,{vertical:"",align:"stretch",justify:"start",style:{height:"100%",position:"relative"}},{default:t(()=>[n(Ro,null,{"lang-switch":t(()=>[(M(),G(yo,null,{default:t(()=>[n(Ji,{onLangChange:m,onLangReady:E})]),_:1}))]),_:1}),n(Ze,{name:"fade"},{default:t(()=>[e(A)?(M(),G(ce,{key:0,vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:t(()=>[n(Bo),n(L,{justify:"center"},{default:t(()=>[n(gi,{expanded:e(H).expandExtButtons,"onUpdate:expanded":v[0]||(v[0]=U=>e(H).expandExtButtons=U),target:e(H).acceptTypeValue,"onUpdate:target":v[1]||(v[1]=U=>e(H).acceptTypeValue=U),userExtensions:e(H).editedAcceptTypes,"onUpdate:userExtensions":v[2]||(v[2]=U=>e(H).editedAcceptTypes=U),"disable-notifying-folder-select":e(H).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":v[3]||(v[3]=U=>e(H).disableNotifyingFolderSelect=U),forbidden:e(z),onInput:O,onClick:v[4]||(v[4]=U=>F(!0)),onCancel:v[5]||(v[5]=U=>F(!1))},null,8,["expanded","target","userExtensions","disable-notifying-folder-select","forbidden"])]),_:1}),n(Vl,{input:e(s),format:e(H).imageFormat,quality:e(H).imageQuality,"retain-extension":e(H).retainExtension,maxZipSizeMB:e(H).maxZipSizeMB,threads:e(H).multithread?e(H).threadCount:0,"show-note":e(c),"onUpdate:showNote":v[6]||(v[6]=U=>Ce(c)?c.value=U:null),onStart:v[7]||(v[7]=U=>z.value=!0),onEnd:v[8]||(v[8]=U=>z.value=!1),onMultiThreadCount:v[9]||(v[9]=U=>r.value=U)},null,8,["input","format","quality","retain-extension","maxZipSizeMB","threads","show-note"]),n(L,{vertical:"",align:"center"},{default:t(()=>[n(V,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(ee,{size:"4vh",color:"#DADADA",style:{margin:"0px"}},{default:t(()=>[n(e(wo))]),_:1})]),default:t(()=>[Xi]),_:1})]),_:1}),n(L,{vertical:"",align:"center"},{default:t(()=>[n(vi,{format:e(H).imageFormat,"onUpdate:format":v[10]||(v[10]=U=>e(H).imageFormat=U),quality:e(H).imageQuality,"onUpdate:quality":v[11]||(v[11]=U=>e(H).imageQuality=U)},null,8,["format","quality"]),n(xi,{"retain-ext":e(H).retainExtension,"onUpdate:retainExt":v[12]||(v[12]=U=>e(H).retainExtension=U),"use-folder-name-for-zip":e(H).useFolderNameForZip,"onUpdate:useFolderNameForZip":v[13]||(v[13]=U=>e(H).useFolderNameForZip=U),"max-zip-size":e(H).maxZipSizeMB,"onUpdate:maxZipSize":v[14]||(v[14]=U=>e(H).maxZipSizeMB=U),expanded:e(H).expandAdvSettings,"onUpdate:expanded":v[15]||(v[15]=U=>e(H).expandAdvSettings=U),multithread:e(H).multithread,"onUpdate:multithread":v[16]||(v[16]=U=>e(H).multithread=U),"thread-count":e(H).threadCount,"onUpdate:threadCount":v[17]||(v[17]=U=>e(H).threadCount=U),"thread-max":e(r)||0,"shrink-image":e(H).shrinkImage,"onUpdate:shrinkImage":v[18]||(v[18]=U=>e(H).shrinkImage=U),"max-width":e(H).maxWidth,"onUpdate:maxWidth":v[19]||(v[19]=U=>e(H).maxWidth=U),"max-height":e(H).maxHeight,"onUpdate:maxHeight":v[20]||(v[20]=U=>e(H).maxHeight=U)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","expanded","multithread","thread-count","thread-max","shrink-image","max-width","max-height"])]),_:1}),n(Ii)]),_:1})):de("",!0)]),_:1})]),_:1})}}}),Et=be({__name:"App",setup(a){const l={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{color:"#000000AA"},Image:{toolbarColor:"#00000099"}},f=_(!0);return $e(()=>{f.value=!1}),(o,s)=>{const r=xo,i=ko,p=Ao,z=zo,k=To,A=bo;return M(),G(A,{"theme-overrides":l,style:{width:"100%",height:"100%"}},{default:t(()=>[n(k,null,{default:t(()=>[n(z,{placement:"top-right",max:20},{default:t(()=>[n(p,{placement:"top-left",closable:!0,max:50},{default:t(()=>[n(i,null,{default:t(()=>[n(r,null,{default:t(()=>[n(es,{class:et({hide:e(f)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),za=[{path:"/",name:"Home",component:Et}];for(const a of st)za.push({path:"/"+a+"/",strict:!0,name:a,component:Et});Io(Et,{routes:za,base:"/avif2jpeg/dist/"},({app:a,router:l,routes:f,isClient:o,initialState:s})=>{a.use(rt)});
