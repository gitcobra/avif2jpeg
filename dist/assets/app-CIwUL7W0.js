var Oa=Object.defineProperty;var Ma=(i,s,u)=>s in i?Oa(i,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):i[s]=u;var ut=(i,s,u)=>Ma(i,typeof s!="symbol"?s+"":s,u);import{m as ot,c as q,o as I,a as y,d as ye,u as mn,r as v,b as Oe,w as be,e as t,n as fe,f as $e,g as We,h as Te,i as J,_ as kt,j as e,k as st,l as me,p as Ce,q as n,N as Ct,s as L,t as d,F as Pe,v as it,B as Fe,x as je,y as vn,T as Tt,z as ze,A as Ae,C as Ie,D as $t,E as at,L as Ua,G as Ra,H as le,I as lt,J as Ba,K as Na,M as hn,O as Zt,P as yn,Q as Ht,R as Se,S as ja,U as Bt,V as et,W as Za,X as Ha,Y as Ge,Z as Wt,$ as ct,a0 as qe,a1 as _n,a2 as Ke,a3 as wn,a4 as pt,a5 as Ft,a6 as dt,a7 as At,a8 as Wa,a9 as nt,aa as Va,ab as Jt,ac as en,ad as bn,ae as qa,af as Et,ag as Ga,ah as Ka,ai as kn,aj as Qa,ak as tn,al as ft,am as Xa,an as zn,ao as Ya,ap as Pt,aq as Ja,ar as el,as as tl,at as Nt,au as Sn,av as nl,aw as Cn,ax as Tn,ay as ol,az as al,aA as ll,aB as Vt,aC as An,aD as sl,aE as xn,aF as In,aG as qt,aH as il,aI as Ln,aJ as rl,aK as ul,aL as vt,aM as ht,aN as cl,aO as dl,aP as pl,aQ as fl,aR as gl,aS as ml,aT as nn,aU as vl,aV as hl,aW as yl,aX as _l,aY as wl,aZ as bl,a_ as kl,a$ as zl,b0 as Sl,b1 as Cl,b2 as Tl,b3 as Al,b4 as xl}from"./vendor-D3o1LRaX.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function u(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(o){if(o.ep)return;o.ep=!0;const a=u(o);fetch(o.href,a)}})();const Il={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ll(i,s){return I(),q("svg",Il,s[0]||(s[0]=[y("path",{fill:"currentColor",d:"m12 13.4l-4.9 4.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.9-4.9l-4.9-4.9q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l4.9 4.9l4.9-4.9q.275-.275.7-.275t.7.275t.275.7t-.275.7L13.4 12l4.9 4.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275z"},null,-1)]))}const $l=ot({name:"material-symbols-close-rounded",render:Ll}),Fl=["width","height"],El={key:1,class:"error"},Pl=["height"],Dl=ye({__name:"canvas-thumbnail",props:{source:{},width:{},height:{},fit:{}},setup(i,{expose:s,emit:u}){const l=i;s({}),mn();const o=z(),a=v(!1),r=v(),c=v(100),f=v(100);let w,k;Oe(async()=>{await o?w=r.value.getContext("bitmaprenderer"):k=r.value.getContext("2d"),be(()=>l.source,async p=>{a.value=!1,await o?m(p):C(p)},{immediate:!0})});async function z(){if(typeof window.createImageBitmap!="function"||/firefox/i.test(navigator.userAgent))return!1;const p=new ImageData(1,1);try{return(await createImageBitmap(p,{resizeWidth:1})).close(),!0}catch{return!1}}async function m(p){try{let $,_,g;p instanceof Blob?(g=await createImageBitmap(p,{resizeWidth:Math.max(200,l.width),resizeQuality:"pixelated"}),{width:$,height:_}=g,p=g):p instanceof VideoFrame?($=p.displayWidth,_=p.displayHeight):{width:$,height:_}=p;const{tw:S,th:h,cropx:A,cropy:M,cropw:P,croph:B}=F($,_,l.width,l.height),ee=await createImageBitmap(p,A,M,P,B,{resizeWidth:S,resizeHeight:h,resizeQuality:"pixelated"});c.value=S,f.value=h,r.value.style.width=S+"px",r.value.style.height=h+"px",w.transferFromImageBitmap(ee),g&&g.close()}catch{a.value=!0}}async function C(p){let $;if(p instanceof Blob){const ee=URL.createObjectURL(p);$=new Image,await new Promise(K=>{$.onload=$.onerror=K,$.src=ee,setTimeout(K,1e4)}).finally(()=>{}),$.complete,p=$,URL.revokeObjectURL(ee)}else if(p instanceof ImageData||p instanceof VideoFrame||p instanceof SVGElement)return;const{width:_,height:g}=p,{tw:S,th:h,sx:A,sy:M,sw:P,sh:B}=F(_,g,l.width,l.height);r.value.width=S,r.value.height=h,r.value.style.width=S+"px",r.value.style.height=h+"px",k.drawImage(p,A,M,P,B),$&&($.src="",$=null)}function F(p,$,_,g){const S=p/$,h=_/g;let A,M,P=0,B=0,ee=p,K=$,U=0,T=0,ae=0,ue=0;return S>h?(M=g,A=M*S,P=(A-_)/2*(p/A),ee=_*(p/A),ue=g,ae=g*S,U=-(ae-_)/2):(A=_,M=A/S,B=(M-g)/2*($/M),K=g*($/M),ae=_,ue=_/S,T=-(ue-g)/2),{tw:_,th:g,cropx:P,cropy:B,cropw:ee,croph:K,sx:U,sy:T,sw:ae,sh:ue}}return(p,$)=>t(a)?(I(),q("div",El,[(I(),q("svg",{xmlns:"http://www.w3.org/2000/svg",style:fe({width:Math.min(p.width,p.height)+"px"}),height:Math.min(p.width,p.height),viewBox:"0 0 32 32"},$[0]||($[0]=[y("path",{fill:"currentColor",d:"M2 16A14 14 0 1 0 16 2A14 14 0 0 0 2 16m23.15 7.75L8.25 6.85a12 12 0 0 1 16.9 16.9M8.24 25.16a12 12 0 0 1-1.4-16.89l16.89 16.89a12 12 0 0 1-15.49 0"},null,-1)]),12,Pl))])):(I(),q("canvas",{key:0,ref_key:"canvas",ref:r,width:t(c),height:t(f)},null,8,Fl))}}),Me=(i,s)=>{const u=i.__vccOpts||i;for(const[l,o]of s)u[l]=o;return u},Ol=Me(Dl,[["__scopeId","data-v-14a1f9fe"]]);function He(i,s=2){const u=Math.sign(i);i=Math.abs(i);const l=["Bytes","KB","MB","GB"],o=i?Math.floor(Math.log(i)/Math.log(1024)):0;return`${(i/Math.pow(1024,o)*u).toFixed(s)}${l[o]}`}function $n(i,s=100,u=!1){s=typeof s=="number"?{width:s,height:s}:s;const{width:l,height:o}=s;let{width:a,height:r}=i;const c=a/r,f=l/o;return c>=f?(a=u?Math.min(l,a):l,r=a/c|0):(r=u?Math.min(o,r):o,a=r*c|0),{width:a,height:r}}class Ml{constructor(){ut(this,"_currentFileCount",0);ut(this,"_currentZipIndex",0);ut(this,"_totalFileCount",0);ut(this,"_zipLengthSumList",[]);ut(this,"_pathBank",{})}increase(s){return s&&(this._pathBank[s]=[this._zipLengthSumList.length,this._currentFileCount]),this._currentFileCount++,this._totalFileCount++}split(){this._zipLengthSumList.push(this._totalFileCount),this._currentZipIndex++,this._currentFileCount=0}get(s){if(typeof s=="number"){let u=this._zipLengthSumList.findIndex((a,r)=>s<a);u===-1&&(u=this._zipLengthSumList.length);const l=this._zipLengthSumList[u-1]||0,o=s-l;return[u,o]}else{const u=this._pathBank[String(s)];if(u)return u}return null}getZipIndex(){return this._currentZipIndex}getIndex(){return this._totalFileCount}}function Ul(i){return new Promise(s=>setTimeout(s,i))}function Rl(i,s=0,u,l){i.value=u;const o=setTimeout(()=>{i.value=!0},s);return()=>clearTimeout(o)}function Bl(i,s=0){const u=v(i);return be(u,l=>{l!==void 0&&$e(()=>{setTimeout(()=>u.value=void 0,s)})},{immediate:!0}),u}const Fn=ye({__name:"prompt-on-dup",props:We({preset:{default:"dialog"},title:{},content:{},type:{},show:{type:Boolean},buttons:{},defaultButtons:{},closable:{type:Boolean},draggable:{type:Boolean},closeOnEsc:{type:Boolean},maskClosable:{type:Boolean},showApplyAll:{type:Boolean},labelApplyAll:{default:"Apply this action to all"}},{applyAllChecked:{type:Boolean},applyAllCheckedModifiers:{}}),emits:We(["start","close","applyAllChange"],["update:applyAllChecked"]),setup(i,{expose:s,emit:u}){const l=i,o=Te(i,"applyAllChecked"),a=u;s({start:m,click:$,close:C,isApplyAllChecked:S});const r=mn(),c={overwrite:"Overwrite",skip:"Skip",rename:"Rename",cancel:"Cancel"},f=v(),w=v(!1);let k,z;be(()=>l.show,(h,A)=>{h?m():C()},{immediate:l.show});function m(){f.value=F(),w.value=!0,z=void 0,o.value=!1;const h=new Promise(A=>{k=A});return a("start",h),h}function C(){w.value=!1;const h=z;return setTimeout(()=>{k(h),a("close",h)},50),z}function F(){const h=[];if(l.buttons)for(const A of l.buttons){let M,P;if(typeof A=="string"?M=P=A:A instanceof Array?([P,M]=A,typeof M>"u"&&(M=P)):A&&({key:M,label:P}=A),!M||!P)throw new Error("unexpected button item");h.push([P,M])}else(l.defaultButtons||["overwrite","skip","cancel"]).forEach(M=>{if(!(M in c))throw new Error(`${M} doen't exist in DEF_LABELS`);h.push([c[M],M])});return h}function p(h){return typeof h=="function"?h():h}function $(h){z=h,C()}function _(){z="close",C()}function g(h){a("applyAllChange",h)}function S(){return o.value}return(h,A)=>{const M=Fe,P=Ct,B=Ce,ee=kt;return I(),J(ee,{show:t(w),closable:h.closable,draggable:h.draggable,preset:h.preset,title:h.title,content:h.content,type:h.type,onClose:A[1]||(A[1]=K=>h.closable&&_()),onEsc:A[2]||(A[2]=K=>h.closeOnEsc&&_()),onMaskClick:A[3]||(A[3]=K=>h.maskClosable&&_())},{action:e(()=>[r.action?st(h.$slots,"action",{key:0}):(I(!0),q(Pe,{key:1},it(t(f),K=>(I(),J(M,{onClick:U=>$(typeof K[1]<"u"?K[1]:K[0])},{default:e(()=>[L(d(p(K[0])),1)]),_:2},1032,["onClick"]))),256))]),default:e(()=>[st(h.$slots,"default"),h.showApplyAll?(I(),J(B,{key:0,justify:"end",style:{padding:"1em","font-size":"0.8em"}},{default:e(()=>[n(P,{checked:o.value,"onUpdate:checked":A[0]||(A[0]=K=>o.value=K),onUpdateChecked:g},{default:e(()=>[L(d(h.labelApplyAll),1)]),_:1},8,["checked"])]),_:1})):me("",!0)]),header:e(()=>[st(h.$slots,"header")]),icon:e(()=>[st(h.$slots,"icon")]),close:e(()=>[st(h.$slots,"close")]),_:3},8,["show","closable","draggable","preset","title","content","type"])}}}),Nl={class:"list-label"},jl={class:"sum"},Zl={class:"size"},Hl={class:"files"},Wl={class:"path"},Vl=3,ql=ye({__name:"file-list",props:We({additionalFiles:{}},{"file-list":{required:!0},"file-listModifiers":{}}),emits:["update:file-list"],setup(i){const{t:s}=je(),u=i,l=Te(i,"file-list"),o=v([]),a=v(""),r=v(0),c=v(),f=v(!1),w=v(""),k=v([[()=>s("dupAction_replace"),"overwrite"],[()=>s("dupAction_skip"),"skip"],[()=>s("cancel"),"cancel"]]);Oe(()=>{be(()=>u.additionalFiles,async m=>{const C=new Map(l.value.map($=>[$.webkitRelativePath||$.name,$]));let F=!1,p="";for(const $ of m){const _=$.webkitRelativePath||$.name;if(C.has(_)){w.value=_;const g=p||await c.value.start();switch(!p&&f.value&&(p=g),g){case"overwrite":F=!0;break;case"cancel":return;case"skip":default:continue}}C.delete(_),C.set(_,$)}(C.size>l.value.length||F)&&(l.value=[...C.values()])}),be(()=>l.value[l.value.length-1],()=>{const m=l.value.slice(-3);for(const F of m){const p=F.name;o.value.push({file:F,name:p})}const C=Math.min(Vl,l.value.length);o.value.length>C&&(o.value=o.value.slice(-C)),a.value=He(l.value.reduce((F,p)=>F+p.size,0))})});function z(){l.value.length=0,o.value.length=0}return(m,C)=>{const F=vn,p=Ce,$=$l,_=Ae,g=Fe,S=ze;return I(),q("div",null,[n(p,{class:"container",justify:"stretch",align:"stretch",wrap:!1,size:1},{default:e(()=>[n(p,{class:"list-box",wrap:!1,size:0},{default:e(()=>[y("span",Nl,d(m.$t("SourceImageList")),1),n(p,{class:"list-status",vertical:"",size:4,align:"end",justify:"end"},{default:e(()=>[y("div",jl,d(m.$t("status.total")),1),y("div",Zl,d(t(a)),1),y("div",Hl,[n(F,{active:!0,duration:1e3,"show-separator":"",to:l.value.length,from:t(r),onFinish:C[0]||(C[0]=h=>r.value=l.value.length)},null,8,["to","from"]),L(" "+d(m.$t("files",l.value.length)),1)])]),_:1}),n(Tt,{name:"list"},{default:e(()=>[(I(!0),q(Pe,null,it(t(o),(h,A)=>(I(),J(Ol,{key:h.file._id,source:h.file,width:67,height:100,class:"image-item"},null,8,["source"]))),128))]),_:1})]),_:1}),n(p,{class:"button-box",align:"center",justify:"center"},{default:e(()=>[n(S,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,delay:100},{trigger:e(()=>[n(g,{class:"close-button",bordered:!1,color:"gray",ghost:"",size:"tiny",onClick:C[1]||(C[1]=h=>z())},{default:e(()=>[n(p,{vertical:"",align:"center"},{default:e(()=>[n(_,{size:"1.6em"},{default:e(()=>[n($)]),_:1}),y("span",null,d(m.$t("reset")),1)]),_:1})]),_:1})]),default:e(()=>[L(d(m.$t("resetListButtonTooltip")),1)]),_:1})]),_:1})]),_:1}),n(Fn,{ref_key:"promptdup",ref:c,closable:"",buttons:t(k),"close-on-esc":"","show-apply-all":"","label-apply-all":m.$t("confirmApplyAllLabel"),"apply-all-checked":t(f),"onUpdate:applyAllChecked":C[2]||(C[2]=h=>Ie(f)?f.value=h:null)},{header:e(()=>[L(d(m.$t("confirmListOverwrite")),1)]),default:e(()=>[y("div",null,d(m.$t("confirmListOverwriteMsg")),1),y("p",Wl,d(t(w)),1)]),_:1},8,["buttons","label-apply-all","apply-all-checked"])])}}}),Gl=Me(ql,[["__scopeId","data-v-3209b149"]]),Kl=10,Be=v(navigator.hardwareConcurrency?Math.min(navigator.hardwareConcurrency,Kl):0),yt={threadCount:{min:2,max:Math.max(2,Be.value)}},Ql={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:Be.value,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1,changeLogCheckedDate:0,lang:"",autoStartConversion:!1,outputMethod:"zip",actionOnDuplicate:"prompt"},Xl=["outputMethod","actionOnDuplicate"],W=$t(En({}));function Yl(){En(W)}function En(i){return Object.assign(i,Ql)}const Pn="avif2jpeg",Dt=JSON.parse(localStorage.getItem(Pn)||"{}");for(const i in W)if(Dt.hasOwnProperty(i)&&Dt[i]!==void 0){let s=Dt[i];yt.hasOwnProperty(i)&&(yt[i].min>s&&(s=yt[i].min),yt[i].max<s&&(s=yt[i].max)),W[i]=s}function Dn(){const i={};for(const s in W)Xl.includes(s)||(i[s]=W[s]);localStorage.setItem(Pn,JSON.stringify(i))}window.addEventListener("beforeunload",Dn);function Jl(){localStorage.clear(),window.removeEventListener("beforeunload",Dn)}const es={href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-weight":"bolder"}},ts=ye({__name:"github",setup(i){const s=at(Qe);return(u,l)=>{const o=Ae,a=Ce,r=ze;return I(),J(r,{to:!1,"display-directive":"show",show:t(s).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:e(()=>[y("a",es,[n(a,{align:"center",size:0},{default:e(()=>[n(o,{size:"1.2em"},{default:e(()=>[n(t(Ua))]),_:1}),l[0]||(l[0]=L("GitHub "))]),_:1,__:[0]})])]),default:e(()=>[L(" "+d(u.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),ns=["href"],os=ye({__name:"licenses",setup(i){const s=v(!1),u={Vue:"https://github.com/vuejs/core/blob/main/LICENSE",Vite:"https://github.com/vitejs/vite/blob/main/LICENSE","Vite SSG":"https://github.com/antfu/vite-ssg/blob/main/LICENSE","Naive UI":"https://github.com/TuSimple/naive-ui/blob/main/LICENSE",Ionicons:"https://github.com/ionic-team/ionicons/blob/main/LICENSE"};return(l,o)=>{const a=Fe;return I(),q(Pe,null,[n(a,{text:"",onClick:o[0]||(o[0]=r=>s.value=!0),style:{color:"black","font-size":"small"}},{default:e(()=>o[2]||(o[2]=[L("Licenses")])),_:1,__:[2]}),n(t(kt),{preset:"dialog",ref:"dialog",show:s.value,"onUpdate:show":o[1]||(o[1]=r=>s.value=r),"positive-text":"OK",title:"Licenses"},{default:e(()=>[o[3]||(o[3]=y("h3",null,"Frameworks and Libraries",-1)),y("ul",null,[(I(),q(Pe,null,it(u,(r,c)=>y("li",null,[y("a",{href:r},d(c),9,ns)])),64))]),o[4]||(o[4]=y("h3",null,"App icon",-1)),o[5]||(o[5]=y("div",null,[L(" The app icon is derived from "),y("a",{href:"https://aomediacodec.github.io/av1-avif/"},"AVIF logo"),L(". ")],-1))]),_:1,__:[3,4,5]},8,["show"])],64)}}}),as=1,ls=12,ss=3,is="",zt={major:as,minor:ls,build:ss,tag:is},rs={style:{"font-size":"x-small","user-select":"none"}},us=ye({__name:"version",setup(i){const s=["0.0.118"],u=`${zt.major}.${zt.minor}.${zt.build}${zt.tag}`,l=s.map(c=>({label:`v${c}`,key:c,value:c}));function o(c){const{key:f,label:w}=c,k=r(f),z=le("a",{href:k},w),m=le("div",null,z);return le("div",null,m)}function a(c){location.href=r(c)}function r(c){return`/avif2jpeg/old/${c}/`}return(c,f)=>{const w=Ra;return I(),J(w,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:t(l),"render-label":o,"onUpdate:value":a},{header:e(()=>[y("span",rs,d(c.$t("previousVersion")),1)]),default:e(()=>[y("span",{style:{cursor:"pointer"}},"v"+d(u))]),_:1},8,["options"])}}}),cs={key:0,style:{color:"red"}},ds=["innerHTML"],ps=ye({__name:"changelog",props:{url:{}},setup(i){const s=i,u=v("fetching..."),l=v(!1);Oe(()=>a(s.url));let o=0;async function a(c){const f=await fetch(c,{headers:{Accept:"application/vnd.github.v3+json"}}).then(w=>w.ok?w.text():null);u.value="",f&&(u.value=f.replace(/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2}) \+\d+$/mg,(w,k)=>{const z=new Date(w),m=z.getTime(),C=z.toLocaleString();let F="";return m>W.changeLogCheckedDate&&(l.value=!0,m>o&&(o=m),F="update"),`<span class="date ${F}">${C}</span>`}))}function r(){o>W.changeLogCheckedDate&&(W.changeLogCheckedDate=o),l.value=!1}return(c,f)=>{const w=Ae,k=Ce,z=lt;return I(),J(z,{trigger:"click",placement:"bottom","arrow-point-to-center":"","onUpdate:show":r,style:{"margin-left":"-1em","max-width":"80%","white-space":"initial"}},{trigger:e(()=>[n(k,{align:"center",size:1,style:{cursor:"pointer"}},{default:e(()=>[n(w,{component:t(Ba),size:"1.5em",color:t(l)?"blue":"silver",style:{transition:"color 0.5s"}},null,8,["component","color"]),L(" "+d(c.$t("changelog")),1)]),_:1})]),default:e(()=>[t(u)?(I(),q("pre",{key:1,innerHTML:t(u),class:"commits"},null,8,ds)):(I(),q("div",cs," connection error "))]),_:1})}}}),fs="modulepreload",gs=function(i){return"/avif2jpeg/dist/"+i},on={},xe=function(s,u,l){let o=Promise.resolve();if(u&&u.length>0){let r=function(w){return Promise.all(w.map(k=>Promise.resolve(k).then(z=>({status:"fulfilled",value:z}),z=>({status:"rejected",reason:z}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));o=r(u.map(w=>{if(w=gs(w),w in on)return;on[w]=!0;const k=w.endsWith(".css"),z=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${w}"]${z}`))return;const m=document.createElement("link");if(m.rel=k?"stylesheet":fs,k||(m.as="script"),m.crossOrigin="",m.href=w,f&&m.setAttribute("nonce",f),document.head.appendChild(m),k)return new Promise((C,F)=>{m.addEventListener("load",C),m.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${w}`)))})}))}function a(r){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=r,window.dispatchEvent(c),!c.defaultPrevented)throw r}return o.then(r=>{for(const c of r||[])c.status==="rejected"&&a(c.reason);return s().catch(a)})},On="English",Mn="🇬🇧",Un='AVIF to JPEG "Offline" Batch Converter',Rn="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",Bn=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.',"Use this app at your own risk."],Nn="Select your language",jn="Choose Target File Extentions",Zn={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},Hn="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",Wn="Select your images from a dialog window.<br>*Multiple selection allowed.",Vn=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,qn="Converting images",Gn="Aborted",Kn="Some files failed to convert",Qn="Completed",Xn="Currently Busy",Yn="No files with the extentions were found.",Jn="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",eo="Cancel",to="Save",no="Close",oo="Open",ao="Re-convert",lo="Convert previous selected {n} @:files again",so="File | Files",io="thread | threads",ro="You have not saved the converted images yet.",uo="Data have not been saved",co="Open Source",po="Open the converted image",fo="Copied to clipboard",go="The converted image was copied to your clipboard as DataURL.",mo="Copy the converted image as DataURL",vo="Convert Again",ho={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",showOnlyErrors:"Show only errors",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files",Shrinked:"Shrinked",Shrinking:"Shrinking",saveAll:"Save All",progressRetries:"Retrying files",success:"success",started:"started",total:"total",files:"files",failure:"failure",all:"all",filterLogSelect:"filter",showOnlySuccess:"Only successes",showOnlyError:"Only errors",showAll:"Show all",Progress:"Progress",PreviewImage:"Preview Images",Log:"Log",log:"Log",Output:"Output Results",expandLog:"expand log size",autoScroll:"auto-scroll",sortByStatus:"status",sort:"Sort list by",sortByName:"name",sortBySize:"size",sortByOutputSize:"size(output)",sortByStart:"starting order",sortByCompletion:"output order",outputToDir:"Export to Folder",numberOfFilesWrittenToDir:"Number of files written to the folder"},yo={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file",useFileSystemAPI:"Directly write output files to the local folder",autoStartConversion:"Automatically start conversion after loading images",outputFolderDenied:"Output folder selection was canceled",saveAsZIP:"Save as a ZIP File",changeSaveMethod:"Change Save Method",chooseOutputFolder:"Choose an output folder",saveToSpecifiedFolder:"Write to Selected Folder Directly",actionOnDuplicate:"Action on Duplicate",autoStartConversionTooltip:"Conversion will start automatically after images are loaded. The list is reset each time you load images.",chooseOutputFolderTooltip:"No output folder selected.",outputType:"Output Type",outputQuality:"Output Quality"},_o="Disabled",wo="Download",bo="Reset",ko="Back",zo="Failed",So="Success",Co="Previous version",To=`
Height`,Ao="Width",xo="Don't show this message again",Io="About the warning when selecting a folder",Lo="OK",$o={},Fo="You must press the “Upload” button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",Eo="Continue",Po="Cancel",Do="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",Oo="This page may be an outdated version. Please reload the page.",Mo="Reload",Uo='If the conversion process frequently fails and an “Out of Memory” message appears, try reducing or disabling the number of "multi-threads" in the "Advanced Settings".',Ro="Next",Bo="Previous",No="or",jo="Source Image Extensions",Zo="Changelog",Ho="Choose source image extensions",Wo="Drag & Drop AVIF Images to Convert",Vo="Or just drag & drop",qo="Install as App",Go='Installing allows you to launch this web app directly from desktop icons or other shortcuts. The security level is the same as a regular web page, so it remains safe. For more details, please see <a href="https://support.google.com/chrome/answer/9658361">Google’s support page</a>.',Ko="Use the browser’s language setting",Qo="Installed as an app",Xo="A new version of the page is available. Click the Reload button to update.",Yo="Start Conversion",Jo="Default",ea="Add Images",ta="Add Entire Folder",na="Source Image List",oa="Clear the current list of source images",aa="Click here to start conversion",la="experimental",sa="Show confirmation dialog",ia="Overwrite",ra="Skip",ua="Confirm List Overwrite",ca="This path already exists in the list.",da="Replace",pa="Output folder not specified.",fa="Apply this action to all",ga="A {type} with the same name already exists.",ma="file",va="folder",ha="Overwrite Confirmation",ya="Load source images first",_a="Converted images will be saved to the folder below.",wa="This feature is experimental. Continue only if it is acceptable to lose data in the output folder.",ba="Images will be written directly to folder",ka="Restore all settings to default",za={lang:On,flags:Mn,title:Un,metaDescription:Rn,descriptions:Bn,selectLanguage:Nn,fileTypeRadioTitle:jn,fileTypeRadioOptions:Zn,editAcceptTypes:Hn,loadbuttontooltip:Wn,loadfoldertooltip:Vn,processing:qn,aborted:Gn,incomplete:Kn,completed:Qn,interfered:Xn,noimage:Yn,avifUnsupported:Jn,cancel:eo,save:to,close:no,open:oo,reconvert:ao,reconvertTip:lo,files:so,threads:io,confirmCloseDialog:ro,confirmCloseDialogTitle:uo,githubOpenSource:co,convertedImageUrlTooltip:po,copiedDataURLDialogTitle:fo,copiedDataURLMessage:go,convertedImageDataUrlTooltip:mo,convertAgain:vo,status:ho,settings:yo,disabled:_o,Download:wo,reset:bo,back:ko,failed:zo,success:So,previousVersion:Co,height:To,width:Ao,checkboxTextDontShowThis:xo,loadfolderNotifyingTitle:Io,OK:Lo,loadfolderNotifyingMessage:$o,loadfolderNotifyingMessageTerm2:Fo,Continue:Eo,Cancel:Po,loadfolderNotifyingMessageTerm1:Do,errMsgWorkerLoadError:Oo,Reload:Mo,annotationOutOfMemory:Uo,Next:Ro,Prev:Bo,or:No,TargetFileTypeExt:jo,changelog:Zo,TargetFileTypeExtTooltip:Ho,droptargetTooltip:Wo,droptargetLabel:Vo,installAsApp:qo,PWAinstallAsAppTooltip:Go,selectLangCloseTooltip:Ko,PWAInstalledTooltip:Qo,PWAUpdateMessage:Xo,StartConversion:Yo,Default:Jo,loadbutton:ea,loadfolderbutton:ta,SourceImageList:na,resetListButtonTooltip:oa,convertTooltip:aa,experimental:la,dupAction_prompt:sa,dupAction_overwrite:ia,dupAction_skip:ra,confirmListOverwrite:ua,confirmListOverwriteMsg:ca,dupAction_replace:da,errMsgOutputDirNotFound:pa,confirmApplyAllLabel:fa,confirmFileOverwriteMsg:ga,file:ma,folder:va,confirmFileOverwriteTitle:ha,convertUnpreparedTooltip:ya,warnAboutFileSysBeforeConversion1:_a,warnAboutFileSysBeforeConversion2:wa,warnAboutFileSysTitle:ba,warnAboutResetMsg:ka},ms=Object.freeze(Object.defineProperty({__proto__:null,Cancel:Po,Continue:Eo,Default:Jo,Download:wo,Next:Ro,OK:Lo,PWAInstalledTooltip:Qo,PWAUpdateMessage:Xo,PWAinstallAsAppTooltip:Go,Prev:Bo,Reload:Mo,SourceImageList:na,StartConversion:Yo,TargetFileTypeExt:jo,TargetFileTypeExtTooltip:Ho,aborted:Gn,annotationOutOfMemory:Uo,avifUnsupported:Jn,back:ko,cancel:eo,changelog:Zo,checkboxTextDontShowThis:xo,close:no,completed:Qn,confirmApplyAllLabel:fa,confirmCloseDialog:ro,confirmCloseDialogTitle:uo,confirmFileOverwriteMsg:ga,confirmFileOverwriteTitle:ha,confirmListOverwrite:ua,confirmListOverwriteMsg:ca,convertAgain:vo,convertTooltip:aa,convertUnpreparedTooltip:ya,convertedImageDataUrlTooltip:mo,convertedImageUrlTooltip:po,copiedDataURLDialogTitle:fo,copiedDataURLMessage:go,default:za,descriptions:Bn,disabled:_o,droptargetLabel:Vo,droptargetTooltip:Wo,dupAction_overwrite:ia,dupAction_prompt:sa,dupAction_replace:da,dupAction_skip:ra,editAcceptTypes:Hn,errMsgOutputDirNotFound:pa,errMsgWorkerLoadError:Oo,experimental:la,failed:zo,file:ma,fileTypeRadioOptions:Zn,fileTypeRadioTitle:jn,files:so,flags:Mn,folder:va,githubOpenSource:co,height:To,incomplete:Kn,installAsApp:qo,interfered:Xn,lang:On,loadbutton:ea,loadbuttontooltip:Wn,loadfolderNotifyingMessage:$o,loadfolderNotifyingMessageTerm1:Do,loadfolderNotifyingMessageTerm2:Fo,loadfolderNotifyingTitle:Io,loadfolderbutton:ta,loadfoldertooltip:Vn,metaDescription:Rn,noimage:Yn,open:oo,or:No,previousVersion:Co,processing:qn,reconvert:ao,reconvertTip:lo,reset:bo,resetListButtonTooltip:oa,save:to,selectLangCloseTooltip:Ko,selectLanguage:Nn,settings:yo,status:ho,success:So,threads:io,title:Un,warnAboutFileSysBeforeConversion1:_a,warnAboutFileSysBeforeConversion2:wa,warnAboutFileSysTitle:ba,warnAboutResetMsg:ka,width:Ao},Symbol.toStringTag,{value:"Module"})),vs="Arabic",hs="German",ys="English",_s="Spanish",ws="Finnish",bs="French",ks="Hindi",zs="Indonesian",Ss="Italian",Cs="Japanese",Ts="Korean",As="Dutch",xs="Polish",Is="Portuguese",Ls="Russian",$s="Turkish",Fs="Ukrainian",Es="Chinese",Ps={ar:vs,de:hs,en:ys,es:_s,fi:ws,fr:bs,hi:ks,id:zs,it:Ss,ja:Cs,ko:Ts,nl:As,pl:xs,pt:Is,ru:Ls,tr:$s,uk:Fs,"zh-hant":"Chinese(hant)",zh:Es},_t=[],Sa={en:za},Gt={},an=Object.assign({"./locales/ar.json":()=>xe(()=>import("./ar-Ikflx6l4.js"),[]),"./locales/de.json":()=>xe(()=>import("./de-c3czPvNh.js"),[]),"./locales/en.json":()=>xe(()=>Promise.resolve().then(()=>ms),void 0),"./locales/es.json":()=>xe(()=>import("./es-hmw6qoc9.js"),[]),"./locales/fi.json":()=>xe(()=>import("./fi-CieSZ_6-.js"),[]),"./locales/fr.json":()=>xe(()=>import("./fr-Ntr_VsJE.js"),[]),"./locales/hi.json":()=>xe(()=>import("./hi-CVEH8snI.js"),[]),"./locales/id.json":()=>xe(()=>import("./id-C0CTfUnd.js"),[]),"./locales/it.json":()=>xe(()=>import("./it-DBBMsFoD.js"),[]),"./locales/ja.json":()=>xe(()=>import("./ja-DUG1ANiW.js"),[]),"./locales/ko.json":()=>xe(()=>import("./ko-4BySyTdz.js"),[]),"./locales/nl.json":()=>xe(()=>import("./nl-C3a2ArPH.js"),[]),"./locales/pl.json":()=>xe(()=>import("./pl-BTfPrP5Q.js"),[]),"./locales/pt.json":()=>xe(()=>import("./pt-B2BJjkec.js"),[]),"./locales/ru.json":()=>xe(()=>import("./ru-DwH_JxLh.js"),[]),"./locales/tr.json":()=>xe(()=>import("./tr-lITmrr_t.js"),[]),"./locales/uk.json":()=>xe(()=>import("./uk-_A6jRv1V.js"),[]),"./locales/zh-hant.json":()=>xe(()=>import("./zh-hant-VL25lLo6.js"),[]),"./locales/zh.json":()=>xe(()=>import("./zh-iNdkdJOg.js"),[])});var gn;for(const i in an){const s=(gn=i.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:gn[1];s&&(_t.push(s),!(s in Sa)&&(Gt[s]=an[i]))}let jt=Os();jt in Gt||(jt="en");const xt=Na({legacy:!1,globalInjection:!0,locale:jt,fallbackLocale:"en",messages:Sa,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Ds(i){if(xt.global.availableLocales.indexOf(i)>=0)return!0;const s=await Gt[i]().catch(u=>{});return s?(xt.global.setLocaleMessage(i,s),await $e(),!0):!1}function Os(){const i=location.pathname;return String(i.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Ms=ye({__name:"header",setup(i){const s=hn(),{locale:u}=je();return(l,o)=>{const a=Zt("router-link"),r=Ce,c=yn;return I(),J(r,{vertical:"",justify:"start"},{default:e(()=>[n(r,{justify:"space-between",align:"center",wrap:!1},{default:e(()=>[n(r,{align:"center"},{default:e(()=>[n(ts),n(us),n(ps,{url:"/avif2jpeg/dist/commits.txt"}),n(os),n(r,{style:{"font-size":"1em"}},{default:e(()=>[t(s).path!=="/"?(I(),J(a,{key:0,to:"/",style:{color:"black"}},{default:e(()=>o[0]||(o[0]=[L("HOME")])),_:1,__:[0]})):me("",!0)]),_:1})]),_:1}),n(r,{align:"end",id:"langtarget"},{default:e(()=>[st(l.$slots,"lang-switch")]),_:3})]),_:3}),n(c,{style:{margin:"0px"}})]),_:3})}}}),Us="/avif2jpeg/dist/pwa-64x64.png",Rs={class:"title"},Bs=ye({__name:"title",setup(i){const s=Ht();return Se(()=>{const u=s.currentRoute.value.path||"";return!String(u.match(new RegExp("(?<=^\\/)[^/]+"))||"")}),(u,l)=>{const o=Ce;return I(),J(o,{vertical:"",align:"center",justify:"center",style:{margin:"0px"},size:1},{default:e(()=>[y("h1",Rs,[l[0]||(l[0]=y("img",{src:Us,style:{height:"1em","vertical-align":"middle"}},null,-1)),L(" "+d(u.$t("title")),1)])]),_:1})}}}),Ns=Me(Bs,[["__scopeId","data-v-0b61dfe0"]]),js={viewBox:"0 0 15 16",width:"1.13em",height:"1.2em"};function Zs(i,s){return I(),q("svg",js,s[0]||(s[0]=[ja('<path fill="currentColor" d="m6.22 8.14l-3.17 4.28c-.18.24 0 .58.29.58h6.32c.3 0 .47-.34.29-.58L6.8 8.14c-.14-.2-.44-.2-.58 0"></path><path fill="currentColor" d="m9.72 10.09l-1.9 2.57c-.11.14 0 .35.17.35h3.79c.18 0 .28-.2.17-.35l-1.89-2.57a.215.215 0 0 0-.35 0Z"></path><circle cx="10" cy="8" r="1" fill="currentColor"></circle><path fill="currentColor" d="M12.5 16h-10c-.83 0-1.5-.67-1.5-1.5v-13C1 .67 1.67 0 2.5 0h7.09c.4 0 .78.16 1.06.44l2.91 2.91c.28.28.44.66.44 1.06V14.5c0 .83-.67 1.5-1.5 1.5M2.5 1c-.28 0-.5.22-.5.5v13c0 .28.22.5.5.5h10c.28 0 .5-.22.5-.5V4.41a.47.47 0 0 0-.15-.35L9.94 1.15A.5.5 0 0 0 9.59 1z"></path><path fill="currentColor" d="M13.38 5h-2.91C9.66 5 9 4.34 9 3.53V.62c0-.28.22-.5.5-.5s.5.22.5.5v2.91c0 .26.21.47.47.47h2.91c.28 0 .5.22.5.5s-.22.5-.5.5"></path>',5)]))}const Hs=ot({name:"formkit-fileimage",render:Zs}),Ws={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Vs(i,s){return I(),q("svg",Ws,s[0]||(s[0]=[y("path",{fill:"currentColor",d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm0-2h16V8h-8.825l-2-2H4zm0 0V6z"},null,-1)]))}const Ca=ot({name:"material-symbols-folder-outline",render:Vs}),qs={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Gs(i,s){return I(),q("svg",qs,s[0]||(s[0]=[y("path",{fill:"currentColor",d:"M12 .037C5.373.037 0 5.394 0 12s5.373 11.963 12 11.963c6.628 0 12-5.357 12-11.963S18.627.037 12 .037m-.541 4.8c1.91-.13 3.876.395 5.432 1.934c1.426 1.437 2.51 3.44 2.488 5.317h2.133l-4.444 4.963l-4.445-4.963h2.313c-.001-1.724-.427-2.742-1.78-4.076c-1.325-1.336-2.667-2.11-4.978-2.303a9.2 9.2 0 0 1 3.281-.871zM6.934 6.95l4.445 4.963H9.066c0 1.724.426 2.742 1.778 4.076c1.326 1.336 2.667 2.112 4.978 2.305c-2.684 1.268-6.22 1.398-8.71-1.064c-1.427-1.437-2.512-3.44-2.489-5.317H2.488z"},null,-1)]))}const Ks=ot({name:"simple-icons-convertio",render:Gs}),ln=new Set,Qs=new Set,Xs=new Set,It=new Map;function Ys(i){const s=It.get(i);s&&(It.delete(i),s(),St==null||St(),St=null)}function Js(){for(const i of It.keys())Ys(i)}let St=null;function Ta(){Js();for(const i of ln)i.onmessage=null,i.terminate();ln.clear(),Qs.clear(),Xs.clear(),It.clear()}function ei(i){return new Worker("/avif2jpeg/dist/assets/worker.zip-Bt_6u_43.js",{name:i==null?void 0:i.name})}function ti(i){return new Worker("/avif2jpeg/dist/assets/worker.loader-ClWxlXFI.js",{name:i==null?void 0:i.name})}function ni(){return typeof window.showDirectoryPicker=="function"}async function oi(){let i,s;try{s=await window.showDirectoryPicker(),s&&(i=await s.quryPermission({mode:"readwrite"}),i!=="granted"&&(i=await s.requestPermission({mode:"readwrite"})))}catch{}if(i!=="granted")try{i=await s.requestPermission({mode:"readwrite"})}catch{return null}return i==="granted"?s:null}async function ai(i,s,u){const l=s.split("/"),o=l.pop();let a=i;for(const c of l)a=await a.getDirectoryHandle(c);const r=await a.getFileHandle(o);return u?r.getFile():r}async function li(i,s){const u=s.split("/"),l=u.pop();let o=i;for(const a of u)o=await o.getDirectoryHandle(a);return await o.getDirectoryHandle(l)}async function si(i,s,u,l,o){const r=await(await i.getFileHandle(s,{create:!0})).createWritable();return await r.write(u),await r.close(),!0}async function ii(i,s,u,l){const o=u===!0;let a;try{if(a=await i.getDirectoryHandle(s,{create:o}),o)return a;!u||typeof u=="function"&&await u(i,s,l)}catch(r){if(r.name==="NotFoundError")a=await i.getDirectoryHandle(s,{create:!0});else throw r}return a}const sn=new Map;async function ri(i,s,u,l){let o=sn.get(i);o||(o={},sn.set(i,o));const a=[];let r=i,c;const f=typeof s=="string"?s.split("/"):s;c=f.join("/");do{if(o[c]){r=o[c],c+="/";break}a.unshift(f.pop()),c=f.join("/")}while(f.length);for(const w of a){if(!w)throw new Error("folderName is empty");if(r=await ii(r,w,u,c),!r)return null;o[c+w]=r,c+=w+"/"}return r}async function ui(i,s,u,l){const o=s.split("/"),a=o.pop();if(!a)throw new Error("fileName is empty");const r=o.length?await ri(i,o,l):i;return r?await si(r,a,u,l,o.length?o.join("/")+"/":""):!1}function ci(i){const s=new Set;for(const u of i){const o=u.webkitRelativePath.split("/");do{o.pop();const a=o.join("/");if(s.has(a))break;s.add(a)}while(o.length>=2)}return s}async function di(i,s){const l=[...ci(s)].sort(),o=new Set;let a,r="";for(let c of l){let f=c;r&&c.startsWith(r+"/")?f=f.slice(r.length+1):a=i;try{a=await li(a,f),o.add(c),r=c}catch{r=""}}return o}const pi=1e3*10;let tt;const Ne=new Map,bt=new Map,Lt=new Map;let j;function Ot(i){tt=null,Ne.clear(),bt.clear(),Lt.clear(),bt.clear(),Lt.clear(),j={...i}}async function fi(i){Ot(i),j.completedFileIdSet.clear(),j.completedFileDat.length=0;let s;try{s=await gi()}catch{return Ot(),{exception:new Error("worker-load-error"),callbackToClearConverter:new Function,callbackToGenerateFailedZips:new Function}}const[u,l]=s;tt=l;const o=new Promise(m=>{l.onmessage=C=>{const F=C.data,{action:p}=F;switch(p){case"squeeze-zip":case"zip-squeeze-error":m(void 0);break}}}),a=new Promise(m=>{u.onmessage=C=>{const{data:{action:F}}=C;F==="close-loader"&&m()}}),r=j.files.map(m=>[m._id,m.webkitRelativePath]);j.files.forEach(m=>bt.set(m._id,m));const c=be(j.canceled,m=>{if(!m)return;c();const C={action:"cancel-convert"};u.postMessage(C)}),f={action:"start-convert",list:j.files,extraPropsForList:r,outputQuality:j.quality,outputType:j.format,keepExt:j.props.retainExtension,outputExt:j.outputExt,fsysDirHandler:j.fsysDirHandler,existingFolders:j.existingFolders,threads:j.props.threads,maxSize:W.shrinkImage?{width:W.maxWidth,height:W.maxHeight}:null};u.postMessage(f),await a,l.postMessage({action:"squeeze"}),await o,c();const w=()=>{Ta(),l.onmessage=null,l.terminate(),u.onmessage=null,u.terminate(),Ot()};let k=!1;return{callbackToClearConverter:w,callbackToGenerateFailedZips:async m=>{k||(k=!0,await Si(m,l,{},j.ConvStats))}}}async function gi(){Ta();const i=new ti,s=new ei,u=new Promise((r,c)=>{const f=C=>{s.removeEventListener("message",z),i.removeEventListener("message",z),clearTimeout(m),C?r(C):c(C)};let w=!1,k=!1;const z=C=>{C.target===s&&(w=!0),C.target===i&&(k=!0),w&&k&&f(!0)};let m=0;s.addEventListener("message",z),i.addEventListener("message",z),m=window.setTimeout(()=>f(!1),pi)}),{port1:l,port2:o}=new MessageChannel,a={action:"set-zip-port"};return s.postMessage({action:"set-port-loader"},[l]),i.postMessage(a,[o]),await u,s.postMessage({action:"set-config",zipSize:j.props.maxZipSizeMB*1024*1024,keepExt:j.props.retainExtension,outputExt:j.outputExt,imageType:j.imageType}),i.addEventListener("message",vi),s.addEventListener("message",mi),[i,s]}const mi=i=>{const s=i.data,{action:u}=s;switch(u){case"add-zip-completed":{const{fileId:r,entireIndex:c,storedPath:f}=s;return}case"respond-image":{const{url:r,index:c,path:f,size:w,fileId:k}=s;j.ConvStats.convertedImageUrl=r,j.ConvStats.convertedImageSize=w,j.ConvStats.convertedImageIndex=c,j.ConvStats.convertedImageName=f;let z="",m=0,C="";const F=Ne.get(k);if(k>=0){const p=bt.get(k);z=URL.createObjectURL(p),m=p.size,C=p.webkitRelativePath||p.name}j.ConvStats.convertedImageOrgUrl=z,j.ConvStats.convertedImageOrgSize=m,j.ConvStats.convertedImageOrgName=C,j.ConvStats.convertedImageShrinked=F==null?void 0:F.shrinked;return}case"respond-delete":{const{index:r,success:c,fileId:f}=s;Ne.get(f).command="❌deleted",Ne.get(f).completed=!1;return}}switch(u){case"error-push-filelist-zip":const{path:r}=s;j.ConvStats.failedZipDone=!0,j.message.error(`an error occurred "${r}"`,{duration:3e3});return}const{size:l,count:o}=s,a="url"in i.data?i.data.url:"";switch(u){case"push-zip":j.ConvStats.zips.push({url:a,size:l,count:o}),j.ConvStats.zippedTotalCount+=o,j.ConvStats.zippedTotalSize+=l;break;case"squeeze-zip":o>0&&(j.ConvStats.zips.push({url:a,size:l,count:o}),j.ConvStats.zippedTotalCount+=o,j.ConvStats.zippedTotalSize+=l);break;case"push-filelist":j.ConvStats.failedFileZippedCount++;break;case"squeeze-filelist-zip":j.ConvStats.failedZipDone=!0;case"push-filelist-zip":j.ConvStats.failedZips.push({url:a,size:l,count:o});break;case"zip-error":case"zip-squeeze-error":j.ConvStats.zippingErrorCount+=o;break}},vi=async i=>{const s=i.target,{data:u}=i,{action:l}=u;switch(l){case"list-start":break;case"list-end":break;case"file-start":{const{index:o,path:a,fileId:r}=u;yi(o,a,r);break}case"file-load":{const{thumbnail:o,width:a,height:r,fileId:c,workerId:f,inputsize:w}=u,k=Ne.get(c);k.core=f,k.command="🖼️loaded",k.width=a,k.height=r,k.size=w,o&&(j.ConvStats.thumbnail=o);break}case"file-converted":{const{index:o,path:a,fileId:r,shrinked:c,outputWidth:f,outputHeight:w,outputsize:k,convertedImageBlob:z}=u,m=Ne.get(r);m.command="🔃converted",m.shrinked=m.shrinked==null?c:m.shrinked,m.outputWidth=f,m.outputHeight=w,m.outputSize=k,j.ConvStats.converted++;break}case"file-sys-completed":case"file-completed":{const{inputsize:o,outputsize:a,fileId:r,storedPath:c}=u,f=Ne.get(r);if(f&&(f.command="✅completed",f.completed=!0,f.fileId=r),j.ConvStats.inputTotalSize+=o,j.ConvStats.outputTotalSize+=a,j.ConvStats.done++,j.ConvStats.success++,j.completedFileIdSet.add(r),l==="file-sys-completed"&&(f.zippedIndex=j.completedFileDat.length,j.completedFileDat.push({path:c,id:r})),l==="file-completed"){const{entireIndex:w}=u;f.zippedIndex=w,j.ConvStats.ziplogs[w]={fileId:r,storedPath:c}}break}case"file-retry":{const{index:o,path:a,fileId:r}=u;_i(o,a,r);break}case"file-error":{const{index:o,path:a,fileId:r}=u;wi(o,a,r);break}case"file-canceled":{const{fileId:o,path:a}=u;bi(o);break}case"file-skip":{const{fileId:o,path:a}=u;ki(o);break}case"confirm-overwrite":{const{target:o,type:a,path:r,fileId:c,workerId:f}=u,w=await new Promise(k=>j.enqueueOverwriteConfirmation(k,o,a,r));s.postMessage({action:"respond-overwrite",command:w,target:o,path:r,fileId:c,workerId:f,skippedFolderPath:a==="folder"&&w.startsWith("skip")?o:""});break}}};let hi=0;function yi(i,s,u){const l={key:hi++,core:-1,index:i,path:s,command:"➡️started"};Ne.set(u,l),j.ConvStats.logs.push(l),Lt.has(u)||j.canceled.value||j.ConvStats.startedCount++}function _i(i,s,u){const l=Ne.get(u);l.command="⚠️retry",l.error=!0,j.ConvStats.retried++,Lt.set(u,1)}function wi(i,s,u){const l=Ne.get(u);j.ConvStats.done++,j.ConvStats.failure++,l.command="❗failed",l.error=!0}function bi(i){const s=Ne.get(i);j.ConvStats.done++,j.ConvStats.failure++,s.command="❗canceled",s.error=!0}function ki(i){const s=Ne.get(i);j.ConvStats.done++,j.ConvStats.failure++,s.command="⚠skipped",s.error=!0}async function zi(i){if(j.fsysDirHandler){const s=j.completedFileDat[i];if(!s)return;const u=s.id;let l="",o=0,a="";if(Ne.get(u),u>=0){const w=bt.get(u);l=URL.createObjectURL(w),o=w.size,a=w.webkitRelativePath||w.name}j.ConvStats.convertedImageOrgUrl=l,j.ConvStats.convertedImageOrgSize=o,j.ConvStats.convertedImageOrgName=a;const r=s.path,c=await ai(j.fsysDirHandler,r,!0),f=URL.createObjectURL(c);j.ConvStats.convertedImageUrl=f,j.ConvStats.convertedImageSize=c.size,j.ConvStats.convertedImageIndex=i,j.ConvStats.convertedImageName=s.path}else tt==null||tt.postMessage({action:"request-image",index:i})}function Mt(i){tt==null||tt.postMessage({action:"delete-image",index:i})}async function Si(i,s,u,l){let o=0;for(const a of i){const r=(a.webkitRelativePath||a.name).replace(/^\//,"");if(l.failedZipDone)break;if(u.value)return;o-l.failedFileZippedCount>20&&await new Promise(c=>setTimeout(c,10)),s.postMessage({action:"add-filelist",file:a,path:r}),o++}if(l.failedZipDone){j.message.error("Zipping error files was aborted",{duration:5e3});return}s.postMessage({action:"squeeze-filelist"})}let wt;async function Ci(i,s,u,l,o){let a="";const r=document.createElement("canvas"),c=r.getContext("2d");let f=new Bt;const w=[f],k=new Ml,z=u.format,m=u.quality/100,C=[...z.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),F=i.length,p=u.maxZipSizeMB*1024*1024;let $=0,_=null,g="",S="",h=0,A=0,M=0,P=0,B=0,ee=!1;wt=X=>{const[Z,H]=k.get(X),N=w[Z],ie=N.get(H,z);o.convertedImageIndex=X,o.convertedImageName=N.getPathByIndex(H),o.convertedImageUrl=URL.createObjectURL(ie),o.convertedImageSize=ie.size;let se="",ce=0,_e="";const Q=K[X];se=URL.createObjectURL(Q),ce=Q.size,_e=Q.webkitRelativePath||Q.name,o.convertedImageOrgUrl=se,o.convertedImageOrgSize=ce,o.convertedImageOrgName=_e};const K=[];for(const X of i){if(l.value)break;const Z=X.name;let H="";const N=X.size,ie=(X.webkitRelativePath||X.relativePath||Z).replace(/^\//,""),se=document.createElement("img"),ce={key:M++,core:-1,index:$++,path:ie,command:"➡️start"};o.startedCount=$,o.logs.push(ce),o.logs.length-1,a&&(URL.revokeObjectURL(a),a=""),a=URL.createObjectURL(X),S=a,h=X.size,se.src=a;const _e=await Aa(se).then(()=>!0).catch(()=>!1);if(!se.complete||!_e||l.value){o.done++,o.failure++,ce.command="❗failed";continue}const Q=se.width,Ee=se.height;r.width=Q,r.height=Ee,c.drawImage(se,0,0,Q,Ee,0,0,Q,Ee),ce.command="🖼️imgload",ce.width=Q,ce.height=Ee,ce.size=X.size,o.thumbnail=se;const pe=await new Promise(we=>{const Ue=Re=>{_=Re,we(Re)};r.toBlob(Ue,z,m)});if(l.value)break;if(!pe){o.failure++;continue}A=pe.size,o.converted++,ce.outputSize=A;let ke="";if(B+A>=p){try{await f.wait(),ke=await f.url()}catch{ee=!0,alert("memory problem occurred");break}o.zips.push({url:ke,size:B,count:P}),o.zippedTotalCount+=P,o.zippedTotalSize+=B,B=0,P=0,k.split(),f=new Bt,w.push(f)}B+=A;const de=ie||Z;for(let we=1;we<255&&(H=de.replace(u.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(we>1?`(${we})`:"")+"."+C,!!f.has(H));we++);o.done++;try{P++,f.add(H,pe)}catch{continue}k.increase(),K.push(X),o.inputTotalSize+=N,o.outputTotalSize+=A,o.ziplogs.push({fileId:X._id,storedPath:H}),g=H,ce.zippedIndex=o.success,o.success++,ce.command="✅completed",ce.completed=!0,ce.fileId=X._id,s.add(X._id)}if(o.success>0)if(F===1)_&&(o.convertedImageIndex=0,o.convertedImageName=g.replace(/^.*\/(?=[^/]+$)/,"").replace(u.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+C,o.convertedImageUrl=URL.createObjectURL(_),o.convertedImageOrgUrl=S,o.convertedImageOrgSize=h);else try{if(ee)throw new Error("terminated zipping process for memory problems");await f.wait();const X=await f.url();o.zips.push({url:X,count:P,size:B}),o.zippedTotalCount+=P,o.zippedTotalSize+=B}catch{}const U={value:!1},T=()=>{U.value=!0,w.forEach(X=>X.clear()),w.length=0,K.length=0,wt=null};let ae=!1;return{callbackToClearConverter:T,callbackToGenerateFailedZips:async X=>{ae||(ae=!0,Ai(X,p,o,U))}}}function Ti(i){wt==null||wt(i)}async function Ai(i,s,u,l){let o=0,a=0,r=new Bt;for(let c=0;c<i.length;c++){const f=i[c],w=(f.webkitRelativePath||f.name).replace(/^\//,"");if(l.value)return;try{await r.add(w,f)}catch{alert(`an error occurred during access to "${w}"`);break}if(a+=f.size,o++,u.failedFileZippedCount++,a>=s||c===i.length-1){await r.zip();const k=await r.url();u.failedZips.push({url:k,size:a,count:o}),r.clear(),a=0,o=0}}u.failedZipDone=!0}function Aa(i){if(typeof i.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((s,u)=>{i.onload=s,i.onerror=u})}const xi=["href","download","title"],Ii='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',Li=ye({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean},hidden:{type:Boolean}},emits:["load","error","next","prev"],setup(i,{expose:s,emit:u}){const{t:l}=je(),o=i,a=u,r=v();v();const c=v(!0),f=v(""),w=v(o.width||100),k=v(o.height||100),z=v(!1),m=$t({width:w.value+"px",height:k.value+"px",minWidth:"50px",minHeight:"50px"});et(()=>{var S,h,A;(h=(S=r.value)==null?void 0:S.previewInstRef)==null||h.setPreviewSrc(Ii),URL.revokeObjectURL((((A=r.value)==null?void 0:A.imageRef)||{}).src),r.value=null});const C=v(!0);Za(()=>{C.value=!1}),Ha(()=>{C.value=!0}),be(o,(S,h)=>{m.width=(o.width||100)+"px",m.height=(o.height||100)+"px"}),be(()=>o.src,(S,h)=>{C.value&&$(S)},{immediate:!0}),s({download:_,openPreview:g,active:C});async function F(S){const h=S.target,A=h.naturalWidth,M=h.naturalHeight,{width:P,height:B}=$n({width:A,height:M},{width:o.maxWidth||100,height:o.maxHeight||100},o.expand);w.value=P,k.value=B,a("load",{src:h.src,width:A,height:M}),c.value=!1,await new Promise(ee=>setTimeout(ee,100)),!c.value&&(z.value=!0)}function p(S){const h=S.target;a("error",h.src)}async function $(S){c.value=!0,z.value=!1,f.value=S}function _(){const S=document.createElement("a");S.href=f.value,S.download=o.fileName,S.click()}function g(){var S;(S=r.value)==null||S.click()}return(S,h)=>{const A=_n,M=wn,P=Ce,B=Wt;return Ge((I(),q("div",null,[n(t(ze),null,{trigger:e(()=>[n(B,{show:t(c)||o.loading},{default:e(()=>[n(P,{justify:"center",align:"center",style:fe([t(m),{"line-height":"0px"}])},{default:e(()=>[Ge(y("a",{href:t(f),onClick:h[0]||(h[0]=ct(()=>{},["left","prevent"])),target:"_blank",download:o.fileName,title:o.fileName},[n(qe,{mode:"in-out"},{default:e(()=>[Ge(n(A,{ref_key:"nImageRef",ref:r,"show-toolbar-tooltip":"",onLoad:F,onError:p,src:t(f),width:t(w),height:t(k),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[Ke,t(z)]])]),_:1})],8,xi),[[Ke,!(t(c)||o.loading)]]),Ge(n(M,null,null,512),[[Ke,t(c)||o.loading]])]),_:1},8,["style"])]),_:1},8,["show"])]),default:e(()=>[L(" "+d(o.fileName),1)]),_:1})],512)),[[Ke,!S.hidden]])}}}),rn=Me(Li,[["__scopeId","data-v-a62add3a"]]),$i=["href","download","title"],Fi={class:"left-num"},Ei={class:"right-num"},Pi=["href","download","title"],Di={class:"left-num"},Oi={class:"right-num"},Mi=["href","download"],Ui=ye({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean},variousInfo:{}},emits:["demand-image","delete-image","close"],setup(i,{expose:s,emit:u}){const l=at(Qe),o=i,a=u;s({download:Ee,cleanup:re,openPreview:V,isPreviewing(){return P.value},changeIndex(R){C.value=R}});const r=pt(),{t:c}=je();Ft();const f=v(),w=v(),k=v(),z=dt("viewerItemContainer"),m=v(!0),C=v(Math.max(o.index,0)+1),F=v(1),p=v(1),$=v(""),_=v(""),g=v(1),S=v(1),h=v(!1),A=v(!1),M=v(!1),P=Se(()=>{var R,D;return(D=(R=k.value)==null?void 0:R.previewInstRef)==null?void 0:D.displayed}),B=Se(()=>{var R,D;return((D=(R=k==null?void 0:k.value)==null?void 0:R.previewInstRef)==null?void 0:D.previewSrc)===$.value}),ee=Se(()=>C.value<o.length),K=Se(()=>C.value>1),U=v("viewer-item-init"),T=v(0),ae=v(!0);v({width:"auto",height:"auto"});const ue=v(!1);Oe(()=>{document.body.addEventListener("keydown",ce),document.body.addEventListener("keydown",se),N(C.value-1),ie()}),et(()=>{clearTimeout(X),document.body.removeEventListener("keydown",ce),document.body.removeEventListener("keydown",se),ue.value=!0}),At(()=>{URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl)});let X=-1;be(C,(R,D)=>{C.value<1||C.value>o.length||R===D||(clearTimeout(X),R>D?U.value="viewer-item-next":U.value="viewer-item-prev",X=setTimeout(()=>{o.index!==C.value-1&&(T.value=m.value?T.value:~T.value,ae.value=!1,N(C.value-1))},50))});let Z="",H="";be(()=>o.url,()=>{var b,E;let R="";o.index===0&&m.value?(m.value=!1,C.value=1,R=o.url):o.index===C.value-1?(m.value=!1,h.value=!1,R=o.url):(URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl));const D=Z,te=H;if(URL.revokeObjectURL(D),URL.revokeObjectURL(te),Z=o.url,H=o.originalUrl,R){try{if((E=(b=k.value)==null?void 0:b.previewInstRef)!=null&&E.displayed){B.value?k.value.previewInstRef.setPreviewSrc(R):k.value.previewInstRef.setPreviewSrc(o.originalUrl);try{const Y=k.value.previewInstRef.displayed;k.value.previewInstRef.handleAfterLeave(),k.value.previewInstRef.displayed=Y}catch{}}}catch{}$.value=R,_.value=o.originalUrl}},{immediate:!0});function N(R){h.value=!0,A.value=!1,M.value=!1,$e(()=>a("demand-image",R))}function ie(){if(!l.IS_SP)return;let R=z.value.$el,D=0,te=0,b=0,E=0,Y=0;const he=ne=>{D=ne.touches[0].pageX,te=ne.touches[0].pageY,Y=Date.now()};R.addEventListener("touchstart",he);const O=ne=>{b=ne.touches[0].pageX,E=ne.touches[0].pageY,G()};window.addEventListener("touchmove",O);const x=()=>{G();const ne=b-D,oe=Math.abs(ne),ve=E-te,ge=Math.abs(ve);oe<ge||oe<30||ke(ne>0?-1:1)};window.addEventListener("touchend",x);const G=()=>{const ne=Date.now();ne-Y>500&&(D=b,te=E),Y=ne};et(()=>{R.removeEventListener("touchstart",he),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",x),R=null})}function se(R){var D,te,b,E;if(R.key==="Escape")try{(te=(D=k.value)==null?void 0:D.previewInstRef)!=null&&te.displayed&&(R.stopPropagation(),(E=(b=k.value)==null?void 0:b.previewInstRef)==null||E.toggleShow(!1))}catch{}}function ce(R){switch(R.code){case"ArrowRight":ke(1);break;case"ArrowLeft":ke(-1);break;case"Home":C.value=1;break;case"End":C.value=o.length;break;case"Space":case"Enter":case"NumpadEnter":if(!P.value)return;we();break;case"ArrowUp":case"ArrowDown":default:return}R.stopPropagation(),R.preventDefault()}function _e({width:R,height:D}){F.value=R,p.value=D,A.value=!0}function Q({width:R,height:D}){g.value=R,S.value=D,M.value=!0}function Ee(){B.value?f.value.download():w.value.download()}async function pe(R){try{const D=await fetch(R).then(te=>te.blob()).then(te=>new Promise(b=>{const E=new FileReader;E.onload=b,E.readAsDataURL(te)})).then(te=>te.target.result);navigator.clipboard.writeText(D),r.info({title:c("copiedDataURLDialogTitle"),content:()=>le("div",[le("div",c("copiedDataURLMessage"))]),positiveText:"OK"})}catch{r.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function ke(R){R>0?C.value=Math.min(o.length,C.value+R)|0:R<0&&(C.value=Math.max(1,C.value+R)|0)}let de="";const we=()=>{var D,te,b,E;de=(b=window.getComputedStyle((te=(D=k==null?void 0:k.value)==null?void 0:D.previewInstRef)==null?void 0:te.previewRef))==null?void 0:b.transform;const R=B.value;(E=k==null?void 0:k.value)==null||E.next(),$e(()=>{var Y;B.value===R&&((Y=k==null?void 0:k.value)==null||Y.next())})};function Ue(){try{$e(()=>k.value.previewInstRef.previewRef.style.transform=de)}catch{}}function Re({nodes:R}){const D=le(kn,{color:B.value?"green":"gray",offset:[-20,-12],value:B.value?c("status.Converted"):c("status.Original")},()=>le(Fe,{round:!0,onClick(){we()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>le(B.value?Ga:Ka)}));R.next=le(Fe,{onClick(){ke(1)},disabled:!ee.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>le(en)}),R.prev=le(Fe,{onClick(){ke(-1)},disabled:!K.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>le(Qa)});try{const te=R.download.children;te.default=()=>c("save");const b=te.trigger();b.props.onClick=Ee,te.trigger=()=>b}catch{}return Ve(),[D,...Object.values(R)]}const Xe="#pathbox-"+String(Math.random()).substring(2);let De;function Ve(){var R,D,te;try{if(De=(te=(D=(R=k.value)==null?void 0:R.previewInstRef)==null?void 0:D.previewWrapperRef)==null?void 0:te.parentNode,!De||De.querySelector(Xe))return;let b=le("div",{id:Xe,onMousedown:E=>{E.stopPropagation()},className:"__preview-injected-pathbox"+(B.value?" converted":"")},[le("div",`${String(C.value).padStart(String(o.length).length,"0")}/${String(o.length).padStart(String(o.length).length,"0")}`),le("div",He(B.value?o.size:o.originalSize,0)),le("div",B.value?o.name:o.originalName)]);tn(b,De),b=null}catch{}}et(()=>{De&&(tn(null,De),De=null)});function V(){f.value.openPreview()}function re(){}return(R,D)=>{const te=Ae,b=Ce,E=bn,Y=lt,he=Et,O=Wa;return I(),J(b,{justify:"center",align:"stretch",vertical:"",style:fe([{visibility:m.value?"hidden":"visible"},{overflow:"visible"}]),class:"body",ref:"body"},{default:e(()=>[n(O,{ref_key:"nImageGroupRef",ref:k,"show-toolbar-tooltip":"","render-toolbar":Re,onPreviewNext:Ue},{default:e(()=>[n(b,{wrap:!1,align:"center",justify:"space-between",style:{overflow:"visible"}},{default:e(()=>[n(t(Fe),{onClick:D[0]||(D[0]=x=>ke(-1)),bordered:!1,disabled:!t(K),class:nt({"thumb-arrow":!0,pale:!t(K)}),title:R.$t("Prev")},{icon:e(()=>[n(te,{size:"30"},{default:e(()=>[n(t(Va))]),_:1})]),_:1},8,["disabled","class","title"]),n(b,{justify:"center",ref_key:"viewerItemContainer",ref:z,class:"viewer-item-container",style:{width:"100%"}},{default:e(()=>[n(qe,{name:U.value},{default:e(()=>[(I(),J(b,{vertical:"",key:T.value},{default:e(()=>[n(b,{align:"center",wrap:!1},{default:e(()=>[n(b,{vertical:""},{default:e(()=>[n(b,{align:"center",justify:"center",wrap:!1},{default:e(()=>[n(b,{align:"center",justify:"center",vertical:"",class:"original-thumb"},{default:e(()=>[y("a",{href:R.originalUrl,onClick:D[4]||(D[4]=ct(x=>{w.value.openPreview()},["prevent"])),download:R.originalName,title:R.originalName,class:"imglink"},[n(b,{align:"center",justify:"center",wrap:!1},{default:e(()=>[n(rn,{ref:x=>{x!=null&&x.active&&(w.value=x)},src:_.value,width:1,"max-width":1,"max-height":1,loading:h.value,"file-name":R.originalName,"allow-next":C.value<o.length,"allow-prev":C.value>1,onLoad:Q,onNext:D[1]||(D[1]=x=>ke(1)),onPrev:D[2]||(D[2]=x=>ke(-1)),hidden:!0},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(b,{vertical:"",align:"center"},{default:e(()=>[n(b,{class:"imglink-label"},{default:e(()=>[L(d(t(c)("status.Original")),1)]),_:1}),n(b,{justify:"center",class:"img-size",wrap:!1,size:2},{default:e(()=>[y("span",Fi,d(M.value?g.value:"?"),1),D[11]||(D[11]=L(" × ")),y("span",Ei,d(M.value?S.value:"?"),1)]),_:1,__:[11]}),n(b,{justify:"center"},{default:e(()=>[D[3]||(Jt(-1,!0),(D[3]=n(b,null,{default:e(()=>[L(d(M.value?t(He)(o.originalSize,0):"?"),1)]),_:1})).cacheIndex=3,Jt(1),D[3])]),_:1})]),_:1})]),_:1})],8,$i)]),_:1}),n(b,{vertical:"",align:"center",class:"original-thumb"},{default:e(()=>[n(te,{size:"20",color:"silver",component:t(en)},null,8,["component"])]),_:1}),y("a",{href:$.value,onClick:D[5]||(D[5]=ct(x=>V(),["prevent"])),download:o.name,title:o.name,class:"imglink"},[n(b,{vertical:"",align:"center",justify:"center"},{default:e(()=>[n(b,{class:"imglink-label"},{default:e(()=>[L(d(t(c)("status.Converted")),1)]),_:1}),n(b,{vertical:"",align:"center",justify:"center",size:0},{default:e(()=>[n(b,{justify:"center"},{default:e(()=>{var x;return[n(b,{wrap:!1,style:fe((x=o.variousInfo)!=null&&x.shrinked?{color:"blue"}:{}),class:"img-size",size:2},{default:e(()=>[y("span",Di,d(A.value?F.value:"?"),1),D[12]||(D[12]=L(" × ")),y("span",Oi,d(A.value?p.value:"?"),1)]),_:1,__:[12]},8,["style"])]}),_:1})]),_:1}),n(b,{justify:"center"},{default:e(()=>[L(d(A.value?t(He)(o.size,0):"?"),1)]),_:1})]),_:1})],8,Pi)]),_:1}),n(b,{ref:"fileNameContainer",justify:"center",align:"center",class:"pathbox",title:o.name,style:{overflow:"hidden"}},{default:e(()=>[n(E,{"x-scrollable":!0,trigger:"hover",style:{"text-align":"center","font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:e(()=>[L(d(A.value?o.name:"?"),1)]),_:1})]),_:1},8,["title"])]),_:1}),n(b,{vertical:"",style:{overflow:"visible"}},{default:e(()=>[n(rn,{ref:x=>{x!=null&&x.active&&(f.value=x)},src:$.value,width:142,"max-width":140,"max-height":100,loading:h.value,"file-name":o.name,"allow-next":C.value<o.length,"allow-prev":C.value>1,onLoad:_e,onNext:D[6]||(D[6]=x=>ke(1)),onPrev:D[7]||(D[7]=x=>ke(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(b,{justify:"center",align:"center",wrap:!1},{default:e(()=>[n(Y,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:e(()=>[y("a",{href:o.url,ref:"saveImg",target:"_blank",download:o.name,style:{"line-height":"1em"}},[n(t(Fe),{disabled:!A.value,round:"",size:"tiny"},{default:e(()=>[L(d(R.$t("save")),1)]),_:1},8,["disabled"])],8,Mi)]),default:e(()=>[L(" "+d(R.$t("save")),1)]),_:1}),n(Y,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:e(()=>[n(t(Fe),{disabled:!A.value,onClick:D[8]||(D[8]=x=>pe(o.url)),round:"",size:"tiny"},{default:e(()=>D[13]||(D[13]=[L("DataURL")])),_:1,__:[13]},8,["disabled"])]),default:e(()=>[L(" "+d(R.$t("convertedImageDataUrlTooltip")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["name"])]),_:1},512),n(t(Fe),{bordered:!1,onClick:D[9]||(D[9]=x=>ke(1)),disabled:!t(ee),class:nt({"thumb-arrow":!0,next:!0,pale:!t(ee)}),title:R.$t("Next")},{icon:e(()=>[n(te,{size:"30"},{default:e(()=>[n(t(qa))]),_:1})]),_:1},8,["disabled","class","title"])]),_:1}),R.isSingle?me("",!0):(I(),J(b,{key:0,justify:"center",align:"center",wrap:!1,size:4},{default:e(()=>[n(he,{value:C.value,"onUpdate:value":D[10]||(D[10]=x=>C.value=x),tooltip:!1,step:1,min:1,max:o.length,keyboard:!1,class:"index-slider"},null,8,["value","max"]),n(b,{class:"index",align:"center",justify:"center",wrap:!1,size:3},{default:e(()=>[n(b,null,{default:e(()=>[L(d(t(c)("status.index"))+":",1)]),_:1}),n(b,{justify:"end",align:"center",class:"counter"},{default:e(()=>[L(d(C.value),1)]),_:1}),n(b,null,{default:e(()=>D[14]||(D[14]=[L("/")])),_:1,__:[14]}),n(b,{justify:"start",align:"center",class:"counter"},{default:e(()=>[L(d(o.length),1)]),_:1})]),_:1})]),_:1}))]),_:1},512)]),_:1},8,["style"])}}}),Ri=Me(Ui,[["__scopeId","data-v-493984f3"]]),Bi={key:0},Ni={style:{}},ji={key:1},Zi={key:2,style:{color:"red"}},Hi={key:1,style:{width:"106px",height:"80px",opacity:"0.15",border:"1px solid gray"}},Wi=ye({__name:"status.progress",props:{processing:{type:Boolean},successPerc:{},elapsedTime:{},threads:{},fileType:{},shrink:{},zipSize:{},outputToDir:{type:Boolean},inputTotalSize:{},outputTotalSize:{},rateColor:{},difColor:{},totalSizeDifStr:{},thumbnail:{},opened:{type:Boolean}},setup(i){const s=i,u=v(null),l={W:110,H:80};let o;return be(()=>[s.thumbnail,s.opened],()=>{if(!s.thumbnail||!s.opened||s.thumbnail===o||!u.value)return;const{width:a,height:r}=$n(s.thumbnail,{width:l.W,height:l.H});u.value.width=a,u.value.height=r,u.value.style.width=a+"px",u.value.style.height=r+"px",s.thumbnail instanceof HTMLImageElement?u.value.getContext("2d").drawImage(s.thumbnail,0,0,a,r):(u.value.getContext("bitmaprenderer").transferFromImageBitmap(s.thumbnail),o=s.thumbnail,s.thumbnail.close())}),(a,r)=>{const c=Ce,f=Xa,w=ft;return I(),J(w,{name:"progress",style:{"white-space":"nowrap"}},{header:e(({collapsed:k})=>[n(c,{align:"center"},{default:e(()=>[L(d(a.$t("status.Progress"))+" ",1),k?(I(),q(Pe,{key:0},[L(" ("+d(a.successPerc|0)+"%) ",1)],64)):me("",!0)]),_:2},1024)]),default:e(()=>[n(c,{justify:"center",align:"center",size:0,wrap:!1,style:{"white-space":"nowrap","margin-top":"-1em","padding-bottom":"5px"}},{default:e(()=>[r[0]||(r[0]=y("div",{class:"grow"},null,-1)),n(c,{justify:"center",class:"grow",wrap:!1,style:{"z-index":"1"}},{default:e(()=>[n(c,{vertical:"",justify:"center",class:"left-column"},{default:e(()=>[n(f,{"tabular-nums":"",label:a.$t("status.elapsedTime")},{default:e(()=>[n(c,null,{default:e(()=>[L(d(a.elapsedTime),1)]),_:1})]),_:1},8,["label"]),n(f,{"tabular-nums":"",label:a.$t("status.multiThreading")},{default:e(()=>[n(c,{style:fe({color:a.threads?"":"red",fontSize:"0.7rem"})},{default:e(()=>[L(d(a.threads?a.$rt("{n} @:threads",a.threads):a.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(f,{"tabular-nums":"",label:a.$t("status.outputSettings")},{default:e(()=>[n(c,{vertical:"",justify:"end",style:{"font-size":"0.6rem","line-height":"0.6rem"}},{default:e(()=>[y("div",null,d(a.$t("settings.imageType"))+": "+d(a.fileType),1),a.shrink?(I(),q("div",Bi,[L(d(a.$t("status.Shrinking"))+": ",1),y("span",Ni,d(a.shrink[0])+"×"+d(a.shrink[1]),1)])):me("",!0),a.outputToDir?(I(),q("div",Zi,d(a.$t("status.outputToDir")),1)):(I(),q("div",ji,"Zip: "+d(a.zipSize)+"MB",1))]),_:1})]),_:1},8,["label"])]),_:1}),st(a.$slots,"center",{},void 0,!0),n(c,{vertical:"",style:{height:"100%"},justify:"center",class:"right-column"},{default:e(()=>[n(f,{"tabular-nums":"",label:a.$t("status.inputSize")},{default:e(()=>[n(c,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:e(()=>[L(d((a.inputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(f,{"tabular-nums":"",label:a.$t("status.outputSize")},{default:e(()=>[n(c,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:e(()=>[L(d((a.outputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(f,{"tabular-nums":"",label:a.$t("status.outInRate")},{default:e(()=>[n(c,{vertical:"",align:"end",justify:"start",style:{"font-size":"0.8em","font-family":"v-mono","line-height":"50%"}},{default:e(()=>[y("span",{style:fe({color:a.rateColor,fontSize:"larger"})},"× "+d((a.outputTotalSize/a.inputTotalSize||1).toFixed(2)),5),y("span",{style:fe({color:a.difColor})},"("+d(a.totalSizeDifStr)+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:3}),n(c,{class:"thumb-container",align:"center",style:{position:"relative"}},{default:e(()=>[n(c,{justify:"center",align:"center",class:"grow thumbnail",style:fe({width:l.W+"px",height:l.H+"px"})},{default:e(()=>[n(qe,{name:"fade",mode:"out-in"},{default:e(()=>[a.processing?(I(),q("canvas",{key:0,ref_key:"thumbcanvas",ref:u,width:"106",height:"80",class:"thumb-canvas"},null,512)):(I(),q("div",Hi))]),_:1})]),_:1},8,["style"])]),_:1})]),_:3,__:[0]})]),_:3})}}}),Vi=Me(Wi,[["__scopeId","data-v-51e086be"]]),qi={class:"status-table"},Gi={class:"started"},Ki={class:"mini-counter"},Qi={class:"failure"},Xi={class:"mini-counter"},Yi={colspan:"2"},Ji={class:"completed"},er={class:"main-counter"},tr={class:"total"},nr={class:"main-counter"},or=ye({__name:"status.progress-center",props:{processing:{type:Boolean},interval:{},statusColor:{},success:{},successTo:{},successFrom:{},index:{},length:{},failure:{},retried:{},successPercTo:{},successPercFrom:{}},setup(i){const s=i,u=Ft(),l=v(u.value.successColor),o=v(!1);return be(()=>s.processing,a=>{a||(s.success===s.length?o.value=!0:l.value=u.value.errorColor)}),(a,r)=>{const c=lt,f=Ae,w=vn,k=Ce,z=zn;return I(),J(z,{type:"multiple-circle","stroke-width":2,percentage:[a.successTo/a.length*100|0,a.index/a.length*100|0],color:[t(u).successColor,a.statusColor],"rail-style":[{stroke:t(l),opacity:.3}],style:{width:"12em"}},{default:e(()=>[n(k,{vertical:"",align:"center",justify:"center",size:0,style:{"white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:e(()=>[y("table",qi,[y("tbody",null,[y("tr",Gi,[y("td",null,d(a.$t("status.started"))+":",1),y("td",Ki,[n(c,{trigger:"hover",style:fe({color:t(u).infoColor}),placement:"left"},{trigger:e(()=>[y("span",{style:fe({color:t(u).infoColor})},d(a.index.toLocaleString("en-us")),5)]),default:e(()=>[L(" "+d(a.$t("status.progressStarted"))+" ("+d(a.index.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),y("tr",Qi,[y("td",null,d(a.$t("status.failure"))+":",1),y("td",Xi,[n(c,{trigger:"hover",style:fe({color:t(u).errorColor}),placement:"left"},{trigger:e(()=>[y("span",{style:fe({color:t(u).errorColor})},d(a.failure.toLocaleString("en-us")),5)]),default:e(()=>[L(" "+d(a.$t("status.progressErrors"))+" ("+d(a.failure.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"]),a.retried>0?(I(),J(c,{key:0,trigger:"hover",style:fe({color:t(u).warningColor}),placement:"left"},{trigger:e(()=>[y("span",{style:fe({color:t(u).warningColor})}," ("+d(a.retried.toLocaleString("en-us"))+") ",5)]),default:e(()=>[L(" "+d(a.$t("status.progressRetries"))+" ("+d(a.retried.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):me("",!0)])]),y("tr",null,[y("td",Yi,[n(k,{size:0,align:"center",justify:"center",style:fe({color:a.processing?a.statusColor:t(l)}),wrap:!1,class:"percent"},{default:e(()=>[t(o)?(I(),J(f,{key:0,component:t(Ya)},null,8,["component"])):me("",!0),n(w,{duration:a.interval*3|0,from:a.successPercFrom|0,to:a.successPercTo|0,active:!0},null,8,["duration","from","to"]),r[0]||(r[0]=L("% "))]),_:1,__:[0]},8,["style"])])]),y("tr",Ji,[y("td",null,d(a.$t("status.success"))+":",1),y("td",er,[n(c,{trigger:"hover",duration:0,delay:0,style:fe({color:t(u).successColor}),placement:"bottom"},{trigger:e(()=>[y("span",{style:fe({color:t(u).successColor})},[n(w,{duration:a.interval*3|0,from:a.successFrom,to:a.successTo,active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:e(()=>[L(" "+d(a.$t("status.progressSuccess"))+" ("+d(a.successTo.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),y("tr",tr,[y("td",null,d(a.$t("status.all"))+":",1),y("td",nr,[n(c,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:e(()=>[L(d(a.length.toLocaleString("en-us")),1)]),default:e(()=>[L(" "+d(a.$t("status.progressTotal"))+" ("+d(a.length.toLocaleString("en-us"))+") ",1)]),_:1})])])])])]),_:1})]),_:1},8,["percentage","color","rail-style"])}}}),ar={key:0,class:"log-table",ref:"table"},lr={class:"log-tr label"},sr=["title"],ir={style:{"min-width":"7em"},class:"log-th"},rr={style:{"padding-left":"2em"},class:"log-th"},ur=["data-index-loglist"],cr={class:"log-td"},dr={class:"log-td"},pr={class:"log-td"},fr={class:"log-td"},gr={key:0,class:"log-td log-extra",style:{"padding-left":"0.5em"}},mr={key:0},vr={key:1,style:{color:"blue"}},hr={key:1},un=2,cn=3e3,Ut=80,yr=100,_r=ye({__name:"status.log",props:We({processing:{type:Boolean},opened:{type:Boolean},previewCollapsed:{type:Boolean},logs:{},imageIndex:{}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},"auto-scroll":{type:Boolean,required:!1},"auto-scrollModifiers":{},order:{required:!1,default:"processed"},orderModifiers:{}}),emits:We(["open-preview","change-index"],["update:expanded","update:auto-scroll","update:order"]),setup(i,{emit:s}){const{t:u}=je(),l=i,o=Te(i,"expanded"),a=Te(i,"auto-scroll"),r=s;dt("table");const c=dt("tbody"),f=v(),w=v(null),k=v(40),z=Se(()=>o.value?k.value:Ut),m=v(Ut),C=Se(()=>{let b=l.logs;switch(S.value){case"success":b=b.filter(E=>E.completed);break;case"error":b=b.filter(E=>!E.completed);break}return b}),F=Bl(!1),$=v([{type:"group",label:()=>u("status.sort"),key:"sort",children:[{label:()=>u("status.sortByStart"),value:"processed"},{label:()=>u("status.sortByCompletion"),value:"zipped"},{label:()=>u("status.sortByName"),value:"name"},{label:()=>u("status.sortBySize"),value:"size"},{label:()=>u("status.sortByOutputSize"),value:"outputsize"},{label:()=>u("status.sortByStatus"),value:"status"}]}]),_=Te(i,"order");be(_,()=>{Re()});const g=[{label:()=>u("status.showAll"),value:""},{label:()=>u("status.showOnlySuccess"),value:"success"},{label:()=>u("status.showOnlyError"),value:"error"}],S=v(g[0].value);let h;Oe(()=>{h=tl(),K(),window.addEventListener("resize",()=>K());const b=new ResizeObserver(()=>K());b.observe(h.parent.parent.vnode.el),et(()=>{window.removeEventListener("resize",()=>K()),b.disconnect()})}),et(()=>{clearTimeout(P),clearTimeout(ce),clearTimeout(T)});let A=0;be(()=>l.imageIndex,b=>M(b));async function M(b){var x;const E=b||l.imageIndex;let Y=C.value.findIndex(G=>G.zippedIndex===E);Y===-1&&(Y=E);const he=Y<=H.value,O=Y>H.value+N.value;if(he||O){const G=Y*ie.value-(O?z.value:0);(x=f.value)==null||x.scrollTo({behavior:"instant",top:G,left:V}),await $e(),pe(!0),await $e()}$e(()=>{var ne,oe;let G=w.value;G&&(A>Y&&(G=G.previousSibling||G,G instanceof HTMLElement||((ne=f.value)==null||ne.scrollTo(V,0),G=null)),(oe=G==null?void 0:G.scrollIntoView)==null||oe.call(G,{behavior:"instant",block:"nearest"}),A=Y)})}be(()=>l.opened,b=>{$e(()=>{b&&(M(),pe())})});let P;const B=v(document.documentElement.clientHeight),ee=v(100);function K(){clearTimeout(P),P=setTimeout(()=>{if(!l.opened||!f.value)return;const b=f.value.$parent.$el.offsetHeight,E=window.innerHeight-h.parent.parent.parent.parent.parent.vnode.el.offsetHeight-8,Y=Math.min(ie.value*Math.max(5,l.logs.length+2),Math.max(200,b+E));B.value=document.documentElement.clientHeight,ee.value=Math.min(ie.value*Math.max(5,l.logs.length),Math.max(Ut,Y)),l.opened&&(k.value=Math.max(Y,m.value))},100)}function U(){ue(!0),K(),F.value=!0}let T=0,ae=!1;function ue(b=!1){if(!ae){if(T){ae=!0;return}$e(()=>{!b&&!a.value||(f.value.scrollTo({behavior:"instant",top:l.logs.length*50,left:V}),T=window.setTimeout(()=>{T=0,ae&&(ae=!1,ue())},yr))})}}const X=v({height:"0px"}),Z=v({height:"0px"}),H=v(0),N=Se(()=>z.value/ie.value+un*2|0),ie=v(15);let se=0,ce=0,_e=0,Q=-999,Ee=-1;function pe(b){const E=Date.now();if(b!==!0){if(ce)return;if(E-_e<30){ce=window.setTimeout(()=>{ce=0,pe()},30-(E-_e));return}}_e=E,!se&&l.logs.length&&(se=c.value.rows[1].offsetHeight,ie.value=se);const Y=C.value.length,O=f.value.scrollbarInstRef.containerRef.scrollTop;if(!b&&Y===Ee&&Math.abs(O-Q)<ie.value*.5)return;Q=O,Ee=Y;const x=Math.max(0,(O/ie.value|0)-un);H.value=x,X.value.height=x*ie.value+"px",Z.value.height=Math.max(0,Y-(x+N.value))*ie.value+"px"}function ke(){var b;(b=f.value)==null||b.scrollTo(0,0),pe()}be(()=>l.logs,()=>{l.opened&&($e(pe),a.value&&ue(),Ue())});let de=0,we=0;function Ue(){if(_.value==="processed"||!_.value)return;const b=Date.now();if(b-we<cn){if(de)return;de=window.setTimeout(Ue,cn-(b-we));return}de=0,we=b,Re()}function Re(){switch(_.value){case"zipped":l.logs.sort((b,E)=>b.zippedIndex-E.zippedIndex);break;case"status":l.logs.sort((b,E)=>b.command>E.command?1:-1);break;case"name":l.logs.sort((b,E)=>b.path>E.path?1:-1);break;case"size":l.logs.sort((b,E)=>b.size-E.size);break;case"outputsize":l.logs.sort((b,E)=>b.outputSize-E.outputSize);break;case"processed":default:l.logs.sort((b,E)=>b.index-E.index);break}}function Xe(b){const E=l.logs,Y=E.findIndex(oe=>oe.zippedIndex===l.imageIndex);let he=0,O=1;switch(b.code){case"ArrowUp":he=-1;break;case"ArrowDown":he=1;break;case"PageUp":he=-1,O=z.value/ie.value-1|0;break;case"PageDown":he=1,O=z.value/ie.value-1|0;break;case"Enter":case"NumpadEnter":if(Y>=0&&l.previewCollapsed){$e(()=>r("open-preview")),b.stopPropagation(),b.preventDefault();return}break;default:return}let x=Y,G=-1;const ne=E.length;do{if(x+=he,x<0||x>ne-1||x===Y)break;if(E[x].completed){if(G=x,--O>0)continue;break}}while(!0);if(G>=0){const oe=E[G];r("change-index",!0,oe.path,oe.fileId,oe.zippedIndex),b.preventDefault()}}let De=-1,Ve=-1,V=0,re=!1;function R(b){var he,O;if(pe(),re){re=!1;return}const{scrollLeft:E=0,scrollTop:Y=0}=(O=(he=f.value)==null?void 0:he.scrollbarInstRef)==null?void 0:O.containerRef;(E!==De||De<0)&&(Y===Ve||Ve<0)&&(V=E),De=E,Ve=Y,$e(()=>{var G,ne;re=!0;const x=(ne=(G=f.value)==null?void 0:G.scrollbarInstRef)==null?void 0:ne.containerRef;x&&(x.scrollLeft=V)})}function D(b){a.value=!1}function te(b,E){var oe,ve;const he=(ve=(oe=b.target.closest("tr"))==null?void 0:oe.dataset)==null?void 0:ve.indexLoglist;if(!/^\d+$/.test(he))return;const{completed:O,path:x,fileId:G,zippedIndex:ne}=C.value[he];O&&(l.imageIndex!==ne&&r("change-index",O,x,G,ne),E&&r("open-preview"))}return(b,E)=>{const Y=Ce,he=Ae,O=Pt,x=Ct,G=ze,ne=Et,oe=lt,ve=ft;return I(),J(ve,{name:"log",style:{"white-space":"nowrap"}},{header:e(()=>[n(Y,{align:"center",wrap:!1},{default:e(()=>[L(d(b.$t("status.Log")),1)]),_:1})]),"header-extra":e(()=>[l.opened?(I(),J(Y,{key:0,align:"center",justify:"end",wrap:!0,style:{"margin-top":"0.2em","margin-left":"0.5em"}},{default:e(()=>[n(O,{value:_.value,"onUpdate:value":[E[0]||(E[0]=ge=>_.value=ge),Re],options:t($),style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1,size:"tiny"},{arrow:e(()=>[n(he,{component:t(Ja)},null,8,["component"])]),_:1},8,["value","options"]),n(O,{value:t(S),"onUpdate:value":[E[1]||(E[1]=ge=>Ie(S)?S.value=ge:null),E[2]||(E[2]=ge=>ke())],options:g,placeholder:b.$t("status.filterLogSelect"),size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1},{arrow:e(()=>[n(he,{component:t(el)},null,8,["component"])]),_:1},8,["value","placeholder"]),n(x,{key:"b",checked:a.value,"onUpdate:checked":[E[3]||(E[3]=ge=>a.value=ge),E[4]||(E[4]=ge=>ge&&ue(!0))],size:"small",style:{"font-size":"0.9em"}},{default:e(()=>[L(d(b.$t("status.autoScroll")),1)]),_:1},8,["checked"]),n(oe,{trigger:"hover",show:t(F),disabled:!o.value,placement:"top",delay:0,duration:1e3},{trigger:e(()=>[n(G,{style:{"max-width":"30em"},disabled:!0},{trigger:e(()=>[n(x,{size:"small",checked:o.value,"onUpdate:checked":[E[5]||(E[5]=ge=>o.value=ge),U],style:{"font-size":"0.9em"}},{default:e(()=>[L(d(b.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:e(()=>[L(d(b.$t("status.expandLog")),1)]),_:1})]),default:e(()=>[n(Y,{wrap:!1,align:"center",style:{"font-size":"0.8em"}},{default:e(()=>[n(ne,{value:t(m),"onUpdate:value":E[6]||(E[6]=ge=>Ie(m)?m.value=ge:null),onUpdateValue:E[7]||(E[7]=ge=>K()),disabled:!o.value,"format-tooltip":ge=>`Log size: ${ge}`,tooltip:!0,step:1,min:t(ee),max:t(B),style:{"z-index":"3",width:"100px"}},null,8,["value","disabled","format-tooltip","min","max"])]),_:1})]),_:1},8,["show","disabled"])]),_:1})):me("",!0)]),default:e(()=>[n(Y,{wrap:!1,align:"stretch",class:nt({"log-container":1,"expand-log":o.value}),style:fe({height:t(z)+"px"}),onKeydown:Xe,tabindex:"-1"},{default:e(()=>[n(t(bn),{ref_key:"scrollref",ref:f,distance:10,"x-scrollable":!0,onMousedownCapture:D,onWheel:E[9]||(E[9]=ge=>a.value=!1),onScroll:R,load:"handleLogLoad",trigger:"none",style:fe([{"z-index":"2","padding-right":"10px",height:"100%"},{height:t(z)+"px"}]),size:50},{default:e(()=>[l.opened?(I(),q("table",ar,[y("thead",null,[y("tr",lr,[y("th",{class:"log-th",title:b.$t("status.table.core")},"th",8,sr),E[10]||(E[10]=y("th",{class:"log-th"},"no.",-1)),y("th",ir,d(b.$t("status.table.status")),1),y("th",rr,d(b.$t("status.table.details")),1),E[11]||(E[11]=y("th",{class:"log-th"},"size",-1))])]),y("tbody",{ref:"tbody",onClick:te,onDblclick:E[8]||(E[8]=ge=>te(ge,!0))},[y("tr",{style:fe(t(X))},null,4),(I(!0),q(Pe,null,it(t(C).slice(t(H),t(H)+t(N)),({index:ge,key:Ze,command:Ye,path:gt,core:Le,zippedIndex:rt,completed:mt,fileId:Je,shrinked:La,width:Qt,height:$a,outputWidth:Fa,outputHeight:Ea,size:Pa,outputSize:Xt},Yt)=>(I(),q("tr",{key:Ze,class:nt({"log-tr":1,completed:mt,selected:b.imageIndex===rt,stripe:(t(H)+Yt)%2}),ref_for:!0,ref:Da=>{b.imageIndex===rt&&(w.value=Da)},"data-index-loglist":t(H)+Yt},[y("td",cr,d(Le>=0?Le+1:"-"),1),y("td",dr,d(ge+1),1),y("td",pr,d(Ye),1),y("td",fr,d(gt),1),Qt?(I(),q("td",gr,[L(d(`[${Qt}×${$a}] (${t(He)(Pa,0)})`)+" ",1),Xt?(I(),q("span",mr,[E[12]||(E[12]=L(" → ")),y("span",null," ("+d(t(He)(Xt,0))+") ",1)])):me("",!0),La?(I(),q("span",vr,d(` [${Fa}×${Ea}]`),1)):me("",!0)])):(I(),q("td",hr))],10,ur))),128)),y("tr",{style:fe(t(Z))},null,4)],544)],512)):me("",!0),E[13]||(E[13]=y("div",{style:{height:"1em"}},null,-1))]),_:1,__:[13]},8,["style"])]),_:1},8,["class","style"])]),_:1})}}}),wr={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function br(i,s){return I(),q("svg",wr,s[0]||(s[0]=[y("path",{fill:"currentColor",d:"M4 18h8.13L11 19.13V20H4a2 2 0 0 1-2-2V6c0-1.11.89-2 2-2h6l2 2h8a2 2 0 0 1 2 2v2.15c-.26-.09-.54-.15-.83-.15c-.42 0-.81.11-1.17.3V8H4zm18.85-4.53l-1.32-1.32c-.2-.2-.53-.2-.72 0l-.98.98l2.04 2.04l.98-.98c.2-.19.2-.52 0-.72M13 19.96V22h2.04l6.13-6.12l-2.04-2.05z"},null,-1)]))}const xa=ot({name:"mdi-folder-edit-outline",render:br}),kr={class:"container"},zr={__name:"zipicon",setup(i){return(s,u)=>(I(),q("span",kr,[n(t(Ae),null,{default:e(()=>[n(t(Nt))]),_:1}),u[0]||(u[0]=y("span",{class:"text"},"ZIP",-1))]))}},Sr=Me(zr,[["__scopeId","data-v-8b8df2f0"]]),Cr=["innerHTML"],Tr={style:{margin:"1px"}},Ar=["href","download","onClick"],xr={key:0,style:{position:"relative"}},Ir=["href","download"],Lr=["href","download"],$r={style:{"margin-left":"0.5em"}},Fr={key:0,style:{margin:"1px"}},Er=["href","download","onClick"],Pr=ye({__name:"status.result",props:{processing:{type:Boolean},listLength:{},zippingFlag:{type:Boolean},converted:{},success:{},zippedTotalCount:{},zippedTotalSize:{},baseZipName:{},zips:{},unconvertedListText:{},unconvertedFileCount:{},unconvertedTotalSize:{},failedZips:{},failedZipDone:{type:Boolean},failedToCreateFailedZip:{type:Boolean},failedFileZippedCount:{},imgUrl:{},imgName:{},type:{},outputToDir:{type:Boolean},outputDirName:{}},emits:["all-zips-clicked","demand-zip-errors"],setup(i,{emit:s}){const u=pt(),{t:l}=je(),o=Ft(),a=i,r=s,c=v(!1),f=v([]),w=v([]),k=v(void 0),z=Se(()=>[{key:"open",label:l("status.openFailedList"),icon:()=>le(Ae,()=>le(Sn)),onSelect(){F()}},{key:"download",label:l("status.saveFailedList"),icon:()=>le(Ae,()=>le(nl)),onSelect(){F(!0)}},{key:"zip",label:`${l("status.zipFailedList")}`+(a.failedZipDone?`(✔${l("status.done")})`:""),icon:()=>le(Wt,{show:c.value&&!a.failedZipDone,size:"small"},()=>le(Ae,()=>le(Nt))),disabled:c.value,onSelect(p){return c.value=!0,r("demand-zip-errors"),!1}}]);be([()=>a.zips.length,()=>a.failedZips.length],()=>{{f.value.length>a.zips.length&&(f.value.length=0);let p=0;const $=a.zips.length===1&&a.zippedTotalCount===a.listLength;for(let _=f.value.length;_<a.zips.length;_++){const g=a.zips[_],S=a.baseZipName+($?"":"-"+String(_+1).padStart(2,"0"))+".zip";p+=g.size,f.value[_]={url:g.url,size:g.size,number:$?0:_+1,sizeByUnit:He(g.size),name:S,count:g.count,clicked:!1}}}{w.value.length>a.failedZips.length&&(w.value.length=0);let p=0;const $=a.failedZipDone&&a.failedZips.length===1;for(let _=w.value.length;_<a.failedZips.length;_++){const g=a.failedZips[_],S=a.baseZipName+"-error"+($?"":"-"+String(_+1).padStart(2,"0"))+".zip";p+=g.size,w.value[_]={url:g.url,size:g.size,number:$?0:_+1,sizeByUnit:He(g.size),name:S,count:g.count,clicked:!1}}}});function m(p,$=!1){const{url:_,name:g}=p;if($){const S=document.createElement("a");S.href=_,S.download=g,S.click()}p.clicked||(p.clicked=!0,a.processing||f.value.every(S=>S.clicked)&&r("all-zips-clicked"))}async function C(p){if(a.zippingFlag){if(f.value.length>=2&&!await new Promise((g,S)=>u.warning({title:l("Download"),content:l("status.confirmDownloadMessage",[f.value.length]),positiveText:"OK",negativeText:l("cancel"),onPositiveClick:()=>g(!0),onNegativeClick:()=>S()})))return;const $=f.value;for(const _ of $)m(_,!0)}}function F(p=!1){const $=new Blob([a.unconvertedListText],{type:"text/plain;charset=utf8"}),_=URL.createObjectURL($),g=document.createElement("a");g.href=_,g.target="_blank",p&&(g.download=a.baseZipName+"-error.txt"),g.click()}return(p,$)=>{const _=zn,g=lt,S=Fe,h=Ce,A=Sr,M=kn,P=xa,B=Tn,ee=ol,K=ft;return I(),J(K,{name:"output",style:{"white-space":"nowrap"},disabled:""},{header:e(()=>[y("span",{style:{color:"black"},innerHTML:p.$t("status.Output")},null,8,Cr)]),default:e(()=>[n(h,{wrap:!1,vertical:"",style:{"margin-top":"-1.3em"}},{default:e(()=>[p.outputToDir?me("",!0):(I(),J(h,{key:0,justify:"center"},{default:e(()=>[Ge(n(h,{vertical:"",align:"center"},{default:e(()=>[n(g,{placement:"left"},{trigger:e(()=>[n(_,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":a.zippedTotalCount===p.listLength?"white":"green",processing:a.processing,percentage:a.zippedTotalCount/p.listLength*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:e(()=>[y("span",Tr,d(a.zippedTotalCount/p.listLength*100|0)+"% "+d(p.$t("status.zippingProgress"))+" ("+d(a.zippedTotalCount)+"/"+d(a.converted)+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:e(()=>[L(" "+d(p.$t("status.zippingProgress"))+" ("+d(a.zippedTotalCount/a.listLength*100|0)+"%) ",1)]),_:1}),t(f).length>=2||a.processing?(I(),J(Tt,{key:0,name:"zips",class:"zip-buttons-parent",tag:"div"},{default:e(()=>[(I(!0),q(Pe,null,it(t(f),(U,T)=>(I(),q("span",{key:T},[n(g,{trigger:"hover",duration:0,delay:0},{trigger:e(()=>[y("a",{href:U.url,download:U.name,class:"in-button-anchor",onClick:ae=>m(U)},[n(S,{class:"zip-button",size:"tiny",color:U.clicked?"#050":"lime","text-color":U.clicked?"gray":"white",onClick:ct(ae=>m(U),["stop"]),round:""},{default:e(()=>[n(t(Ae),{size:"tiny"},{default:e(()=>[n(t(Nt))]),_:1}),L("ZIP"+d(U.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Ar)]),default:e(()=>[y("div",{style:fe({color:t(o).successColor})},[y("div",null,"ZIP "+d(U.number||"")+" ("+d(p.$t("success"))+")",1),y("div",null,d(U.name),1),y("div",null,d(U.sizeByUnit),1),y("div",null,d(p.$rt("{n} @:files",U.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):me("",!0)]),_:1},512),[[Ke,p.zippingFlag]])]),_:1})),n(qe,null,{default:e(()=>[Ge(n(h,{justify:"center",align:"center"},{default:e(()=>[p.outputToDir?(I(),J(g,{key:1,trigger:"hover",duration:0,delay:0,placement:"left",style:fe({color:"white",backgroundColor:t(o).successColor}),"arrow-style":{backgroundColor:t(o).successColor}},{trigger:e(()=>[n(h,{align:"center",size:1,style:fe(`border: 1px solid ${t(o).successColor}; border-radius:4px; padding:0.3em;`)},{default:e(()=>[n(P,{style:{"vertical-align":"middle"}}),n(B,{style:{"font-size":"smaller","max-width":"25em"}},{default:e(()=>[L(d(p.outputDirName),1)]),_:1}),y("span",$r,[y("span",{style:fe({color:t(o).successColor})},d(p.success),5),L(" "+d(t(l)("files",p.success)),1)])]),_:1},8,["style"])]),default:e(()=>[L(d(p.$t("status.numberOfFilesWrittenToDir")),1)]),_:1},8,["style","arrow-style"])):(I(),J(g,{key:0,trigger:"hover",duration:0,delay:0,placement:"left",style:fe({color:"white",backgroundColor:t(o).successColor}),"arrow-style":{backgroundColor:t(o).successColor}},{trigger:e(()=>[n(qe,{name:"save"},{default:e(()=>[p.success>0?(I(),q("span",xr,[n(M,{value:p.zippingFlag?a.zippedTotalCount.toLocaleString("en-us"):a.type.replace(/\(.+\)/,""),color:t(o).successColorHover,offset:[-20,-3]},{default:e(()=>[p.zippingFlag?(I(),J(S,{key:0,size:"medium",onClick:C,color:t(o).successColor,round:""},{default:e(()=>[t(f).length?(I(),q("a",{key:0,href:t(f)[0].url,download:t(f)[0].name,class:"in-button-anchor",onClick:$[0]||($[0]=ct(()=>{},["prevent"]))},[n(A),L(" × "+d(t(f).length)+" "+d(p.$t("status.saveAll")),1)],8,Ir)):me("",!0)]),_:1},8,["color"])):(I(),q("a",{key:1,href:a.imgUrl,download:a.imgName,class:"in-button-anchor"},[n(S,{size:"medium",color:t(o).successColor,round:""},{default:e(()=>[n(t(Ae),{size:"tiny",component:t(Cn)},null,8,["component"]),L(" "+d(p.$t("save")),1)]),_:1},8,["color"])],8,Lr))]),_:1},8,["value","color"])])):me("",!0)]),_:1})]),default:e(()=>[a.listLength>=2?(I(),q(Pe,{key:0},[y("div",null,d(t(l)("success"))+": "+d(p.zippedTotalCount.toLocaleString()),1),y("div",null,d(t(l)("status.totalSize"))+": "+d(t(He)(a.zippedTotalSize)),1),y("div",null,"ZIP × "+d(t(f).length),1),y("div",null,d(t(l)("status.saveAllZipsTooltip")),1)],64)):(I(),q(Pe,{key:1},[L(d(p.$t("status.downloadConvertedImage",t(f).length)),1)],64))]),_:1},8,["style","arrow-style"])),!a.processing&&a.success!==p.listLength?(I(),J(ee,{key:2,options:t(z),onSelect:$[1]||($[1]=(U,T)=>{var ae;return(ae=t(z).find(({key:ue})=>U===ue))==null?void 0:ae.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:e(()=>[n(g,{show:t(k),duration:0,delay:0,placement:"right",style:fe({color:"white",backgroundColor:t(o).errorColor}),"arrow-style":{backgroundColor:t(o).errorColor}},{trigger:e(()=>[n(M,{value:a.unconvertedFileCount.toLocaleString(),color:t(o).errorColorHover,offset:[-0,-3]},{default:e(()=>[n(S,{size:"small",color:t(o).errorColor},{default:e(()=>[n(t(Ae),{size:"medium",style:{"vertical-align":"middle"},component:t(al)},null,8,["component"])]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:e(()=>[y("div",null,[y("div",null,d(t(l)("failed"))+": "+d(a.unconvertedFileCount.toLocaleString()),1),y("div",null,d(t(l)("status.totalSize"))+": "+d(t(He)(a.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])):me("",!0)]),_:1},512),[[Ke,!a.processing||p.outputToDir]])]),_:1}),n(qe,{name:"zipcontainer"},{default:e(()=>[Ge(n(h,{vertical:"",align:"center"},{default:e(()=>[n(g,{placement:"left"},{trigger:e(()=>[n(_,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":a.failedFileZippedCount===a.unconvertedFileCount?"white":"#500",processing:t(c)&&!a.failedZipDone&&!a.failedToCreateFailedZip,percentage:a.failedFileZippedCount/a.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:e(()=>[a.failedToCreateFailedZip?(I(),q("div",{key:1,style:fe({color:t(o).errorColor})},d(p.$t("status.failureZippingFailedFiles")),5)):(I(),q("span",Fr,d(a.failedFileZippedCount/a.unconvertedFileCount*100|0)+"% "+d(p.$t("status.zipped"))+" ("+d(a.failedFileZippedCount)+"/"+d(a.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:e(()=>[L(" "+d(p.$t("status.zippingProgress"))+" ("+d(a.failedFileZippedCount/a.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(Tt,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:e(()=>[(I(!0),q(Pe,null,it(t(w),(U,T)=>(I(),q("span",{key:T},[n(g,{trigger:"hover",duration:0,delay:0},{trigger:e(()=>[y("a",{href:U.url,download:U.name,class:"in-button-anchor",onClick:ae=>m(U)},[n(S,{class:"zip-button",size:"tiny",color:U.clicked?"#551122":"#F00","text-color":U.clicked?"gray":"white",onClick:ct(ae=>m(U),["stop"]),round:""},{default:e(()=>[n(t(Ae),{size:"tiny",component:t(ll)},null,8,["component"]),L("ZIP"+d(U.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Er)]),default:e(()=>[y("div",{style:fe({color:t(o).errorColor})},[y("div",null,"ZIP "+d(U.number||"")+" ("+d(p.$t("failed"))+")",1),y("div",null,d(U.name),1),y("div",null,d(U.sizeByUnit),1),y("div",null,d(p.$rt("{n} @:files",U.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1},512),[[Ke,t(c)]])]),_:1})]),_:1})]),_:1})}}}),Dr=Me(Pr,[["__scopeId","data-v-1aee218a"]]),Or=ye({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image","delete-image"],setup(i,{expose:s,emit:u}){const l={itemMargin:"1px",titlePadding:"2px",titleFontSize:"0.8rem"},{t:o}=je(),a=Ft(),r=i,c=u;s({cleanup:Ve});const f=v(!1),w=v([]),k=v(!1),z=v(!1),m=v([0,0]),C=v([0,0]),F=v([0,0]),p=v([0,0]),$=v([0,0]),_=v([0,0]),g=v(0),S=v(0),h=v([0,0]),A=v(0),M=v(a.value.infoColor),P=v("#000000"),B=v("#000000"),ee=v(0),K=v(0),U=v(""),T=v("00:00:00"),ae=v(null),ue=v(["progress","log","output"]),X=V=>ue.value.includes(V),Z=V=>ue.value.push(V),H=V=>{const re=ue.value.findIndex(R=>R===V);re>=0&&ue.value.splice(re,1)},N=Se(()=>ue.value.includes("log")),ie=Se(()=>ue.value.includes("progress")),se=v(!1),ce=v(!0),_e=v("processed"),Q=$t({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:0,various:{shrinked:!1}}),Ee=dt("body"),pe=dt("imageViewer");Oe(()=>{be(r.status,()=>Ue(),{deep:!1});let V=0;const re=()=>{if(V)return;const R=Date.now();T.value="00:00:00",V=window.setInterval(()=>{const D=(Date.now()-R)/1e3;T.value=`${String(D/3600|0).padStart(2,"0")}:${String(D/60%60|0).padStart(2,"0")}:${String(D%60|0).padStart(2,"0")}`},300)};re(),z.value=!0,be(()=>r.processing,(R,D)=>{R||Re(),R?(re(),w.value.length=0,f.value=!1,k.value=!1):(clearInterval(V),V=0)}),et(()=>{clearInterval(V),clearTimeout(we)}),At(()=>clearInterval(V))}),et(()=>{Ve()}),At(()=>{clearTimeout(we)});const ke=r.interval||100;let de=!1,we=0;function Ue(){if(de)return;if(we){de=!0;return}we=window.setTimeout(()=>{we=0,de&&(de=!1,Ue())},ke);const V=r.status;f.value=V.length>=2,C.value[1]=C.value[0],C.value[0]=V.startedCount,F.value[1]=F.value[0],F.value[0]=V.success,p.value[1]=p.value[0],p.value[0]=V.failure,$.value[1]=$.value[0],$.value[0]=V.done,_.value[1]=_.value[0],_.value[0]=V.converted,g.value=V.retried,S.value=V.length,h.value[1]=h.value[0],h.value[0]=V.zippedTotalCount,ee.value=V.inputTotalSize,K.value=V.outputTotalSize,A.value=V.failedFileZippedCount;const re=K.value-ee.value;U.value=(re>=0?"+ ":"")+He(re);const R=K.value/ee.value,D=(256|Math.min(255,Math.max(0,R-1.5)*255|0)).toString(16).substring(1);P.value="#"+D+"0000";const te=1024*1024,b=(256|Math.min(255,Math.max(0,re/1024/te)*255|0)).toString(16).substring(1);B.value="#"+b+"0000",m.value[1]=m.value[0],m.value[0]=F.value[0]/S.value*100,(N.value||!r.processing)&&(w.value=w.value.concat(V.logs),V.logs.length=0),ae.value=V.thumbnail,r.processing?M.value=p.value[0]?a.value.errorColor:g.value?a.value.warningColor:a.value.infoColor:z.value=!1,V.convertedImageUrl!==Q.url&&(Q.url=V.convertedImageUrl,Q.name=V.convertedImageName,Q.dataUrl=V.convertedImageDataUrl,Q.size=V.convertedImageSize||V.outputTotalSize,Q.originalSize=V.convertedImageOrgSize,Q.originalName=V.convertedImageOrgName,Q.index=V.convertedImageIndex,Q.originalUrl=V.convertedImageOrgUrl,Q.various={shrinked:V.convertedImageShrinked})}function Re(){const V=r.status;M.value=r.status.success===r.status.length?a.value.successColor:a.value.errorColor,_e.value==="processed"&&(_e.value="zipped"),V.success>0&&(ce.value&&(H("log"),se.value=!0),Z("preview"))}async function Xe(V,re,R,D){var b;if(!V)return;const te=D;X("preview")||(Z("preview"),await $e()),(b=pe.value)==null||b.changeIndex(te+1),await $e(()=>{var E;try{(E=pe.value)==null||E.$el.scrollIntoView({behavior:"instant",block:"nearest"})}catch{}})}const De=v(!1);function Ve(){De.value=!0,URL.revokeObjectURL(Q.url),URL.revokeObjectURL(Q.originalName),Q.originalUrl="",Q.url="",Q.index=0,r.status.logs.length=0,w.value.length=0}return(V,re)=>{const R=Ce,D=ft,te=Vt;return I(),J(R,{ref_key:"body",ref:Ee,vertical:"",justify:"center"},{default:e(()=>[n(te,{"display-directive":"show","trigger-areas":["arrow","main"],"expanded-names":t(ue),"onUpdate:expandedNames":re[7]||(re[7]=b=>Ie(ue)?ue.value=b:null),"theme-overrides":l},{default:e(()=>[n(Vi,{processing:t(z),"elapsed-time":t(T),"success-perc":t(m)[0],"input-total-size":t(ee),"output-total-size":t(K),"file-type":r.status.type,shrink:r.status.shrink,threads:r.status.threads,"zip-size":r.status.zipSize,"output-to-dir":r.status.outputToDir,"rate-color":t(P),"dif-color":t(B),"total-size-dif-str":t(U),thumbnail:t(ae),opened:t(ie)},{center:e(()=>[t(De)?me("",!0):(I(),J(or,{key:0,index:t(C)[0],success:t(F)[0],length:V.status.length,"success-to":t(F)[0],"success-from":t(F)[1],failure:t(p)[0],"success-perc-to":t(m)[0],"success-perc-from":t(m)[1],retried:t(g),processing:t(z),interval:t(ke),"status-color":t(M),class:"center-column"},null,8,["index","success","length","success-to","success-from","failure","success-perc-to","success-perc-from","retried","processing","interval","status-color"]))]),_:1},8,["processing","elapsed-time","success-perc","input-total-size","output-total-size","file-type","shrink","threads","zip-size","output-to-dir","rate-color","dif-color","total-size-dif-str","thumbnail","opened"]),n(_r,{processing:t(z),"image-index":t(Q).index,opened:t(N),"preview-collapsed":X("preview"),logs:t(w),expanded:t(se),"onUpdate:expanded":re[0]||(re[0]=b=>Ie(se)?se.value=b:null),"auto-scroll":t(ce),"onUpdate:autoScroll":re[1]||(re[1]=b=>Ie(ce)?ce.value=b:null),order:t(_e),onChangeIndex:Xe,onOpenPreview:re[2]||(re[2]=b=>{var E;return(E=t(pe))==null?void 0:E.openPreview()}),name:"log",style:{"white-space":"nowrap"}},null,8,["processing","image-index","opened","preview-collapsed","logs","expanded","auto-scroll","order"]),n(D,{title:V.$t("status.PreviewImage"),name:"preview",style:{"white-space":"nowrap"},disabled:!(t(F)[0]>0)},{default:e(()=>[n(R,{justify:"center",align:"center",vertical:"",style:{"margin-top":"-1em"}},{default:e(()=>[n(Ri,{"_v-else-if":"imageViewerStarted && status.success > 0 /*&& (props.status.threads || !zippingFlag)*/ && !cleaningUp",ref_key:"imageViewer",ref:pe,url:t(Q).url,size:t(Q).size,"original-url":t(Q).originalUrl,"original-size":t(Q).originalSize,name:t(Q).name,originalName:t(Q).originalName,length:t(F)[0],index:t(Q).index,"various-info":t(Q).various,"is-single":!t(f),onDemandImage:re[3]||(re[3]=b=>c("demand-image",b)),on_deleteImage:re[4]||(re[4]=b=>c("delete-image",b)),_close:"imageViewerStarted=false"},null,8,["url","size","original-url","original-size","name","originalName","length","index","various-info","is-single"])]),_:1})]),_:1},8,["title","disabled"]),n(Dr,{processing:t(z),"list-length":t(S),zippingFlag:t(f),zips:r.status.zips,"img-url":t(Q).url,"img-name":t(Q).name,success:t(F)[0],failure:t(p)[0],done:t($)[0],converted:t(_)[0],retried:t(g),"zipped-total-count":t(h)[0],"zipped-total-size":r.status.zippedTotalSize,"base-zip-name":r.status.baseZipName,"failed-file-zipped-count":t(A),"failed-to-create-failed-zip":r.status.failedToCreateFailedZip,"failed-zip-done":r.status.failedZipDone,"failed-zips":r.status.failedZips,"unconverted-file-count":r.status.unconvertedFileCount,"unconverted-list-text":r.status.unconvertedListText,"unconverted-total-size":r.status.unconvertedTotalSize,"output-to-dir":V.status.outputToDir,"output-dir-name":V.status.outputDirName,type:r.status.type,onAllZipsClicked:re[5]||(re[5]=b=>c("all-zips-clicked")),onDemandZipErrors:re[6]||(re[6]=b=>c("demand-zip-errors"))},null,8,["processing","list-length","zippingFlag","zips","img-url","img-name","success","failure","done","converted","retried","zipped-total-count","zipped-total-size","base-zip-name","failed-file-zipped-count","failed-to-create-failed-zip","failed-zip-done","failed-zips","unconverted-file-count","unconverted-list-text","unconverted-total-size","output-to-dir","output-dir-name","type"])]),_:1},8,["expanded-names"])]),_:1},512)}}}),Mr=Me(Or,[["__scopeId","data-v-a067ea79"]]),Ur=["innerHTML"],Rr={style:{color:"red"}},Br=ye({__name:"converter",props:We({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},autoStart:{type:Boolean},threads:{},outputToDir:{type:Boolean},outputDirHandle:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:We(["start","end"],["update:showNote"]),setup(i,{expose:s,emit:u}){at(Qe);const{t:l}=je(),o=pt(),a=An(),r=10,c=navigator.hardwareConcurrency,f=typeof OffscreenCanvas=="function",w=100,k=v([[()=>l("dupAction_overwrite"),"overwrite"],[()=>l("dupAction_skip"),"skip"],[()=>l("cancel"),"cancel"]]),z=i,m=Te(i,"showNote"),C=u;s({beginConversion:de});const F=v(!1),p=v(!1),$=v(!1),_=v(!1),g=v(!1),S=v(()=>"initializing"),h=v("info"),A=$t(Ue()),M=dt("stat"),P=v(0),B=Se(()=>{var O;return(O=z.input)==null?void 0:O.length}),ee=v(),K=v(""),U=v(!1),T=v(!0),ae=v(!1);let ue=()=>{};const X=v(!1);let Z=!1,H=!1,N,ie=()=>{},se,ce=0,_e=!1;be(()=>z.input.length,(O,x)=>{O>=x&&z.autoStart&&de()}),be(_,O=>{document.body.style.overflowY=O?"hidden":"auto"}),Oe(async()=>{await V(),re()});async function Q(){let O=!0;if(ce>r*1e3&&!z.outputToDir&&!_e&&A.success>0&&(O=!1,await new Promise(x=>{o.warning({title:l("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:l("close"),negativeText:l("back"),onPositiveClick:()=>O=!0,onAfterLeave:x,content:l("confirmCloseDialog")})})),!O)return!1;a.destroyAll(),_.value=!1,m.value=!1}function Ee(O){se==null||se(O)}function pe(O){Mt==null||Mt(O)}function ke(){!p.value&&F.value?p.value=!0:Q()}async function de(){var O;if(!((O=z.input)!=null&&O.length)||F.value){o.error({title:"error",positiveText:"OK",content:"An unexpected error occurred."});return}if(z.outputToDir&&!z.outputDirHandle){o.error({title:"error",positiveText:"OK",content:l("errMsgOutputDirNotFound")});return}if(F.value){o.error({title:"Busy",positiveText:"OK",content:l("interfered")});return}if(z.outputToDir&&!X.value&&(await new Promise(x=>{ae.value=!0,Z=!1,ue=x}),!Z)){X.value=!1;return}Xe(z.input)}let we=v(()=>{});function Ue(O){const x={logs:[],ziplogs:[],startedCount:0,converted:0,success:0,failure:0,retried:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",convertedImageOrgUrl:"",convertedImageIndex:-1,convertedImageShrinked:!1,zipSize:z.maxZipSizeMB,shrink:W.multithread&&W.shrinkImage?[W.maxWidth,W.maxHeight]:void 0,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1,outputToDir:z.outputToDir,outputDirName:z.outputDirHandle?z.outputDirHandle.name:""};return Object.assign(O||{},x)}function Re(){g.value=!1,URL.revokeObjectURL(A.convertedImageUrl),URL.revokeObjectURL(A.convertedImageOrgUrl);for(const O of A.zips)URL.revokeObjectURL(O.url);A.zips.length=0;for(const O of A.failedZips)URL.revokeObjectURL(O.url);A.failedZips.length=0,Ue(A),ie(),ie=()=>{},se=null,_e=!1,$.value=!1,p.value=!1,D=!1,te.length=0,N=void 0,E.clear(),Y.clear()}async function Xe(O){_.value&&(P.value^=1);let x=O.concat();Ue(A),Re(),_.value=!0,g.value=!0,F.value=!0,A.processing=!0,h.value="info",S.value=()=>l("processing");const G=new Set,ne=[],oe=z.format,ve=z.quality,ge=[...oe.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),Ze=Ve(oe,ve,x[0].webkitRelativePath);let Ye=new Set;z.outputDirHandle&&(Ye=await di(z.outputDirHandle,x)),A.length=x.length,A.baseZipName=Ze,A.type=oe.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(oe)?" ("+ve+")":""),A.threads=H?0:z.threads;const gt=Date.now();C("start");let Le,rt,mt;if(!H&&z.threads>=2?(se=zi,mt=await fi({files:x,completedFileIdSet:G,completedFileDat:ne,ConvStats:A,canceled:p,props:z,imageType:oe,quality:ve,outputExt:ge,format:oe,message:a,fsysDirHandler:z.outputDirHandle,writeUsingFileSystem:R,enqueueOverwriteConfirmation:b,existingFolders:Ye})):(se=Ti,mt=await Ci(x,G,z,p,A)),{exception:rt,callbackToGenerateFailedZips:Le,callbackToClearConverter:ie}=mt,rt){let Je;switch(rt.message){case"worker-load-error":Je=l("errMsgWorkerLoadError");break;default:Je="unexpected error"}o.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:()=>le("div",[le("p",Je),le(Fe,{onClick(){location.reload()}},l("Reload"))])})}if(A.success===A.length?(h.value="success",S.value=()=>l("completed")):(h.value="error",S.value=()=>p.value?l("aborted"):l("incomplete")),G.size!==x.length){const Je=De(O,G);we.value=()=>{!Je||!Je.length||Le(Je)}}F.value=!1,A.processing=!1,$.value=!0,x.length=0,ce=Date.now()-gt,C("end")}function De(O,x){const G=[],ne=[];let oe=0;for(const ve of O)x.has(ve._id)||(G.push(ve),ne.push(ve.webkitRelativePath||ve.relativePath||ve.name),oe+=ve.size);return ne.length&&(A.unconvertedListText=ne.join(`
`),A.unconvertedFileCount=G.length,A.unconvertedTotalSize=oe),G}function Ve(O,x,G){var Ze;const ne=new Date;O=O.replace(/^image\//,"").toLowerCase();const oe=W.useFolderNameForZip&&((Ze=String(G).match(/^\/?([^/]+)\//))==null?void 0:Ze[1])||"avif2jpg",ve=`
    ${ne.getFullYear().toString().substring(2)}
    ${String((ne.getMonth()+1)*100+ne.getDate()).padStart(4,"0")}
    ${String(ne.getHours()*1e4+ne.getMinutes()*100+ne.getSeconds()).padStart(6,"0")}
    -
    ${O+(/jpe?g|webp/i.test(O)?x:"")}
  `.replace(/\s/g,"");return`${oe}-${ve}`.replace(/\s+/g," ")}async function V(){const O="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",x=document.createElement("img"),G=Aa(x).then(()=>!0,()=>!1);x.src=O,await G||o.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:l("avifUnsupported")})}function re(){(!f||c<2||!Promise.any)&&(H=!0),H&&(Be.value=0)}async function R(O,x){const G=z.outputDirHandle;if(!G)throw new Error("Directory Handle is empty");await ui(G,O,x,!0)}let D=!1;const te=[];async function b(O,x,G,ne){D?te.push({resolver:O,target:x,type:G,path:ne}):(D=!0,he(O,x,G))}const E=new Set,Y=new Set;async function he(O,x,G,ne){let oe="";if(p.value?oe="cancel":E.has(x)?oe="overwrite":Y.has(x)?oe="skip":(K.value=x,T.value=G==="folder",oe=N||await ee.value.start(),oe.startsWith("cancel")&&(p.value=!0),oe==="overwrite"&&E.add(x),oe==="skip"&&Y.add(x),oe==="close"&&(U.value=!1),await $e(),!N&&U.value&&(oe+="-all",N=oe)),O(oe),te.length){const{resolver:ve,target:ge,type:Ze,path:Ye}=te.shift();he(ve,ge,Ze)}else D=!1}return(O,x)=>{const G=Ks,ne=Ae,oe=ze,ve=Ce,ge=Wt,Ze=kt,Ye=Ca,gt=Hs;return I(),q(Pe,null,[t(F)?me("",!0):(I(),J(ve,{key:0,justify:"center",align:"center",style:{"margin-top":"0.4em"}},{default:e(()=>[n(oe,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:e(()=>[n(qe,null,{default:e(()=>[n(t(Fe),{disabled:!t(B),onClick:de,round:"",size:"large",style:{"font-size":"1.5em",padding:"1em"},type:t(B)?"success":void 0,"_:class":"{'button-ready': isReadyToConvert}"},{icon:e(()=>[n(ne,{size:"1.2em"},{default:e(()=>[n(G)]),_:1})]),default:e(()=>[L(" "+d(t(l)("StartConversion")),1)]),_:1},8,["disabled","type"])]),_:1})]),default:e(()=>[y("div",{innerHTML:t(B)?t(l)("convertTooltip"):t(l)("convertUnpreparedTooltip")},null,8,Ur)]),_:1})]),_:1})),n(Ze,{ref:"processingModal","display-directive":"show",show:t(_),"onUpdate:show":x[2]||(x[2]=Le=>Ie(_)?_.value=Le:null),closable:t($),"close-on-esc":!1,preset:"dialog",onClick:x[3]||(x[3]=Le=>{t(a).destroyAll()}),onMaskClick:x[4]||(x[4]=Le=>{t(a).destroyAll()}),onClose:Q,onEsc:ke,title:t(S),type:t(h),"mask-closable":!1,onAfterLeave:Re,onBeforeLeave:x[5]||(x[5]=Le=>{t(M).cleanup()}),class:"processing-dialog"},{default:e(()=>[n(ve,{vertical:"",style:{"flex-grow":"1"}},{default:e(()=>[t(g)?(I(),J(Mr,{ref_key:"stat",ref:M,key:t(P),processing:t(F),status:t(A),interval:w,onAllZipsClicked:x[0]||(x[0]=Le=>Ie(_e)?_e.value=!0:_e=!0),onDemandZipErrors:t(we),onDemandImage:Ee,onDeleteImage:pe},null,8,["processing","status","onDemandZipErrors"])):me("",!0),n(ve,{justify:"end",align:"center",wrap:!1},{default:e(()=>[t(F)?(I(),J(t(Fe),{key:0,disabled:t(p),ref:"cancelbutton",round:"",size:"large",onClick:x[1]||(x[1]=Le=>p.value=!0)},{default:e(()=>[n(ge,{show:t(p)&&!t($),size:"small"},{default:e(()=>[L(d(t(l)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):t($)?(I(),J(t(Fe),{key:1,onClick:Q,round:"",size:"large"},{default:e(()=>[L(d(t(l)("close")),1)]),_:1})):me("",!0)]),_:1})]),_:1})]),_:1},8,["show","closable","title","type"]),n(Fn,{ref_key:"promptref",ref:ee,closable:"",draggable:"",type:"warning","close-on-esc":"",buttons:t(k),"show-apply-all":"","label-apply-all":O.$t("confirmApplyAllLabel"),"apply-all-checked":t(U),"onUpdate:applyAllChecked":x[6]||(x[6]=Le=>Ie(U)?U.value=Le:null)},{header:e(()=>[L(d(O.$t("confirmFileOverwriteTitle",{type:t(T)?O.$t("folder"):O.$t("file")})),1)]),default:e(()=>[y("div",null,d(O.$t("confirmFileOverwriteMsg",{type:t(T)?O.$t("folder"):O.$t("file")})),1),n(ve,{class:"path",align:"center",size:1,wrap:!1},{default:e(()=>[t(T)?(I(),J(Ye,{key:0})):(I(),J(gt,{key:1})),L(" "+d(t(K)),1)]),_:1})]),_:1},8,["buttons","label-apply-all","apply-all-checked"]),n(Ze,{preset:"dialog",type:"warning",show:t(ae),"onUpdate:show":x[7]||(x[7]=Le=>Ie(ae)?ae.value=Le:null),title:O.$t("warnAboutFileSysTitle"),onAfterLeave:x[8]||(x[8]=Le=>t(ue)()),"positive-text":O.$t("Continue"),"negative-text":O.$t("cancel"),onPositiveClick:x[9]||(x[9]=Le=>void(Ie(Z)?Z.value=!0:Z=!0)),onNegativeClick:x[10]||(x[10]=Le=>void(Ie(Z)?Z.value=!1:Z=!1))},{default:e(()=>[y("p",null,d(O.$t("warnAboutFileSysBeforeConversion1")),1),n(ve,{class:"path",align:"center",size:1,wrap:!1},{default:e(()=>[n(Ye),L(" "+d(O.outputDirHandle.name),1)]),_:1}),y("p",Rr,d(O.$t("warnAboutFileSysBeforeConversion2")),1)]),_:1},8,["show","title","positive-text","negative-text"])],64)}}}),Nr={class:"container-1"},jr={style:{color:"gray",padding:"0.2em","font-size":"smaller","text-align":"center"}},Zr=["innerHTML"],Hr={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},Wr=ye({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(i,{emit:s}){at(Qe);const u=i,l=s,o=sl(),a=v(!1),r=v(0),c=v("");Oe(()=>{f(u.dropTarget||document)});function f(k){document.ondragstart=z=>z.preventDefault(),document.ondragover=z=>z.preventDefault(),k.ondrop=async z=>{var C;if(z.preventDefault(),a.value||u.forbidden)return;a.value=!0,r.value=0,c.value="";let m;try{const F=[...z.dataTransfer.items].map(p=>p.webkitGetAsEntry());o.start(),m=await w(F),o.finish()}catch{m=[...((C=z.dataTransfer)==null?void 0:C.files)??[]],o.error()}a.value&&(a.value=!1,l("drop",m))}}async function w(k,z){z=z||[];for(const m of k)if(m.isFile){const C=await new Promise(F=>m.file(p=>F(p)));Object.defineProperty(C,"webkitRelativePath",{value:m.fullPath.replace(/^\//,"")}),z.push(C),r.value++}else if(m.isDirectory){c.value=m.fullPath;const C=m.createReader();do{const F=await new Promise(p=>C.readEntries($=>p($)));if(!F.length)break;await w(F,z)}while(!0)}return z}return(k,z)=>{const m=ze,C=Ce,F=kt;return I(),q("div",Nr,[n(m,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:e(()=>[y("div",jr," ("+d(k.$t("droptargetLabel"))+") ",1)]),default:e(()=>[y("h3",{innerHTML:k.$t("droptargetTooltip"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,Zr)]),_:1}),n(F,{show:t(a),"onUpdate:show":z[0]||(z[0]=p=>Ie(a)?a.value=p:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":k.$t("cancel")},{default:e(()=>[n(C,{vertical:"",align:"center"},{default:e(()=>[y("div",Hr,d(t(c)),1),y("div",null,"found "+d(t(r))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])])}}}),Vr=Me(Wr,[["__scopeId","data-v-bf1cf34d"]]),qr={class:"container-1"},Gr={class:"container-2"},Kr=["innerHTML"],Qr=["innerHTML"],Xr={style:{"white-space":"nowrap"}},Yr={style:{"padding-left":"1em"}},Jr=["innerHTML"],eu=["accept"],tu=ye({__name:"file-selector",props:We({target:{},userExtensions:{},forbidden:{type:Boolean}},{"auto-start-opt":{type:Boolean,required:!0},"auto-start-optModifiers":{},expanded:{type:Boolean,required:!1},expandedModifiers:{},disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:We(["input","click","cancel","on-change-accept","update:target","update:userExtensions"],["update:auto-start-opt","update:expanded","update:disableNotifyingFolderSelect"]),setup(i,{emit:s}){const u=pt(),{t:l}=je(),o=at(Qe),a=["avif_only","all_images","all_files","edit_type"],r=[];for(const Z of a)r.push({label:()=>l("fileTypeRadioOptions."+Z),value:Z});const c=({node:Z,option:H})=>le(ze,{placement:"right"},{trigger:()=>Z,default:()=>U(H.value).replace(/,/g,", ")}),f=i,w=Te(i,"auto-start-opt"),k=s,z=v(0),m=v(!1),C=v(!1),F=Se(()=>U(_.value)),p=Se(()=>g.value.split(",").every(H=>/^\s*(\.[\w\-]+)*\s*$/.test(H))?"success":"error"),$=Se(()=>!f.forbidden&&!C.value);Te(i,"expanded");const _=Se({get:()=>a.indexOf(f.target)>=0?f.target:a[0],set:Z=>{k("update:target",Z)}}),g=Se({get:()=>f.userExtensions,set:Z=>{k("update:userExtensions",Z)}}),S=Te(i,"disableNotifyingFolderSelect"),h=v(null),A=v(null),M=v(K());be(_,Z=>{k("on-change-accept",F.value)}),Oe(()=>{});async function P(Z){if(k("click"),Z===A.value&&!S.value){let H=!1;if(await new Promise(N=>{u.info({title:l("loadfolderNotifyingTitle"),positiveText:l("Continue"),negativeText:l("Cancel"),onAfterLeave:()=>N(H),onPositiveClick:()=>H=!0,content:()=>le("div",[le("p",{},l("loadfolderNotifyingMessageTerm1")),le("div",[le(_n,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/dist//notification-folder.png"})]),le("p",{},l("loadfolderNotifyingMessageTerm2")),le("p",[le(Ct,{onUpdateChecked:ie=>S.value=ie,checked:S.value},()=>l("checkboxTextDontShowThis"))])])})}),!H){S.value=!1,k("cancel");return}}Z.click()}function B(){k("cancel")}function ee(Z){const N=[...Z.target.files];h.value.value="",A.value.value="",ae(N)}function K(){return"webkitdirectory"in document.createElement("input")}function U(Z){switch(Z){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico, .svg";case"edit_type":return g.value;case"all_files":default:return".*"}}async function T(Z){const H=String(F.value).toLowerCase().replace(/\s+/g,"");if(H&&F.value!==".*"){const N=H.split(",");Z=Z.filter(ie=>N.includes(ie.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),Z.length||(await new Promise(ie=>{u.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:ie,content:()=>le("div",[le(wn,{description:"NO IMAGES"}),`${l("noimage")}`,le("br"),F.value])})}),B())}return Z}async function ae(Z){C.value=!0,Z=await T(Z),z.value=Z.length,Z.length>0&&k("input",X(Z)),C.value=!1}let ue=0;function X(Z){const H=[];for(const N of Z)N.hasOwnProperty("_id")||Object.defineProperty(N,"_id",{value:ue++}),H.push(N);return H}return(Z,H)=>{const N=Ae,ie=Fe,se=Ce,ce=Pt,_e=il,Q=qt,Ee=lt;return I(),q(Pe,null,[y("div",qr,[y("div",Gr,[n(se,{vertical:"",align:"center",justify:"center",inline:"",size:"large"},{default:e(()=>[n(se,{align:"center",justify:"space-around",class:"main-buttons"},{default:e(()=>[n(se,{vertical:"",align:"stretch",justify:"center"},{default:e(()=>[n(t(ze),{to:!1,"display-directive":"show",show:t(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:"top",duration:0,delay:0,"z-index":10},{trigger:e(()=>[n(ie,{disabled:!t($),size:"large",onClick:H[0]||(H[0]=pe=>P(t(h))),round:"",style:{width:"100%","background-color":"white","font-size":"1.3em"}},{icon:e(()=>[n(N,{size:"large",color:"gray"},{default:e(()=>[n(t(xn))]),_:1})]),default:e(()=>[L(" "+d(Z.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:e(()=>[y("div",{innerHTML:Z.$t("loadbuttontooltip")},null,8,Kr)]),_:1},8,["show"]),t(M)||t(o).SSR?(I(),q(Pe,{key:0},[n(t(ze),{to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:t(o).showTooltipsBeforeMounted.value},{trigger:e(()=>[n(ie,{disabled:!t($),size:"large",onClick:H[1]||(H[1]=pe=>P(t(A))),round:"",style:{width:"100%","background-color":"white","font-size":"1.3em"}},{icon:e(()=>[n(N,{size:"large",color:"gray"},{default:e(()=>[n(t(In))]),_:1})]),default:e(()=>[L(" "+d(Z.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:e(()=>[y("div",{innerHTML:Z.$t("loadfoldertooltip")},null,8,Qr)]),_:1},8,["show"]),t(o).IS_SP?me("",!0):(I(),J(Vr,{key:0,onDrop:ae,forbidden:!t($),_class:"drop-target"},null,8,["forbidden"]))],64)):me("",!0)]),_:1})]),_:1}),n(se,{vertical:""},{default:e(()=>[n(se,{wrap:t(o).IS_SP,align:"center",justify:"stretch"},{default:e(()=>[n(t(ze),{to:!1,"display-directive":"show",trigger:"hover","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:t(o).showTooltipsBeforeMounted.value},{trigger:e(()=>[y("span",Xr,d(Z.$t("TargetFileTypeExt"))+": ",1)]),default:e(()=>[L(d(Z.$t("TargetFileTypeExtTooltip")),1)]),_:1},8,["show"]),n(t(ze),{"keep-alive-on-hover":!1,placement:"right",style:{"max-width":"200px"},duration:0,delay:0},{trigger:e(()=>[n(ce,{trigger:"click",width:"trigger",size:"tiny",value:t(_),"onUpdate:value":H[2]||(H[2]=pe=>Ie(_)?_.value=pe:null),options:r,"render-option":c,"consistent-menu-width":!1},null,8,["value"])]),default:e(()=>[L(" "+d(U(t(_)).replace(/,/g,", ")),1)]),_:1})]),_:1},8,["wrap"]),t(_)==="edit_type"?(I(),J(t(ze),{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:t(m),duration:0,delay:0},{trigger:e(()=>[y("div",Yr,[n(Ee,{trigger:"manual",placement:"right-end",show:t(_)==="edit_type"&&t(p)!=="success"&&!!t(m)},{trigger:e(()=>[n(_e,{value:t(g),"onUpdate:value":H[3]||(H[3]=pe=>Ie(g)?g.value=pe:null),status:t(p),disabled:t(_)!=="edit_type",onFocus:H[4]||(H[4]=pe=>m.value=!0),onBlur:H[5]||(H[5]=pe=>m.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:e(()=>[n(Q,{type:"error","show-icon":!0,title:"Validation error"},{default:e(()=>H[7]||(H[7]=[L(" Please correct the extension list."),y("br",null,null,-1),y("ul",null,[y("li",null,"Each extension must begin with a period. "),y("li",null,"Separate each extension with a comma. "),y("li",null,"Use alphameric characters.")],-1)])),_:1,__:[7]})]),_:1},8,["show"])])]),default:e(()=>[y("span",{innerHTML:Z.$t("editAcceptTypes")},null,8,Jr)]),_:1},8,["show"])):me("",!0)]),_:1}),n(t(ze),null,{trigger:e(()=>[n(t(Ct),{checked:w.value,"onUpdate:checked":H[6]||(H[6]=pe=>w.value=pe),size:"small",style:{}},{default:e(()=>[L(d(Z.$t("settings.autoStartConversion")),1)]),_:1},8,["checked"])]),default:e(()=>[L(d(Z.$t("settings.autoStartConversionTooltip")),1)]),_:1})]),_:1})])]),y("input",{ref_key:"fileinput",ref:h,onInput:ee,onCancel:B,type:"file",multiple:"",accept:t(F),style:{display:"none"}},null,40,eu),y("input",{ref_key:"folderinput",ref:A,webkitdirectory:"",directory:"",onInput:ee,onCancel:B,type:"file",style:{display:"none"}},null,544)],64)}}}),nu=Me(tu,[["__scopeId","data-v-1689b029"]]),ou={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function au(i,s){return I(),q("svg",ou,s[0]||(s[0]=[y("path",{fill:"currentColor","fill-rule":"evenodd",d:"M9.293 7.293a1 1 0 0 1 1.414 0L15.414 12l-4.707 4.707a1 1 0 0 1-1.414-1.414L12.586 12L9.293 8.707a1 1 0 0 1 0-1.414","clip-rule":"evenodd"},null,-1)]))}const lu=ot({name:"stash-chevron-right-duotone",render:au}),su={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function iu(i,s){return I(),q("svg",su,s[0]||(s[0]=[y("path",{fill:"currentColor",d:"M5 21q-1.275 0-1.812-1.137t.262-2.113L9 11V5H8q-.425 0-.712-.288T7 4t.288-.712T8 3h8q.425 0 .713.288T17 4t-.288.713T16 5h-1v6l5.55 6.75q.8.975.263 2.113T19 21zm2-3h10l-3.4-4h-3.2zm-2 1h14l-6-7.3V5h-2v6.7zm7-7"},null,-1)]))}const ru=ot({name:"material-symbols-experiment-outline",render:iu}),uu={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function cu(i,s){return I(),q("svg",uu,s[0]||(s[0]=[y("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"},[y("path",{d:"M19.5 11c0-.818 0-1.57-.152-1.937s-.441-.657-1.02-1.235l-4.736-4.736c-.499-.499-.748-.748-1.058-.896a2 2 0 0 0-.197-.082C12.014 2 11.661 2 10.956 2c-3.245 0-4.868 0-5.967.886a4 4 0 0 0-.603.603C3.5 4.59 3.5 6.211 3.5 9.456V14c0 3.771 0 5.657 1.172 6.828S7.729 22 11.5 22h8m-7-19.5V3c0 2.828 0 4.243.879 5.121C14.257 9 15.672 9 18.5 9h.5"}),y("path",{d:"M14.5 13.999v5M12 19H9l3-5H9m8 3v-3h2a1.5 1.5 0 0 1 0 3zm0 0v2"})],-1)]))}const du=ot({name:"hugeicons-zip02",render:cu}),pu={style:{"white-space":"nowrap"}},fu=ye({__name:"settings-output",props:We({quality:{},format:{},isMultithreadEnabled:{type:Boolean}},{method:{required:!0},methodModifiers:{},"target-folder-handle":{},"target-folder-handleModifiers":{},"action-on-duplicate":{default:"prompt"},"action-on-duplicateModifiers":{}}),emits:We(["update:format","update:quality"],["update:method","update:target-folder-handle","update:action-on-duplicate"]),setup(i,{emit:s}){const u=i,l=Te(i,"method"),o=Te(i,"target-folder-handle");Te(i,"action-on-duplicate");const a=s,{t:r}=je(),c=pt();An();const f=at(Qe),w=v([]),k=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],z=Se({get:()=>u.format,set:P=>{P=g(P),a("update:format",P)}}),m=Se({get:()=>u.quality,set:P=>{a("update:quality",P)}}),C=Se(()=>/png|bmp/i.test(z.value)),F=v(null),p=v(!1),$=Se(()=>l.value==="fs"&&!o.value);be(()=>u.isMultithreadEnabled,P=>{P||(l.value="zip")});const _=ni();Oe(()=>{S(),!_&&l.value==="fs"&&(l.value="zip")});function g(P){return w.value.indexOf(P)<0&&(P=w.value[0]),P}function S(){for(const P of k)F.value.toDataURL(P).indexOf(P)>=0&&w.value.push(P);w.value.length===0&&w.value.push(k[0])}function h(){return o.value.name}function A(){l.value="fs",Rl(p,200,!1)}async function M(){const P=await oi();if(!P){if(await c.warning({title:"Rejected",positiveText:"OK",maskClosable:!0,content:r("settings.outputFolderDenied")}),o.value)return;l.value="zip"}o.value=P}return(P,B)=>{const ee=Ae,K=Pt,U=Ce,T=ze,ae=Et,ue=Ln,X=du,Z=rl,H=xa,N=ru,ie=lu,se=Ca,ce=Tn,_e=Fe,Q=qt,Ee=lt,pe=ft,ke=Vt;return I(),q(Pe,null,[n(U,{vertical:"",justify:"center",class:"body"},{default:e(()=>[n(U,{vertical:""},{default:e(()=>[n(T,{to:!1,"display-directive":"show",show:t(f).showTooltipsBeforeMounted.value,trigger:"hover",placement:t(f).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(U,{align:"center",wrap:!1},{default:e(()=>[n(ee,null,{default:e(()=>[n(t(xn))]),_:1}),L(d(t(r)("settings.outputType"))+": ",1),n(K,{value:z.value,"onUpdate:value":B[0]||(B[0]=de=>z.value=de),options:w.value.map(de=>({value:de,label:de})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:e(()=>[L(" "+d(t(r)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(T,{to:!1,"display-directive":"show",show:t(f).showTooltipsBeforeMounted.value,trigger:"hover",placement:t(f).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(U,{align:"center"},{default:e(()=>[n(U,{align:"start",wrap:!1},{default:e(()=>[n(ee,null,{default:e(()=>[n(t(Cn))]),_:1}),y("span",pu,d(t(r)("settings.outputQuality"))+":",1),n(U,{align:"center",justify:"space-between"},{default:e(()=>[n(ae,{tooltip:!1,value:m.value,"onUpdate:value":B[1]||(B[1]=de=>m.value=de),step:1,style:{width:"120px"},disabled:C.value},null,8,["value","disabled"]),n(ue,{onBlur:B[2]||(B[2]=de=>m.value=m.value==null?0:m.value),value:m.value,"onUpdate:value":B[3]||(B[3]=de=>m.value=de),step:"1",min:"0",max:"100",disabled:C.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:e(()=>[L(" "+d(t(r)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1}),n(ke,{"trigger-areas":["arrow","main"]},{default:e(()=>[n(pe,{disabled:l.value==="fs"},{header:e(()=>[L(d(P.$t("settings.changeSaveMethod")),1)]),default:e(()=>[n(U,{vertical:"",align:"stretch",class:"method-box",size:1},{default:e(()=>[n(Z,{checked:l.value==="zip","onUpdate:checked":B[4]||(B[4]=de=>de&&(l.value="zip"))},{default:e(()=>[n(U,{align:"center",size:2,class:nt(l.value==="zip"?"method-active":"method-inactive")},{default:e(()=>[n(ee,{size:"1.5em"},{default:e(()=>[n(X)]),_:1}),y("span",null,d(P.$t("settings.saveAsZIP"))+" ("+d(P.$t("Default"))+") ",1)]),_:1},8,["class"])]),_:1},8,["checked"]),n(Z,{disabled:!t(_)||!P.isMultithreadEnabled,checked:l.value==="fs","onUpdate:checked":B[5]||(B[5]=de=>de&&t(_)&&A())},{default:e(()=>[n(U,{align:"center",size:2,class:nt(l.value==="fs"?"method-active":"method-inactive")},{default:e(()=>[n(ee,{size:"1.5em"},{default:e(()=>[n(H)]),_:1}),n(U,{align:"center",size:1},{default:e(()=>[L(d(P.$t("settings.saveToSpecifiedFolder"))+" (",1),n(N),L(d(P.$t("experimental"))+") ",1)]),_:1})]),_:1},8,["class"])]),_:1},8,["disabled","checked"]),n(qe,null,{default:e(()=>[l.value==="fs"?(I(),J(U,{key:0,vertical:"",justify:"center",style:{"margin-left":"2em"}},{default:e(()=>[n(Ee,{trigger:"manual",placement:"right-start",show:p.value&&$.value,"keep-alive-on-hover":!0},{trigger:e(()=>[n(_e,{onClick:B[6]||(B[6]=de=>M()),size:"small",style:{"justify-content":"start"},ghost:"",color:o.value?"green":"red"},{icon:e(()=>[n(ie)]),default:e(()=>[o.value?(I(),J(U,{key:0,wrap:!1,size:2,align:"center"},{default:e(()=>[n(se),n(ce,{style:{"max-width":"15em"}},{default:e(()=>[L(d(h()),1)]),_:1})]),_:1})):(I(),J(U,{key:1,wrap:!1,size:2,align:"center"},{default:e(()=>[L(d(P.$t("settings.chooseOutputFolder")),1)]),_:1}))]),_:1},8,["color"])]),default:e(()=>[n(Q,{type:"error","show-icon":!0,title:P.$t("settings.chooseOutputFolderTooltip")},null,8,["title"])]),_:1},8,["show"])]),_:1})):me("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1}),y("canvas",{ref_key:"canvas",ref:F,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),gu=Me(fu,[["__scopeId","data-v-26344520"]]),mu={style:{"font-size":"1.1em"}},vu={style:{"font-size":"1.1em"}},hu={style:{width:"4em","text-align":"left"}},yu={style:{width:"4em","text-align":"left"}},Rt=100,dn=2e3,pn=4096,fn=4096,_u=100,wu=100,bu=ye({__name:"settings-adv",props:{expanded:{type:Boolean,required:!1},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}},emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(i){const s=at(Qe),u={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},l=Te(i,"expanded"),o=Te(i,"multithread"),a=Te(i,"threadCount"),r=Te(i,"maxZipSize"),c=Te(i,"retainExt"),f=Te(i,"useFolderNameForZip"),w=Te(i,"shrinkImage"),k=Te(i,"maxWidth"),z=Te(i,"maxHeight");be(Be,_=>{_>1||(o.value=!1),a.value>_&&(a.value=_)},{immediate:!0});const m=v(!1);let C=!1,F=()=>{};const p=Se(()=>o.value&&Be.value>1);Oe(()=>{Be.value>1&&typeof a.value>"u"&&(a.value=Math.max(Be.value,2))});async function $(){C=!1,await new Promise(_=>{m.value=!0,F=_}),C&&Yl()}return(_,g)=>{const S=Ae,h=Fe,A=dl,M=Ce,P=Et,B=Ln,ee=ft,K=Vt,U=kt;return I(),q(Pe,null,[n(M,{justify:"center"},{default:e(()=>[n(K,{"display-directive":"show","default-expanded-names":l.value?["collapitem"]:"","on-update:expanded-names":T=>l.value=!!String(T),"trigger-areas":["arrow","main"],class:nt(["settings-body",l.value?"expand-adv-settings":""])},ul({arrow:e(()=>[y("span",mu,[n(S,{style:fe(l.value&&{top:"8px"})},{default:e(()=>[n(t(gl))]),_:1},8,["style"]),n(S,null,{default:e(()=>[n(t(ml))]),_:1})])]),default:e(()=>[n(ee,{name:"collapitem"},{header:e(()=>[y("span",vu,d(_.$t("settings.advancedSettings")),1)]),default:e(()=>[n(M,{vertical:"",style:{"padding-left":"2em"}},{default:e(()=>[n(t(ze),vt(ht(u)),{trigger:e(()=>[n(M,{vertical:""},{default:e(()=>[n(M,{wrap:!1,align:"center"},{default:e(()=>[n(h,{text:"",disabled:!t(Be),style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[2]||(g[2]=T=>o.value=!o.value)},{icon:e(()=>[n(S,null,{default:e(()=>[n(t(cl))]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(A,{value:o.value,"onUpdate:value":g[3]||(g[3]=T=>o.value=T),disabled:!t(Be),size:"small"},null,8,["value","disabled"])]),_:1}),n(M,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(P,{value:a.value,"onUpdate:value":g[4]||(g[4]=T=>a.value=T),disabled:!t(Be)||!o.value,step:1,min:2,max:t(Be),style:{width:"120px"}},null,8,["value","disabled","max"]),n(B,{onBlur:g[5]||(g[5]=T=>a.value=a.value==null?2:a.value),size:"tiny",value:a.value,"onUpdate:value":g[6]||(g[6]=T=>a.value=T),disabled:!t(Be)||!o.value,step:1,min:2,max:t(Be),style:{width:"10em"}},{suffix:e(()=>[L(d(_.$t("threads",a.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(t(ze),vt(ht(u)),{trigger:e(()=>[n(M,{vertical:""},{default:e(()=>[n(M,{wrap:!1,align:"center"},{default:e(()=>[n(h,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:e(()=>[n(S,{style:{"vertical-align":"middle"}},{default:e(()=>[n(t(pl))]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(M,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(P,{tooltip:!1,value:r.value,"onUpdate:value":g[7]||(g[7]=T=>r.value=T),step:1,min:Rt,max:dn,style:{width:"120px"}},null,8,["value"]),n(B,{onBlur:g[8]||(g[8]=T=>r.value=r.value==null?Rt:r.value),size:"tiny",value:r.value,"onUpdate:value":g[9]||(g[9]=T=>r.value=T),step:"1",min:Rt,max:dn,style:{width:"10em"}},{suffix:e(()=>g[25]||(g[25]=[L("(MB)")])),_:1},8,["value"])]),_:1})]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(t(ze),vt(ht(u)),{trigger:e(()=>[n(M,{wrap:!1,align:"center"},{default:e(()=>[n(h,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[10]||(g[10]=T=>f.value=!f.value)},{icon:e(()=>[n(S,null,{default:e(()=>[n(t(In))]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.useFolderNameForZip")),1)]),_:1}),n(A,{value:f.value,"onUpdate:value":g[11]||(g[11]=T=>f.value=T),size:"small"},null,8,["value"])]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(t(ze),vt(ht(u)),{trigger:e(()=>[n(M,{wrap:!1,align:"center"},{default:e(()=>[n(h,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[12]||(g[12]=T=>c.value=!c.value)},{icon:e(()=>[n(S,null,{default:e(()=>[n(t(Sn))]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.retainOriginalExtension")),1)]),_:1}),n(A,{value:c.value,"onUpdate:value":g[13]||(g[13]=T=>c.value=T),size:"small"},null,8,["value"])]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.retainExtTooltip")),1)]),_:1},16),n(t(ze),vt(ht(u)),{trigger:e(()=>[n(M,{vertical:""},{default:e(()=>[n(M,{wrap:!1,align:"center"},{default:e(()=>[n(h,{disabled:!p.value,text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:g[14]||(g[14]=T=>w.value=!w.value)},{icon:e(()=>[n(S,null,{default:e(()=>[n(t(fl))]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(A,{disabled:!p.value,value:w.value,"onUpdate:value":g[15]||(g[15]=T=>w.value=T),size:"small"},null,8,["disabled","value"])]),_:1}),n(M,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(P,{value:k.value,"onUpdate:value":g[16]||(g[16]=T=>k.value=T),disabled:!w.value||!p.value,step:1,min:_u,max:pn,style:{width:"120px"}},null,8,["value","disabled"]),n(B,{size:"tiny",onBlur:g[17]||(g[17]=T=>k.value=k.value==null?8:k.value),value:k.value,"onUpdate:value":g[18]||(g[18]=T=>k.value=T),disabled:!w.value||!p.value,step:1,min:8,max:pn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:e(()=>[y("span",hu,d(_.$t("width")),1)]),suffix:e(()=>g[26]||(g[26]=[L("px")])),_:1},8,["value","disabled","max"])]),_:1}),n(M,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:e(()=>[n(P,{value:z.value,"onUpdate:value":g[19]||(g[19]=T=>z.value=T),disabled:!w.value||!p.value,step:1,min:wu,max:fn,style:{width:"120px"}},null,8,["value","disabled"]),n(B,{size:"tiny",onBlur:g[20]||(g[20]=T=>z.value=z.value==null?8:z.value),value:z.value,"onUpdate:value":g[21]||(g[21]=T=>z.value=T),disabled:!w.value||!p.value,step:1,min:8,max:fn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:e(()=>[y("span",yu,d(_.$t("height")),1)]),suffix:e(()=>g[27]||(g[27]=[L("px")])),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1})]),_:2},[l.value?{name:"header-extra",fn:e(()=>[n(t(ze),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(h,{onClick:g[0]||(g[0]=T=>$()),size:"tiny",style:{"font-size":"xx-small"}},{default:e(()=>[L(d(_.$t("reset")),1)]),_:1})]),default:e(()=>[L(" "+d(_.$t("settings.resetButtonTooltip")),1)]),_:1}),t(s).IS_DEV?(I(),q("button",{key:0,onClick:g[1]||(g[1]=T=>t(Jl)())},"delcfg")):me("",!0)]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1}),n(U,{preset:"confirm",type:"info",show:t(m),"onUpdate:show":g[22]||(g[22]=T=>Ie(m)?m.value=T:null),title:_.$t("reset"),"positive-text":_.$t("OK"),"negative-text":_.$t("cancel"),onPositiveClick:g[23]||(g[23]=T=>Ie(C)?C.value=!0:C=!0),onAfterLeave:g[24]||(g[24]=T=>t(F)())},{default:e(()=>[L(d(_.$t("warnAboutResetMsg")),1)]),_:1},8,["show","title","positive-text","negative-text"])],64)}}}),ku=Me(bu,[["__scopeId","data-v-c3ff20ca"]]),zu={},Su={style:{color:"gray","padding-left":"20px"}},Cu=["innerHTML"];function Tu(i,s){const u=yn,l=Ce;return I(),J(l,{vertical:"",justify:"end"},{default:e(()=>[n(u,{style:{margin:"0px"}}),n(l,{justify:"center"},{default:e(()=>[y("ul",Su,[(I(!0),q(Pe,null,it(i.$tm("descriptions"),o=>(I(),q("li",{key:o,style:{"text-align":"left"},innerHTML:o},null,8,Cu))),128))])]),_:1})]),_:1})}const Au=Me(zu,[["render",Tu]]);function xu(i={}){const{immediate:s=!1,onNeedRefresh:u,onOfflineReady:l,onRegistered:o,onRegisteredSW:a,onRegisterError:r}=i;let c,f,w;const k=async(m=!0)=>{await f,w==null||w()};async function z(){if("serviceWorker"in navigator){if(c=await xe(async()=>{const{Workbox:m}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:m}},[]).then(({Workbox:m})=>new m("/avif2jpeg/dist/sw.js",{scope:"/avif2jpeg/dist/",type:"classic"})).catch(m=>{r==null||r(m)}),!c)return;w=()=>{c==null||c.messageSkipWaiting()};{let m=!1;const C=()=>{m=!0,c==null||c.addEventListener("controlling",F=>{F.isUpdate&&window.location.reload()}),u==null||u()};c.addEventListener("installed",F=>{typeof F.isUpdate>"u"?typeof F.isExternal<"u"&&F.isExternal?C():!m&&(l==null||l()):F.isUpdate||l==null||l()}),c.addEventListener("waiting",C)}c.register({immediate:s}).then(m=>{a?a("/avif2jpeg/dist/sw.js",m):o==null||o(m)}).catch(m=>{r==null||r(m)})}}return f=z(),k}function Iu(i={}){const{immediate:s=!0,onNeedRefresh:u,onOfflineReady:l,onRegistered:o,onRegisteredSW:a,onRegisterError:r}=i,c=v(!1),f=v(!1);return{updateServiceWorker:xu({immediate:s,onNeedRefresh(){c.value=!0,u==null||u()},onOfflineReady(){f.value=!0,l==null||l()},onRegistered:o,onRegisteredSW:a,onRegisterError:r}),offlineReady:f,needRefresh:c}}const Lu={style:{"line-height":"0px"}},$u=["innerHTML"],Fu=ye({__name:"PWAPrompt",setup(i){const s=v(null),u=v(!1),l=v(void 0),o=v(!1),a=v("unknown");window.addEventListener("beforeinstallprompt",p=>{p.preventDefault(),s.value=p,u.value=!0,l.value=!1}),window.addEventListener("appinstalled",p=>{m()});const{needRefresh:r,updateServiceWorker:c}=Iu({onOfflineReady(){},async onNeedRefresh(){const p=await fetch(location.origin+"/avif2jpeg/dist/version.txt",{cache:"no-store"});if(p.status!==200)return;const $=await p.text();$&&(a.value=$)},onRegisterError(p){}});Oe(async()=>{setTimeout(f,100)});async function f(){await w()&&(l.value=!!(k()||!u.value),l.value)}async function w(){var $;return await(($=navigator.userAgentData)==null?void 0:$.getHighEntropyValues(["brands"]).then(_=>_.brands.some(g=>g.brand.includes("Chromium")||g.brand.includes("Google Chrome")||g.brand.includes("Microsoft Edge"))))||/Chrome|Chromium|Edg\//.test(navigator.userAgent)}function k(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}async function z(){if(s.value){s.value.prompt();const p=await s.value.userChoice;s.value=null,p.outcome==="accepted"&&setTimeout(m,500)}}function m(){var p;(p=navigator.serviceWorker)==null||p.ready.then($=>{var _;l.value||((_=$.active)==null||_.postMessage("app-installed"),l.value=!0)})}function C(){o.value=!0,setTimeout(()=>o.value=!1,60*60*1e3)}async function F(){r.value=!1,await c()}return(p,$)=>{const _=Ae,g=Ce,S=ze,h=Fe,A=qt;return I(),q("div",Lu,[l.value===!0?(I(),J(S,{key:0,placement:"bottom"},{trigger:e(()=>[n(g,{id:"app-installed",align:"center",size:1},{default:e(()=>[n(_,{component:t(nn)},null,8,["component"]),$[0]||($[0]=L("PWA "))]),_:1,__:[0]})]),default:e(()=>[L(d(p.$t("PWAInstalledTooltip")),1)]),_:1})):l.value===!1&&s.value&&!t(r)?(I(),J(S,{key:1,placement:"bottom","keep-alive-on-hover":!0,style:{"max-width":"40vw"},delay:300,duration:150,"z-index":10},{trigger:e(()=>[n(h,{onClick:z,size:"tiny"},{icon:e(()=>[n(_,{component:t(nn)},null,8,["component"])]),default:e(()=>[L(" "+d(p.$t("installAsApp")),1)]),_:1})]),default:e(()=>[y("div",{id:"pwa-tooltip",innerHTML:p.$t("PWAinstallAsAppTooltip")},null,8,$u)]),_:1})):me("",!0),n(qe,null,{default:e(()=>[t(r)&&!o.value?(I(),J(A,{key:0,onClose:C,type:"info",closable:""},{default:e(()=>[n(g,{justify:"space-between",align:"center"},{default:e(()=>[n(g,{vertical:"",class:"message",size:1},{default:e(()=>[y("span",null,d(a.value),1),y("span",null,d(p.$t("PWAUpdateMessage")),1)]),_:1}),n(g,{size:8},{default:e(()=>[n(h,{onClick:F,round:"",type:"primary",size:"small"},{default:e(()=>[L(d(p.$t("Reload")),1)]),_:1}),n(h,{onClick:C,round:"",size:"small"},{default:e(()=>[L(d(p.$t("close")),1)]),_:1})]),_:1})]),_:1})]),_:1})):me("",!0)]),_:1})])}}}),Eu=["innerHTML"],Pu=ye({__name:"switch-lang",props:{delay:{}},emits:["ready","lang-ready","lang-change","lang-change-by-user"],async setup(i,{emit:s}){let u,l;const o=at(Qe),a=Ht(),{locale:r,t:c}=je(),f=pt(),w=i,k=s,z=Object.entries(Ps).map(([S,h])=>({label:h,value:S}));z.sort((S,h)=>{const A=S.label,M=h.label;return A>M?1:A<M?-1:0});let m="";Oe(()=>{a.afterEach((S,h,A)=>{p(),o.switchToolTipVisibility()})}),[u,l]=vl(()=>p()),await u,l(),C(),k("ready");function C(){const S="/avif2jpeg/dist/",h=[];for(const A of _t){if(a.currentRoute.value.path.includes(A))continue;const M={rel:"alternate",hreflang:A,href:S+A};h.push(M)}h.push({rel:"alternate",hreflang:"x-default",href:S}),hl({title:c("title"),meta:[{property:"og:title",content:c("title")},{property:"og:description",content:c("metaDescription")}],link:[...h]})}async function F(S){if(S!==r.value||xt.global.availableLocales.indexOf(S)===-1){if(k("lang-change",S),await Ul(w.delay),!await Ds(S))return f.error({title:c("Failed to get language file"),positiveText:"OK",content:()=>le("div",[`lang: ${S}`])}),k("lang-ready",""),!1;r.value=S,document.title=c("title"),document.documentElement.lang=S,await $e()}return k("lang-ready",S),!0}async function p(){var A;const h=((A=(a.currentRoute.value.path||"").match(/([^/]+)\/?$/))==null?void 0:A[1])||"";h&&_t.includes(h)?await F(h)&&m===h&&k("lang-change-by-user",h):await $()}async function $(){const S=_().toLowerCase(),h=S.split(/[-_]/)[0];if(_t.includes(h)){let A=h;if(h==="zh")switch(S){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":A="zh-hant"}await F(A)}}function _(){const S=window.navigator;return S.language||S.userLanguage||S.browserLanguage}function g(S){m=S;const h=S?S+"/":"";a.push("/"+h)}return(S,h)=>{const A=Ae,M=Zt("router-link"),P=ze,B=Pt,ee=Ce;return I(),J(ee,{align:"center",size:2},{default:e(()=>[t(a).currentRoute.value.path!=="/"?(I(),J(P,{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"left",duration:0,delay:50},{trigger:e(()=>[n(M,{to:"/",onClick:h[0]||(h[0]=K=>k("lang-change-by-user","")),style:{color:"gray","line-height":"0px","font-size":"1.2em"}},{default:e(()=>[n(A,{component:t(yl)},null,8,["component"])]),_:1})]),default:e(()=>[L(d(t(c)("selectLangCloseTooltip")),1)]),_:1})):me("",!0),n(P,{to:!1,trigger:"hover","keep-alive-on-hover":!1,placement:t(o).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:e(()=>[n(B,{ref:"langselect",size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,options:t(z),value:t(r),"onUpdate:value":g},{arrow:e(()=>[n(A,null,{default:e(()=>[n(t(_l))]),_:1})]),_:1},8,["options","value"])]),default:e(()=>[y("div",{innerHTML:S.$t("selectLanguage")},null,8,Eu)]),_:1},8,["placement"])]),_:1})}}}),Qe=Symbol("global variables"),Du=ye({__name:"Avif2Jpeg",emits:["ready"],setup(i,{emit:s}){const{t:u,locale:l}=je(),o=200,a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),r=!1,c=v([]),f=v([]);v(0);let w=v(void 0);const k=v(!0),z=v(!1),m=v(!1),C=v(!1),F=v(!0);v(!1);const p=v(null),$=v(!1),_=v();kl(Qe,{showTooltipsBeforeMounted:w,LANDSCAPE:k,IS_SP:a,IS_DEV:r,switchToolTipVisibility:P,SSR:!1}),Oe(()=>{B(),window.addEventListener("resize",B),P(),setTimeout(()=>m.value=!0,3e3)}),At(()=>{window.removeEventListener("resize",B)});function g(){var ae;!((ae=hn().path.match(/[^/]+(?=\/?$)/))==null?void 0:ae[0])&&W.lang&&Ht().push("/"+W.lang)}let S=0;function h(){C.value=!1,S=Date.now()}function A(U){W.lang=U}function M(){const U=F.value?0:Math.max(0,o-(Date.now()-S));F.value=!1,$e(()=>{setTimeout(()=>C.value=!0,U)})}async function P(){}function B(){const U=document.body.clientWidth,T=document.body.clientHeight;k.value=U*.75>T||U>900}async function ee(U){W.autoStartConversion&&(c.value.length=0,await $e()),f.value=U}function K(U){$.value=U}return(U,T)=>{const ae=Zt("ClientOnly"),ue=Gl,X=Ce,Z=Ae,H=lt;return I(),J(X,{vertical:"",align:"stretch",class:"avif2jpeg"},{default:e(()=>[n(Ms,null,{"lang-switch":e(()=>[(I(),J(wl,null,{default:e(()=>[n(Pu,{onLangChange:h,onLangReady:M,onLangChangeByUser:A,onReady:g,delay:t(F)?0:o},null,8,["delay"])]),_:1}))]),_:1}),n(ae,null,{default:e(()=>[n(Fu)]),_:1}),n(qe,{name:"fade"},{default:e(()=>[Ge(n(X,{vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:e(()=>[n(X,{justify:"space-around",vertical:"",style:{height:"100%"}},{default:e(()=>[n(Ns),n(X,{justify:"center",align:"center",style:{"margin-top":"0.3em"}},{default:e(()=>[n(nu,{key:"key-fselector",target:t(W).acceptTypeValue,"onUpdate:target":T[0]||(T[0]=N=>t(W).acceptTypeValue=N),userExtensions:t(W).editedAcceptTypes,"onUpdate:userExtensions":T[1]||(T[1]=N=>t(W).editedAcceptTypes=N),"disable-notifying-folder-select":t(W).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":T[2]||(T[2]=N=>t(W).disableNotifyingFolderSelect=N),"auto-start-opt":t(W).autoStartConversion,"onUpdate:autoStartOpt":T[3]||(T[3]=N=>t(W).autoStartConversion=N),forbidden:t(z),onInput:ee,onClick:T[4]||(T[4]=N=>K(!0)),onCancel:T[5]||(T[5]=N=>K(!1))},null,8,["target","userExtensions","disable-notifying-folder-select","auto-start-opt","forbidden"]),n(Tt,null,{default:e(()=>[Ge(n(ue,{key:"key-filelist","file-list":t(c),"onUpdate:fileList":T[6]||(T[6]=N=>Ie(c)?c.value=N:null),"additional-files":t(f)},null,8,["file-list","additional-files"]),[[Ke,t(c).length]])]),_:1})]),_:1}),n(X,{vertical:"",align:"center"},{default:e(()=>[n(H,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:e(()=>[n(Z,{size:"5vh",color:"#DADADA",style:{margin:"0px"}},{default:e(()=>[n(t(bl))]),_:1})]),default:e(()=>[T[22]||(T[22]=y("span",null,"CONVERT TO👇",-1))]),_:1,__:[22]})]),_:1}),n(X,{vertical:"",align:"center"},{default:e(()=>[n(gu,{format:t(W).imageFormat,"onUpdate:format":T[7]||(T[7]=N=>t(W).imageFormat=N),quality:t(W).imageQuality,"onUpdate:quality":T[8]||(T[8]=N=>t(W).imageQuality=N),method:t(W).outputMethod,"onUpdate:method":T[9]||(T[9]=N=>t(W).outputMethod=N),"target-folder-handle":t(p),"onUpdate:targetFolderHandle":T[10]||(T[10]=N=>Ie(p)?p.value=N:null),"is-multithread-enabled":t(W).multithread},null,8,["format","quality","method","target-folder-handle","is-multithread-enabled"])]),_:1}),n(Br,{input:t(c),format:t(W).imageFormat,quality:t(W).imageQuality,"retain-extension":t(W).retainExtension,maxZipSizeMB:t(W).maxZipSizeMB,threads:t(W).multithread?t(W).threadCount:0,"auto-start":t(W).autoStartConversion,"output-to-dir":t(W).outputMethod==="fs","output-dir-handle":t(W).outputMethod==="fs"?t(p):null,onStart:T[11]||(T[11]=N=>z.value=!0),onEnd:T[12]||(T[12]=N=>z.value=!1)},{"lang-switch":e(()=>T[23]||(T[23]=[])),_:1},8,["input","format","quality","retain-extension","maxZipSizeMB","threads","auto-start","output-to-dir","output-dir-handle"]),n(X,{vertical:"",align:t(_)?"center":"end",style:{"padding-right":"1em"}},{default:e(()=>[n(ku,{"retain-ext":t(W).retainExtension,"onUpdate:retainExt":T[13]||(T[13]=N=>t(W).retainExtension=N),"use-folder-name-for-zip":t(W).useFolderNameForZip,"onUpdate:useFolderNameForZip":T[14]||(T[14]=N=>t(W).useFolderNameForZip=N),"max-zip-size":t(W).maxZipSizeMB,"onUpdate:maxZipSize":T[15]||(T[15]=N=>t(W).maxZipSizeMB=N),multithread:t(W).multithread,"onUpdate:multithread":T[16]||(T[16]=N=>t(W).multithread=N),"thread-count":t(W).threadCount,"onUpdate:threadCount":T[17]||(T[17]=N=>t(W).threadCount=N),expanded:t(_),"onUpdate:expanded":T[18]||(T[18]=N=>Ie(_)?_.value=N:null),"shrink-image":t(W).shrinkImage,"onUpdate:shrinkImage":T[19]||(T[19]=N=>t(W).shrinkImage=N),"max-width":t(W).maxWidth,"onUpdate:maxWidth":T[20]||(T[20]=N=>t(W).maxWidth=N),"max-height":t(W).maxHeight,"onUpdate:maxHeight":T[21]||(T[21]=N=>t(W).maxHeight=N)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","multithread","thread-count","expanded","shrink-image","max-width","max-height"])]),_:1},8,["align"]),n(Au)]),_:1})]),_:1},512),[[Ke,t(C)]])]),_:1})]),_:1})}}}),Ou={key:0,style:{"text-align":"center"}},Kt=ye({__name:"App",setup(i){const s={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{},Image:{toolbarColor:"#00000099"}},u=v(!0);return Oe(()=>{u.value=!1}),(l,o)=>{const a=Tl,r=Cl,c=Sl,f=zl,w=Al;return I(),q(Pe,null,[t(u)?(I(),q("div",Ou," Rendering the page… please wait. ")):me("",!0),n(w,{"theme-overrides":s,style:{width:"100%",height:"100%"}},{default:e(()=>[n(f,null,{default:e(()=>[n(c,{placement:"top-left",closable:!0,max:50},{default:e(()=>[n(r,null,{default:e(()=>[n(a,null,{default:e(()=>[n(Du,{class:nt({hide:t(u)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}}),Ia=[{path:"/",name:"Home",component:Kt}];for(const i of _t)Ia.push({path:"/"+i+"/",strict:!0,name:i,component:Kt});xl(Kt,{routes:Ia,base:"/avif2jpeg/dist/"},({app:i,router:s,routes:u,isClient:l,initialState:o})=>{i.use(xt)});
