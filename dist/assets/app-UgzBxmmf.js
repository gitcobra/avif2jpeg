var ea=Object.defineProperty;var ta=(s,r,i)=>r in s?ea(s,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[r]=i;var nt=(s,r,i)=>ta(s,typeof r!="symbol"?r+"":r,i);import{r as y,a as It,d as xe,i as Je,c as te,o as U,_ as ke,u as e,w as t,b as I,t as d,e as n,f as na,N as we,L as oa,g as ee,B as Ee,h as Rt,j as h,F as Pe,k as ct,l as aa,m as Y,n as la,p as sa,q as Oe,s as fe,v as gn,x as mn,y as vn,z as ze,A as ye,C as Te,D as Ot,E as Ut,G as He,H as Ge,I as ia,J as ra,K as Be,M as At,O as re,P as Qe,T as Xe,Q as hn,R as De,S as Nt,U as St,V as jt,W as ot,X as Ne,Y as _t,Z as ua,$ as at,a0 as da,a1 as Jt,a2 as en,a3 as _n,a4 as et,a5 as ca,a6 as Tt,a7 as pa,a8 as fa,a9 as Bt,aa as ga,ab as tn,ac as wn,ad as ma,ae as va,af as lt,ag as Fe,ah as ha,ai as Dt,aj as Lt,ak as _a,al as Ze,am as wa,an as yn,ao as bn,ap as ya,aq as kn,ar as ba,as as nn,at as zn,au as ka,av as za,aw as xa,ax as Ia,ay as Aa,az as Sa,aA as Zt,aB as xn,aC as Ta,aD as La,aE as In,aF as Ca,aG as it,aH as rt,aI as $a,aJ as Ea,aK as Fa,aL as Pa,aM as Oa,aN as Ua,aO as Ma,aP as Ra,aQ as Na,aR as ja,aS as Ba,aT as Da,aU as Za,aV as Va,aW as Ha,aX as Wa,aY as qa,aZ as Ga}from"./vendor-CMlg4H3Z.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&p(f)}).observe(document,{childList:!0,subtree:!0});function i(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function p(o){if(o.ep)return;o.ep=!0;const l=i(o);fetch(o.href,l)}})();const Ue=y(navigator.hardwareConcurrency?Math.min(navigator.hardwareConcurrency,12):0),ut={threadCount:{min:2,max:Math.max(2,Ue.value)}},Ka={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:Ue.value,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1},V=It(An({}));function Ya(){An(V)}function An(s){return Object.assign(s,Ka)}const Sn="avif2jpeg",$t=JSON.parse(localStorage.getItem(Sn)||"{}");for(const s in V)if($t.hasOwnProperty(s)&&$t[s]!==void 0){let r=$t[s];ut.hasOwnProperty(s)&&(ut[s].min>r&&(r=ut[s].min),ut[s].max<r&&(r=ut[s].max)),V[s]=r}const Qa=()=>{const s={};for(const r in V)s[r]=V[r];localStorage.setItem(Sn,JSON.stringify(s))};window.addEventListener("beforeunload",Qa);const Xa=xe({__name:"github",setup(s){const r=Je(Ye);return(i,p)=>{const o=we,l=na,f=ke;return U(),te(f,{to:!1,"display-directive":"show",show:e(r).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(l,{href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-size":"small","font-weight":"bolder"}},{default:t(()=>[n(o,null,{default:t(()=>[n(e(oa))]),_:1}),p[0]||(p[0]=I("GitHub"))]),_:1})]),default:t(()=>[I(" "+d(i.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),Ja=["href"],el=xe({__name:"licenses",setup(s){const r=y(!1),i={Vue:"https://github.com/vuejs/core/blob/main/LICENSE",Vite:"https://github.com/vitejs/vite/blob/main/LICENSE","Vite SSG":"https://github.com/antfu/vite-ssg/blob/main/LICENSE","Naive UI":"https://github.com/TuSimple/naive-ui/blob/main/LICENSE",Ionicons:"https://github.com/ionic-team/ionicons/blob/main/LICENSE"};return(p,o)=>{const l=Ee;return U(),ee(Pe,null,[n(l,{text:"",onClick:o[0]||(o[0]=f=>r.value=!0),style:{color:"black","font-size":"small"}},{default:t(()=>o[2]||(o[2]=[I("Licenses")])),_:1}),n(e(Rt),{preset:"dialog",ref:"dialog",show:r.value,"onUpdate:show":o[1]||(o[1]=f=>r.value=f),"positive-text":"OK",title:"Licenses"},{default:t(()=>[o[3]||(o[3]=h("h3",null,"Used Framework and Libraries",-1)),h("ul",null,[(U(),ee(Pe,null,ct(i,(f,g)=>h("li",null,[h("a",{href:f},d(g),9,Ja)])),64))])]),_:1},8,["show"])],64)}}}),tl=1,nl=10,ol=14,al="",mt={major:tl,minor:nl,build:ol,tag:al},ll={style:{"font-size":"x-small","user-select":"none"}},sl=xe({__name:"version",setup(s){const r=["0.0.118"],i=`${mt.major}.${mt.minor}.${mt.build}${mt.tag}`,p=r.map(g=>({label:`v${g}`,key:g,value:g}));function o(g){const{key:b,label:_}=g,w=f(b),k=Y("a",{href:w},_),m=Y("div",null,k);return Y("div",null,m)}function l(g){location.href=f(g)}function f(g){return`/avif2jpeg/old/${g}/`}return(g,b)=>{const _=aa;return U(),te(_,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:e(p),"render-label":o,"onUpdate:value":l},{header:t(()=>[h("span",ll,d(g.$t("previousVersion")),1)]),default:t(()=>[h("span",{style:{cursor:"pointer"}},"v"+d(i))]),_:1},8,["options"])}}}),il=xe({__name:"header",setup(s){const r=la();return(i,p)=>{const o=sa("router-link"),l=Oe,f=mn;return U(),te(l,{vertical:"",justify:"start"},{default:t(()=>[n(l,{justify:"space-between",align:"center",wrap:!1},{default:t(()=>[n(l,{align:"center"},{default:t(()=>[n(Xa),n(sl),n(el),n(l,{style:{"font-size":"small"}},{default:t(()=>[e(r).path!=="/"?(U(),te(o,{key:0,to:"/"},{default:t(()=>p[0]||(p[0]=[I("HOME")])),_:1})):fe("",!0)]),_:1})]),_:1}),n(l,{align:"end",style:{"font-size":"x-small"}},{default:t(()=>[gn(i.$slots,"lang-switch")]),_:3})]),_:3}),n(f,{style:{margin:"0px"}})]),_:3})}}}),rl={style:{padding:"0px",margin:"0px","text-align":"center"}},ul=xe({__name:"title",setup(s){const r=vn();return ze(()=>{const i=r.currentRoute.value.path||"";return!String(i.match(new RegExp("(?<=^\\/)[^/]+"))||"")}),(i,p)=>{const o=Oe;return U(),te(o,{align:"center",justify:"center",style:{margin:"0px"}},{default:t(()=>[h("h1",rl,d(i.$t("title")),1)]),_:1})}}}),on=new Set,dl=new Set,cl=new Set,wt=new Map;function pl(s){const r=wt.get(s);if(!r){console.warn("the worker was already released.",s.id);return}wt.delete(s),r(),vt==null||vt(),vt=null}function fl(){for(const s of wt.keys())pl(s)}let vt=null;function Tn(){fl();for(const s of on)s.onmessage=null,s.terminate();on.clear(),dl.clear(),cl.clear(),wt.clear()}function gl(s){return new Worker("/avif2jpeg/dist/assets/worker.zip-BpG-kYFu.js",{name:s==null?void 0:s.name})}function ml(s){return new Worker("/avif2jpeg/dist/assets/worker.loader-hdSA9Vyi.js",{name:s==null?void 0:s.name})}const vl=1e3*10;let Ke;const Re=new Map,yt=new Map,bt=new Map;let Vt,Q,Ht,kt,ht,Ln,Cn,$n,En,pt;function Et(s){if({files:ht,completedFileIdSet:Vt,ConvStats:Q,canceled:Ht,props:kt,format:Ln,quality:Cn,outputExt:$n,imageType:En,message:pt}=s||{},Ke=null,Re.clear(),yt.clear(),bt.clear(),yt.clear(),bt.clear(),s)for(const i in s)delete s[i]}async function hl(s){Et(s),Vt.clear();let r;try{r=await _l()}catch{return Et(),{exception:new Error("worker-load-error"),callbackToClearConverter:new Function,callbackToGenerateFailedZips:new Function}}const[i,p]=r;Ke=p;const o=new Promise(m=>{p.onmessage=u=>{const x=u.data,{action:O}=x;switch(O){case"squeeze-zip":case"zip-squeeze-error":m(void 0);break}}}),l=new Promise(m=>{i.onmessage=u=>{const{data:{action:x}}=u;x==="close-loader"&&m()}}),f=ht.map(m=>m._id);ht.forEach(m=>yt.set(m._id,m));const g=ye(Ht,m=>{if(!m)return;g();const u={action:"cancel-convert"};i.postMessage(u)}),b={action:"start-convert",list:ht,fileIdList:f,outputQuality:Cn,outputType:Ln,threads:kt.threads,maxSize:V.shrinkImage?{width:V.maxWidth,height:V.maxHeight}:null};i.postMessage(b),await l,console.log("end loader worker"),p.postMessage({action:"squeeze"}),await o,console.log("end zip worker"),g();const _=()=>{Tn(),p.onmessage=null,p.terminate(),i.onmessage=null,i.terminate(),Et()};let w=!1;return{callbackToClearConverter:_,callbackToGenerateFailedZips:async m=>{w||(w=!0,await Sl(m,p,{},Q))}}}async function _l(){Tn();const s=new ml,r=new gl,i=new Promise((f,g)=>{const b=u=>{r.removeEventListener("message",k),s.removeEventListener("message",k),clearTimeout(m),u?(console.log("workers are avialble"),f(u)):(console.error("couldn't get responses from workers"),g(u))};let _=!1,w=!1;const k=u=>{u.target===r&&(console.log("got a message from zip worker"),_=!0),u.target===s&&(console.log("got a message from loader worker"),w=!0),_&&w&&b(!0)};let m=0;r.addEventListener("message",k),s.addEventListener("message",k),m=window.setTimeout(()=>b(!1),vl)}),{port1:p,port2:o}=new MessageChannel,l={action:"set-zip-port"};return r.postMessage({action:"set-port-loader"},[p]),s.postMessage(l,[o]),console.log("test workers' availability"),await i,r.postMessage({action:"set-config",zipSize:kt.maxZipSizeMB*1024*1024,keepExt:kt.retainExtension,outputExt:$n,imageType:En}),s.addEventListener("message",yl),r.addEventListener("message",wl),[s,r]}const wl=s=>{const r=s.data,{action:i}=r;switch(i){case"add-zip-completed":{const{fileId:f,entireIndex:g,storedPath:b}=r;return}case"respond-image":{const{url:f,index:g,path:b,size:_,fileId:w}=r;Q.convertedImageUrl=f,Q.convertedImageSize=_,Q.convertedImageIndex=g,Q.convertedImageName=b;let k="",m=0,u="";const x=Re.get(w);if(w>=0){const O=yt.get(w);k=URL.createObjectURL(O),m=O.size,u=O.webkitRelativePath||O.name}Q.convertedImageOrgUrl=k,Q.convertedImageOrgSize=m,Q.convertedImageOrgName=u,Q.convertedImageShrinked=x==null?void 0:x.shrinked;return}case"respond-delete":{const{index:f,success:g,fileId:b}=r;Re.get(b).command="❌deleted",Re.get(b).completed=!1;return}}switch(i){case"error-push-filelist-zip":const{path:f}=r;Q.failedZipDone=!0,pt.error(`an error occurred "${f}"`,{duration:3e3});return}const{size:p,count:o}=r,l="url"in s.data?s.data.url:"";switch(i){case"push-zip":Q.zips.push({url:l,size:p,count:o}),Q.zippedTotalCount+=o,Q.zippedTotalSize+=p;break;case"squeeze-zip":o>0&&(Q.zips.push({url:l,size:p,count:o}),Q.zippedTotalCount+=o,Q.zippedTotalSize+=p);break;case"push-filelist":Q.failedFileZippedCount++;break;case"squeeze-filelist-zip":Q.failedZipDone=!0;case"push-filelist-zip":console.log("push-filelist-zip",o),Q.failedZips.push({url:l,size:p,count:o}),console.log(o);break;case"zip-error":case"zip-squeeze-error":Q.zippingErrorCount+=o;break}},yl=s=>{s.target;const{data:r}=s,{action:i}=r;switch(i){case"list-start":break;case"list-end":break;case"file-start":{const{index:p,path:o,fileId:l}=r;kl(p,o,l);break}case"file-load":{const{thumbnail:p,width:o,height:l,fileId:f,workerId:g,inputsize:b}=r,_=Re.get(f);_.core=g,_.command="🖼️loaded",_.width=o,_.height=l,_.size=b,p&&(Q.thumbnail=p);break}case"file-converted":{const{index:p,path:o,fileId:l,shrinked:f,outputWidth:g,outputHeight:b,outputsize:_}=r,w=Re.get(l);w.command="🔃converted",w.shrinked??(w.shrinked=f),w.outputWidth=g,w.outputHeight=b,w.outputSize=_,Q.converted++;break}case"file-completed":{const{inputsize:p,outputsize:o,fileId:l,entireIndex:f,storedPath:g}=r,b=Re.get(l);b&&(b.command="✅completed",b.completed=!0,b.fileId=l),Q.inputTotalSize+=p,Q.outputTotalSize+=o,Q.done++,Q.success++,Vt.add(l),b.zippedIndex=f,Q.ziplogs[f]={fileId:l,storedPath:g};break}case"file-retry":{const{index:p,path:o,fileId:l}=r;zl(p,o,l);break}case"file-error":{const{index:p,path:o,fileId:l}=r;xl(p,o,l);break}case"file-canceled":{const{fileId:p,path:o}=r;Il(p);break}}};let bl=0;function kl(s,r,i){const p={key:bl++,core:-1,index:s,path:r,command:"➡️started"};Re.set(i,p),Q.logs.push(p),bt.has(i)?console.warn(`retry "${r}".`):Ht.value||Q.startedCount++}function zl(s,r,i){const p=Re.get(i);p.command="⚠️retrying",p.error=!0,pt.warning(`retrying "${r}"`,{duration:3e3}),Q.retried++,bt.set(i,1)}function xl(s,r,i){console.error(`failed to load "${r}". the image may be corrupted or cannot be read by some reason.`);const p=Re.get(i);Q.done++,Q.failure++,p.command="❗failed",p.error=!0,pt.error(`failed to load "${r}"`,{duration:5e3})}function Il(s){const r=Re.get(s);Q.done++,Q.failure++,r.command="❗canceled",r.error=!0}function Al(s){Ke==null||Ke.postMessage({action:"request-image",index:s})}function Ft(s){Ke==null||Ke.postMessage({action:"delete-image",index:s})}async function Sl(s,r,i,p){let o=0;for(const l of s){const f=(l.webkitRelativePath||l.name).replace(/^\//,"");if(p.failedZipDone)break;if(i.value)return;o-p.failedFileZippedCount>20&&await new Promise(g=>setTimeout(g,10)),r.postMessage({action:"add-filelist",file:l,path:f}),o++}if(p.failedZipDone){pt.error("Zipping error files was aborted",{duration:5e3});return}r.postMessage({action:"squeeze-filelist"})}function je(s,r=2){const i=Math.sign(s);s=Math.abs(s);const p=["Bytes","KB","MB","GB"],o=s?Math.floor(Math.log(s)/Math.log(1024)):0;return`${(s/Math.pow(1024,o)*i).toFixed(r)}${p[o]}`}function Fn(s,r=100,i=!1){r=typeof r=="number"?{width:r,height:r}:r;const{width:p,height:o}=r;let{width:l,height:f}=s;const g=l/f,b=p/o;return g>=b?(l=i?Math.min(p,l):p,f=l/g|0):(f=i?Math.min(o,f):o,l=f*g|0),{width:l,height:f}}class Tl{constructor(){nt(this,"_currentFileCount",0);nt(this,"_currentZipIndex",0);nt(this,"_totalFileCount",0);nt(this,"_zipLengthSumList",[]);nt(this,"_pathBank",{})}increase(r){return r&&(this._pathBank[r]=[this._zipLengthSumList.length,this._currentFileCount]),this._currentFileCount++,this._totalFileCount++}split(){this._zipLengthSumList.push(this._totalFileCount),this._currentZipIndex++,this._currentFileCount=0}get(r){if(typeof r=="number"){let i=this._zipLengthSumList.findIndex((l,f)=>r<l);i===-1&&(i=this._zipLengthSumList.length);const p=this._zipLengthSumList[i-1]||0,o=r-p;return[i,o]}else{const i=this._pathBank[String(r)];if(i)return i}return null}getZipIndex(){return this._currentZipIndex}getIndex(){return this._totalFileCount}}function Ll(s){return new Promise(r=>setTimeout(r,s))}function Cl(s,r=0){const i=y(s);return ye(i,p=>{p!==void 0&&Te(()=>{setTimeout(()=>i.value=void 0,r)})},{immediate:!0}),i}let dt;async function $l(s,r,i,p,o){let l="";const f=document.createElement("canvas"),g=f.getContext("2d");let b=new Ot;const _=[b],w=new Tl,k=i.format,m=i.quality/100,u=[...k.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),x=s.length,O=i.maxZipSizeMB*1024*1024;let $=0,E=null,M="",A="",D=0,j=0,v=0,H=0,W=0,me=!1;dt=T=>{const[Z,K]=w.get(T),le=_[Z],pe=le.get(K,k);o.convertedImageIndex=T,o.convertedImageName=le.getPathByIndex(K),o.convertedImageUrl=URL.createObjectURL(pe),o.convertedImageSize=pe.size;let ne="",se=0,he="";const ge=R[T];ne=URL.createObjectURL(ge),se=ge.size,he=ge.webkitRelativePath||ge.name,o.convertedImageOrgUrl=ne,o.convertedImageOrgSize=se,o.convertedImageOrgName=he};const R=[];for(const T of s){if(p.value)break;const Z=T.name;let K="";const le=T.size,pe=(T.webkitRelativePath||T.relativePath||Z).replace(/^\//,""),ne=document.createElement("img"),se={key:v++,core:-1,index:$++,path:pe,command:"➡️start"};o.startedCount=$,o.logs.push(se),o.logs.length-1,l&&(URL.revokeObjectURL(l),l=""),l=URL.createObjectURL(T),A=l,D=T.size,ne.src=l;const he=await Pn(ne).then(()=>!0).catch(()=>!1);if(!ne.complete||!he||p.value){o.done++,o.failure++,se.command="❗failed";continue}const ge=ne.width,z=ne.height;f.width=ge,f.height=z,g.drawImage(ne,0,0,ge,z,0,0,ge,z),se.command="🖼️imgload",se.width=ge,se.height=z,se.size=T.size,o.thumbnail=ne;const G=await new Promise(J=>{const ae=Ce=>{E=Ce,J(Ce)};f.toBlob(ae,k,m)});if(p.value)break;if(!G){console.log("failed to toBlob",Z),o.failure++;continue}j=G.size,o.converted++,se.outputSize=j;let q="";if(W+j>=O){try{await b.wait(),q=await b.url()}catch(J){me=!0,console.warn(J.message,W),alert("memory problem occurred");break}o.zips.push({url:q,size:W,count:H}),o.zippedTotalCount+=H,o.zippedTotalSize+=W,W=0,H=0,w.split(),b=new Ot,_.push(b)}W+=j;const oe=pe||Z;for(let J=1;J<255&&(K=oe.replace(i.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(J>1?`(${J})`:"")+"."+u,!!b.has(K));J++);o.done++;try{H++,b.add(K,G)}catch(J){console.error(J.message);continue}w.increase(),R.push(T),o.inputTotalSize+=le,o.outputTotalSize+=j,o.ziplogs.push({fileId:T._id,storedPath:K}),M=K,se.zippedIndex=o.success,o.success++,se.command="✅completed",se.completed=!0,se.fileId=T._id,r.add(T._id)}if(o.success>0)if(x===1)E&&(o.convertedImageIndex=0,o.convertedImageName=M.replace(/^.*\/(?=[^/]+$)/,"").replace(i.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+u,o.convertedImageUrl=URL.createObjectURL(E),o.convertedImageOrgUrl=A,o.convertedImageOrgSize=D);else try{if(me)throw new Error("terminated zipping process for memory problems");await b.wait();const T=await b.url();o.zips.push({url:T,count:H,size:W}),o.zippedTotalCount+=H,o.zippedTotalSize+=W}catch(T){console.error(T.message)}const ue={value:!1},ve=()=>{ue.value=!0,_.forEach(T=>T.clear()),_.length=0,R.length=0,dt=null};let Ae=!1;return{callbackToClearConverter:ve,callbackToGenerateFailedZips:async T=>{Ae||(Ae=!0,Fl(T,O,o,ue))}}}function El(s){dt==null||dt(s)}async function Fl(s,r,i,p){let o=0,l=0,f=new Ot;for(let g=0;g<s.length;g++){const b=s[g],_=(b.webkitRelativePath||b.name).replace(/^\//,"");if(p.value)return;try{await f.add(_,b)}catch{alert(`an error occurred during access to "${_}"`);break}if(l+=b.size,o++,i.failedFileZippedCount++,l>=r||g===s.length-1){await f.zip();const w=await f.url();i.failedZips.push({url:w,size:l,count:o}),f.clear(),l=0,o=0}}i.failedZipDone=!0}function Pn(s){if(typeof s.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((r,i)=>{s.onload=r,s.onerror=i})}const We=(s,r)=>{const i=s.__vccOpts||s;for(const[p,o]of r)i[p]=o;return i},Pl={class:"container"},Ol={__name:"zipicon",setup(s){return(r,i)=>(U(),ee("span",Pl,[n(e(we),null,{default:t(()=>[n(e(Ut))]),_:1}),i[0]||(i[0]=h("span",{class:"text"},"ZIP",-1))]))}},Ul=We(Ol,[["__scopeId","data-v-8b8df2f0"]]),Ml=["href","download","title"],Rl='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',Nl=xe({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean},hidden:{type:Boolean}},emits:["load","error","next","prev"],setup(s,{expose:r,emit:i}){const{t:p}=He(),o=s,l=i,f=y();y();const g=y(!0),b=y(""),_=y(o.width||100),w=y(o.height||100),k=y(!1),m=It({width:_.value+"px",height:w.value+"px",minWidth:"50px",minHeight:"50px"});Ge(()=>{var A,D,j;(D=(A=f.value)==null?void 0:A.previewInstRef)==null||D.setPreviewSrc(Rl),URL.revokeObjectURL((((j=f.value)==null?void 0:j.imageRef)||{}).src),f.value=null});const u=y(!0);ia(()=>{u.value=!1}),ra(()=>{u.value=!0}),ye(o,(A,D)=>{m.width=(o.width||100)+"px",m.height=(o.height||100)+"px"}),ye(()=>o.src,(A,D)=>{u.value&&$(A)},{immediate:!0}),r({download:E,openPreview:M,active:u});async function x(A){const D=A.target,j=D.naturalWidth,v=D.naturalHeight,{width:H,height:W}=Fn({width:j,height:v},{width:o.maxWidth||100,height:o.maxHeight||100},o.expand);_.value=H,w.value=W,l("load",{src:D.src,width:j,height:v}),g.value=!1,await new Promise(me=>setTimeout(me,100)),!g.value&&(k.value=!0)}function O(A){const D=A.target;l("error",D.src)}async function $(A){g.value=!0,k.value=!1,b.value=A,console.log("changeSrc:",b.value)}function E(){const A=document.createElement("a");A.href=b.value,A.download=o.fileName,A.click()}function M(){var A;(A=f.value)==null||A.click()}return(A,D)=>{const j=hn,v=Nt,H=Oe,W=At;return Be((U(),ee("div",null,[n(e(ke),null,{trigger:t(()=>[n(W,{show:e(g)||o.loading},{default:t(()=>[n(H,{justify:"center",align:"center",style:re(e(m))},{default:t(()=>[h("a",{"_v-show":"!(imgloading || props.loading)",href:e(b),onClick:D[0]||(D[0]=Qe(()=>{},["left","prevent"])),target:"_blank",download:o.fileName,title:o.fileName,style:{"line-height":"0px"}},[n(Xe,{mode:"in-out"},{default:t(()=>[Be(n(j,{ref_key:"nImageRef",ref:f,"show-toolbar-tooltip":"",onLoad:x,onError:O,src:e(b),width:e(_),height:e(w),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[De,e(k)]])]),_:1})],8,Ml),e(g)||o.loading?(U(),te(v,{key:0})):fe("",!0)]),_:1},8,["style"])]),_:1},8,["show"])]),default:t(()=>[I(" "+d(o.fileName),1)]),_:1})],512)),[[De,!A.hidden]])}}}),an=We(Nl,[["__scopeId","data-v-6c94d582"]]),jl=["href","download","title"],Bl={class:"left-num"},Dl={class:"right-num"},Zl=["href","download","title"],Vl={class:"left-num"},Hl={class:"right-num"},Wl=["href","download"],ql=xe({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean},variousInfo:{}},emits:["demand-image","delete-image","close"],setup(s,{expose:r,emit:i}){const p=Je(Ye),o=s,l=i;r({download:z,cleanup:be,openPreview:Se,isPreviewing(){return H.value},changeIndex(F){u.value=F}});const f=St(),{t:g}=He();jt();const b=y(),_=y(),w=y(),k=ot("viewerItemContainer"),m=y(!0),u=y(Math.max(o.index,0)+1),x=y(1),O=y(1),$=y(""),E=y(""),M=y(1),A=y(1),D=y(!1),j=y(!1),v=y(!1),H=ze(()=>{var F,L;return(L=(F=w.value)==null?void 0:F.previewInstRef)==null?void 0:L.displayed}),W=ze(()=>{var F,L;return((L=(F=w==null?void 0:w.value)==null?void 0:F.previewInstRef)==null?void 0:L.previewSrc)===$.value}),me=ze(()=>u.value<o.length),R=ze(()=>u.value>1),ue=y("viewer-item-init"),ve=y(0),Ae=y(!0);y({width:"auto",height:"auto"});const Le=y(!1);Ne(()=>{document.body.addEventListener("keydown",se),document.body.addEventListener("keydown",ne),le(u.value-1),pe()}),Ge(()=>{clearTimeout(T),document.body.removeEventListener("keydown",se),document.body.removeEventListener("keydown",ne),Le.value=!0}),_t(()=>{URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl)});let T=-1;ye(u,(F,L)=>{u.value<1||u.value>o.length||F===L||(clearTimeout(T),F>L?ue.value="viewer-item-next":ue.value="viewer-item-prev",T=setTimeout(()=>{o.index!==u.value-1&&(ve.value=m.value?ve.value:~ve.value,Ae.value=!1,le(u.value-1))},50))});let Z="",K="";ye(()=>o.url,()=>{var a,c;let F="";o.index===0&&m.value?(m.value=!1,u.value=1,F=o.url):o.index===u.value-1?(m.value=!1,D.value=!1,F=o.url):(URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl));const L=Z,X=K;if(URL.revokeObjectURL(L),URL.revokeObjectURL(X),Z=o.url,K=o.originalUrl,F){try{if((c=(a=w.value)==null?void 0:a.previewInstRef)!=null&&c.displayed){W.value?w.value.previewInstRef.setPreviewSrc(F):w.value.previewInstRef.setPreviewSrc(o.originalUrl);try{const S=w.value.previewInstRef.displayed;w.value.previewInstRef.handleAfterLeave(),w.value.previewInstRef.displayed=S}catch(S){console.error(S)}}}catch{}$.value=F,E.value=o.originalUrl}},{immediate:!0});function le(F){D.value=!0,j.value=!1,v.value=!1,Te(()=>l("demand-image",F))}function pe(){if(!p.IS_SP)return;let F=k.value.$el,L=0,X=0,a=0,c=0,S=0;const P=ie=>{L=ie.touches[0].pageX,X=ie.touches[0].pageY,S=Date.now()};F.addEventListener("touchstart",P);const B=ie=>{a=ie.touches[0].pageX,c=ie.touches[0].pageY,ce()};window.addEventListener("touchmove",B);const C=()=>{ce();const ie=a-L,Me=Math.abs(ie),tt=c-X,st=Math.abs(tt);Me<st||Me<30||q(ie>0?-1:1)};window.addEventListener("touchend",C);const ce=()=>{const ie=Date.now();ie-S>500&&(L=a,X=c),S=ie};Ge(()=>{F.removeEventListener("touchstart",P),window.removeEventListener("touchmove",B),window.removeEventListener("touchend",C),F=null})}function ne(F){var L,X,a,c;if(F.key==="Escape")try{(X=(L=w.value)==null?void 0:L.previewInstRef)!=null&&X.displayed&&(F.stopPropagation(),(c=(a=w.value)==null?void 0:a.previewInstRef)==null||c.toggleShow(!1))}catch{}}function se(F){switch(F.code){case"ArrowRight":q(1);break;case"ArrowLeft":q(-1);break;case"Home":u.value=1;break;case"End":u.value=o.length;break;case"Space":case"Enter":case"NumpadEnter":if(!H.value)return;J();break;case"ArrowUp":case"ArrowDown":default:return}F.stopPropagation(),F.preventDefault()}function he({width:F,height:L}){x.value=F,O.value=L,j.value=!0}function ge({width:F,height:L}){M.value=F,A.value=L,v.value=!0}function z(){W.value?b.value.download():_.value.download()}async function G(F){try{const L=await fetch(F).then(X=>X.blob()).then(X=>new Promise(a=>{const c=new FileReader;c.onload=a,c.readAsDataURL(X)})).then(X=>X.target.result);navigator.clipboard.writeText(L),f.info({title:g("copiedDataURLDialogTitle"),content:()=>Y("div",[Y("div",g("copiedDataURLMessage"))]),positiveText:"OK"})}catch(L){console.error(L),f.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function q(F){F>0?u.value=Math.min(o.length,u.value+F)|0:F<0&&(u.value=Math.max(1,u.value+F)|0)}let oe="";const J=()=>{var L,X,a,c;oe=(a=window.getComputedStyle((X=(L=w==null?void 0:w.value)==null?void 0:L.previewInstRef)==null?void 0:X.previewRef))==null?void 0:a.transform;const F=W.value;(c=w==null?void 0:w.value)==null||c.next(),Te(()=>{var S;W.value===F&&((S=w==null?void 0:w.value)==null||S.next())})};function ae(){try{Te(()=>w.value.previewInstRef.previewRef.style.transform=oe)}catch{}}function Ce({nodes:F}){const L=Y(Bt,{color:W.value?"green":"gray",offset:[-20,-12],value:W.value?g("status.Converted"):g("status.Original")},()=>Y(Ee,{round:!0,onClick(){J()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>Y(W.value?pa:fa)}));F.next=Y(Ee,{onClick(){q(1)},disabled:!me.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>Y(en)}),F.prev=Y(Ee,{onClick(){q(-1)},disabled:!R.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>Y(ga)});try{const X=F.download.children;X.default=()=>g("save");const a=X.trigger();a.props.onClick=z,X.trigger=()=>a}catch{}return de(),[L,...Object.values(F)]}const $e="#pathbox-"+String(Math.random()).substring(2);let Ie;function de(){var F,L,X;try{if(Ie=(X=(L=(F=w.value)==null?void 0:F.previewInstRef)==null?void 0:L.previewWrapperRef)==null?void 0:X.parentNode,!Ie||Ie.querySelector($e))return;let a=Y("div",{id:$e,onMousedown:c=>{c.stopPropagation()},className:"__preview-injected-pathbox"+(W.value?" converted":"")},[Y("div",`${String(u.value).padStart(String(o.length).length,"0")}/${String(o.length).padStart(String(o.length).length,"0")}`),Y("div",je(W.value?o.size:o.originalSize,0)),Y("div",W.value?o.name:o.originalName)]);tn(a,Ie),a=null}catch(a){console.error(a)}}Ge(()=>{Ie&&(tn(null,Ie),Ie=null)});function Se(){b.value.openPreview()}function be(){}return(F,L)=>{const X=we,a=Oe,c=_n,S=et,P=Tt,B=ua;return U(),te(a,{justify:"center",align:"center",vertical:"",style:re({visibility:m.value?"hidden":"visible"}),class:"body",ref:"body"},{default:t(()=>[n(B,{ref_key:"nImageGroupRef",ref:w,"show-toolbar-tooltip":"","render-toolbar":Ce,onPreviewNext:ae},{default:t(()=>[n(a,{wrap:!1,align:"center",justify:"center"},{default:t(()=>[n(e(Ee),{onClick:L[0]||(L[0]=C=>q(-1)),disabled:!e(R),block:"",class:at({"thumb-arrow":!0,pale:!e(R)}),title:F.$t("Prev")},{icon:t(()=>[n(X,{size:"30"},{default:t(()=>[n(e(da))]),_:1})]),_:1},8,["disabled","class","title"]),n(a,{justify:"center",ref_key:"viewerItemContainer",ref:k,class:"viewer-item-container"},{default:t(()=>[n(Xe,{name:ue.value},{default:t(()=>[(U(),te(a,{vertical:"",key:ve.value,"_v-show":"viewerItemVisibility"},{default:t(()=>[n(a,{align:"center",wrap:!1},{default:t(()=>[n(a,{vertical:""},{default:t(()=>[n(a,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(a,{align:"center",justify:"center",vertical:"",class:"original-thumb"},{default:t(()=>[h("a",{href:F.originalUrl,onClick:L[4]||(L[4]=Qe(C=>{_.value.openPreview()},["prevent"])),download:F.originalName,title:F.originalName,class:"imglink"},[n(a,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(an,{ref:C=>{C!=null&&C.active&&(_.value=C)},src:E.value,width:1,"max-width":1,"max-height":1,loading:D.value,"file-name":F.originalName,"allow-next":u.value<o.length,"allow-prev":u.value>1,onLoad:ge,onNext:L[1]||(L[1]=C=>q(1)),onPrev:L[2]||(L[2]=C=>q(-1)),hidden:!0},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(a,{vertical:"",align:"center"},{default:t(()=>[n(a,{class:"imglink-label"},{default:t(()=>[I(d(e(g)("status.Original")),1)]),_:1}),n(a,{justify:"center",class:"img-size",wrap:!1},{default:t(()=>[h("span",Bl,d(v.value?M.value:"?"),1),L[11]||(L[11]=I(" × ")),h("span",Dl,d(v.value?A.value:"?"),1)]),_:1}),n(a,{justify:"center"},{default:t(()=>[L[3]||(Jt(-1,!0),(L[3]=n(a,null,{default:t(()=>[I(d(v.value?e(je)(o.originalSize,0):"?"),1)]),_:1})).cacheIndex=3,Jt(1),L[3])]),_:1})]),_:1})]),_:1})],8,jl)]),_:1}),n(a,{vertical:"",align:"center",style:{margin:"1em"},class:"original-thumb"},{default:t(()=>[n(X,{size:"20",color:"silver",component:e(en)},null,8,["component"])]),_:1}),h("a",{href:$.value,onClick:L[5]||(L[5]=Qe(C=>Se(),["prevent"])),download:o.name,title:o.name,class:"imglink"},[n(a,{vertical:"",align:"center",justify:"center"},{default:t(()=>[n(a,{class:"imglink-label"},{default:t(()=>[I(d(e(g)("status.Converted")),1)]),_:1}),n(a,{vertical:"",align:"center",justify:"center",size:0},{default:t(()=>[n(a,{justify:"center"},{default:t(()=>{var C;return[n(a,{wrap:!1,style:re((C=o.variousInfo)!=null&&C.shrinked?{color:"blue"}:{}),class:"img-size"},{default:t(()=>[h("span",Vl,d(j.value?x.value:"?"),1),L[12]||(L[12]=I(" × ")),h("span",Hl,d(j.value?O.value:"?"),1)]),_:1},8,["style"])]}),_:1})]),_:1}),n(a,{justify:"center"},{default:t(()=>[I(d(j.value?e(je)(o.size,0):"?"),1)]),_:1})]),_:1})],8,Zl)]),_:1}),n(a,{ref:"fileNameContainer",justify:"center",align:"center",class:"pathbox",title:o.name},{default:t(()=>[n(c,{"x-scrollable":!0,trigger:"hover",style:{"text-align":"center","font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:t(()=>[I(d(j.value?o.name:"?"),1)]),_:1})]),_:1},8,["title"])]),_:1}),n(a,{vertical:""},{default:t(()=>[n(an,{ref:C=>{C!=null&&C.active&&(b.value=C)},src:$.value,width:142,"max-width":140,"max-height":100,loading:D.value,"file-name":o.name,"allow-next":u.value<o.length,"allow-prev":u.value>1,onLoad:he,onNext:L[6]||(L[6]=C=>q(1)),onPrev:L[7]||(L[7]=C=>q(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(a,{justify:"center",wrap:!0},{default:t(()=>[n(S,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:o.url,ref:"saveImg",target:"_blank",download:o.name},[n(e(Ee),{disabled:!j.value,round:"",size:"tiny"},{default:t(()=>[I(d(F.$t("save")),1)]),_:1},8,["disabled"])],8,Wl)]),default:t(()=>[I(" "+d(F.$t("save")),1)]),_:1}),n(S,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(e(Ee),{disabled:!j.value,onClick:L[8]||(L[8]=C=>G(o.url)),round:"",size:"tiny"},{default:t(()=>L[13]||(L[13]=[I("DataURL")])),_:1},8,["disabled"])]),default:t(()=>[I(" "+d(F.$t("convertedImageDataUrlTooltip")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["name"])]),_:1},512),n(e(Ee),{onClick:L[9]||(L[9]=C=>q(1)),disabled:!e(me),block:"",class:at({"thumb-arrow":!0,next:!0,pale:!e(me)}),title:F.$t("Next")},{icon:t(()=>[n(X,{size:"30"},{default:t(()=>[n(e(ca))]),_:1})]),_:1},8,["disabled","class","title"])]),_:1}),Be(n(a,{style:{width:"100%"},wrap:!1},{default:t(()=>[n(P,{value:u.value,"onUpdate:value":L[10]||(L[10]=C=>u.value=C),tooltip:!1,step:1,min:1,max:o.length,keyboard:!1,class:"index-slider"},null,8,["value","max"]),n(a,{class:"index",align:"center",justify:"center",wrap:!1,size:3},{default:t(()=>[n(a,null,{default:t(()=>[I(d(e(g)("status.index"))+":",1)]),_:1}),n(a,{justify:"end",align:"center",class:"counter"},{default:t(()=>[I(d(u.value),1)]),_:1}),n(a,null,{default:t(()=>L[14]||(L[14]=[I("/")])),_:1}),n(a,{justify:"start",align:"center",class:"counter"},{default:t(()=>[I(d(o.length),1)]),_:1})]),_:1})]),_:1},512),[[De,!F.isSingle]])]),_:1},512)]),_:1},8,["style"])}}}),Gl=We(ql,[["__scopeId","data-v-c0e45804"]]),Kl={class:"status-table"},Yl={class:"started"},Ql={class:"mini-counter"},Xl={class:"failure"},Jl={class:"mini-counter"},es={colspan:"2"},ts={class:"completed"},ns={class:"main-counter"},os={class:"total"},as={class:"main-counter"},ls=xe({__name:"status.center-column",props:{processing:{type:Boolean},interval:{},statusColor:{},success:{},successTo:{},successFrom:{},index:{},length:{},failure:{},retried:{},successPercTo:{},successPercFrom:{}},setup(s){const r=s,i=jt(),p=y(i.value.successColor),o=y(!1);return ye(()=>r.processing,l=>{l||(r.success===r.length?o.value=!0:p.value=i.value.errorColor)}),(l,f)=>{const g=et,b=we,_=va,w=Oe,k=wn;return U(),te(k,{type:"multiple-circle","stroke-width":2,percentage:[l.successTo/l.length*100|0,l.index/l.length*100|0],color:[e(i).successColor,l.statusColor],"rail-style":[{stroke:e(p),opacity:.3}]},{default:t(()=>[n(w,{vertical:"",align:"center",justify:"center",size:0,style:{"font-family":"v-mono","white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:t(()=>[h("table",Kl,[h("tbody",null,[h("tr",Yl,[h("td",null,d(l.$t("status.started"))+":",1),h("td",Ql,[n(g,{trigger:"hover",style:re({color:e(i).infoColor}),placement:"left"},{trigger:t(()=>[h("span",{style:re({color:e(i).infoColor})},d(l.index.toLocaleString("en-us")),5)]),default:t(()=>[I(" "+d(l.$t("status.progressStarted"))+" ("+d(l.index.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),h("tr",Xl,[h("td",null,d(l.$t("status.failure"))+":",1),h("td",Jl,[n(g,{trigger:"hover",style:re({color:e(i).errorColor}),placement:"left"},{trigger:t(()=>[h("span",{style:re({color:e(i).errorColor})},d(l.failure.toLocaleString("en-us")),5)]),default:t(()=>[I(" "+d(l.$t("status.progressErrors"))+" ("+d(l.failure.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"]),l.retried>0?(U(),te(g,{key:0,trigger:"hover",style:re({color:e(i).warningColor}),placement:"left"},{trigger:t(()=>[h("span",{style:re({color:e(i).warningColor})}," ("+d(l.retried.toLocaleString("en-us"))+") ",5)]),default:t(()=>[I(" "+d(l.$t("status.progressRetries"))+" ("+d(l.retried.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):fe("",!0)])]),h("tr",null,[h("td",es,[n(w,{size:0,align:"center",justify:"center",style:re({color:l.processing?l.statusColor:e(p)}),wrap:!1,class:"perc"},{default:t(()=>[e(o)?(U(),te(b,{key:0,component:e(ma)},null,8,["component"])):fe("",!0),n(_,{duration:l.interval*3|0,from:l.successPercFrom|0,to:l.successPercTo|0,active:!0},null,8,["duration","from","to"]),f[0]||(f[0]=I("% "))]),_:1},8,["style"])])]),h("tr",ts,[h("td",null,d(l.$t("status.success"))+":",1),h("td",ns,[n(g,{trigger:"hover",duration:0,delay:0,style:re({color:e(i).successColor}),placement:"bottom"},{trigger:t(()=>[h("span",{style:re({color:e(i).successColor})},[n(_,{duration:l.interval*3|0,from:l.successFrom,to:l.successTo,active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:t(()=>[I(" "+d(l.$t("status.progressSuccess"))+" ("+d(l.successTo.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),h("tr",os,[h("td",null,d(l.$t("status.all"))+":",1),h("td",as,[n(g,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:t(()=>[I(d(l.length.toLocaleString("en-us")),1)]),default:t(()=>[I(" "+d(l.$t("status.progressTotal"))+" ("+d(l.length.toLocaleString("en-us"))+") ",1)]),_:1})])])])])]),_:1})]),_:1},8,["percentage","color","rail-style"])}}}),ss={key:0,class:"log-table",ref:"table"},is={class:"log-tr label"},rs=["title"],us={style:{"min-width":"7em"},class:"log-th"},ds={style:{"padding-left":"2em"},class:"log-th"},cs={ref:"tbody"},ps=["onClick","onDblclick"],fs={class:"log-td"},gs={class:"log-td"},ms={class:"log-td"},vs={class:"log-td"},hs={key:0,class:"log-td log-extra",style:{"padding-left":"0.5em"}},_s={key:0},ws={key:1,style:{color:"blue"}},ys={key:1},ln=3,sn=3e3,bs=100,ks=xe({__name:"status.log",props:lt({processing:{type:Boolean},opened:{type:Boolean},previewCollapsed:{type:Boolean},logs:{},imageIndex:{},thumbnail:{}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},order:{required:!1,default:"processed"},orderModifiers:{}}),emits:lt(["open-preview","change-index"],["update:expanded","update:order"]),setup(s,{emit:r}){const{t:i}=He(),p={W:160,H:80},o=s,l=Fe(s,"expanded"),f=r;ot("table");const g=ot("tbody"),b=y(),_=y(null),w=y(null),k=y(!0),m=y(80),u=y(200),x=ze(()=>{let a=o.logs;switch(D.value){case"success":a=a.filter(c=>c.completed);break;case"error":a=a.filter(c=>!c.completed);break}return a}),O=Cl(!1),E=y([{type:"group",label:()=>i("status.sort"),key:"sort",children:[{label:()=>i("status.sortByStart"),value:"processed"},{label:()=>i("status.sortByCompletion"),value:"zipped"},{label:()=>i("status.sortByName"),value:"name"},{label:()=>i("status.sortBySize"),value:"size"},{label:()=>i("status.sortByOutputSize"),value:"outputsize"},{label:()=>i("status.sortByStatus"),value:"status"}]}]),M=Fe(s,"order");ye(M,$e);const A=[{label:()=>i("status.showAll"),value:""},{label:()=>i("status.showOnlySuccess"),value:"success"},{label:()=>i("status.showOnlyError"),value:"error"}],D=y(A[0].value);Ne(()=>{W=ha(),ue(),window.addEventListener("resize",()=>ue());const a=new ResizeObserver(()=>ue());a.observe(W.parent.parent.vnode.el),Ge(()=>{window.removeEventListener("resize",()=>ue()),a.disconnect()})}),Ge(()=>{j==null||j.close(),clearTimeout(H),clearTimeout(he),clearTimeout(Ae)});let j;ye(()=>[o.thumbnail,o.opened],()=>{if(!o.thumbnail||!o.opened||o.thumbnail===j)return;const{width:a,height:c}=Fn(o.thumbnail,{width:p.W,height:p.H});w.value.width=a,w.value.height=c,w.value.style.width=a+"px",w.value.style.height=c+"px",o.thumbnail instanceof HTMLImageElement?w.value.getContext("2d").drawImage(o.thumbnail,0,0,a,c):(w.value.getContext("bitmaprenderer").transferFromImageBitmap(o.thumbnail),j=o.thumbnail,o.thumbnail.close())});let v=0;ye(()=>o.imageIndex,async()=>{var B;const a=o.imageIndex;let c=x.value.findIndex(C=>C.zippedIndex===a);c===-1&&(c=a);const S=c<le.value,P=c>le.value+pe.value;if(S||P){const C=c*ne-(P?m.value:0);(B=b.value)==null||B.scrollTo({behavior:"instant",top:C,left:be}),await Te(),q(!0),await Te()}Te(()=>{var ce,ie;let C=_.value;C&&(v>c&&(C=C.previousSibling||C,C instanceof HTMLElement||((ce=b.value)==null||ce.scrollTo(be,0),C=null)),(ie=C==null?void 0:C.scrollIntoView)==null||ie.call(C,{behavior:"instant",block:"nearest"}),v=c)})});let H,W;const me=y(document.documentElement.clientHeight),R=y(100),ue=a=>{clearTimeout(H),H=setTimeout(()=>{const c=b.value.$parent.$el.offsetHeight,S=window.innerHeight-W.parent.parent.vnode.el.offsetHeight-8,P=Math.max(200,c+S);me.value=document.documentElement.clientHeight,R.value=Math.max(100,P),!(!o.opened||!l.value)&&(m.value=Math.max(P,u.value))},100)};function ve(a){a&&(T(!0),ue(),O.value=!0)}let Ae=0,Le=!1;function T(a=!1){if(!Le){if(Ae){Le=!0;return}Te(()=>{!a&&!k.value||(b.value.scrollTo({behavior:"instant",top:o.logs.length*50,left:be}),Ae=window.setTimeout(()=>{Ae=0,Le&&(Le=!1,T())},bs))})}}const Z=y({height:"0px"}),K=y({height:"0px"}),le=y(0),pe=ze(()=>m.value/ne+ln*2|0);let ne=15,se=0,he=0,ge=0,z=-999,G=-1;function q(a){const c=Date.now();if(a!==!0){if(he)return;if(c-ge<30){he=window.setTimeout(()=>{he=0,q()},30-(c-ge));return}}ge=c,se||(se=g.value.rows[1].offsetHeight,ne=se);const S=x.value.length,B=b.value.scrollbarInstRef.containerRef.scrollTop;if(!a&&S===G&&Math.abs(B-z)<ne*.5)return;z=B,G=S;const C=Math.max(0,(B/ne|0)-ln);le.value=C,Z.value.height=C*ne+"px",K.value.height=Math.max(0,S-(C+pe.value))*ne+"px"}function oe(){var a;(a=b.value)==null||a.scrollTo(0,0),q()}ye(()=>o.logs,()=>{o.opened&&(Te(q),k.value&&T(),Ce())}),ye(()=>o.opened,a=>{a&&q()});let J=0,ae=0;function Ce(){if(M.value==="processed"||!M.value)return;const a=Date.now();if(a-ae<sn){if(J)return;J=window.setTimeout(Ce,sn-(a-ae));return}J=0,ae=a,$e()}function $e(){switch(console.log("sortList",M.value),M.value){case"zipped":o.logs.sort((a,c)=>a.zippedIndex-c.zippedIndex);break;case"status":o.logs.sort((a,c)=>a.command>c.command?1:-1);break;case"name":o.logs.sort((a,c)=>a.path>c.path?1:-1);break;case"size":o.logs.sort((a,c)=>a.size-c.size);break;case"outputsize":o.logs.sort((a,c)=>a.outputSize-c.outputSize);break;case"processed":default:o.logs.sort((a,c)=>a.index-c.index);break}}function Ie(a){const c=o.logs,S=c.findIndex(Me=>Me.zippedIndex===o.imageIndex);let P=0,B=1;switch(a.code){case"ArrowUp":P=-1;break;case"ArrowDown":P=1;break;case"PageUp":P=-1,B=m.value/ne|0;break;case"PageDown":P=1,B=m.value/ne|0;break;case"Enter":case"NumpadEnter":if(S>=0&&o.previewCollapsed){Te(()=>f("open-preview")),a.stopPropagation(),a.preventDefault();return}break;default:return}let C=S,ce=-1;const ie=c.length;do{if(C+=P,C<0||C>ie-1||C===S)break;if(c[C].completed){if(ce=C,--B>0)continue;break}}while(!0);if(ce>=0){const Me=c[ce];f("change-index",!0,Me.path,Me.fileId,Me.zippedIndex),a.preventDefault()}}let de=-1,Se=-1,be=0,F=!1;function L(a){var P,B;if(q(),F){F=!1;return}const{scrollLeft:c=0,scrollTop:S=0}=(B=(P=b.value)==null?void 0:P.scrollbarInstRef)==null?void 0:B.containerRef;(c!==de||de<0)&&(S===Se||Se<0)&&(be=c,console.log(be,"storedLogTableScrollLeft")),de=c,Se=S,Te(()=>{var ce,ie;F=!0;const C=(ie=(ce=b.value)==null?void 0:ce.scrollbarInstRef)==null?void 0:ie.containerRef;C&&(C.scrollLeft=be)})}function X(a){k.value=!1}return(a,c)=>{const S=At,P=Oe,B=we,C=Lt,ce=yn,ie=ke,Me=Tt,tt=et,st=Nt,Ct=Dt;return U(),te(Ct,{name:"log",style:{"white-space":"nowrap"}},{header:t(()=>[n(P,{align:"center",wrap:!1},{default:t(()=>[I(d(a.$t("status.Log")),1),Be(n(S,{size:16},null,512),[[De,a.processing&&!o.opened]])]),_:1})]),"header-extra":t(()=>[Be(n(P,{align:"center",justify:"end",wrap:!0,style:{"margin-top":"0.2em","margin-left":"0.5em"}},{default:t(()=>[n(C,{value:M.value,"onUpdate:value":[c[0]||(c[0]=N=>M.value=N),$e],options:e(E),style:{width:"auto","font-size":"smaller"},"consistent-menu-width":!1,"show-on-focus":!1,size:"tiny"},{arrow:t(()=>[n(B,{component:e(_a)},null,8,["component"])]),_:1},8,["value","options"]),n(C,{value:e(D),"onUpdate:value":[c[1]||(c[1]=N=>Ze(D)?D.value=N:null),c[2]||(c[2]=N=>oe())],options:A,placeholder:a.$t("status.filterLogSelect"),size:"tiny",style:{width:"auto","font-size":"smaller"},"consistent-menu-width":!1,"show-on-focus":!1},{arrow:t(()=>[n(B,{component:e(wa)},null,8,["component"])]),_:1},8,["value","placeholder"]),n(ce,{key:"b",checked:e(k),"onUpdate:checked":[c[3]||(c[3]=N=>Ze(k)?k.value=N:null),c[4]||(c[4]=N=>N&&T(!0))],size:"small",style:{"font-size":"smaller"}},{default:t(()=>[I(d(a.$t("status.autoScroll")),1)]),_:1},8,["checked"]),n(tt,{trigger:"hover",show:e(O),disabled:!l.value,placement:"top",delay:0},{trigger:t(()=>[n(ie,{style:{"max-width":"30em"},disabled:!0},{trigger:t(()=>[n(ce,{size:"small",checked:l.value,"onUpdate:checked":[c[5]||(c[5]=N=>l.value=N),ve],style:{"font-size":"smaller"}},{default:t(()=>[I(d(a.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:t(()=>[I(d(a.$t("status.expandLog")),1)]),_:1})]),default:t(()=>[n(P,{wrap:!1,align:"center",style:{"font-size":"0.8rem"}},{default:t(()=>[n(Me,{value:e(u),"onUpdate:value":c[6]||(c[6]=N=>Ze(u)?u.value=N:null),onUpdateValue:c[7]||(c[7]=N=>ue()),disabled:!l.value,"format-tooltip":N=>`Log size: ${N}`,tooltip:!0,step:1,min:e(R),max:e(me),style:{"z-index":"3",width:"100px"}},null,8,["value","disabled","format-tooltip","min","max"])]),_:1})]),_:1},8,["show","disabled"])]),_:1},512),[[De,o.opened]])]),default:t(()=>[n(P,{wrap:!1,align:"stretch",class:at({"log-container":1,"expand-log":l.value}),style:re(l.value?{height:e(m)+"px"}:{height:"110px"}),onKeydown:Ie,tabindex:"-1"},{default:t(()=>[n(e(_n),{ref_key:"scrollref",ref:b,distance:10,"x-scrollable":!0,onMousedownCapture:X,onWheel:c[8]||(c[8]=N=>k.value=!1),onScroll:L,load:"handleLogLoad",trigger:"none",style:re([{"z-index":"2","padding-right":"10px",height:"100%"},l.value?{height:e(m)+"px"}:{}]),size:50},{default:t(()=>[o.opened?(U(),ee("table",ss,[h("thead",null,[h("tr",is,[h("th",{class:"log-th",title:a.$t("status.table.core")},"th",8,rs),c[9]||(c[9]=h("th",{class:"log-th"},"no.",-1)),h("th",us,d(a.$t("status.table.status")),1),h("th",ds,d(a.$t("status.table.details")),1),c[10]||(c[10]=h("th",{class:"log-th"},"size",-1))])]),h("tbody",cs,[h("tr",{style:re(e(Z))},null,4),(U(!0),ee(Pe,null,ct(e(x).slice(e(le),e(le)+e(pe)),({index:N,key:Ve,command:qe,path:ft,core:Gt,zippedIndex:gt,completed:Kt,fileId:Go,shrinked:Ko,width:Yt,height:Yo,outputWidth:Qo,outputHeight:Xo,size:Jo,outputSize:Qt},Zi)=>(U(),ee("tr",{key:Ve,class:at({"log-tr":1,completed:Kt,selected:a.imageIndex===gt}),ref_for:!0,ref:Xt=>{a.imageIndex===gt&&(_.value=Xt)},onClick:Xt=>f("change-index",Kt,ft,Go,gt),onDblclick:()=>{a.imageIndex===gt&&f("open-preview")}},[h("td",fs,d(Gt>=0?Gt+1:"-"),1),h("td",gs,d(N+1),1),h("td",ms,d(qe),1),h("td",vs,d(ft),1),Yt?(U(),ee("td",hs,[I(d(`[${Yt}×${Yo}] (${e(je)(Jo,0)})`)+" ",1),Qt?(U(),ee("span",_s,[c[11]||(c[11]=I(" → ")),h("span",null," ("+d(e(je)(Qt,0))+") ",1)])):fe("",!0),Ko?(U(),ee("span",ws,d(` [${Qo}×${Xo}]`),1)):fe("",!0)])):(U(),ee("td",ys))],42,ps))),128)),h("tr",{style:re(e(K))},null,4)],512)],512)):fe("",!0),c[12]||(c[12]=h("div",{style:{height:"1em"}},null,-1))]),_:1},8,["style"]),n(P,{style:re([{"align-self":"center",position:"absolute","z-index":"0","margin-top":"10px",right:"0.1em","line-height":"0px"},{width:p.W+"px",height:p.H+"px"}]),justify:"center",align:"center"},{default:t(()=>[n(S,{size:"small",show:a.processing},{default:t(()=>[o.thumbnail===void 0?(U(),te(st,{key:0,description:"EMPTY"})):fe("",!0),Be(h("canvas",{ref_key:"thumbcanvas",ref:w,width:"106",height:"80",style:re({border:"1px solid gray",filter:a.processing?"":"opacity(0.35)"})},null,4),[[De,o.thumbnail!==void 0]])]),_:1},8,["show"])]),_:1},8,["style"])]),_:1},8,["class","style"])]),_:1})}}}),zs={key:0},xs={style:{}},Is=["innerHTML"],As={style:{margin:"1px"}},Ss=["href","download","onClick"],Ts={key:0,style:{position:"relative"}},Ls=["href","download"],Cs=["href","download"],$s={key:0,style:{margin:"1px"}},Es=["href","download","onClick"],Fs=xe({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image","delete-image"],setup(s,{expose:r,emit:i}){const p={itemMargin:"1px",titlePadding:"2px",titleFontSize:"0.8rem"},o=St(),{t:l}=He(),f=jt(),g=s,b=i;r({cleanup:X});const _=y(!1),w=y([]),k=y(!1),m=y([]),u=y([]),x=y(!1),O=y([0,0]),$=y([0,0]),E=y([0,0]),M=y([0,0]),A=y([0,0]),D=y([0,0]),j=y(0),v=y(0),H=y([0,0]),W=y(f.value.infoColor),me=y("#000000"),R=y("#000000"),ue=y(0),ve=y(0),Ae=y(""),Le=y("00:00:00"),T=y(void 0),Z=y(null),K=y(["progress","log","output"]),le=a=>K.value.includes(a),pe=a=>K.value.push(a),ne=a=>{const c=K.value.findIndex(S=>S===a);c>=0&&K.value.splice(c,1)},se=ze(()=>K.value.includes("log")),he=y(!1),ge=y("processed"),z=It({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:0,various:{shrinked:!1}}),G=ot("body"),q=ot("imageViewer");Ne(()=>{ye(g.status,()=>Ce(),{deep:!1});let a=0;const c=()=>{if(a)return;const S=Date.now();Le.value="00:00:00",a=window.setInterval(()=>{const P=(Date.now()-S)/1e3;Le.value=`${String(P/3600|0).padStart(2,"0")}:${String(P/60%60|0).padStart(2,"0")}:${String(P%60|0).padStart(2,"0")}`},300)};c(),x.value=!0,ye(()=>g.processing,(S,P)=>{S||$e(),S?(c(),w.value.length=0,_.value=!1,k.value=!1,m.value=[],u.value=[]):(clearInterval(a),a=0)}),Ge(()=>{clearInterval(a),clearTimeout(ae)}),_t(()=>clearInterval(a))}),Ge(()=>{X()}),_t(()=>{clearTimeout(ae)}),ye([()=>g.status.zips.length,()=>g.status.failedZips.length],()=>{const a=g.status;{m.value.length>a.zips.length&&(m.value.length=0);let c=0;const S=a.zips.length===1&&a.zippedTotalCount===a.length;for(let P=m.value.length;P<a.zips.length;P++){const B=a.zips[P],C=a.baseZipName+(S?"":"-"+String(P+1).padStart(2,"0"))+".zip";c+=B.size,m.value[P]={url:B.url,size:B.size,number:S?0:P+1,sizeByUnit:je(B.size),name:C,count:B.count,clicked:!1}}}{u.value.length>a.failedZips.length&&(u.value.length=0);let c=0;const S=a.failedZipDone&&a.failedZips.length===1;for(let P=u.value.length;P<a.failedZips.length;P++){const B=a.failedZips[P],C=a.baseZipName+"-error"+(S?"":"-"+String(P+1).padStart(2,"0"))+".zip";c+=B.size,u.value[P]={url:B.url,size:B.size,number:S?0:P+1,sizeByUnit:je(B.size),name:C,count:B.count,clicked:!1}}}});const oe=g.interval||100;let J=!1,ae=0;function Ce(){if(J)return;if(ae){J=!0;return}ae=window.setTimeout(()=>{ae=0,J&&(J=!1,Ce())},oe);const a=g.status;_.value=a.length>=2,$.value[1]=$.value[0],$.value[0]=a.startedCount,E.value[1]=E.value[0],E.value[0]=a.success,M.value[1]=M.value[0],M.value[0]=a.failure,A.value[1]=A.value[0],A.value[0]=a.done,D.value[1]=D.value[0],D.value[0]=a.converted,j.value=a.retried,v.value=a.length,H.value[1]=H.value[0],H.value[0]=a.zippedTotalCount,ue.value=a.inputTotalSize,ve.value=a.outputTotalSize;const c=ve.value-ue.value;Ae.value=(c>=0?"+ ":"")+je(c);const S=ve.value/ue.value,P=(256|Math.min(255,Math.max(0,S-1.5)*255|0)).toString(16).substring(1);me.value="#"+P+"0000";const B=1024*1024,C=(256|Math.min(255,Math.max(0,c/1024/B)*255|0)).toString(16).substring(1);R.value="#"+C+"0000",O.value[1]=O.value[0],O.value[0]=E.value[0]/v.value*100,(se.value||!g.processing)&&(w.value=w.value.concat(a.logs),a.logs.length=0),Z.value=a.thumbnail,g.processing?W.value=M.value[0]?f.value.errorColor:j.value?f.value.warningColor:f.value.infoColor:x.value=!1,a.convertedImageUrl!==z.url&&(z.url=a.convertedImageUrl,z.name=a.convertedImageName,z.dataUrl=a.convertedImageDataUrl,z.size=a.convertedImageSize||a.outputTotalSize,z.originalSize=a.convertedImageOrgSize,z.originalName=a.convertedImageOrgName,z.index=a.convertedImageIndex,z.originalUrl=a.convertedImageOrgUrl,z.various={shrinked:a.convertedImageShrinked})}function $e(){const a=g.status;W.value=g.status.success===g.status.length?f.value.successColor:f.value.errorColor,he.value||(ne("log"),he.value=!0),ge.value==="processed"&&(ge.value="zipped"),a.success>0&&pe("preview")}async function Ie(a,c,S,P){var C;if(!a)return;const B=P;console.log(a,c,S,P,"completed, path, fileId, zippedIndex"),console.log(B,g.status.ziplogs[B]),le("preview")||(pe("preview"),await Te()),(C=q.value)==null||C.changeIndex(B+1),await Te(()=>{var ce;try{(ce=q.value)==null||ce.$el.scrollIntoView({behavior:"instant",block:"nearest"})}catch{}})}const de=ze(()=>[{key:"open",label:l("status.openFailedList"),icon:()=>Y(we,()=>Y(bn)),onSelect(){F()}},{key:"download",label:l("status.saveFailedList"),icon:()=>Y(we,()=>Y(ya)),onSelect(){F(!0)}},{key:"zip",label:`${l("status.zipFailedList")}`+(g.status.failedZipDone?`(✔${l("status.done")})`:""),icon:()=>Y(At,{show:k.value&&!g.status.failedZipDone,size:"small"},()=>Y(we,()=>Y(Ut))),disabled:k.value,onSelect(a){return k.value=!0,b("demand-zip-errors"),!1}}]);function Se(a,c=!1){const{url:S,name:P}=a;if(c){const B=document.createElement("a");B.href=S,B.download=P,B.click()}a.clicked||(a.clicked=!0,x.value||m.value.every(B=>B.clicked)&&b("all-zips-clicked"))}async function be(){if(_.value){if(m.value.length>=2&&!await new Promise((S,P)=>o.warning({title:l("Download"),content:l("status.confirmDownloadMessage",[m.value.length]),positiveText:"OK",negativeText:l("cancel"),onPositiveClick:()=>S(!0),onNegativeClick:()=>P()})))return;const a=m.value;for(const c of a)Se(c,!0)}else q.value.download()}function F(a=!1){const c=new Blob([g.status.unconvertedListText],{type:"text/plain;charset=utf8"}),S=URL.createObjectURL(c),P=document.createElement("a");P.href=S,P.target="_blank",a&&(P.download=g.status.baseZipName+"-error.txt"),P.click()}const L=y(!1);function X(){L.value=!0,URL.revokeObjectURL(z.url),URL.revokeObjectURL(z.originalName),z.originalUrl="",z.url="",z.index=0,g.status.logs.length=0,w.value.length=0,u.value.length=0,m.value.length=0}return(a,c)=>{const S=Oe,P=ba,B=Dt,C=wn,ce=et,ie=Ee,Me=Ul,tt=Bt,st=ka,Ct=kn;return U(),te(S,{ref_key:"body",ref:G,vertical:"",justify:"center"},{default:t(()=>[n(Ct,{"display-directive":"show","trigger-areas":["arrow","main"],"expanded-names":e(K),"onUpdate:expandedNames":c[6]||(c[6]=N=>Ze(K)?K.value=N:null),"theme-overrides":p},{default:t(()=>[n(B,{name:"progress",style:{"white-space":"nowrap"}},{header:t(({collapsed:N})=>[n(S,null,{default:t(()=>[I(d(a.$t("status.Progress"))+" ",1),N?(U(),ee(Pe,{key:0},[I(" ("+d(e(O)[0]|0)+"%) ",1)],64)):fe("",!0)]),_:2},1024)]),default:t(()=>[n(S,{justify:"center",align:"center",wrap:!1,style:{"white-space":"nowrap","margin-top":"-2em"}},{default:t(()=>[n(S,{vertical:"",justify:"center",class:"left-column"},{default:t(()=>[n(P,{"tabular-nums":"",label:a.$t("status.elapsedTime")},{default:t(()=>[n(S,null,{default:t(()=>[I(d(e(Le)),1)]),_:1})]),_:1},8,["label"]),n(P,{"tabular-nums":"",label:a.$t("status.multiThreading")},{default:t(()=>[n(S,{style:re({color:g.status.threads?"":"red",fontSize:"0.7rem"})},{default:t(()=>[I(d(g.status.threads?a.$rt("{n} @:threads",g.status.threads):a.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(P,{"tabular-nums":"",label:a.$t("status.outputSettings")},{default:t(()=>[n(S,{vertical:"",justify:"end",style:{"font-size":"0.6rem","line-height":"0.6rem"}},{default:t(()=>[h("div",null,d(a.$t("settings.imageType"))+": "+d(g.status.type),1),a.status.shrink?(U(),ee("div",zs,[I(d(a.$t("status.Shrinking"))+": ",1),h("span",xs,d(a.status.shrink[0])+"×"+d(a.status.shrink[1]),1)])):fe("",!0),h("div",null,"Zip: "+d(g.status.zipSize)+"MB",1)]),_:1})]),_:1},8,["label"])]),_:1}),e(L)?fe("",!0):(U(),te(ls,{key:0,index:e($)[0],success:e(E)[0],length:a.status.length,"success-to":e(E)[0],"success-from":e(E)[1],failure:e(M)[0],"success-perc-to":e(O)[0],"success-perc-from":e(O)[1],retried:e(j),processing:e(x),interval:e(oe),"status-color":e(W),class:"center-column"},null,8,["index","success","length","success-to","success-from","failure","success-perc-to","success-perc-from","retried","processing","interval","status-color"])),n(S,{vertical:"",style:{height:"100%"},justify:"center"},{default:t(()=>[n(P,{"tabular-nums":"",label:a.$t("status.inputSize")},{default:t(()=>[n(S,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[I(d((e(ue)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(P,{"tabular-nums":"",label:a.$t("status.outputSize")},{default:t(()=>[n(S,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[I(d((e(ve)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(P,{"tabular-nums":"",label:a.$t("status.outInRate")},{default:t(()=>[n(S,{vertical:"",align:"end",justify:"start",style:{"font-size":"smaller","font-family":"v-mono","line-height":"50%"}},{default:t(()=>[h("span",{style:re({color:e(me),fontSize:"larger"})},"× "+d((e(ve)/e(ue)||1).toFixed(2)),5),h("span",{style:re({color:e(R)})},"("+d(e(Ae))+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:1})]),_:1}),n(ks,{processing:e(x),"image-index":e(z).index,thumbnail:e(Z),opened:e(se),"preview-collapsed":le("preview"),logs:e(w),expanded:e(he),order:e(ge),onChangeIndex:Ie,onOpenPreview:c[0]||(c[0]=N=>{var Ve;return(Ve=e(q))==null?void 0:Ve.openPreview()}),name:"log",style:{"white-space":"nowrap"}},null,8,["processing","image-index","thumbnail","opened","preview-collapsed","logs","expanded","order"]),n(B,{title:a.$t("status.PreviewImage"),name:"preview",style:{"white-space":"nowrap"},disabled:!(e(E)[0]>0)},{default:t(()=>[n(S,{justify:"center",align:"center",vertical:""},{default:t(()=>[n(Gl,{"_v-else-if":"imageViewerStarted && status.success > 0 /*&& (props.status.threads || !zippingFlag)*/ && !cleaningUp",ref_key:"imageViewer",ref:q,url:e(z).url,size:e(z).size,"original-url":e(z).originalUrl,"original-size":e(z).originalSize,name:e(z).name,originalName:e(z).originalName,length:e(E)[0],index:e(z).index,"various-info":e(z).various,"is-single":!e(_),onDemandImage:c[1]||(c[1]=N=>b("demand-image",N)),on_deleteImage:c[2]||(c[2]=N=>b("delete-image",N)),_close:"imageViewerStarted=false"},null,8,["url","size","original-url","original-size","name","originalName","length","index","various-info","is-single"])]),_:1})]),_:1},8,["title","disabled"]),n(B,{name:"output",style:{"white-space":"nowrap"},disabled:""},{header:t(()=>[h("span",{style:{color:"black"},innerHTML:a.$t("status.Output")},null,8,Is)]),default:t(()=>[n(S,{wrap:!1,vertical:"",style:{"margin-top":"-1.3em"}},{default:t(()=>[e(L)?fe("",!0):(U(),te(S,{key:0,justify:"center"},{default:t(()=>[Be(n(S,{vertical:"",align:"center"},{default:t(()=>[n(ce,{placement:"left"},{trigger:t(()=>[n(C,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":e(H)[0]===e(v)?"white":"green",processing:e(x),percentage:e(H)[0]/e(v)*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[h("span",As,d(e(H)[0]/e(v)*100|0)+"% "+d(a.$t("status.zipped"))+" ("+d(e(H)[0])+"/"+d(e(D)[0])+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[I(" "+d(a.$t("status.zippingProgress"))+" ("+d(e(H)[0]/e(v)*100|0)+"%) ",1)]),_:1}),n(Xe,{name:"zipcontainer"},{default:t(()=>[e(m).length>=1||e(x)?(U(),te(nn,{key:0,name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(U(!0),ee(Pe,null,ct(e(m),(N,Ve)=>(U(),ee("span",{key:Ve},[n(ce,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:N.url,download:N.name,class:"in-button-anchor",onClick:qe=>Se(N)},[n(ie,{class:"zip-button",size:"tiny",color:N.clicked?"#050":"lime","text-color":N.clicked?"gray":"white",onClick:Qe(qe=>Se(N),["stop"]),round:""},{default:t(()=>[n(e(we),{size:"tiny"},{default:t(()=>[n(e(Ut))]),_:1}),I("ZIP"+d(N.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Ss)]),default:t(()=>[h("div",{style:re({color:e(f).successColor})},[h("div",null,"ZIP "+d(N.number||"")+" ("+d(a.$t("success"))+")",1),h("div",null,d(N.name),1),h("div",null,d(N.sizeByUnit),1),h("div",null,d(a.$rt("{n} @:files",N.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):fe("",!0)]),_:1})]),_:1},512),[[De,e(_)]])]),_:1})),n(Xe,null,{default:t(()=>[e(L)?fe("",!0):Be((U(),te(S,{key:0,justify:"center",align:"center"},{default:t(()=>[n(ce,{trigger:"hover",duration:0,delay:0,placement:"left",style:re({color:"white",backgroundColor:e(f).successColor}),"arrow-style":{backgroundColor:e(f).successColor}},{trigger:t(()=>[n(Xe,{name:"save"},{default:t(()=>[e(E)[0]>0?(U(),ee("span",Ts,[n(tt,{value:e(_)?e(H)[0].toLocaleString("en-us"):g.status.type.replace(/\(.+\)/,""),color:e(f).successColorHover,offset:[-20,-3]},{default:t(()=>[n(ie,{size:"medium",onClick:be,color:e(f).successColor,round:""},{default:t(()=>[e(_)?(U(),ee(Pe,{key:0},[e(m).length?(U(),ee("a",{key:0,href:e(m)[0].url,download:e(m)[0].name,class:"in-button-anchor",onClick:c[3]||(c[3]=Qe(()=>{},["prevent"]))},[n(Me),I(" × "+d(e(m).length)+" "+d(a.$t("status.saveAll")),1)],8,Ls)):fe("",!0)],64)):(U(),ee("a",{key:1,href:e(z).url,download:e(z).name,class:"in-button-anchor",onClick:c[4]||(c[4]=Qe(()=>{},["prevent"]))},[n(e(we),{size:"tiny"},{default:t(()=>[n(e(zn))]),_:1}),I(" "+d(a.$t("save")),1)],8,Cs))]),_:1},8,["color"])]),_:1},8,["value","color"])])):fe("",!0)]),_:1})]),default:t(()=>[a.status.length>=2?(U(),ee(Pe,{key:0},[h("div",null,d(e(l)("success"))+": "+d(e(H)[0].toLocaleString()),1),h("div",null,d(e(l)("status.totalSize"))+": "+d(e(je)(a.status.zippedTotalSize)),1),h("div",null,"ZIP × "+d(e(m).length),1),h("div",null,d(e(l)("status.saveAllZipsTooltip")),1)],64)):(U(),ee(Pe,{key:1},[I(d(a.$t("status.downloadConvertedImage",e(m).length)),1)],64))]),_:1},8,["style","arrow-style"]),!e(x)&&a.status.success!==e(v)?(U(),te(st,{key:0,options:e(de),onSelect:c[5]||(c[5]=(N,Ve)=>{var qe;return(qe=e(de).find(({key:ft})=>N===ft))==null?void 0:qe.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:t(()=>[n(ce,{show:e(T),duration:0,delay:0,placement:"right",style:re({color:"white",backgroundColor:e(f).errorColor}),"arrow-style":{backgroundColor:e(f).errorColor}},{trigger:t(()=>[n(tt,{value:a.status.unconvertedFileCount.toLocaleString(),color:e(f).errorColorHover,offset:[-0,-3]},{default:t(()=>[n(ie,{size:"small",color:e(f).errorColor},{default:t(()=>[n(e(we),{size:"medium",style:{"vertical-align":"middle"}},{default:t(()=>[n(e(za))]),_:1})]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:t(()=>[h("div",null,[h("div",null,d(e(l)("failed"))+": "+d(a.status.unconvertedFileCount.toLocaleString()),1),h("div",null,d(e(l)("status.totalSize"))+": "+d(e(je)(a.status.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])):fe("",!0)]),_:1},512)),[[De,!e(x)]])]),_:1}),n(Xe,{name:"zipcontainer"},{default:t(()=>[e(L)?fe("",!0):Be((U(),te(S,{key:0,vertical:"",align:"center"},{default:t(()=>[n(ce,{placement:"left"},{trigger:t(()=>[n(C,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":a.status.failedFileZippedCount===a.status.unconvertedFileCount?"white":"#500",processing:e(k)&&!a.status.failedZipDone&&!a.status.failedToCreateFailedZip,percentage:a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[a.status.failedToCreateFailedZip?(U(),ee("div",{key:1,style:re({color:e(f).errorColor})},d(a.$t("status.failureZippingFailedFiles")),5)):(U(),ee("span",$s,d(a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0)+"% "+d(a.$t("status.zipped"))+" ("+d(a.status.failedFileZippedCount)+"/"+d(a.status.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[I(" "+d(a.$t("status.zippingProgress"))+" ("+d(a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(nn,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(U(!0),ee(Pe,null,ct(e(u),(N,Ve)=>(U(),ee("span",{key:Ve},[n(ce,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:N.url,download:N.name,class:"in-button-anchor",onClick:qe=>Se(N)},[n(ie,{class:"zip-button",size:"tiny",color:N.clicked?"#551122":"#F00","text-color":N.clicked?"gray":"white",onClick:Qe(qe=>Se(N),["stop"]),round:""},{default:t(()=>[n(e(we),{size:"tiny"},{default:t(()=>[n(e(xa))]),_:1}),I("ZIP"+d(N.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Es)]),default:t(()=>[h("div",{style:re({color:e(f).errorColor})},[h("div",null,"ZIP "+d(N.number||"")+" ("+d(a.$t("failed"))+")",1),h("div",null,d(N.name),1),h("div",null,d(N.sizeByUnit),1),h("div",null,d(a.$rt("{n} @:files",N.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1},512)),[[De,e(k)]])]),_:1})]),_:1})]),_:1})]),_:1},8,["expanded-names"])]),_:1},512)}}}),Ps=We(Fs,[["__scopeId","data-v-fe0ceb0a"]]),Os=["innerHTML"],Us=xe({__name:"converter",props:lt({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},threads:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:lt(["start","end"],["update:showNote"]),setup(s,{emit:r}){Je(Ye);const{t:i}=He(),p=St(),o=Ia(),l=10,f=navigator.hardwareConcurrency,g=typeof OffscreenCanvas=="function",b=100,_=s,w=Fe(s,"showNote"),k=r,m=y(!1),u=y(!1),x=y(!1),O=y(!1),$=y(!1),E=y(()=>"initializing"),M=y("info"),A=It(K()),D=ot("stat"),j=y(0);let v=!1,H=()=>{},W,me=0,R=!1;ye(()=>_.input,z=>{z!=null&&z.length&&pe(z)}),ye(O,z=>{document.body.style.overflowY=z?"hidden":"auto"}),Ne(async()=>{await he(),ge()});async function ue(){let z=!0;if(me>l*1e3&&!R&&A.success>0&&(z=!1,await new Promise(G=>{p.warning({title:i("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:i("close"),negativeText:i("back"),onPositiveClick:()=>z=!0,onAfterLeave:G,content:i("confirmCloseDialog")})})),!z)return!1;o.destroyAll(),O.value=!1,w.value=!1}function ve(z){W==null||W(z),console.log(z,"demanded")}function Ae(z){Ft==null||Ft(z),console.log(z,"delete")}function Le(){!u.value&&m.value?u.value=!0:ue()}function T(){pe(_.input)}let Z=y(()=>{});function K(z){const G={logs:[],ziplogs:[],startedCount:0,converted:0,success:0,failure:0,retried:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",convertedImageOrgUrl:"",convertedImageIndex:-1,convertedImageShrinked:!1,zipSize:_.maxZipSizeMB,shrink:V.multithread&&V.shrinkImage?[V.maxWidth,V.maxHeight]:void 0,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1};return Object.assign(z||{},G)}function le(){$.value=!1,URL.revokeObjectURL(A.convertedImageUrl),URL.revokeObjectURL(A.convertedImageOrgUrl);for(const z of A.zips)URL.revokeObjectURL(z.url);A.zips.length=0;for(const z of A.failedZips)URL.revokeObjectURL(z.url);A.failedZips.length=0,K(A),H(),H=()=>{},W=null,R=!1,x.value=!1,u.value=!1}async function pe(z){if(m.value){p.error({title:"Busy",positiveText:"OK",content:i("interfered")});return}O.value&&(j.value^=1);let G=z.concat();K(A),le(),O.value=!0,$.value=!0,m.value=!0,A.processing=!0,M.value="info",E.value=()=>i("processing");const q=new Set,oe=_.format,J=_.quality,ae=[...oe.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),Ce=se(oe,J,G[0].webkitRelativePath);A.length=G.length,A.baseZipName=Ce,A.type=oe.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(oe)?" ("+J+")":""),A.threads=v?0:_.threads;const $e=Date.now();k("start");let Ie,de,Se;if(!v&&_.threads>=2?(W=Al,Se=await hl({files:G,completedFileIdSet:q,ConvStats:A,canceled:u,props:_,imageType:oe,quality:J,outputExt:ae,format:oe,message:o})):(W=El,Se=await $l(G,q,_,u,A)),{exception:de,callbackToGenerateFailedZips:Ie,callbackToClearConverter:H}=Se,de){let be;switch(de.message){case"worker-load-error":be=i("errMsgWorkerLoadError");break;default:be="unexpected error"}p.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:()=>Y("div",[Y("p",be),Y(Ee,{onClick(){location.reload()}},i("Reload"))])})}if(A.success===A.length?(M.value="success",E.value=()=>i("completed")):(M.value="error",E.value=()=>u.value?i("aborted"):i("incomplete")),q.size!==G.length){const be=ne(z,q);Z.value=()=>{!be||!be.length||Ie(be)}}m.value=!1,A.processing=!1,x.value=!0,G.length=0,me=Date.now()-$e,k("end")}function ne(z,G){const q=[],oe=[];let J=0;for(const ae of z)G.has(ae._id)||(q.push(ae),oe.push(ae.webkitRelativePath||ae.relativePath||ae.name),J+=ae.size);return oe.length&&(A.unconvertedListText=oe.join(`
`),A.unconvertedFileCount=q.length,A.unconvertedTotalSize=J),q}function se(z,G,q){var $e;const oe=new Date;z=z.replace(/^image\//,"").toLowerCase();const J=V.useFolderNameForZip&&(($e=String(q).match(/^\/?([^/]+)\//))==null?void 0:$e[1])||"avif2jpg",ae=`
    ${oe.getFullYear().toString().substring(2)}
    ${String((oe.getMonth()+1)*100+oe.getDate()).padStart(4,"0")}
    ${String(oe.getHours()*1e4+oe.getMinutes()*100+oe.getSeconds()).padStart(6,"0")}
    -
    ${z+(/jpe?g|webp/i.test(z)?G:"")}
  `.replace(/\s/g,"");return`${J}-${ae}`.replace(/\s+/g," ")}async function he(){const z="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",G=document.createElement("img"),q=Pn(G).then(()=>!0,()=>!1);G.src=z,await q||p.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:i("avifUnsupported")})}function ge(){(!g||f<2||!Promise.any)&&(v=!0),v&&(Ue.value=0)}return(z,G)=>{var Ie;const q=we,oe=Bt,J=ke,ae=Oe,Ce=At,$e=Rt;return U(),ee(Pe,null,[!e(m)&&((Ie=_.input)!=null&&Ie.length)?(U(),te(ae,{key:0,justify:"center",align:"center",style:{"margin-top":"0.4em"}},{default:t(()=>[n(J,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:t(()=>{var de;return[n(oe,{value:((de=z.input)==null?void 0:de.length)||0,offset:[-12,-5],color:"#99999966"},{default:t(()=>[n(e(Ee),{onClick:T,round:"",size:"medium"},{icon:t(()=>[n(q,{size:"1.2em",color:"#CCCCCC"},{default:t(()=>[n(e(Aa))]),_:1})]),default:t(()=>[I(" "+d(e(i)("convertAgain")),1)]),_:1})]),_:1},8,["value"])]}),default:t(()=>{var de;return[h("div",{innerHTML:e(i)("reconvertTip",(de=_.input)==null?void 0:de.length)},null,8,Os)]}),_:1})]),_:1})):fe("",!0),n($e,{ref:"processingModal","display-directive":"show",show:e(O),"onUpdate:show":G[2]||(G[2]=de=>Ze(O)?O.value=de:null),closable:e(x),"close-on-esc":!1,preset:"dialog",onClick:G[3]||(G[3]=de=>{e(o).destroyAll()}),onMaskClick:G[4]||(G[4]=de=>{e(o).destroyAll()}),onClose:ue,onEsc:Le,title:e(E),type:e(M),"mask-closable":!1,onAfterLeave:le,onBeforeLeave:G[5]||(G[5]=de=>{e(D).cleanup()}),class:"processing-dialog"},{default:t(()=>[n(ae,{vertical:"",style:{"flex-grow":"1"}},{default:t(()=>[e($)?(U(),te(Ps,{ref_key:"stat",ref:D,key:e(j),processing:e(m),status:e(A),interval:b,onAllZipsClicked:G[0]||(G[0]=de=>Ze(R)?R.value=!0:R=!0),onDemandZipErrors:e(Z),onDemandImage:ve,onDeleteImage:Ae},null,8,["processing","status","onDemandZipErrors"])):fe("",!0),n(ae,{justify:"end",align:"center",wrap:!1},{default:t(()=>[n(ae,{justify:"start",align:"center"},{default:t(()=>[gn(z.$slots,"lang-switch")]),_:3}),e(m)?(U(),te(e(Ee),{key:0,disabled:e(u),ref:"cancelbutton",round:"",size:"large",onClick:G[1]||(G[1]=de=>u.value=!0)},{default:t(()=>[n(Ce,{show:e(u)&&!e(x),size:"small"},{default:t(()=>[I(d(e(i)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):e(x)?(U(),te(e(Ee),{key:1,onClick:ue,round:"",size:"large",style:{"font-size":"small","margin-top":"1em"}},{default:t(()=>[I(d(e(i)("close")),1)]),_:1})):fe("",!0)]),_:3})]),_:3})]),_:3},8,["show","closable","title","type"])],64)}}}),Ms="/avif2jpeg/dist/avif.png",Rs={class:"container-1"},Ns={style:{position:"relative"}},js={style:{position:"absolute","font-size":"0.5em",right:"-3.5em",bottom:"-1.5em","white-space":"nowrap"}},Bs={style:{color:"#666666"}},Ds=["innerHTML"],Zs={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},Vs=xe({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(s,{emit:r}){Je(Ye);const i=s,p=r,o=Sa(),l=y(!1),f=y(0),g=y("");Ne(()=>{b(i.dropTarget||document)});function b(w){document.ondragstart=k=>k.preventDefault(),document.ondragover=k=>k.preventDefault(),w.ondrop=async k=>{var u;if(k.preventDefault(),l.value||i.forbidden)return;l.value=!0,f.value=0,g.value="";let m;try{const x=[...k.dataTransfer.items].map(O=>O.webkitGetAsEntry());o.start(),m=await _(x),o.finish()}catch{m=[...((u=k.dataTransfer)==null?void 0:u.files)??[]],o.error()}l.value&&(l.value=!1,p("drop",m))}}async function _(w,k){k=k||[];for(const m of w)if(m.isFile){const u=await new Promise(x=>m.file(O=>x(O)));Object.defineProperty(u,"webkitRelativePath",{value:m.fullPath}),k.push(u),f.value++}else if(m.isDirectory){g.value=m.fullPath;const u=m.createReader();do{const x=await new Promise(O=>u.readEntries($=>O($)));if(!x.length)break;await _(x,k)}while(!0)}return k}return(w,k)=>{const m=we,u=et,x=Oe,O=ke,$=Rt;return U(),ee("div",Rs,[n(O,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"bottom-end"},{trigger:t(()=>[n(x,{vertical:"",class:"container-2"},{default:t(()=>[n(x,{align:"center",wrap:!1,class:"container-3"},{default:t(()=>[n(x,{vertical:"",align:"center",wrap:!1,style:{"font-weight":"bold","font-size":"1em","line-height":"90%","white-space":"nowrap"}},{default:t(()=>[k[5]||(k[5]=h("span",null,"Drag & Drop",-1)),h("span",Ns,[k[4]||(k[4]=I(" AVIF Images ")),h("span",js,[k[3]||(k[3]=I(" or ")),n(u,{placement:"bottom-end"},{trigger:t(()=>[h("span",Bs,[n(m,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Zt))]),_:1}),k[1]||(k[1]=I(" Folders "))])]),default:t(()=>[k[2]||(k[2]=I(" You can drag and drop your local folders "))]),_:1})])])]),_:1}),n(x,null,{default:t(()=>k[6]||(k[6]=[h("img",{src:Ms,class:"avif"},null,-1)])),_:1})]),_:1})]),_:1})]),default:t(()=>[h("h3",{innerHTML:w.$t("droptarget"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,Ds)]),_:1}),n($,{show:e(l),"onUpdate:show":k[0]||(k[0]=E=>Ze(l)?l.value=E:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":w.$t("cancel")},{default:t(()=>[n(x,{vertical:"",align:"center"},{default:t(()=>[h("div",Zs,d(e(g)),1),h("div",null,"found "+d(e(f))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])])}}}),Hs=We(Vs,[["__scopeId","data-v-963c44a5"]]),Ws={class:"container-1"},qs={class:"container-2"},Gs=["innerHTML"],Ks=["innerHTML"],Ys={style:{"white-space":"nowrap"}},Qs={style:{"padding-left":"1em"}},Xs=["innerHTML"],Js=["accept"],ei=xe({__name:"file-selector",props:lt({target:{},userExtensions:{},forbidden:{type:Boolean}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:lt(["input","click","cancel","on-change-accept","update:target","update:userExtensions"],["update:expanded","update:disableNotifyingFolderSelect"]),setup(s,{emit:r}){const i=St(),{t:p}=He(),o=Je(Ye),l=["avif_only","all_images","all_files","edit_type"],f=[];for(const T of l)f.push({label:()=>p("fileTypeRadioOptions."+T),value:T});const g=({node:T,option:Z})=>Y(ke,{placement:"right"},{trigger:()=>T,default:()=>R(Z.value).replace(/,/g,", ")}),b=s,_=r,w=y(0),k=y(!1),m=y(!1),u=ze(()=>R($.value)),x=ze(()=>E.value.split(",").every(Z=>/^\s*(\.[\w\-]+)*\s*$/.test(Z))?"success":"error"),O=ze(()=>!b.forbidden&&!m.value);Fe(s,"expanded");const $=ze({get:()=>l.indexOf(b.target)>=0?b.target:l[0],set:T=>{_("update:target",T)}}),E=ze({get:()=>b.userExtensions,set:T=>{_("update:userExtensions",T)}}),M=Fe(s,"disableNotifyingFolderSelect"),A=y(null),D=y(null),j=y(me());ye($,T=>{_("on-change-accept",u.value)}),Ne(()=>{});async function v(T){if(_("click"),T===D.value&&!M.value){let Z=!1;if(await new Promise(K=>{i.info({title:p("loadfolderNotifyingTitle"),positiveText:p("Continue"),negativeText:p("Cancel"),onAfterLeave:()=>K(Z),onPositiveClick:()=>Z=!0,content:()=>Y("div",[Y("p",{},p("loadfolderNotifyingMessageTerm1")),Y("div",[Y(hn,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/dist//notification-folder.png"})]),Y("p",{},p("loadfolderNotifyingMessageTerm2")),Y("p",[Y(yn,{onUpdateChecked:le=>M.value=le,checked:M.value},()=>p("checkboxTextDontShowThis"))])])})}),!Z){M.value=!1,_("cancel");return}}T.click()}function H(){_("cancel")}function W(T){const K=[...T.target.files];A.value.value="",D.value.value="",ve(K)}function me(){return"webkitdirectory"in document.createElement("input")}function R(T){switch(T){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico";case"edit_type":return E.value;case"all_files":default:return".*"}}async function ue(T){const Z=String(u.value).toLowerCase().replace(/\s+/g,"");if(Z&&u.value!==".*"){const K=Z.split(",");T=T.filter(le=>K.includes(le.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),T.length||(await new Promise(le=>{i.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:le,content:()=>Y("div",[Y(Nt,{description:"NO IMAGES"}),`${p("noimage")}`,Y("br"),u.value])})}),H())}return T}async function ve(T){m.value=!0,T=await ue(T),w.value=T.length,T.length>0&&_("input",Le(T)),m.value=!1}let Ae=0;function Le(T){const Z=[];for(const K of T)K.hasOwnProperty("_id")||Object.defineProperty(K,"_id",{value:Ae++}),Z.push(K);return Z}return(T,Z)=>{const K=we,le=Ee,pe=Oe,ne=Lt,se=La,he=Ta,ge=et;return U(),ee(Pe,null,[h("div",Ws,[h("div",qs,[n(pe,{vertical:"",align:"center",justify:"center",inline:"",size:"large"},{default:t(()=>[n(pe,{align:"center",justify:"space-around",class:"main-buttons"},{default:t(()=>[n(pe,{vertical:"",align:"stretch",justify:"center"},{default:t(()=>[n(e(ke),{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(o).LANDSCAPE.value?"right":"top",duration:0,delay:0,"z-index":10},{trigger:t(()=>[n(le,{disabled:!e(O),size:"large",onClick:Z[0]||(Z[0]=z=>v(e(A))),round:"",style:{width:"100%","background-color":"white","font-size":"large"}},{icon:t(()=>[n(K,{size:"large",color:"gray"},{default:t(()=>[n(e(xn))]),_:1})]),default:t(()=>[I(" "+d(T.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[h("div",{innerHTML:T.$t("loadbuttontooltip")},null,8,Gs)]),_:1},8,["show","placement"]),!e(o).IS_SP&&e(j)||e(o).SSR?(U(),ee(Pe,{key:0},[n(pe,{align:"center",justify:"center",style:{color:"gray",margin:"0em"}},{default:t(()=>[I(d(T.$t("or")),1)]),_:1}),n(e(ke),{to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:e(o).showTooltipsBeforeMounted.value},{trigger:t(()=>[n(le,{disabled:!e(O),size:"large",onClick:Z[1]||(Z[1]=z=>v(e(D))),round:"",style:{width:"100%","background-color":"white","font-size":"large"}},{icon:t(()=>[n(K,{size:"large",color:"gray"},{default:t(()=>[n(e(Zt))]),_:1})]),default:t(()=>[I(" "+d(T.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[h("div",{innerHTML:T.$t("loadfoldertooltip")},null,8,Ks)]),_:1},8,["show"])],64)):fe("",!0)]),_:1}),e(o).IS_SP?fe("",!0):(U(),te(Hs,{key:0,onDrop:ve,forbidden:!e(O),class:"drop-target"},null,8,["forbidden"]))]),_:1}),n(pe,{vertical:""},{default:t(()=>[n(pe,{wrap:e(o).IS_SP,align:"center",justify:"stretch"},{default:t(()=>[h("span",Ys,d(T.$t("TargetFileTypeExt"))+": ",1),n(e(ke),{"keep-alive-on-hover":!1,placement:"right",style:{"max-width":"200px"},duration:0,delay:0},{trigger:t(()=>[n(ne,{trigger:"click",width:"trigger",size:"small",value:e($),"onUpdate:value":Z[2]||(Z[2]=z=>Ze($)?$.value=z:null),options:f,"render-option":g,"consistent-menu-width":!1},null,8,["value"])]),default:t(()=>[I(" "+d(R(e($)).replace(/,/g,", ")),1)]),_:1})]),_:1},8,["wrap"]),e($)==="edit_type"?(U(),te(e(ke),{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:e(k),duration:0,delay:0},{trigger:t(()=>[h("div",Qs,[n(ge,{trigger:"manual",placement:"right-end",show:e($)==="edit_type"&&e(x)!=="success"&&!!e(k)},{trigger:t(()=>[n(se,{value:e(E),"onUpdate:value":Z[3]||(Z[3]=z=>Ze(E)?E.value=z:null),status:e(x),disabled:e($)!=="edit_type",onFocus:Z[4]||(Z[4]=z=>k.value=!0),onBlur:Z[5]||(Z[5]=z=>k.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:t(()=>[n(he,{type:"error","show-icon":!0,title:"Validation error"},{default:t(()=>Z[6]||(Z[6]=[I(" Please correct the extension list."),h("br",null,null,-1),h("ul",null,[h("li",null,"Each extension must begin with a period. "),h("li",null,"Separate each extension with a comma. "),h("li",null,"Use alphameric characters.")],-1)])),_:1})]),_:1},8,["show"])])]),default:t(()=>[h("span",{innerHTML:T.$t("editAcceptTypes")},null,8,Xs)]),_:1},8,["show"])):fe("",!0)]),_:1})]),_:1})])]),h("input",{ref_key:"fileinput",ref:A,onInput:W,onCancel:H,type:"file",multiple:"",accept:e(u),style:{display:"none"}},null,40,Js),h("input",{ref_key:"folderinput",ref:D,webkitdirectory:"",directory:"",onInput:W,onCancel:H,type:"file",style:{display:"none"}},null,544)],64)}}}),ti=We(ei,[["__scopeId","data-v-946de019"]]),ni={style:{"white-space":"nowrap"}},oi=xe({__name:"settings-output",props:{quality:{},format:{}},emits:["update:format","update:quality"],setup(s,{emit:r}){const i=s,p=r,{t:o}=He(),l=Je(Ye),f=y([]),g=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],b=ze({get:()=>i.format,set:x=>{x=m(x),p("update:format",x)}}),_=ze({get:()=>i.quality,set:x=>{p("update:quality",x)}}),w=ze(()=>/png|bmp/i.test(b.value)),k=y(null);Ne(()=>{u()});function m(x){return f.value.indexOf(x)<0&&(x=f.value[0]),x}function u(){for(const x of g)k.value.toDataURL(x).indexOf(x)>=0&&f.value.push(x);f.value.length===0&&f.value.push(g[0])}return(x,O)=>{const $=we,E=Lt,M=Oe,A=ke,D=Tt,j=In;return U(),ee(Pe,null,[n(M,{justify:"center",class:"body"},{default:t(()=>[n(M,{vertical:""},{default:t(()=>[n(A,{to:!1,"display-directive":"show",show:e(l).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(l).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(M,{align:"center",wrap:!1},{default:t(()=>[n($,null,{default:t(()=>[n(e(xn))]),_:1}),I(d(e(o)("settings.imageType"))+": ",1),n(E,{value:b.value,"onUpdate:value":O[0]||(O[0]=v=>b.value=v),options:f.value.map(v=>({value:v,label:v})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:t(()=>[I(" "+d(e(o)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(A,{to:!1,"display-directive":"show",show:e(l).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(l).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(M,{align:"center"},{default:t(()=>[n(M,{align:"start",wrap:!1},{default:t(()=>[n($,null,{default:t(()=>[n(e(zn))]),_:1}),h("span",ni,d(e(o)("settings.quality"))+":",1),n(M,{align:"center",justify:"space-between"},{default:t(()=>[n(D,{tooltip:!1,value:_.value,"onUpdate:value":O[1]||(O[1]=v=>_.value=v),step:1,style:{width:"120px"},disabled:w.value},null,8,["value","disabled"]),n(j,{onBlur:O[2]||(O[2]=v=>_.value??(_.value=0)),value:_.value,"onUpdate:value":O[3]||(O[3]=v=>_.value=v),step:"1",min:"0",max:"100",disabled:w.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:t(()=>[I(" "+d(e(o)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1})]),_:1}),h("canvas",{ref_key:"canvas",ref:k,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),ai=We(oi,[["__scopeId","data-v-060333f5"]]),li={style:{width:"4em","text-align":"left"}},si={style:{width:"4em","text-align":"left"}},Pt=100,rn=2e3,un=4096,dn=4096,ii=100,ri=100,ui=xe({__name:"settings-adv",props:{expanded:{type:Boolean,required:!1},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}},emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(s){const r={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},i=Fe(s,"expanded"),p=Fe(s,"multithread"),o=Fe(s,"threadCount"),l=Fe(s,"maxZipSize"),f=Fe(s,"retainExt"),g=Fe(s,"useFolderNameForZip"),b=Fe(s,"shrinkImage"),_=Fe(s,"maxWidth"),w=Fe(s,"maxHeight");ye(Ue,m=>{m>1||(p.value=!1),o.value>m&&(o.value=m)},{immediate:!0});const k=ze(()=>p.value&&Ue.value>1);return Ne(()=>{Ue.value>1&&typeof o.value>"u"&&(o.value=Math.max(Ue.value,2))}),(m,u)=>{const x=we,O=Ee,$=Ea,E=Oe,M=Tt,A=In,D=Dt,j=kn;return U(),te(E,{justify:"center"},{default:t(()=>[n(j,{"display-directive":"show","default-expanded-names":i.value?["collapitem"]:"","on-update:expanded-names":v=>i.value=!!String(v),"trigger-areas":["arrow","main"],class:at(["settings-body",i.value?"expand-adv-settings":""])},Ca({arrow:t(()=>[n(x,{style:re(i.value&&{top:"8px"})},{default:t(()=>[n(e(Oa))]),_:1},8,["style"]),n(x,null,{default:t(()=>[n(e(Ua))]),_:1})]),default:t(()=>[n(D,{title:m.$t("settings.advancedSettings"),name:"collapitem"},{default:t(()=>[n(E,{vertical:"",style:{"padding-left":"2em"}},{default:t(()=>[n(e(ke),it(rt(r)),{trigger:t(()=>[n(E,{vertical:""},{default:t(()=>[n(E,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",disabled:!e(Ue),style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:u[0]||(u[0]=v=>p.value=!p.value)},{icon:t(()=>[n(x,null,{default:t(()=>[n(e($a))]),_:1})]),default:t(()=>[I(" "+d(m.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n($,{value:p.value,"onUpdate:value":u[1]||(u[1]=v=>p.value=v),disabled:!e(Ue),size:"small"},null,8,["value","disabled"])]),_:1}),n(E,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(M,{value:o.value,"onUpdate:value":u[2]||(u[2]=v=>o.value=v),disabled:!e(Ue)||!p.value,step:1,min:2,max:e(Ue),style:{width:"120px"}},null,8,["value","disabled","max"]),n(A,{onBlur:u[3]||(u[3]=v=>o.value??(o.value=2)),size:"tiny",value:o.value,"onUpdate:value":u[4]||(u[4]=v=>o.value=v),disabled:!e(Ue)||!p.value,step:1,min:2,max:e(Ue),style:{width:"10em"}},{suffix:t(()=>[I(d(m.$t("threads",o.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[I(" "+d(m.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(e(ke),it(rt(r)),{trigger:t(()=>[n(E,{vertical:""},{default:t(()=>[n(E,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:t(()=>[n(x,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Fa))]),_:1})]),default:t(()=>[I(" "+d(m.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(E,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(M,{tooltip:!1,value:l.value,"onUpdate:value":u[5]||(u[5]=v=>l.value=v),step:1,min:Pt,max:rn,style:{width:"120px"}},null,8,["value"]),n(A,{onBlur:u[6]||(u[6]=v=>l.value??(l.value=Pt)),size:"tiny",value:l.value,"onUpdate:value":u[7]||(u[7]=v=>l.value=v),step:"1",min:Pt,max:rn,style:{width:"10em"}},{suffix:t(()=>u[20]||(u[20]=[I("(MB)")])),_:1},8,["value"])]),_:1})]),_:1})]),default:t(()=>[I(" "+d(m.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(e(ke),it(rt(r)),{trigger:t(()=>[n(E,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:u[8]||(u[8]=v=>g.value=!g.value)},{icon:t(()=>[n(x,null,{default:t(()=>[n(e(Zt))]),_:1})]),default:t(()=>[I(" "+d(m.$t("settings.useFolderNameForZip")),1)]),_:1}),n($,{value:g.value,"onUpdate:value":u[9]||(u[9]=v=>g.value=v),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[I(" "+d(m.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(e(ke),it(rt(r)),{trigger:t(()=>[n(E,{wrap:!1,align:"center"},{default:t(()=>[n(O,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:u[10]||(u[10]=v=>f.value=!f.value)},{icon:t(()=>[n(x,null,{default:t(()=>[n(e(bn))]),_:1})]),default:t(()=>[I(" "+d(m.$t("settings.retainOriginalExtension")),1)]),_:1}),n($,{value:f.value,"onUpdate:value":u[11]||(u[11]=v=>f.value=v),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[I(" "+d(m.$t("settings.retainExtTooltip")),1)]),_:1},16),n(e(ke),it(rt(r)),{trigger:t(()=>[n(E,{vertical:""},{default:t(()=>[n(E,{wrap:!1,align:"center"},{default:t(()=>[n(O,{disabled:!k.value,text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:u[12]||(u[12]=v=>b.value=!b.value)},{icon:t(()=>[n(x,null,{default:t(()=>[n(e(Pa))]),_:1})]),default:t(()=>[I(" "+d(m.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n($,{disabled:!k.value,value:b.value,"onUpdate:value":u[13]||(u[13]=v=>b.value=v),size:"small"},null,8,["disabled","value"])]),_:1}),n(E,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(M,{value:_.value,"onUpdate:value":u[14]||(u[14]=v=>_.value=v),disabled:!b.value||!k.value,step:1,min:ii,max:un,style:{width:"120px"}},null,8,["value","disabled"]),n(A,{size:"tiny",onBlur:u[15]||(u[15]=v=>_.value??(_.value=8)),value:_.value,"onUpdate:value":u[16]||(u[16]=v=>_.value=v),disabled:!b.value||!k.value,step:1,min:8,max:un*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[h("span",li,d(m.$t("width")),1)]),suffix:t(()=>u[21]||(u[21]=[I("px")])),_:1},8,["value","disabled","max"])]),_:1}),n(E,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(M,{value:w.value,"onUpdate:value":u[17]||(u[17]=v=>w.value=v),disabled:!b.value||!k.value,step:1,min:ri,max:dn,style:{width:"120px"}},null,8,["value","disabled"]),n(A,{size:"tiny",onBlur:u[18]||(u[18]=v=>w.value??(w.value=8)),value:w.value,"onUpdate:value":u[19]||(u[19]=v=>w.value=v),disabled:!b.value||!k.value,step:1,min:8,max:dn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[h("span",si,d(m.$t("height")),1)]),suffix:t(()=>u[22]||(u[22]=[I("px")])),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[I(" "+d(m.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1},8,["title"])]),_:2},[i.value?{name:"header-extra",fn:t(()=>[n(e(ke),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(O,{onClick:e(Ya),size:"tiny",style:{"font-size":"xx-small"}},{default:t(()=>[I(d(m.$t("reset")),1)]),_:1},8,["onClick"])]),default:t(()=>[I(" "+d(m.$t("settings.resetButtonTooltip")),1)]),_:1})]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1})}}}),di=We(ui,[["__scopeId","data-v-661ec94b"]]),ci={},pi={style:{color:"gray","padding-left":"20px"}},fi=["innerHTML"];function gi(s,r){const i=mn,p=Oe;return U(),te(p,{vertical:"",justify:"end"},{default:t(()=>[n(i,{style:{margin:"0px"}}),n(p,{justify:"center"},{default:t(()=>[h("ul",pi,[(U(!0),ee(Pe,null,ct(s.$tm("descriptions"),o=>(U(),ee("li",{key:o,style:{"text-align":"left"},innerHTML:o},null,8,fi))),128))])]),_:1})]),_:1})}const mi=We(ci,[["render",gi]]),vi="modulepreload",hi=function(s){return"/avif2jpeg/dist/"+s},cn={},_e=function(r,i,p){let o=Promise.resolve();if(i&&i.length>0){let f=function(_){return Promise.all(_.map(w=>Promise.resolve(w).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),b=(g==null?void 0:g.nonce)||(g==null?void 0:g.getAttribute("nonce"));o=f(i.map(_=>{if(_=hi(_),_ in cn)return;cn[_]=!0;const w=_.endsWith(".css"),k=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${k}`))return;const m=document.createElement("link");if(m.rel=w?"stylesheet":vi,w||(m.as="script"),m.crossOrigin="",m.href=_,b&&m.setAttribute("nonce",b),document.head.appendChild(m),w)return new Promise((u,x)=>{m.addEventListener("load",u),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(f){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=f,window.dispatchEvent(g),!g.defaultPrevented)throw f}return o.then(f=>{for(const g of f||[])g.status==="rejected"&&l(g.reason);return r().catch(l)})},On="English",Un="🇬🇧",Mn='AVIF to JPEG "Offline" Batch Converter',Rn="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",Nn="Drag & Drop AVIF Images to Convert",jn=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.'],Bn="Select your language",Dn="Choose Target File Extentions",Zn={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},Vn="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",Hn="Load Images",Wn="Select your images from a dialog window.<br>*Multiple selection allowed.",qn="Load a Whole Folder",Gn=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,Kn="Converting images",Yn="Aborted",Qn="Some files failed to convert",Xn="Completed",Jn="Currently Busy",eo="No files with the extentions were found.",to="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",no="Cancel",oo="Save",ao="Close",lo="Open",so="Re-convert",io="Convert previous selected {n} @:files again",ro="File | Files",uo="thread | threads",co="You have not saved the converted images yet.",po="Data have not been saved",fo="Open Source",go="Open the converted image",mo="Copied to clipboard",vo="The converted image was copied to your clipboard as DataURL.",ho="Copy the converted image as DataURL",_o="Convert Again",wo={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",showOnlyErrors:"Show only errors",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files",Shrinked:"Shrinked",Shrinking:"Shrinking",saveAll:"Save All",progressRetries:"Retrying files",success:"success",started:"started",total:"total",files:"files",failure:"failure",all:"all",filterLogSelect:"filter",showOnlySuccess:"Only successes",showOnlyError:"Only errors",showAll:"Show all",Progress:"Progress",PreviewImage:"Preview Images",Log:"Log",log:"Log",Output:"Output Results",expandLog:"expand log size",autoScroll:"auto-scroll",sortByStatus:"status",sort:"Sort list by",sortByName:"name",sortBySize:"size",sortByOutputSize:"size(output)",sortByStart:"starting order",sortByCompletion:"output order"},yo={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file"},bo="Disabled",ko="Download",zo="Reset",xo="Back",Io="Failed",Ao="Success",So="Previous version",To=`
Height`,Lo="Width",Co="Don't show this message again",$o="About the warning when selecting a folder",Eo="OK",Fo={},Po="You must press the “Upload” button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",Oo="Continue",Uo="Cancel",Mo="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",Ro="This page may be an outdated version. Please reload the page.",No="Reload",jo='If the conversion process frequently fails and an “Out of Memory” message appears, try reducing or disabling the number of "multi-threads" in the "Advanced Settings".',Bo="Next",Do="Previous",Zo="or",Vo="Target File Extensions",Ho={lang:On,flags:Un,title:Mn,metaDescription:Rn,droptarget:Nn,descriptions:jn,selectLanguage:Bn,fileTypeRadioTitle:Dn,fileTypeRadioOptions:Zn,editAcceptTypes:Vn,loadbutton:Hn,loadbuttontooltip:Wn,loadfolderbutton:qn,loadfoldertooltip:Gn,processing:Kn,aborted:Yn,incomplete:Qn,completed:Xn,interfered:Jn,noimage:eo,avifUnsupported:to,cancel:no,save:oo,close:ao,open:lo,reconvert:so,reconvertTip:io,files:ro,threads:uo,confirmCloseDialog:co,confirmCloseDialogTitle:po,githubOpenSource:fo,convertedImageUrlTooltip:go,copiedDataURLDialogTitle:mo,copiedDataURLMessage:vo,convertedImageDataUrlTooltip:ho,convertAgain:_o,status:wo,settings:yo,disabled:bo,Download:ko,reset:zo,back:xo,failed:Io,success:Ao,previousVersion:So,height:To,width:Lo,checkboxTextDontShowThis:Co,loadfolderNotifyingTitle:$o,OK:Eo,loadfolderNotifyingMessage:Fo,loadfolderNotifyingMessageTerm2:Po,Continue:Oo,Cancel:Uo,loadfolderNotifyingMessageTerm1:Mo,errMsgWorkerLoadError:Ro,Reload:No,annotationOutOfMemory:jo,Next:Bo,Prev:Do,or:Zo,TargetFileTypeExt:Vo},_i=Object.freeze(Object.defineProperty({__proto__:null,Cancel:Uo,Continue:Oo,Download:ko,Next:Bo,OK:Eo,Prev:Do,Reload:No,TargetFileTypeExt:Vo,aborted:Yn,annotationOutOfMemory:jo,avifUnsupported:to,back:xo,cancel:no,checkboxTextDontShowThis:Co,close:ao,completed:Xn,confirmCloseDialog:co,confirmCloseDialogTitle:po,convertAgain:_o,convertedImageDataUrlTooltip:ho,convertedImageUrlTooltip:go,copiedDataURLDialogTitle:mo,copiedDataURLMessage:vo,default:Ho,descriptions:jn,disabled:bo,droptarget:Nn,editAcceptTypes:Vn,errMsgWorkerLoadError:Ro,failed:Io,fileTypeRadioOptions:Zn,fileTypeRadioTitle:Dn,files:ro,flags:Un,githubOpenSource:fo,height:To,incomplete:Qn,interfered:Jn,lang:On,loadbutton:Hn,loadbuttontooltip:Wn,loadfolderNotifyingMessage:Fo,loadfolderNotifyingMessageTerm1:Mo,loadfolderNotifyingMessageTerm2:Po,loadfolderNotifyingTitle:$o,loadfolderbutton:qn,loadfoldertooltip:Gn,metaDescription:Rn,noimage:eo,open:lo,or:Zo,previousVersion:So,processing:Kn,reconvert:so,reconvertTip:io,reset:zo,save:oo,selectLanguage:Bn,settings:yo,status:wo,success:Ao,threads:uo,title:Mn,width:Lo},Symbol.toStringTag,{value:"Module"})),wi="Arabic",yi="German",bi="English",ki="Spanish",zi="Finnish",xi="French",Ii="Hindi",Ai="Indonesian",Si="Italian",Ti="Japanese",Li="Korean",Ci="Dutch",$i="Polish",Ei="Portuguese",Fi="Russian",Pi="Turkish",Oi="Ukrainian",Ui="Chinese",Mi={ar:wi,de:yi,en:bi,es:ki,fi:zi,fr:xi,hi:Ii,id:Ai,it:Si,ja:Ti,ko:Li,nl:Ci,pl:$i,pt:Ei,ru:Fi,tr:Pi,uk:Oi,"zh-hant":"Chinese(hant)",zh:Ui},zt=[],Wo={en:Ho},Wt={},pn=Object.assign({"./locales/ar.json":()=>_e(()=>import("./ar-BgngyIMi.js"),[]),"./locales/de.json":()=>_e(()=>import("./de-v3ueBOSV.js"),[]),"./locales/en.json":()=>_e(()=>Promise.resolve().then(()=>_i),void 0),"./locales/es.json":()=>_e(()=>import("./es-C2cGdukK.js"),[]),"./locales/fi.json":()=>_e(()=>import("./fi-5ZrKH-Ih.js"),[]),"./locales/fr.json":()=>_e(()=>import("./fr-B1KRO7gm.js"),[]),"./locales/hi.json":()=>_e(()=>import("./hi-BYS3b9Xc.js"),[]),"./locales/id.json":()=>_e(()=>import("./id-Bh86-Owa.js"),[]),"./locales/it.json":()=>_e(()=>import("./it-3HgfLRdM.js"),[]),"./locales/ja.json":()=>_e(()=>import("./ja-CUyuZYIl.js"),[]),"./locales/ko.json":()=>_e(()=>import("./ko-DEvhJkq-.js"),[]),"./locales/nl.json":()=>_e(()=>import("./nl-BVb671a3.js"),[]),"./locales/pl.json":()=>_e(()=>import("./pl-CUezuRiL.js"),[]),"./locales/pt.json":()=>_e(()=>import("./pt-Cuc_8V_q.js"),[]),"./locales/ru.json":()=>_e(()=>import("./ru-CTFfZQm7.js"),[]),"./locales/tr.json":()=>_e(()=>import("./tr-DsQozz3L.js"),[]),"./locales/uk.json":()=>_e(()=>import("./uk-x1nsBL4Z.js"),[]),"./locales/zh-hant.json":()=>_e(()=>import("./zh-hant-COM0_YJO.js"),[]),"./locales/zh.json":()=>_e(()=>import("./zh-Dxq2FLYG.js"),[])});var fn;for(const s in pn){const r=(fn=s.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:fn[1];r&&(zt.push(r),!(r in Wo)&&(Wt[r]=pn[s]))}let Mt=Ni();Mt in Wt||(Mt="en");const xt=Ma({legacy:!1,globalInjection:!0,locale:Mt,fallbackLocale:"en",messages:Wo,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Ri(s){if(xt.global.availableLocales.indexOf(s)>=0)return;const r=await Wt[s]();xt.global.setLocaleMessage(s,r),await Te()}function Ni(){const s=location.pathname;return String(s.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const ji=["innerHTML"],Bi=xe({__name:"switch-lang",props:{delay:{}},emits:["lang-ready","lang-change"],async setup(s,{emit:r}){let i,p;const o=Je(Ye),l=vn(),{locale:f,t:g}=He(),b=s,_=r,w=Object.entries(Mi).map(([$,E])=>({label:E,value:$}));w.sort(($,E)=>{const M=$.label,A=E.label;return M>A?1:M<A?-1:0}),Ne(()=>{l.afterEach(($,E,M)=>{m(),o.switchToolTipVisibility()})}),[i,p]=Ra(()=>m()),await i,p();async function k($){($!==f.value||xt.global.availableLocales.indexOf($)===-1)&&(_("lang-change",$),await Ll(b.delay),await Ri($),f.value=$,document.title=g("title"),await Te()),_("lang-ready",$)}async function m(){const $=l.currentRoute.value.path||"",E=String($.match(new RegExp("(?<=^\\/)[^/]+"))||"");E&&zt.includes(E)?(await k(E),f.value=E):await u()}async function u(){const $=x().toLowerCase(),E=$.split(/[-_]/)[0];if(zt.includes(E)){let M=E;if(E==="zh")switch($){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":M="zh-hant"}await k(M)}}function x(){const $=window.navigator;return $.language||$.userLanguage||$.browserLanguage}function O($){console.log(`changeRoute: ${l.currentRoute.value.fullPath} => ${$}`),l.push("/"+$+"/")}return($,E)=>{const M=we,A=Lt,D=ke;return U(),te(D,{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(o).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:t(()=>[n(A,{ref:"langselect",size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,options:e(w),"_v-model:value":"locale",value:e(f),"onUpdate:value":O},{arrow:t(()=>[n(M,null,{default:t(()=>[n(e(Na))]),_:1})]),_:1},8,["options","value"])]),default:t(()=>[h("div",{innerHTML:$.$t("selectLanguage")},null,8,ji)]),_:1},8,["show","placement"])}}}),Ye=Symbol("global variables"),Di=xe({__name:"Avif2Jpeg",emits:["ready"],setup(s,{emit:r}){const{t:i,locale:p}=He(),o=200,l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),f=y(null);y(0);let g=y(void 0);const b=y(!0),_=y(!1),w=y(!1),k=y(!1),m=y(!0),u=y(!1);Da(Ye,{showTooltipsBeforeMounted:g,LANDSCAPE:b,IS_SP:l,switchToolTipVisibility:E,SSR:!1}),Ne(()=>{M(),window.addEventListener("resize",M),E(),setTimeout(()=>w.value=!0,3e3)}),_t(()=>{window.removeEventListener("resize",M)});let x=0;function O(){k.value=!1,x=Date.now()}function $(){const j=m.value?0:Math.max(0,o-(Date.now()-x));m.value=!1,Te(()=>{setTimeout(()=>k.value=!0,j)})}async function E(){}function M(){const j=document.body.clientWidth,v=document.body.clientHeight;b.value=j*.75>v||j>900}function A(j){f.value=j}function D(j){u.value=j}return(j,v)=>{const H=Oe,W=we,me=et;return U(),te(H,{vertical:"",align:"stretch",class:"avif2jpeg"},{default:t(()=>[n(il,null,{"lang-switch":t(()=>[(U(),te(ja,null,{default:t(()=>[n(Bi,{onLangChange:O,onLangReady:$,delay:e(m)?0:o},null,8,["delay"])]),_:1}))]),_:1}),n(Xe,{name:"fade"},{default:t(()=>[Be(n(H,{vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:t(()=>[n(H,{justify:"space-around",vertical:"",style:{height:"100%"}},{default:t(()=>[n(ul),n(H,{justify:"center"},{default:t(()=>[n(ti,{"_v-model_expanded":"UserSettings.expandExtButtons",target:e(V).acceptTypeValue,"onUpdate:target":v[0]||(v[0]=R=>e(V).acceptTypeValue=R),userExtensions:e(V).editedAcceptTypes,"onUpdate:userExtensions":v[1]||(v[1]=R=>e(V).editedAcceptTypes=R),"disable-notifying-folder-select":e(V).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":v[2]||(v[2]=R=>e(V).disableNotifyingFolderSelect=R),forbidden:e(_),onInput:A,onClick:v[3]||(v[3]=R=>D(!0)),onCancel:v[4]||(v[4]=R=>D(!1))},null,8,["target","userExtensions","disable-notifying-folder-select","forbidden"])]),_:1}),n(Us,{input:e(f),format:e(V).imageFormat,quality:e(V).imageQuality,"retain-extension":e(V).retainExtension,maxZipSizeMB:e(V).maxZipSizeMB,threads:e(V).multithread?e(V).threadCount:0,"show-note":e(u),"onUpdate:showNote":v[5]||(v[5]=R=>Ze(u)?u.value=R:null),onStart:v[6]||(v[6]=R=>_.value=!0),onEnd:v[7]||(v[7]=R=>_.value=!1)},{"lang-switch":t(()=>v[18]||(v[18]=[])),_:1},8,["input","format","quality","retain-extension","maxZipSizeMB","threads","show-note"]),n(H,{vertical:"",align:"center"},{default:t(()=>[n(me,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(W,{size:"5vh",color:"#DADADA",style:{margin:"0px"}},{default:t(()=>[n(e(Ba))]),_:1})]),default:t(()=>[v[19]||(v[19]=h("span",null,"CONVERT TO👇",-1))]),_:1})]),_:1}),n(H,{vertical:"",align:"center"},{default:t(()=>[n(ai,{format:e(V).imageFormat,"onUpdate:format":v[8]||(v[8]=R=>e(V).imageFormat=R),quality:e(V).imageQuality,"onUpdate:quality":v[9]||(v[9]=R=>e(V).imageQuality=R)},null,8,["format","quality"]),n(di,{"retain-ext":e(V).retainExtension,"onUpdate:retainExt":v[10]||(v[10]=R=>e(V).retainExtension=R),"use-folder-name-for-zip":e(V).useFolderNameForZip,"onUpdate:useFolderNameForZip":v[11]||(v[11]=R=>e(V).useFolderNameForZip=R),"max-zip-size":e(V).maxZipSizeMB,"onUpdate:maxZipSize":v[12]||(v[12]=R=>e(V).maxZipSizeMB=R),"_v-model:expanded":"UserSettings.expandAdvSettings",multithread:e(V).multithread,"onUpdate:multithread":v[13]||(v[13]=R=>e(V).multithread=R),"thread-count":e(V).threadCount,"onUpdate:threadCount":v[14]||(v[14]=R=>e(V).threadCount=R),"_:thread-max":"availableThreadCount","shrink-image":e(V).shrinkImage,"onUpdate:shrinkImage":v[15]||(v[15]=R=>e(V).shrinkImage=R),"max-width":e(V).maxWidth,"onUpdate:maxWidth":v[16]||(v[16]=R=>e(V).maxWidth=R),"max-height":e(V).maxHeight,"onUpdate:maxHeight":v[17]||(v[17]=R=>e(V).maxHeight=R)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","multithread","thread-count","shrink-image","max-width","max-height"])]),_:1}),n(mi)]),_:1})]),_:1},512),[[De,e(k)]])]),_:1})]),_:1})}}}),qt=xe({__name:"App",setup(s){const r={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{},Image:{toolbarColor:"#00000099"}},i=y(!0);return Ne(()=>{i.value=!1}),(p,o)=>{const l=Wa,f=Ha,g=Va,b=Za,_=qa;return U(),te(_,{"theme-overrides":r,style:{width:"100%",height:"100%"}},{default:t(()=>[n(b,null,{default:t(()=>[n(g,{placement:"top-left",closable:!0,max:50},{default:t(()=>[n(f,null,{default:t(()=>[n(l,null,{default:t(()=>[n(Di,{class:at({hide:e(i)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),qo=[{path:"/",name:"Home",component:qt}];for(const s of zt)qo.push({path:"/"+s+"/",strict:!0,name:s,component:qt});Ga(qt,{routes:qo,base:"/avif2jpeg/dist/"},({app:s,router:r,routes:i,isClient:p,initialState:o})=>{s.use(xt)});
