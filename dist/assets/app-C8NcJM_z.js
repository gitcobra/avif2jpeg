var Jo=Object.defineProperty;var ea=(s,u,r)=>u in s?Jo(s,u,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[u]=r;var tt=(s,u,r)=>ea(s,typeof u!="symbol"?u+"":u,r);import{r as y,a as It,d as xe,i as Je,c as oe,o as O,_ as ke,u as e,w as t,b as I,t as c,e as n,f as ta,N as _e,L as na,g as ne,B as Ce,h as Mt,j as h,F as Ee,k as ct,l as oa,m as Y,n as aa,p as la,q as Fe,s as pe,v as fn,x as gn,y as mn,z as ze,A as we,C as Te,D as Ot,E as Pt,G as Ve,H as qe,I as sa,J as ia,K as je,M as At,O as se,P as Qe,T as Xe,Q as vn,R as Be,S as Rt,U as Tt,V as Nt,W as nt,X as Re,Y as _t,Z as ra,$ as ot,a0 as ua,a1 as Xt,a2 as Jt,a3 as hn,a4 as et,a5 as da,a6 as St,a7 as ca,a8 as pa,a9 as jt,aa as fa,ab as en,ac as _n,ad as ga,ae as ma,af as at,ag as $e,ah as va,ai as Bt,aj as Lt,ak as ha,al as De,am as _a,an as wn,ao as yn,ap as wa,aq as bn,ar as ya,as as tn,at as kn,au as ba,av as ka,aw as za,ax as xa,ay as Ia,az as Aa,aA as Dt,aB as zn,aC as Ta,aD as Sa,aE as xn,aF as La,aG as it,aH as rt,aI as Ca,aJ as $a,aK as Ea,aL as Fa,aM as Oa,aN as Pa,aO as Ua,aP as Ma,aQ as Ra,aR as Na,aS as ja,aT as Ba,aU as Da,aV as Za,aW as Va,aX as Ha,aY as Wa,aZ as qa}from"./vendor-CMlg4H3Z.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))f(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const g of l.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&f(g)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function f(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();const Ue=y(navigator.hardwareConcurrency?Math.min(navigator.hardwareConcurrency,12):0),ut={threadCount:{min:2,max:Math.max(2,Ue.value)}},Ga={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:Ue.value,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1},W=It(In({}));function Ka(){In(W)}function In(s){return Object.assign(s,Ga)}const An="avif2jpeg",Ct=JSON.parse(localStorage.getItem(An)||"{}");for(const s in W)if(Ct.hasOwnProperty(s)&&Ct[s]!==void 0){let u=Ct[s];ut.hasOwnProperty(s)&&(ut[s].min>u&&(u=ut[s].min),ut[s].max<u&&(u=ut[s].max)),W[s]=u}const Ya=()=>{const s={};for(const u in W)s[u]=W[u];localStorage.setItem(An,JSON.stringify(s))};window.addEventListener("beforeunload",Ya);const Qa=xe({__name:"github",setup(s){const u=Je(Ke);return(r,f)=>{const o=_e,l=ta,g=ke;return O(),oe(g,{to:!1,"display-directive":"show",show:e(u).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(l,{href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-size":"small","font-weight":"bolder"}},{default:t(()=>[n(o,null,{default:t(()=>[n(e(na))]),_:1}),f[0]||(f[0]=I("GitHub"))]),_:1})]),default:t(()=>[I(" "+c(r.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),Xa=["href"],Ja=xe({__name:"licenses",setup(s){const u=y(!1),r={Vue:"https://github.com/vuejs/core/blob/main/LICENSE",Vite:"https://github.com/vitejs/vite/blob/main/LICENSE","Vite SSG":"https://github.com/antfu/vite-ssg/blob/main/LICENSE","Naive UI":"https://github.com/TuSimple/naive-ui/blob/main/LICENSE",Ionicons:"https://github.com/ionic-team/ionicons/blob/main/LICENSE"};return(f,o)=>{const l=Ce;return O(),ne(Ee,null,[n(l,{text:"",onClick:o[0]||(o[0]=g=>u.value=!0),style:{color:"black","font-size":"small"}},{default:t(()=>o[2]||(o[2]=[I("Licenses")])),_:1}),n(e(Mt),{preset:"dialog",ref:"dialog",show:u.value,"onUpdate:show":o[1]||(o[1]=g=>u.value=g),"positive-text":"OK",title:"Licenses"},{default:t(()=>[o[3]||(o[3]=h("h3",null,"Used Framework and Libraries",-1)),h("ul",null,[(O(),ne(Ee,null,ct(r,(g,p)=>h("li",null,[h("a",{href:g},c(p),9,Xa)])),64))])]),_:1},8,["show"])],64)}}}),el=1,tl=10,nl=11,ol="",mt={major:el,minor:tl,build:nl,tag:ol},al={style:{"font-size":"x-small","user-select":"none"}},ll=xe({__name:"version",setup(s){const u=["0.0.118"],r=`${mt.major}.${mt.minor}.${mt.build}${mt.tag}`,f=u.map(p=>({label:`v${p}`,key:p,value:p}));function o(p){const{key:b,label:_}=p,w=g(b),k=Y("a",{href:w},_),m=Y("div",null,k);return Y("div",null,m)}function l(p){location.href=g(p)}function g(p){return`/avif2jpeg/old/${p}/`}return(p,b)=>{const _=oa;return O(),oe(_,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:e(f),"render-label":o,"onUpdate:value":l},{header:t(()=>[h("span",al,c(p.$t("previousVersion")),1)]),default:t(()=>[h("span",{style:{cursor:"pointer"}},"v"+c(r))]),_:1},8,["options"])}}}),sl=xe({__name:"header",setup(s){const u=aa();return(r,f)=>{const o=la("router-link"),l=Fe,g=gn;return O(),oe(l,{vertical:"",justify:"start"},{default:t(()=>[n(l,{justify:"space-between",align:"center",wrap:!1},{default:t(()=>[n(l,{align:"center"},{default:t(()=>[n(Qa),n(ll),n(Ja),n(l,{style:{"font-size":"small"}},{default:t(()=>[e(u).path!=="/"?(O(),oe(o,{key:0,to:"/"},{default:t(()=>f[0]||(f[0]=[I("HOME")])),_:1})):pe("",!0)]),_:1})]),_:1}),n(l,{align:"end",style:{"font-size":"x-small"}},{default:t(()=>[fn(r.$slots,"lang-switch")]),_:3})]),_:3}),n(g,{style:{margin:"0px"}})]),_:3})}}}),il={style:{padding:"0px",margin:"0px","text-align":"center"}},rl=xe({__name:"title",setup(s){const u=mn();return ze(()=>{const r=u.currentRoute.value.path||"";return!String(r.match(new RegExp("(?<=^\\/)[^/]+"))||"")}),(r,f)=>{const o=Fe;return O(),oe(o,{align:"center",justify:"center",style:{margin:"0px"}},{default:t(()=>[h("h1",il,c(r.$t("title")),1)]),_:1})}}}),nn=new Set,ul=new Set,dl=new Set,wt=new Map;function cl(s){const u=wt.get(s);if(!u){console.warn("the worker was already released.",s.id);return}wt.delete(s),u(),vt==null||vt(),vt=null}function pl(){for(const s of wt.keys())cl(s)}let vt=null;function Tn(){pl();for(const s of nn)s.onmessage=null,s.terminate();nn.clear(),ul.clear(),dl.clear(),wt.clear()}function fl(s){return new Worker("/avif2jpeg/dist/assets/worker.zip-BpG-kYFu.js",{name:s==null?void 0:s.name})}function gl(s){return new Worker("/avif2jpeg/dist/assets/worker.loader-hdSA9Vyi.js",{name:s==null?void 0:s.name})}const ml=1e3*10;let Ge;const Me=new Map,yt=new Map,bt=new Map;let Zt,X,Vt,kt,ht,Sn,Ln,Cn,$n,pt;function $t(s){if({files:ht,completedFileIdSet:Zt,ConvStats:X,canceled:Vt,props:kt,format:Sn,quality:Ln,outputExt:Cn,imageType:$n,message:pt}=s||{},Ge=null,Me.clear(),yt.clear(),bt.clear(),yt.clear(),bt.clear(),s)for(const r in s)delete s[r]}async function vl(s){$t(s),Zt.clear();let u;try{u=await hl()}catch{return $t(),{exception:new Error("worker-load-error"),callbackToClearConverter:new Function,callbackToGenerateFailedZips:new Function}}const[r,f]=u;Ge=f;const o=new Promise(m=>{f.onmessage=d=>{const x=d.data,{action:F}=x;switch(F){case"squeeze-zip":case"zip-squeeze-error":m(void 0);break}}}),l=new Promise(m=>{r.onmessage=d=>{const{data:{action:x}}=d;x==="end-convert"&&m()}}),g=ht.map(m=>m._id);ht.forEach(m=>yt.set(m._id,m));const p=we(Vt,m=>{if(!m)return;p();const d={action:"cancel-convert"};r.postMessage(d)}),b={action:"start-convert",list:ht,fileIdList:g,outputQuality:Ln,outputType:Sn,threads:kt.threads,maxSize:W.shrinkImage?{width:W.maxWidth,height:W.maxHeight}:null};r.postMessage(b),await l,console.log("end loader worker"),f.postMessage({action:"squeeze"}),await o,console.log("end zip worker"),p();const _=()=>{Tn(),f.onmessage=null,f.terminate(),r.onmessage=null,r.terminate(),$t()};let w=!1;return{callbackToClearConverter:_,callbackToGenerateFailedZips:async m=>{w||(w=!0,await Al(m,f,{},X))}}}async function hl(){Tn();const s=new gl,u=new fl,r=new Promise((g,p)=>{const b=d=>{u.removeEventListener("message",k),s.removeEventListener("message",k),clearTimeout(m),d?(console.log("workers are avialble"),g(d)):(console.error("couldn't get responses from workers"),p(d))};let _=!1,w=!1;const k=d=>{d.target===u&&(console.log("got a message from zip worker"),_=!0),d.target===s&&(console.log("got a message from loader worker"),w=!0),_&&w&&b(!0)};let m=0;u.addEventListener("message",k),s.addEventListener("message",k),m=window.setTimeout(()=>b(!1),ml)}),{port1:f,port2:o}=new MessageChannel,l={action:"set-zip-port"};return u.postMessage({action:"set-port-loader"},[f]),s.postMessage(l,[o]),console.log("test workers' availability"),await r,u.postMessage({action:"set-config",zipSize:kt.maxZipSizeMB*1024*1024,keepExt:kt.retainExtension,outputExt:Cn,imageType:$n}),s.addEventListener("message",wl),u.addEventListener("message",_l),[s,u]}const _l=s=>{const u=s.data,{action:r}=u;switch(r){case"add-zip-completed":{const{fileId:g,entireIndex:p,storedPath:b}=u;return}case"respond-image":{const{url:g,index:p,path:b,size:_,fileId:w}=u;X.convertedImageUrl=g,X.convertedImageSize=_,X.convertedImageIndex=p,X.convertedImageName=b;let k="",m=0,d="";const x=Me.get(w);if(w>=0){const F=yt.get(w);k=URL.createObjectURL(F),m=F.size,d=F.webkitRelativePath||F.name}X.convertedImageOrgUrl=k,X.convertedImageOrgSize=m,X.convertedImageOrgName=d,X.convertedImageShrinked=x==null?void 0:x.shrinked;return}case"respond-delete":{const{index:g,success:p,fileId:b}=u;Me.get(b).command="❌deleted",Me.get(b).completed=!1;return}}switch(r){case"error-push-filelist-zip":const{path:g}=u;X.failedZipDone=!0,pt.error(`an error occurred "${g}"`,{duration:3e3});return}const{size:f,count:o}=u,l="url"in s.data?s.data.url:"";switch(r){case"push-zip":X.zips.push({url:l,size:f,count:o}),X.zippedTotalCount+=o,X.zippedTotalSize+=f;break;case"squeeze-zip":o>0&&(X.zips.push({url:l,size:f,count:o}),X.zippedTotalCount+=o,X.zippedTotalSize+=f);break;case"push-filelist":X.failedFileZippedCount++;break;case"squeeze-filelist-zip":X.failedZipDone=!0;case"push-filelist-zip":console.log("push-filelist-zip",o),X.failedZips.push({url:l,size:f,count:o}),console.log(o);break;case"zip-error":case"zip-squeeze-error":X.zippingErrorCount+=o;break}},wl=s=>{s.target;const{data:u}=s,{action:r}=u;switch(r){case"list-start":break;case"list-end":break;case"file-start":{const{index:f,path:o,fileId:l}=u;bl(f,o,l);break}case"file-load":{const{thumbnail:f,width:o,height:l,fileId:g,workerId:p,inputsize:b}=u,_=Me.get(g);_.core=p,_.command="🖼️loaded",_.width=o,_.height=l,_.size=b,f&&(X.thumbnail=f);break}case"file-converted":{const{index:f,path:o,fileId:l,shrinked:g,outputWidth:p,outputHeight:b,outputsize:_}=u,w=Me.get(l);w.command="🔃converted",w.shrinked??(w.shrinked=g),w.outputWidth=p,w.outputHeight=b,w.outputSize=_,X.converted++;break}case"file-completed":{const{inputsize:f,outputsize:o,fileId:l,entireIndex:g,storedPath:p}=u,b=Me.get(l);b&&(b.command="✅completed",b.completed=!0,b.fileId=l),X.inputTotalSize+=f,X.outputTotalSize+=o,X.done++,X.success++,Zt.add(l),b.zippedIndex=g,X.ziplogs[g]={fileId:l,storedPath:p};break}case"file-retry":{const{index:f,path:o,fileId:l}=u;kl(f,o,l);break}case"file-error":{const{index:f,path:o,fileId:l}=u;zl(f,o,l);break}case"file-canceled":{const{fileId:f,path:o}=u;xl(f);break}}};let yl=0;function bl(s,u,r){const f={key:yl++,core:-1,index:s,path:u,command:"➡️started"};Me.set(r,f),X.logs.push(f),bt.has(r)?console.warn(`retry "${u}".`):Vt.value||X.startedCount++}function kl(s,u,r){const f=Me.get(r);f.command="⚠️retrying",f.error=!0,pt.warning(`retrying "${u}"`,{duration:3e3}),X.retried++,bt.set(r,1)}function zl(s,u,r){console.error(`failed to load "${u}". the image may be corrupted or cannot be read by some reason.`);const f=Me.get(r);X.done++,X.failure++,f.command="❗failed",f.error=!0,pt.error(`failed to load "${u}"`,{duration:5e3})}function xl(s){const u=Me.get(s);X.done++,X.failure++,u.command="❗canceled",u.error=!0}function Il(s){Ge==null||Ge.postMessage({action:"request-image",index:s})}function Et(s){Ge==null||Ge.postMessage({action:"delete-image",index:s})}async function Al(s,u,r,f){let o=0;for(const l of s){const g=(l.webkitRelativePath||l.name).replace(/^\//,"");if(f.failedZipDone)break;if(r.value)return;o-f.failedFileZippedCount>20&&await new Promise(p=>setTimeout(p,10)),u.postMessage({action:"add-filelist",file:l,path:g}),o++}if(f.failedZipDone){pt.error("Zipping error files was aborted",{duration:5e3});return}u.postMessage({action:"squeeze-filelist"})}function Ne(s,u=2){const r=Math.sign(s);s=Math.abs(s);const f=["Bytes","KB","MB","GB"],o=s?Math.floor(Math.log(s)/Math.log(1024)):0;return`${(s/Math.pow(1024,o)*r).toFixed(u)}${f[o]}`}function En(s,u=100,r=!1){u=typeof u=="number"?{width:u,height:u}:u;const{width:f,height:o}=u;let{width:l,height:g}=s;const p=l/g,b=f/o;return p>=b?(l=r?Math.min(f,l):f,g=l/p|0):(g=r?Math.min(o,g):o,l=g*p|0),{width:l,height:g}}class Tl{constructor(){tt(this,"_currentFileCount",0);tt(this,"_currentZipIndex",0);tt(this,"_totalFileCount",0);tt(this,"_zipLengthSumList",[]);tt(this,"_pathBank",{})}increase(u){return u&&(this._pathBank[u]=[this._zipLengthSumList.length,this._currentFileCount]),this._currentFileCount++,this._totalFileCount++}split(){this._zipLengthSumList.push(this._totalFileCount),this._currentZipIndex++,this._currentFileCount=0}get(u){if(typeof u=="number"){let r=this._zipLengthSumList.findIndex((l,g)=>u<l);r===-1&&(r=this._zipLengthSumList.length);const f=this._zipLengthSumList[r-1]||0,o=u-f;return[r,o]}else{const r=this._pathBank[String(u)];if(r)return r}return null}getZipIndex(){return this._currentZipIndex}getIndex(){return this._totalFileCount}}function Sl(s){return new Promise(u=>setTimeout(u,s))}function Ll(s,u=0){const r=y(s);return we(r,f=>{f!==void 0&&Te(()=>{setTimeout(()=>r.value=void 0,u)})},{immediate:!0}),r}let dt;async function Cl(s,u,r,f,o){let l="";const g=document.createElement("canvas"),p=g.getContext("2d");let b=new Ot;const _=[b],w=new Tl,k=r.format,m=r.quality/100,d=[...k.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),x=s.length,F=r.maxZipSizeMB*1024*1024;let T=0,E=null,M="",A="",H=0,j=0,v=0,Q=0,G=0,fe=!1;dt=L=>{const[N,K]=w.get(L),ie=_[N],ae=ie.get(K,k);o.convertedImageIndex=L,o.convertedImageName=ie.getPathByIndex(K),o.convertedImageUrl=URL.createObjectURL(ae),o.convertedImageSize=ae.size;let ce="",re=0,ye="";const q=P[L];ce=URL.createObjectURL(q),re=q.size,ye=q.webkitRelativePath||q.name,o.convertedImageOrgUrl=ce,o.convertedImageOrgSize=re,o.convertedImageOrgName=ye};const P=[];for(const L of s){if(f.value)break;const N=L.name;let K="";const ie=L.size,ae=(L.webkitRelativePath||L.relativePath||N).replace(/^\//,""),ce=document.createElement("img"),re={key:v++,core:-1,index:T++,path:ae,command:"➡️start"};o.startedCount=T,o.logs.push(re),o.logs.length-1,l&&(URL.revokeObjectURL(l),l=""),l=URL.createObjectURL(L),A=l,H=L.size,ce.src=l;const ye=await Fn(ce).then(()=>!0).catch(()=>!1);if(!ce.complete||!ye||f.value){o.done++,o.failure++,re.command="❗failed";continue}const q=ce.width,U=ce.height;g.width=q,g.height=U,p.drawImage(ce,0,0,q,U,0,0,q,U),re.command="🖼️imgload",o.thumbnail=ce;const B=await new Promise(ee=>{const de=Se=>{E=Se,ee(Se)};g.toBlob(de,k,m)});if(f.value)break;if(!B){console.log("failed to toBlob",N),o.failure++;continue}j=B.size,o.converted++;let J="";if(G+j>=F){try{await b.wait(),J=await b.url()}catch(ee){fe=!0,console.warn(ee.message,G),alert("memory problem occurred");break}o.zips.push({url:J,size:G,count:Q}),o.zippedTotalCount+=Q,o.zippedTotalSize+=G,G=0,Q=0,w.split(),b=new Ot,_.push(b)}G+=j;const te=ae||N;for(let ee=1;ee<255&&(K=te.replace(r.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(ee>1?`(${ee})`:"")+"."+d,!!b.has(K));ee++);o.done++;try{Q++,b.add(K,B)}catch(ee){console.error(ee.message);continue}w.increase(),P.push(L),o.inputTotalSize+=ie,o.outputTotalSize+=j,o.ziplogs.push({fileId:L._id,storedPath:K}),M=K,re.zippedIndex=o.success,o.success++,re.command="✅completed",re.completed=!0,re.fileId=L._id,u.add(L._id)}if(o.success>0)if(x===1)E&&(o.convertedImageIndex=0,o.convertedImageName=M.replace(/^.*\/(?=[^/]+$)/,"").replace(r.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+d,o.convertedImageUrl=URL.createObjectURL(E),o.convertedImageOrgUrl=A,o.convertedImageOrgSize=H);else try{if(fe)throw new Error("terminated zipping process for memory problems");await b.wait();const L=await b.url();o.zips.push({url:L,count:Q,size:G}),o.zippedTotalCount+=Q,o.zippedTotalSize+=G}catch(L){console.error(L.message)}const ue={value:!1},ve=()=>{ue.value=!0,_.forEach(L=>L.clear()),_.length=0,P.length=0,dt=null};let Ie=!1;return{callbackToClearConverter:ve,callbackToGenerateFailedZips:async L=>{Ie||(Ie=!0,El(L,F,o,ue))}}}function $l(s){dt==null||dt(s)}async function El(s,u,r,f){let o=0,l=0,g=new Ot;for(let p=0;p<s.length;p++){const b=s[p],_=(b.webkitRelativePath||b.name).replace(/^\//,"");if(f.value)return;try{await g.add(_,b)}catch{alert(`an error occurred during access to "${_}"`);break}if(l+=b.size,o++,r.failedFileZippedCount++,l>=u||p===s.length-1){await g.zip();const w=await g.url();r.failedZips.push({url:w,size:l,count:o}),g.clear(),l=0,o=0}}r.failedZipDone=!0}function Fn(s){if(typeof s.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((u,r)=>{s.onload=u,s.onerror=r})}const He=(s,u)=>{const r=s.__vccOpts||s;for(const[f,o]of u)r[f]=o;return r},Fl={class:"container"},Ol={__name:"zipicon",setup(s){return(u,r)=>(O(),ne("span",Fl,[n(e(_e),null,{default:t(()=>[n(e(Pt))]),_:1}),r[0]||(r[0]=h("span",{class:"text"},"ZIP",-1))]))}},Pl=He(Ol,[["__scopeId","data-v-8b8df2f0"]]),Ul=["href","download","title"],Ml='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',Rl=xe({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean},hidden:{type:Boolean}},emits:["load","error","next","prev"],setup(s,{expose:u,emit:r}){const{t:f}=Ve(),o=s,l=r,g=y();y();const p=y(!0),b=y(""),_=y(o.width||100),w=y(o.height||100),k=y(!1),m=It({width:_.value+"px",height:w.value+"px",minWidth:"50px",minHeight:"50px"});qe(()=>{var A,H,j;(H=(A=g.value)==null?void 0:A.previewInstRef)==null||H.setPreviewSrc(Ml),URL.revokeObjectURL((((j=g.value)==null?void 0:j.imageRef)||{}).src),g.value=null});const d=y(!0);sa(()=>{d.value=!1}),ia(()=>{d.value=!0}),we(o,(A,H)=>{m.width=(o.width||100)+"px",m.height=(o.height||100)+"px"}),we(()=>o.src,(A,H)=>{d.value&&T(A)},{immediate:!0}),u({download:E,openPreview:M,active:d});async function x(A){const H=A.target,j=H.naturalWidth,v=H.naturalHeight,{width:Q,height:G}=En({width:j,height:v},{width:o.maxWidth||100,height:o.maxHeight||100},o.expand);_.value=Q,w.value=G,l("load",{src:H.src,width:j,height:v}),p.value=!1,await new Promise(fe=>setTimeout(fe,100)),!p.value&&(k.value=!0)}function F(A){const H=A.target;l("error",H.src)}async function T(A){p.value=!0,k.value=!1,b.value=A,console.log("changeSrc:",b.value)}function E(){const A=document.createElement("a");A.href=b.value,A.download=o.fileName,A.click()}function M(){var A;(A=g.value)==null||A.click()}return(A,H)=>{const j=vn,v=Rt,Q=Fe,G=At;return je((O(),ne("div",null,[n(e(ke),null,{trigger:t(()=>[n(G,{show:e(p)||o.loading},{default:t(()=>[n(Q,{justify:"center",align:"center",style:se(e(m))},{default:t(()=>[h("a",{"_v-show":"!(imgloading || props.loading)",href:e(b),onClick:H[0]||(H[0]=Qe(()=>{},["left","prevent"])),target:"_blank",download:o.fileName,title:o.fileName,style:{"line-height":"0px"}},[n(Xe,{mode:"in-out"},{default:t(()=>[je(n(j,{ref_key:"nImageRef",ref:g,"show-toolbar-tooltip":"",onLoad:x,onError:F,src:e(b),width:e(_),height:e(w),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[Be,e(k)]])]),_:1})],8,Ul),e(p)||o.loading?(O(),oe(v,{key:0})):pe("",!0)]),_:1},8,["style"])]),_:1},8,["show"])]),default:t(()=>[I(" "+c(o.fileName),1)]),_:1})],512)),[[Be,!A.hidden]])}}}),on=He(Rl,[["__scopeId","data-v-6c94d582"]]),Nl=["href","download","title"],jl={class:"left-num"},Bl={class:"right-num"},Dl=["href","download","title"],Zl={class:"left-num"},Vl={class:"right-num"},Hl=["href","download"],Wl=xe({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean},variousInfo:{}},emits:["demand-image","delete-image","close"],setup(s,{expose:u,emit:r}){const f=Je(Ke),o=s,l=r;u({download:U,cleanup:Ae,openPreview:Le,isPreviewing(){return Q.value},changeIndex(C){d.value=C}});const g=Tt(),{t:p}=Ve();Nt();const b=y(),_=y(),w=y(),k=nt("viewerItemContainer"),m=y(!0),d=y(Math.max(o.index,0)+1),x=y(1),F=y(1),T=y(""),E=y(""),M=y(1),A=y(1),H=y(!1),j=y(!1),v=y(!1),Q=ze(()=>{var C,$;return($=(C=w.value)==null?void 0:C.previewInstRef)==null?void 0:$.displayed}),G=ze(()=>{var C,$;return(($=(C=w==null?void 0:w.value)==null?void 0:C.previewInstRef)==null?void 0:$.previewSrc)===T.value}),fe=ze(()=>d.value<o.length),P=ze(()=>d.value>1),ue=y("viewer-item-init"),ve=y(0),Ie=y(!0);y({width:"auto",height:"auto"});const Oe=y(!1);Re(()=>{document.body.addEventListener("keydown",re),document.body.addEventListener("keydown",ce),ie(d.value-1),ae()}),qe(()=>{clearTimeout(L),document.body.removeEventListener("keydown",re),document.body.removeEventListener("keydown",ce),Oe.value=!0}),_t(()=>{URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl)});let L=-1;we(d,(C,$)=>{d.value<1||d.value>o.length||C===$||(clearTimeout(L),C>$?ue.value="viewer-item-next":ue.value="viewer-item-prev",L=setTimeout(()=>{o.index!==d.value-1&&(ve.value=m.value?ve.value:~ve.value,T.value=void 0,E.value=void 0,Ie.value=!1,ie(d.value-1))},50))});let N="",K="";we(()=>o.url,()=>{var i,z;let C="";o.index===0&&m.value?(m.value=!1,d.value=1,C=o.url):o.index===d.value-1?(m.value=!1,H.value=!1,C=o.url):(URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl));const $=N,a=K;if(URL.revokeObjectURL($),URL.revokeObjectURL(a),N=o.url,K=o.originalUrl,C){try{if((z=(i=w.value)==null?void 0:i.previewInstRef)!=null&&z.displayed){G.value?w.value.previewInstRef.setPreviewSrc(C):w.value.previewInstRef.setPreviewSrc(o.originalUrl);try{const S=w.value.previewInstRef.displayed;w.value.previewInstRef.handleAfterLeave(),w.value.previewInstRef.displayed=S}catch(S){console.error(S)}}}catch{}T.value=C,E.value=o.originalUrl}},{immediate:!0});function ie(C){H.value=!0,j.value=!1,v.value=!1,Te(()=>l("demand-image",C))}function ae(){if(!f.IS_SP)return;let C=k.value.$el,$=0,a=0,i=0,z=0,S=0;const D=ge=>{$=ge.touches[0].pageX,a=ge.touches[0].pageY,S=Date.now()};C.addEventListener("touchstart",D);const Z=ge=>{i=ge.touches[0].pageX,z=ge.touches[0].pageY,be()};window.addEventListener("touchmove",Z);const V=()=>{be();const ge=i-$,Ye=Math.abs(ge),lt=z-a,st=Math.abs(lt);Ye<st||Ye<30||J(ge>0?-1:1)};window.addEventListener("touchend",V);const be=()=>{const ge=Date.now();ge-S>500&&($=i,a=z),S=ge};qe(()=>{C.removeEventListener("touchstart",D),window.removeEventListener("touchmove",Z),window.removeEventListener("touchend",V),C=null})}function ce(C){var $,a,i,z;if(C.key==="Escape")try{(a=($=w.value)==null?void 0:$.previewInstRef)!=null&&a.displayed&&(C.stopPropagation(),(z=(i=w.value)==null?void 0:i.previewInstRef)==null||z.toggleShow(!1))}catch{}}function re(C){switch(C.code){case"ArrowRight":J(1);break;case"ArrowLeft":J(-1);break;case"Home":d.value=1;break;case"End":d.value=o.length;break;case"Space":case"Enter":if(!Q.value)return;ee();break;case"ArrowUp":case"ArrowDown":default:return}C.stopPropagation(),C.preventDefault()}function ye({width:C,height:$}){x.value=C,F.value=$,j.value=!0}function q({width:C,height:$}){M.value=C,A.value=$,v.value=!0}function U(){G.value?b.value.download():_.value.download()}async function B(C){try{const $=await fetch(C).then(a=>a.blob()).then(a=>new Promise(i=>{const z=new FileReader;z.onload=i,z.readAsDataURL(a)})).then(a=>a.target.result);navigator.clipboard.writeText($),g.info({title:p("copiedDataURLDialogTitle"),content:()=>Y("div",[Y("div",p("copiedDataURLMessage"))]),positiveText:"OK"})}catch($){console.error($),g.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function J(C){C>0?d.value=Math.min(o.length,d.value+C)|0:C<0&&(d.value=Math.max(1,d.value+C)|0)}let te="";const ee=()=>{var $,a,i,z;te=(i=window.getComputedStyle((a=($=w==null?void 0:w.value)==null?void 0:$.previewInstRef)==null?void 0:a.previewRef))==null?void 0:i.transform;const C=G.value;(z=w==null?void 0:w.value)==null||z.next(),Te(()=>{var S;G.value===C&&((S=w==null?void 0:w.value)==null||S.next())})};function de(){try{Te(()=>w.value.previewInstRef.previewRef.style.transform=te)}catch{}}function Se({nodes:C}){const $=Y(jt,{color:G.value?"green":"gray",offset:[-20,-12],value:G.value?p("status.Converted"):p("status.Original")},()=>Y(Ce,{round:!0,onClick(){ee()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>Y(G.value?ca:pa)}));C.next=Y(Ce,{onClick(){J(1)},disabled:!fe.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>Y(Jt)}),C.prev=Y(Ce,{onClick(){J(-1)},disabled:!P.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>Y(fa)});try{const a=C.download.children;a.default=()=>p("save");const i=a.trigger();i.props.onClick=U,a.trigger=()=>i}catch{}return le(),[$,...Object.values(C)]}const Pe="#pathbox-"+String(Math.random()).substring(2);let me;function le(){var C,$,a;try{if(me=(a=($=(C=w.value)==null?void 0:C.previewInstRef)==null?void 0:$.previewWrapperRef)==null?void 0:a.parentNode,!me||me.querySelector(Pe))return;let i=Y("div",{id:Pe,onMousedown:z=>{z.stopPropagation()},className:"__preview-injected-pathbox"+(G.value?" converted":"")},[Y("div",`${String(d.value).padStart(String(o.length).length,"0")}/${String(o.length).padStart(String(o.length).length,"0")}`),Y("div",Ne(G.value?o.size:o.originalSize,0)),Y("div",G.value?o.name:o.originalName)]);en(i,me),i=null}catch(i){console.error(i)}}qe(()=>{me&&(en(null,me),me=null)});function Le(){b.value.openPreview()}function Ae(){}return(C,$)=>{const a=_e,i=Fe,z=hn,S=et,D=St,Z=ra;return O(),oe(i,{justify:"center",align:"center",vertical:"",style:se({visibility:m.value?"hidden":"visible"}),class:"body",ref:"body"},{default:t(()=>[n(Z,{ref_key:"nImageGroupRef",ref:w,"show-toolbar-tooltip":"","render-toolbar":Se,onPreviewNext:de},{default:t(()=>[n(i,{wrap:!1,align:"center",justify:"center"},{default:t(()=>[n(e(Ce),{onClick:$[0]||($[0]=V=>J(-1)),disabled:!e(P),block:"",class:ot({"thumb-arrow":!0,pale:!e(P)}),title:C.$t("Prev")},{icon:t(()=>[n(a,{size:"30"},{default:t(()=>[n(e(ua))]),_:1})]),_:1},8,["disabled","class","title"]),n(i,{justify:"center",ref_key:"viewerItemContainer",ref:k,class:"viewer-item-container"},{default:t(()=>[n(Xe,{name:ue.value},{default:t(()=>[(O(),oe(i,{vertical:"",key:ve.value,"_v-show":"viewerItemVisibility"},{default:t(()=>[n(i,{align:"center",wrap:!1},{default:t(()=>[n(i,{vertical:""},{default:t(()=>[n(i,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(i,{align:"center",justify:"center",vertical:"",class:"original-thumb"},{default:t(()=>[h("a",{href:C.originalUrl,onClick:$[4]||($[4]=Qe(V=>{_.value.openPreview()},["prevent"])),download:C.originalName,title:C.originalName,class:"imglink"},[n(i,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(on,{ref:V=>{V!=null&&V.active&&(_.value=V)},src:E.value,width:1,"max-width":1,"max-height":1,loading:H.value,"file-name":C.originalName,"allow-next":d.value<o.length,"allow-prev":d.value>1,onLoad:q,onNext:$[1]||($[1]=V=>J(1)),onPrev:$[2]||($[2]=V=>J(-1)),hidden:!0},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(i,{vertical:"",align:"center"},{default:t(()=>[n(i,{class:"imglink-label"},{default:t(()=>[I(c(e(p)("status.Original")),1)]),_:1}),n(i,{justify:"center",class:"img-size",wrap:!1},{default:t(()=>[h("span",jl,c(v.value?M.value:"?"),1),$[11]||($[11]=I(" × ")),h("span",Bl,c(v.value?A.value:"?"),1)]),_:1}),n(i,{justify:"center"},{default:t(()=>[$[3]||(Xt(-1,!0),($[3]=n(i,null,{default:t(()=>[I(c(v.value?e(Ne)(o.originalSize,0):"?"),1)]),_:1})).cacheIndex=3,Xt(1),$[3])]),_:1})]),_:1})]),_:1})],8,Nl)]),_:1}),n(i,{vertical:"",align:"center",style:{margin:"1em"},class:"original-thumb"},{default:t(()=>[n(a,{size:"20",color:"silver",component:e(Jt)},null,8,["component"])]),_:1}),h("a",{href:T.value,onClick:$[5]||($[5]=Qe(V=>Le(),["prevent"])),download:o.name,title:o.name,class:"imglink"},[n(i,{vertical:"",align:"center",justify:"center"},{default:t(()=>[n(i,{class:"imglink-label"},{default:t(()=>[I(c(e(p)("status.Converted")),1)]),_:1}),n(i,{vertical:"",align:"center",justify:"center",size:0},{default:t(()=>[n(i,{justify:"center"},{default:t(()=>{var V;return[n(i,{wrap:!1,style:se((V=o.variousInfo)!=null&&V.shrinked?{color:"blue"}:{}),class:"img-size"},{default:t(()=>[h("span",Zl,c(j.value?x.value:"?"),1),$[12]||($[12]=I(" × ")),h("span",Vl,c(j.value?F.value:"?"),1)]),_:1},8,["style"])]}),_:1})]),_:1}),n(i,{justify:"center"},{default:t(()=>[I(c(j.value?e(Ne)(o.size,0):"?"),1)]),_:1})]),_:1})],8,Dl)]),_:1}),n(i,{ref:"fileNameContainer",justify:"center",align:"center",class:"pathbox",title:o.name},{default:t(()=>[n(z,{"x-scrollable":!0,trigger:"hover",style:{"text-align":"center","font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:t(()=>[I(c(j.value?o.name:"?"),1)]),_:1})]),_:1},8,["title"])]),_:1}),n(i,{vertical:""},{default:t(()=>[n(on,{ref:V=>{V!=null&&V.active&&(b.value=V)},src:T.value,width:142,"max-width":140,"max-height":100,loading:H.value,"file-name":o.name,"allow-next":d.value<o.length,"allow-prev":d.value>1,onLoad:ye,onNext:$[6]||($[6]=V=>J(1)),onPrev:$[7]||($[7]=V=>J(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(i,{justify:"center",wrap:!0},{default:t(()=>[n(S,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:o.url,ref:"saveImg",target:"_blank",download:o.name},[n(e(Ce),{disabled:!j.value,round:"",size:"tiny"},{default:t(()=>[I(c(C.$t("save")),1)]),_:1},8,["disabled"])],8,Hl)]),default:t(()=>[I(" "+c(C.$t("save")),1)]),_:1}),n(S,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(e(Ce),{disabled:!j.value,onClick:$[8]||($[8]=V=>B(o.url)),round:"",size:"tiny"},{default:t(()=>$[13]||($[13]=[I("DataURL")])),_:1},8,["disabled"])]),default:t(()=>[I(" "+c(C.$t("convertedImageDataUrlTooltip")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["name"])]),_:1},512),n(e(Ce),{onClick:$[9]||($[9]=V=>J(1)),disabled:!e(fe),block:"",class:ot({"thumb-arrow":!0,next:!0,pale:!e(fe)}),title:C.$t("Next")},{icon:t(()=>[n(a,{size:"30"},{default:t(()=>[n(e(da))]),_:1})]),_:1},8,["disabled","class","title"])]),_:1}),je(n(i,{style:{width:"100%"},wrap:!1},{default:t(()=>[n(D,{value:d.value,"onUpdate:value":$[10]||($[10]=V=>d.value=V),tooltip:!1,step:1,min:1,max:o.length,keyboard:!1,class:"index-slider"},null,8,["value","max"]),n(i,{class:"index",align:"center",justify:"center",wrap:!1,size:3},{default:t(()=>[n(i,null,{default:t(()=>[I(c(e(p)("status.index"))+":",1)]),_:1}),n(i,{justify:"end",align:"center",class:"counter"},{default:t(()=>[I(c(d.value),1)]),_:1}),n(i,null,{default:t(()=>$[14]||($[14]=[I("/")])),_:1}),n(i,{justify:"start",align:"center",class:"counter"},{default:t(()=>[I(c(o.length),1)]),_:1})]),_:1})]),_:1},512),[[Be,!C.isSingle]])]),_:1},512)]),_:1},8,["style"])}}}),ql=He(Wl,[["__scopeId","data-v-67f9ab1f"]]),Gl={class:"status-table"},Kl={class:"started"},Yl={class:"mini-counter"},Ql={class:"failure"},Xl={class:"mini-counter"},Jl={colspan:"2"},es={class:"completed"},ts={class:"main-counter"},ns={class:"total"},os={class:"main-counter"},as=xe({__name:"status.center-column",props:{processing:{type:Boolean},interval:{},statusColor:{},success:{},successTo:{},successFrom:{},index:{},length:{},failure:{},retried:{},successPercTo:{},successPercFrom:{}},setup(s){const u=s,r=Nt(),f=y(r.value.successColor),o=y(!1);return we(()=>u.processing,l=>{l||(u.success===u.length?o.value=!0:f.value=r.value.errorColor)}),(l,g)=>{const p=et,b=_e,_=ma,w=Fe,k=_n;return O(),oe(k,{type:"multiple-circle","stroke-width":2,percentage:[l.successTo/l.length*100|0,l.index/l.length*100|0],color:[e(r).successColor,l.statusColor],"rail-style":[{stroke:e(f),opacity:.3}]},{default:t(()=>[n(w,{vertical:"",align:"center",justify:"center",size:0,style:{"font-family":"v-mono","white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:t(()=>[h("table",Gl,[h("tbody",null,[h("tr",Kl,[h("td",null,c(l.$t("status.started"))+":",1),h("td",Yl,[n(p,{trigger:"hover",style:se({color:e(r).infoColor}),placement:"left"},{trigger:t(()=>[h("span",{style:se({color:e(r).infoColor})},c(l.index.toLocaleString("en-us")),5)]),default:t(()=>[I(" "+c(l.$t("status.progressStarted"))+" ("+c(l.index.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),h("tr",Ql,[h("td",null,c(l.$t("status.failure"))+":",1),h("td",Xl,[n(p,{trigger:"hover",style:se({color:e(r).errorColor}),placement:"left"},{trigger:t(()=>[h("span",{style:se({color:e(r).errorColor})},c(l.failure.toLocaleString("en-us")),5)]),default:t(()=>[I(" "+c(l.$t("status.progressErrors"))+" ("+c(l.failure.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"]),l.retried>0?(O(),oe(p,{key:0,trigger:"hover",style:se({color:e(r).warningColor}),placement:"left"},{trigger:t(()=>[h("span",{style:se({color:e(r).warningColor})}," ("+c(l.retried.toLocaleString("en-us"))+") ",5)]),default:t(()=>[I(" "+c(l.$t("status.progressRetries"))+" ("+c(l.retried.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):pe("",!0)])]),h("tr",null,[h("td",Jl,[n(w,{size:0,align:"center",justify:"center",style:se({color:l.processing?l.statusColor:e(f)}),wrap:!1,class:"perc"},{default:t(()=>[e(o)?(O(),oe(b,{key:0,component:e(ga)},null,8,["component"])):pe("",!0),n(_,{duration:l.interval*3|0,from:l.successPercFrom|0,to:l.successPercTo|0,active:!0},null,8,["duration","from","to"]),g[0]||(g[0]=I("% "))]),_:1},8,["style"])])]),h("tr",es,[h("td",null,c(l.$t("status.success"))+":",1),h("td",ts,[n(p,{trigger:"hover",duration:0,delay:0,style:se({color:e(r).successColor}),placement:"bottom"},{trigger:t(()=>[h("span",{style:se({color:e(r).successColor})},[n(_,{duration:l.interval*3|0,from:l.successFrom,to:l.successTo,active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:t(()=>[I(" "+c(l.$t("status.progressSuccess"))+" ("+c(l.successTo.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),h("tr",ns,[h("td",null,c(l.$t("status.all"))+":",1),h("td",os,[n(p,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:t(()=>[I(c(l.length.toLocaleString("en-us")),1)]),default:t(()=>[I(" "+c(l.$t("status.progressTotal"))+" ("+c(l.length.toLocaleString("en-us"))+") ",1)]),_:1})])])])])]),_:1})]),_:1},8,["percentage","color","rail-style"])}}}),ls={key:0,class:"log-table",ref:"table"},ss={class:"log-tr label"},is=["title"],rs={style:{"min-width":"7em"},class:"log-th"},us={style:{"padding-left":"2em"},class:"log-th"},ds={ref:"tbody"},cs=["onClick","onDblclick"],ps={class:"log-td"},fs={class:"log-td"},gs={class:"log-td"},ms={class:"log-td"},vs={key:0,class:"log-td log-extra",style:{"padding-left":"0.5em"}},hs={key:0},_s={key:1,style:{color:"blue"}},an=3,ln=3e3,ws=100,ys=xe({__name:"status.log",props:at({processing:{type:Boolean},opened:{type:Boolean},previewCollapsed:{type:Boolean},logs:{},imageIndex:{},thumbnail:{}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},order:{required:!1,default:"processed"},orderModifiers:{}}),emits:at(["open-preview","change-index"],["update:expanded","update:order"]),setup(s,{emit:u}){const{t:r}=Ve(),f={W:160,H:80},o=s,l=$e(s,"expanded"),g=u;nt("table");const p=nt("tbody"),b=y(),_=y(null),w=y(null),k=y(!0),m=y(80),d=y(200),x=ze(()=>{let a=o.logs;switch(H.value){case"success":a=a.filter(i=>i.completed);break;case"error":a=a.filter(i=>!i.completed);break}return a}),F=Ll(!1),E=y([{type:"group",label:()=>r("status.sort"),key:"sort",children:[{label:()=>r("status.sortByStart"),value:"processed"},{label:()=>r("status.sortByCompletion"),value:"zipped"},{label:()=>r("status.sortByName"),value:"name"},{label:()=>r("status.sortBySize"),value:"size"},{label:()=>r("status.sortByOutputSize"),value:"outputsize"},{label:()=>r("status.sortByStatus"),value:"status"}]}]),M=$e(s,"order");we(M,Se);const A=[{label:()=>r("status.showAll"),value:""},{label:()=>r("status.showOnlySuccess"),value:"success"},{label:()=>r("status.showOnlyError"),value:"error"}],H=y(A[0].value);Re(()=>{G=va(),ue(),window.addEventListener("resize",ue);const a=new ResizeObserver(ue);a.observe(G.parent.parent.vnode.el),qe(()=>{window.removeEventListener("resize",ue),a.disconnect()})}),qe(()=>{j.close(),clearTimeout(Q),clearTimeout(re),clearTimeout(ve)});let j;we(()=>[o.thumbnail,o.opened],()=>{if(!o.thumbnail||!o.opened||o.thumbnail===j)return;const{width:a,height:i}=En(o.thumbnail,{width:f.W,height:f.H});w.value.width=a,w.value.height=i,w.value.style.width=a+"px",w.value.style.height=i+"px",o.thumbnail instanceof HTMLImageElement?w.value.getContext("2d").drawImage(o.thumbnail,0,0,a,i):(w.value.getContext("bitmaprenderer").transferFromImageBitmap(o.thumbnail),j=o.thumbnail,o.thumbnail.close())});let v=0;we(()=>o.imageIndex,async()=>{var D;const a=o.imageIndex;let i=x.value.findIndex(Z=>Z.zippedIndex===a);i===-1&&(i=a);const z=i<K.value,S=i>K.value+ie.value;if(z||S){const Z=i*ae-(S?m.value:0);(D=b.value)==null||D.scrollTo({behavior:"instant",top:Z,left:Le}),await Te(),B(!0),await Te()}Te(()=>{var V,be;let Z=_.value;Z&&(v>i&&(Z=Z.previousSibling||Z,Z instanceof HTMLElement||((V=b.value)==null||V.scrollTo(Le,0),Z=null)),(be=Z==null?void 0:Z.scrollIntoView)==null||be.call(Z,{behavior:"instant",block:"nearest"}),v=i)})});let Q,G;const fe=y(document.documentElement.clientHeight),P=y(10),ue=()=>{clearTimeout(Q),Q=setTimeout(()=>{const a=b.value.$parent.$el.offsetHeight,i=window.innerHeight-G.parent.parent.vnode.el.offsetHeight-8,z=Math.max(100,a+i);fe.value=document.documentElement.clientHeight,P.value=z,!(!o.opened||!l.value)&&(m.value=Math.max(z,d.value))},100)};let ve=0,Ie=!1;function Oe(a=!1){if(!Ie){if(ve){Ie=!0;return}Te(()=>{!a&&!k.value||(b.value.scrollTo({behavior:"instant",top:o.logs.length*50,left:Le}),ve=window.setTimeout(()=>{ve=0,Ie&&(Ie=!1,Oe())},ws))})}}const L=y({height:"0px"}),N=y({height:"0px"}),K=y(0),ie=ze(()=>m.value/ae+an*2|0);let ae=15,ce=0,re=0,ye=0,q=-999,U=-1;function B(a){const i=Date.now();if(a!==!0){if(re)return;if(i-ye<30){re=window.setTimeout(()=>{re=0,B()},30-(i-ye));return}}ye=i,ce||(ce=p.value.rows[1].offsetHeight,ae=ce);const z=x.value.length,D=b.value.scrollbarInstRef.containerRef.scrollTop;if(!a&&z===U&&Math.abs(D-q)<ae*.5)return;q=D,U=z;const Z=Math.max(0,(D/ae|0)-an);K.value=Z,L.value.height=Z*ae+"px",N.value.height=Math.max(0,z-(Z+ie.value))*ae+"px"}function J(){var a;(a=b.value)==null||a.scrollTo(0,0),B()}we(()=>o.logs,()=>{o.opened&&(Te(B),k.value&&Oe(),de())}),we(()=>o.opened,a=>{a&&B()});let te=0,ee=0;function de(){if(M.value==="processed"||!M.value)return;const a=Date.now();if(a-ee<ln){if(te)return;te=window.setTimeout(de,ln-(a-ee));return}te=0,ee=a,Se()}function Se(){switch(console.log("sortList",M.value),M.value){case"zipped":o.logs.sort((a,i)=>a.zippedIndex-i.zippedIndex);break;case"status":o.logs.sort((a,i)=>a.command>i.command?1:-1);break;case"name":o.logs.sort((a,i)=>a.path>i.path?1:-1);break;case"size":o.logs.sort((a,i)=>a.size-i.size);break;case"outputsize":o.logs.sort((a,i)=>a.outputSize-i.outputSize);break;case"processed":default:o.logs.sort((a,i)=>a.index-i.index);break}}function Pe(a){const i=o.logs,z=i.findIndex(ge=>ge.zippedIndex===o.imageIndex);let S=0,D=1;switch(a.code){case"ArrowUp":S=-1;break;case"ArrowDown":S=1;break;case"PageUp":S=-1,D=m.value/ae|0;break;case"PageDown":S=1,D=m.value/ae|0;break;case"Enter":if(z>=0&&o.previewCollapsed){Te(()=>g("open-preview")),a.stopPropagation(),a.preventDefault();return}break;default:return}let Z=z,V=-1;const be=i.length;do{if(Z+=S,Z<0||Z>be-1||Z===z)break;if(i[Z].completed){if(V=Z,--D>0)continue;break}}while(!0);if(V>=0){const ge=i[V];g("change-index",!0,ge.path,ge.fileId,ge.zippedIndex),a.preventDefault()}}let me=-1,le=-1,Le=0,Ae=!1;function C(a){var S,D;if(B(),Ae){Ae=!1;return}const{scrollLeft:i=0,scrollTop:z=0}=(D=(S=b.value)==null?void 0:S.scrollbarInstRef)==null?void 0:D.containerRef;(i!==me||me<0)&&(z===le||le<0)&&(Le=i,console.log(Le,"storedLogTableScrollLeft")),me=i,le=z,Te(()=>{var V,be;Ae=!0;const Z=(be=(V=b.value)==null?void 0:V.scrollbarInstRef)==null?void 0:be.containerRef;Z&&(Z.scrollLeft=Le)})}function $(a){k.value=!1}return(a,i)=>{const z=At,S=Fe,D=_e,Z=Lt,V=wn,be=ke,ge=St,Ye=et,lt=Rt,st=Bt;return O(),oe(st,{name:"log",style:{"white-space":"nowrap"}},{header:t(()=>[n(S,{align:"center",wrap:!1},{default:t(()=>[I(c(a.$t("status.Log")),1),je(n(z,{size:16},null,512),[[Be,a.processing&&!o.opened]])]),_:1})]),"header-extra":t(()=>[je(n(S,{align:"center",justify:"end",wrap:!0,style:{"margin-top":"0.2em","margin-left":"0.5em"}},{default:t(()=>[n(Z,{value:M.value,"onUpdate:value":[i[0]||(i[0]=R=>M.value=R),Se],options:e(E),style:{width:"auto","font-size":"smaller"},"consistent-menu-width":!1,"show-on-focus":!1,size:"tiny"},{arrow:t(()=>[n(D,{component:e(ha)},null,8,["component"])]),_:1},8,["value","options"]),n(Z,{value:e(H),"onUpdate:value":[i[1]||(i[1]=R=>De(H)?H.value=R:null),i[2]||(i[2]=R=>J())],options:A,placeholder:a.$t("status.filterLogSelect"),size:"tiny",style:{width:"auto","font-size":"smaller"},"consistent-menu-width":!1,"show-on-focus":!1},{arrow:t(()=>[n(D,{component:e(_a)},null,8,["component"])]),_:1},8,["value","placeholder"]),n(V,{key:"b",checked:e(k),"onUpdate:checked":[i[3]||(i[3]=R=>De(k)?k.value=R:null),i[4]||(i[4]=R=>R&&Oe(!0))],size:"small",style:{"font-size":"smaller"}},{default:t(()=>[I(c(a.$t("status.autoScroll")),1)]),_:1},8,["checked"]),n(Ye,{trigger:"hover",show:e(F),disabled:!l.value,placement:"top",delay:0},{trigger:t(()=>[n(be,{style:{"max-width":"30em"},disabled:!0},{trigger:t(()=>[n(V,{size:"small",checked:l.value,"onUpdate:checked":[i[5]||(i[5]=R=>l.value=R),i[6]||(i[6]=R=>{R&&(Oe(!0),ue(),F.value=!0)})],style:{"font-size":"smaller"}},{default:t(()=>[I(c(a.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:t(()=>[I(c(a.$t("status.expandLog")),1)]),_:1})]),default:t(()=>[n(S,{wrap:!1,align:"center",style:{"font-size":"0.8rem"}},{default:t(()=>[n(ge,{value:e(d),"onUpdate:value":i[7]||(i[7]=R=>De(d)?d.value=R:null),onUpdateValue:ue,disabled:!l.value,"format-tooltip":R=>`Log size: ${R}`,tooltip:!0,step:1,min:e(P),max:e(fe),style:{"z-index":"3",width:"100px"}},null,8,["value","disabled","format-tooltip","min","max"])]),_:1})]),_:1},8,["show","disabled"])]),_:1},512),[[Be,o.opened]])]),default:t(()=>[n(S,{wrap:!1,align:"stretch",class:ot({"log-container":1,"expand-log":l.value}),style:se(l.value?{height:e(m)+"px"}:{height:"110px"}),onKeydown:Pe,tabindex:"-1"},{default:t(()=>[n(e(hn),{ref_key:"scrollref",ref:b,distance:10,"x-scrollable":!0,onMousedownCapture:$,onWheel:i[8]||(i[8]=R=>k.value=!1),onScroll:C,load:"handleLogLoad",trigger:"none",style:se([{"z-index":"2","padding-right":"10px",height:"100%"},l.value?{height:e(m)+"px"}:{}]),size:50},{default:t(()=>[o.opened?(O(),ne("table",ls,[h("thead",null,[h("tr",ss,[h("th",{class:"log-th",title:a.$t("status.table.core")},"th",8,is),i[9]||(i[9]=h("th",{class:"log-th"},"no.",-1)),h("th",rs,c(a.$t("status.table.status")),1),h("th",us,c(a.$t("status.table.details")),1),i[10]||(i[10]=h("th",{class:"log-th"},"size",-1))])]),h("tbody",ds,[h("tr",{style:se(e(L))},null,4),(O(!0),ne(Ee,null,ct(e(x).slice(e(K),e(K)+e(ie)),({index:R,key:Ze,command:We,path:ft,core:qt,zippedIndex:gt,completed:Gt,fileId:qo,shrinked:Go,width:Kt,height:Ko,outputWidth:Yt,outputHeight:Yo,size:Qo,outputSize:Xo},Bi)=>(O(),ne("tr",{key:Ze,class:ot({"log-tr":1,completed:Gt,selected:a.imageIndex===gt}),ref_for:!0,ref:Qt=>{a.imageIndex===gt&&(_.value=Qt)},onClick:Qt=>g("change-index",Gt,ft,qo,gt),onDblclick:()=>{a.imageIndex===gt&&g("open-preview")}},[h("td",ps,c(qt>=0?qt+1:"-"),1),h("td",fs,c(R+1),1),h("td",gs,c(We),1),h("td",ms,c(ft),1),Kt?(O(),ne("td",vs,[I(c(`[${Kt}×${Ko}] (${e(Ne)(Qo,0)})`)+" ",1),Yt?(O(),ne("span",hs,[i[11]||(i[11]=I(" → ")),h("span",null," ("+c(e(Ne)(Xo,0))+") ",1)])):pe("",!0),Go?(O(),ne("span",_s,c(` [${Yt}×${Yo}]`),1)):pe("",!0)])):pe("",!0)],42,cs))),128)),h("tr",{style:se(e(N))},null,4)],512)],512)):pe("",!0),i[12]||(i[12]=h("div",{style:{height:"1em"}},null,-1))]),_:1},8,["style"]),n(S,{style:se([{"align-self":"center",position:"absolute","z-index":"0","margin-top":"10px",right:"0.1em","line-height":"0px"},{width:f.W+"px",height:f.H+"px"}]),justify:"center",align:"center"},{default:t(()=>[n(z,{size:"small",show:a.processing},{default:t(()=>[o.thumbnail===void 0?(O(),oe(lt,{key:0,description:"EMPTY"})):pe("",!0),je(h("canvas",{ref_key:"thumbcanvas",ref:w,width:"106",height:"80",style:se({border:"1px solid gray",filter:a.processing?"":"opacity(0.35)"})},null,4),[[Be,o.thumbnail!==void 0]])]),_:1},8,["show"])]),_:1},8,["style"])]),_:1},8,["class","style"])]),_:1})}}}),bs={key:0},ks={style:{}},zs=["innerHTML"],xs={style:{margin:"1px"}},Is=["href","download","onClick"],As={key:0,style:{position:"relative"}},Ts=["href","download"],Ss=["href","download"],Ls={key:0,style:{margin:"1px"}},Cs=["href","download","onClick"],$s=xe({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image","delete-image"],setup(s,{expose:u,emit:r}){const f={itemMargin:"1px",titlePadding:"2px",titleFontSize:"0.8rem"},o=Tt(),{t:l}=Ve(),g=Nt(),p=s,b=r;u({cleanup:$});const _=y(!1),w=y([]),k=y(!1),m=y([]),d=y([]),x=y([0,0]),F=y([0,0]),T=y([0,0]),E=y([0,0]),M=y([0,0]),A=y([0,0]),H=y(0),j=y(0),v=y([0,0]),Q=y(g.value.infoColor),G=y("#000000"),fe=y("#000000"),P=y(0),ue=y(0),ve=y(""),Ie=y("00:00:00"),Oe=y(void 0),L=y(null),N=y(["progress","log","output"]),K=a=>N.value.includes(a),ie=a=>N.value.push(a),ae=a=>{const i=N.value.findIndex(z=>z===a);i>=0&&N.value.splice(i,1)},ce=ze(()=>N.value.includes("log")),re=y(!1),ye=y("processed"),q=It({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:0,various:{shrinked:!1}}),U=nt("body"),B=nt("imageViewer");Re(()=>{we(p.status,()=>de(),{deep:!1});let a=0;const i=()=>{if(a)return;const z=Date.now();Ie.value="00:00:00",a=window.setInterval(()=>{const S=(Date.now()-z)/1e3;Ie.value=`${String(S/3600|0).padStart(2,"0")}:${String(S/60%60|0).padStart(2,"0")}:${String(S%60|0).padStart(2,"0")}`},300)};i(),we(()=>p.processing,(z,S)=>{z?(i(),w.value.length=0,_.value=!1,k.value=!1,m.value=[],d.value=[]):(clearInterval(a),a=0),p.processing||Se()}),qe(()=>{clearInterval(a),clearTimeout(ee)}),_t(()=>clearInterval(a))}),qe(()=>{$()}),_t(()=>{clearTimeout(ee)}),we([()=>p.status.zips.length,()=>p.status.failedZips.length],()=>{const a=p.status;{m.value.length>a.zips.length&&(m.value.length=0);let i=0;const z=a.zips.length===1&&a.zippedTotalCount===a.length;for(let S=m.value.length;S<a.zips.length;S++){const D=a.zips[S],Z=a.baseZipName+(z?"":"-"+String(S+1).padStart(2,"0"))+".zip";i+=D.size,m.value[S]={url:D.url,size:D.size,number:z?0:S+1,sizeByUnit:Ne(D.size),name:Z,count:D.count,clicked:!1}}}{d.value.length>a.failedZips.length&&(d.value.length=0);let i=0;const z=a.failedZipDone&&a.failedZips.length===1;for(let S=d.value.length;S<a.failedZips.length;S++){const D=a.failedZips[S],Z=a.baseZipName+"-error"+(z?"":"-"+String(S+1).padStart(2,"0"))+".zip";i+=D.size,d.value[S]={url:D.url,size:D.size,number:z?0:S+1,sizeByUnit:Ne(D.size),name:Z,count:D.count,clicked:!1}}}});const J=p.interval||100;let te=!1,ee=0;function de(){if(te)return;if(ee){te=!0;return}ee=window.setTimeout(()=>{ee=0,te&&(te=!1,de())},J);const a=p.status;_.value=a.length>=2,F.value[1]=F.value[0],F.value[0]=a.startedCount,T.value[1]=T.value[0],T.value[0]=a.success,E.value[1]=E.value[0],E.value[0]=a.failure,M.value[1]=M.value[0],M.value[0]=a.done,A.value[1]=A.value[0],A.value[0]=a.converted,H.value=a.retried,j.value=a.length,v.value[1]=v.value[0],v.value[0]=a.zippedTotalCount,P.value=a.inputTotalSize,ue.value=a.outputTotalSize;const i=ue.value-P.value;ve.value=(i>=0?"+ ":"")+Ne(i);const z=ue.value/P.value,S=(256|Math.min(255,Math.max(0,z-1.5)*255|0)).toString(16).substring(1);G.value="#"+S+"0000";const D=1024*1024,Z=(256|Math.min(255,Math.max(0,i/1024/D)*255|0)).toString(16).substring(1);fe.value="#"+Z+"0000",x.value[1]=x.value[0],x.value[0]=T.value[0]/j.value*100,(ce.value||!p.processing)&&(w.value=w.value.concat(a.logs),a.logs.length=0),L.value=a.thumbnail,p.processing&&(Q.value=E.value[0]?g.value.errorColor:H.value?g.value.warningColor:g.value.infoColor),a.convertedImageUrl!==q.url&&(q.url=a.convertedImageUrl,q.name=a.convertedImageName,q.dataUrl=a.convertedImageDataUrl,q.size=a.convertedImageSize||a.outputTotalSize,q.originalSize=a.convertedImageOrgSize,q.originalName=a.convertedImageOrgName,q.index=a.convertedImageIndex,q.originalUrl=a.convertedImageOrgUrl,q.various={shrinked:a.convertedImageShrinked})}function Se(){const a=p.status;Q.value=p.status.success===p.status.length?g.value.successColor:g.value.errorColor,re.value||(ae("log"),re.value=!0),ye.value==="processed"&&(ye.value="zipped"),a.success>0&&ie("preview")}async function Pe(a,i,z,S){var Z;if(!a)return;const D=S;console.log(a,i,z,S,"completed, path, fileId, zippedIndex"),console.log(D,p.status.ziplogs[D]),K("preview")||(ie("preview"),await Te()),(Z=B.value)==null||Z.changeIndex(D+1),await Te(()=>{var V;try{(V=B.value)==null||V.$el.scrollIntoView({behavior:"instant",block:"nearest"})}catch{}})}const me=ze(()=>[{key:"open",label:l("status.openFailedList"),icon:()=>Y(_e,()=>Y(yn)),onSelect(){Ae()}},{key:"download",label:l("status.saveFailedList"),icon:()=>Y(_e,()=>Y(wa)),onSelect(){Ae(!0)}},{key:"zip",label:`${l("status.zipFailedList")}`+(p.status.failedZipDone?`(✔${l("status.done")})`:""),icon:()=>Y(At,{show:k.value&&!p.status.failedZipDone,size:"small"},()=>Y(_e,()=>Y(Pt))),disabled:k.value,onSelect(a){return k.value=!0,b("demand-zip-errors"),!1}}]);function le(a,i=!1){const{url:z,name:S}=a;if(i){const D=document.createElement("a");D.href=z,D.download=S,D.click()}a.clicked||(a.clicked=!0,p.processing||m.value.every(D=>D.clicked)&&b("all-zips-clicked"))}async function Le(){if(_.value){if(m.value.length>=2&&!await new Promise((z,S)=>o.warning({title:l("Download"),content:l("status.confirmDownloadMessage",[m.value.length]),positiveText:"OK",negativeText:l("cancel"),onPositiveClick:()=>z(!0),onNegativeClick:()=>S()})))return;const a=m.value;for(const i of a)le(i,!0)}else B.value.download()}function Ae(a=!1){const i=new Blob([p.status.unconvertedListText],{type:"text/plain;charset=utf8"}),z=URL.createObjectURL(i),S=document.createElement("a");S.href=z,S.target="_blank",a&&(S.download=p.status.baseZipName+"-error.txt"),S.click()}const C=y(!1);function $(){C.value=!0,URL.revokeObjectURL(q.url),URL.revokeObjectURL(q.originalName),q.originalUrl="",q.url="",q.index=0,p.status.logs.length=0,w.value.length=0,d.value.length=0,m.value.length=0}return(a,i)=>{const z=Fe,S=ya,D=Bt,Z=_n,V=et,be=Ce,ge=Pl,Ye=jt,lt=ba,st=bn;return O(),oe(z,{ref_key:"body",ref:U,vertical:"",justify:"center"},{default:t(()=>[n(st,{"display-directive":"show","trigger-areas":["arrow","main"],"expanded-names":e(N),"onUpdate:expandedNames":i[6]||(i[6]=R=>De(N)?N.value=R:null),"theme-overrides":f},{default:t(()=>[n(D,{name:"progress",style:{"white-space":"nowrap"}},{header:t(({collapsed:R})=>[n(z,null,{default:t(()=>[I(c(a.$t("status.Progress"))+" ",1),R?(O(),ne(Ee,{key:0},[I(" ("+c(e(x)[0]|0)+"%) ",1)],64)):pe("",!0)]),_:2},1024)]),default:t(()=>[n(z,{justify:"center",align:"center",wrap:!1,style:{"white-space":"nowrap","margin-top":"-2em"}},{default:t(()=>[n(z,{vertical:"",justify:"center",class:"left-column"},{default:t(()=>[n(S,{"tabular-nums":"",label:a.$t("status.elapsedTime")},{default:t(()=>[n(z,null,{default:t(()=>[I(c(e(Ie)),1)]),_:1})]),_:1},8,["label"]),n(S,{"tabular-nums":"",label:a.$t("status.multiThreading")},{default:t(()=>[n(z,{style:se({color:p.status.threads?"":"red",fontSize:"0.7rem"})},{default:t(()=>[I(c(p.status.threads?a.$rt("{n} @:threads",p.status.threads):a.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(S,{"tabular-nums":"",label:a.$t("status.outputSettings")},{default:t(()=>[n(z,{vertical:"",justify:"end",style:{"font-size":"0.6rem","line-height":"0.6rem"}},{default:t(()=>[h("div",null,c(a.$t("settings.imageType"))+": "+c(p.status.type),1),a.status.shrink?(O(),ne("div",bs,[I(c(a.$t("status.Shrinking"))+": ",1),h("span",ks,c(a.status.shrink[0])+"×"+c(a.status.shrink[1]),1)])):pe("",!0),h("div",null,"Zip: "+c(p.status.zipSize)+"MB",1)]),_:1})]),_:1},8,["label"])]),_:1}),e(C)?pe("",!0):(O(),oe(as,{key:0,index:e(F)[0],success:e(T)[0],length:a.status.length,"success-to":e(T)[0],"success-from":e(T)[1],failure:e(E)[0],"success-perc-to":e(x)[0],"success-perc-from":e(x)[1],retried:e(H),processing:a.processing,interval:e(J),"status-color":e(Q),class:"center-column"},null,8,["index","success","length","success-to","success-from","failure","success-perc-to","success-perc-from","retried","processing","interval","status-color"])),n(z,{vertical:"",style:{height:"100%"},justify:"center"},{default:t(()=>[n(S,{"tabular-nums":"",label:a.$t("status.inputSize")},{default:t(()=>[n(z,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[I(c((e(P)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(S,{"tabular-nums":"",label:a.$t("status.outputSize")},{default:t(()=>[n(z,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[I(c((e(ue)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(S,{"tabular-nums":"",label:a.$t("status.outInRate")},{default:t(()=>[n(z,{vertical:"",align:"end",justify:"start",style:{"font-size":"smaller","font-family":"v-mono","line-height":"50%"}},{default:t(()=>[h("span",{style:se({color:e(G),fontSize:"larger"})},"× "+c((e(ue)/e(P)||1).toFixed(2)),5),h("span",{style:se({color:e(fe)})},"("+c(e(ve))+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:1})]),_:1}),n(ys,{processing:a.processing,"image-index":e(q).index,thumbnail:e(L),opened:e(ce),"preview-collapsed":K("preview"),logs:e(w),expanded:e(re),order:e(ye),onChangeIndex:Pe,onOpenPreview:i[0]||(i[0]=R=>{var Ze;return(Ze=e(B))==null?void 0:Ze.openPreview()}),name:"log",style:{"white-space":"nowrap"}},null,8,["processing","image-index","thumbnail","opened","preview-collapsed","logs","expanded","order"]),n(D,{title:a.$t("status.PreviewImage"),name:"preview",style:{"white-space":"nowrap"},disabled:!(e(T)[0]>0)},{default:t(()=>[n(z,{justify:"center",align:"center",vertical:""},{default:t(()=>[n(ql,{"_v-else-if":"imageViewerStarted && status.success > 0 /*&& (props.status.threads || !zippingFlag)*/ && !cleaningUp",ref_key:"imageViewer",ref:B,url:e(q).url,size:e(q).size,"original-url":e(q).originalUrl,"original-size":e(q).originalSize,name:e(q).name,originalName:e(q).originalName,length:e(T)[0],index:e(q).index,"various-info":e(q).various,"is-single":!e(_),onDemandImage:i[1]||(i[1]=R=>b("demand-image",R)),on_deleteImage:i[2]||(i[2]=R=>b("delete-image",R)),_close:"imageViewerStarted=false"},null,8,["url","size","original-url","original-size","name","originalName","length","index","various-info","is-single"])]),_:1})]),_:1},8,["title","disabled"]),n(D,{name:"output",style:{"white-space":"nowrap"},disabled:""},{header:t(()=>[h("span",{style:{color:"black"},innerHTML:a.$t("status.Output")},null,8,zs)]),default:t(()=>[n(z,{wrap:!1,vertical:"",style:{"margin-top":"-1.3em"}},{default:t(()=>[e(C)?pe("",!0):(O(),oe(z,{key:0,justify:"center"},{default:t(()=>[je(n(z,{vertical:"",align:"center"},{default:t(()=>[n(V,{placement:"left"},{trigger:t(()=>[n(Z,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":e(v)[0]===e(j)?"white":"green",processing:a.processing,percentage:e(v)[0]/e(j)*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[h("span",xs,c(e(v)[0]/e(j)*100|0)+"% "+c(a.$t("status.zipped"))+" ("+c(e(v)[0])+"/"+c(e(A)[0])+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[I(" "+c(a.$t("status.zippingProgress"))+" ("+c(e(v)[0]/e(j)*100|0)+"%) ",1)]),_:1}),n(Xe,{name:"zipcontainer"},{default:t(()=>[e(m).length>=1||p.processing?(O(),oe(tn,{key:0,name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(O(!0),ne(Ee,null,ct(e(m),(R,Ze)=>(O(),ne("span",{key:Ze},[n(V,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:R.url,download:R.name,class:"in-button-anchor",onClick:We=>le(R)},[n(be,{class:"zip-button",size:"tiny",color:R.clicked?"#050":"lime","text-color":R.clicked?"gray":"white",onClick:Qe(We=>le(R),["stop"]),round:""},{default:t(()=>[n(e(_e),{size:"tiny"},{default:t(()=>[n(e(Pt))]),_:1}),I("ZIP"+c(R.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Is)]),default:t(()=>[h("div",{style:se({color:e(g).successColor})},[h("div",null,"ZIP "+c(R.number||"")+" ("+c(a.$t("success"))+")",1),h("div",null,c(R.name),1),h("div",null,c(R.sizeByUnit),1),h("div",null,c(a.$rt("{n} @:files",R.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):pe("",!0)]),_:1})]),_:1},512),[[Be,e(_)]])]),_:1})),n(Xe,null,{default:t(()=>[e(C)?pe("",!0):je((O(),oe(z,{key:0,justify:"center",align:"center"},{default:t(()=>[n(V,{trigger:"hover",duration:0,delay:0,placement:"left",style:se({color:"white",backgroundColor:e(g).successColor}),"arrow-style":{backgroundColor:e(g).successColor}},{trigger:t(()=>[n(Xe,{name:"save"},{default:t(()=>[e(T)[0]>0?(O(),ne("span",As,[n(Ye,{value:e(_)?e(v)[0].toLocaleString("en-us"):p.status.type.replace(/\(.+\)/,""),color:e(g).successColorHover,offset:[-20,-3]},{default:t(()=>[n(be,{size:"medium",onClick:Le,color:e(g).successColor,round:""},{default:t(()=>[e(_)?(O(),ne(Ee,{key:0},[e(m).length?(O(),ne("a",{key:0,href:e(m)[0].url,download:e(m)[0].name,class:"in-button-anchor",onClick:i[3]||(i[3]=Qe(()=>{},["prevent"]))},[n(ge),I(" × "+c(e(m).length)+" "+c(a.$t("status.saveAll")),1)],8,Ts)):pe("",!0)],64)):(O(),ne("a",{key:1,href:e(q).url,download:e(q).name,class:"in-button-anchor",onClick:i[4]||(i[4]=Qe(()=>{},["prevent"]))},[n(e(_e),{size:"tiny"},{default:t(()=>[n(e(kn))]),_:1}),I(" "+c(a.$t("save")),1)],8,Ss))]),_:1},8,["color"])]),_:1},8,["value","color"])])):pe("",!0)]),_:1})]),default:t(()=>[a.status.length>=2?(O(),ne(Ee,{key:0},[h("div",null,c(e(l)("success"))+": "+c(e(v)[0].toLocaleString()),1),h("div",null,c(e(l)("status.totalSize"))+": "+c(e(Ne)(a.status.zippedTotalSize)),1),h("div",null,"ZIP × "+c(e(m).length),1),h("div",null,c(e(l)("status.saveAllZipsTooltip")),1)],64)):(O(),ne(Ee,{key:1},[I(c(a.$t("status.downloadConvertedImage",e(m).length)),1)],64))]),_:1},8,["style","arrow-style"]),n(lt,{"_v-if":"!processing && !(status.success === length)",options:e(me),onSelect:i[5]||(i[5]=(R,Ze)=>{var We;return(We=e(me).find(({key:ft})=>R===ft))==null?void 0:We.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:t(()=>[n(V,{show:e(Oe),duration:0,delay:0,placement:"right",style:se({color:"white",backgroundColor:e(g).errorColor}),"arrow-style":{backgroundColor:e(g).errorColor}},{trigger:t(()=>[n(Ye,{value:a.status.unconvertedFileCount.toLocaleString(),color:e(g).errorColorHover,offset:[-0,-3]},{default:t(()=>[n(be,{size:"small",color:e(g).errorColor},{default:t(()=>[n(e(_e),{size:"medium",style:{"vertical-align":"middle"}},{default:t(()=>[n(e(ka))]),_:1})]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:t(()=>[h("div",null,[h("div",null,c(e(l)("failed"))+": "+c(a.status.unconvertedFileCount.toLocaleString()),1),h("div",null,c(e(l)("status.totalSize"))+": "+c(e(Ne)(a.status.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])]),_:1},512)),[[Be,!p.processing]])]),_:1}),n(Xe,{name:"zipcontainer"},{default:t(()=>[e(C)?pe("",!0):je((O(),oe(z,{key:0,vertical:"",align:"center"},{default:t(()=>[n(V,{placement:"left"},{trigger:t(()=>[n(Z,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":a.status.failedFileZippedCount===a.status.unconvertedFileCount?"white":"#500",processing:e(k)&&!a.status.failedZipDone&&!a.status.failedToCreateFailedZip,percentage:a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[a.status.failedToCreateFailedZip?(O(),ne("div",{key:1,style:se({color:e(g).errorColor})},c(a.$t("status.failureZippingFailedFiles")),5)):(O(),ne("span",Ls,c(a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0)+"% "+c(a.$t("status.zipped"))+" ("+c(a.status.failedFileZippedCount)+"/"+c(a.status.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[I(" "+c(a.$t("status.zippingProgress"))+" ("+c(a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(tn,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(O(!0),ne(Ee,null,ct(e(d),(R,Ze)=>(O(),ne("span",{key:Ze},[n(V,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:R.url,download:R.name,class:"in-button-anchor",onClick:We=>le(R)},[n(be,{class:"zip-button",size:"tiny",color:R.clicked?"#551122":"#F00","text-color":R.clicked?"gray":"white",onClick:Qe(We=>le(R),["stop"]),round:""},{default:t(()=>[n(e(_e),{size:"tiny"},{default:t(()=>[n(e(za))]),_:1}),I("ZIP"+c(R.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Cs)]),default:t(()=>[h("div",{style:se({color:e(g).errorColor})},[h("div",null,"ZIP "+c(R.number||"")+" ("+c(a.$t("failed"))+")",1),h("div",null,c(R.name),1),h("div",null,c(R.sizeByUnit),1),h("div",null,c(a.$rt("{n} @:files",R.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1},512)),[[Be,e(k)]])]),_:1})]),_:1})]),_:1})]),_:1},8,["expanded-names"])]),_:1},512)}}}),Es=He($s,[["__scopeId","data-v-b297220f"]]),Fs=["innerHTML"],Os=xe({__name:"converter",props:at({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},threads:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:at(["start","end"],["update:showNote"]),setup(s,{emit:u}){Je(Ke);const{t:r}=Ve(),f=Tt(),o=xa(),l=10,g=navigator.hardwareConcurrency,p=typeof OffscreenCanvas=="function",b=100,_=s,w=$e(s,"showNote"),k=u,m=y(!1),d=y(!1),x=y(!1),F=y(!1),T=y(!1),E=y(()=>"initializing"),M=y("info"),A=It(K()),H=nt("stat"),j=y(0);let v=!1,Q=()=>{},G,fe=0,P=!1;we(()=>_.input,U=>{U!=null&&U.length&&ae(U)}),we(F,U=>{document.body.style.overflowY=U?"hidden":"auto"}),Re(async()=>{await ye(),q()});async function ue(){let U=!0;if(fe>l*1e3&&!P&&A.success>0&&(U=!1,await new Promise(B=>{f.warning({title:r("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:r("close"),negativeText:r("back"),onPositiveClick:()=>U=!0,onAfterLeave:B,content:r("confirmCloseDialog")})})),!U)return!1;o.destroyAll(),F.value=!1,w.value=!1}function ve(U){G==null||G(U),console.log(U,"demanded")}function Ie(U){Et==null||Et(U),console.log(U,"delete")}function Oe(){!d.value&&m.value?d.value=!0:ue()}function L(){ae(_.input)}let N=y(()=>{});function K(U){const B={logs:[],ziplogs:[],startedCount:0,converted:0,success:0,failure:0,retried:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",convertedImageOrgUrl:"",convertedImageIndex:-1,convertedImageShrinked:!1,zipSize:_.maxZipSizeMB,shrink:W.multithread&&W.shrinkImage?[W.maxWidth,W.maxHeight]:void 0,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1};return Object.assign(U||{},B)}function ie(){T.value=!1,URL.revokeObjectURL(A.convertedImageUrl),URL.revokeObjectURL(A.convertedImageOrgUrl);for(const U of A.zips)URL.revokeObjectURL(U.url);A.zips.length=0;for(const U of A.failedZips)URL.revokeObjectURL(U.url);A.failedZips.length=0,K(A),Q(),Q=()=>{},G=null,P=!1,x.value=!1,d.value=!1}async function ae(U){if(m.value){f.error({title:"Busy",positiveText:"OK",content:r("interfered")});return}F.value&&(j.value^=1);let B=U.concat();K(A),ie(),F.value=!0,T.value=!0,m.value=!0,A.processing=!0,M.value="info",E.value=()=>r("processing");const J=new Set,te=_.format,ee=_.quality,de=[...te.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),Se=re(te,ee,B[0].webkitRelativePath);A.length=B.length,A.baseZipName=Se,A.type=te.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(te)?" ("+ee+")":""),A.threads=v?0:_.threads;const Pe=Date.now();k("start");let me,le,Le;if(!v&&_.threads>=2?(G=Il,Le=await vl({files:B,completedFileIdSet:J,ConvStats:A,canceled:d,props:_,imageType:te,quality:ee,outputExt:de,format:te,message:o})):(G=$l,Le=await Cl(B,J,_,d,A)),{exception:le,callbackToGenerateFailedZips:me,callbackToClearConverter:Q}=Le,le){let Ae;switch(le.message){case"worker-load-error":Ae=r("errMsgWorkerLoadError");break;default:Ae="unexpected error"}f.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:()=>Y("div",[Y("p",Ae),Y(Ce,{onClick(){location.reload()}},r("Reload"))])})}if(A.success===A.length?(M.value="success",E.value=()=>r("completed")):(M.value="error",E.value=()=>d.value?r("aborted"):r("incomplete")),J.size!==B.length){const Ae=ce(U,J);N.value=()=>{!Ae||!Ae.length||me(Ae)}}m.value=!1,A.processing=!1,x.value=!0,B.length=0,fe=Date.now()-Pe,k("end")}function ce(U,B){const J=[],te=[];let ee=0;for(const de of U)B.has(de._id)||(J.push(de),te.push(de.webkitRelativePath||de.relativePath||de.name),ee+=de.size);return te.length&&(A.unconvertedListText=te.join(`
`),A.unconvertedFileCount=J.length,A.unconvertedTotalSize=ee),J}function re(U,B,J){var Pe;const te=new Date;U=U.replace(/^image\//,"").toLowerCase();const ee=W.useFolderNameForZip&&((Pe=String(J).match(/^\/?([^/]+)\//))==null?void 0:Pe[1])||"avif2jpg",de=`
    ${te.getFullYear().toString().substring(2)}
    ${String((te.getMonth()+1)*100+te.getDate()).padStart(4,"0")}
    ${String(te.getHours()*1e4+te.getMinutes()*100+te.getSeconds()).padStart(6,"0")}
    -
    ${U+(/jpe?g|webp/i.test(U)?B:"")}
  `.replace(/\s/g,"");return`${ee}-${de}`.replace(/\s+/g," ")}async function ye(){const U="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",B=document.createElement("img"),J=Fn(B).then(()=>!0,()=>!1);B.src=U,await J||f.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:r("avifUnsupported")})}function q(){(!p||g<2||!Promise.any)&&(v=!0),v&&(Ue.value=0)}return(U,B)=>{var me;const J=_e,te=jt,ee=ke,de=Fe,Se=At,Pe=Mt;return O(),ne(Ee,null,[!e(m)&&((me=_.input)!=null&&me.length)?(O(),oe(de,{key:0,justify:"center",align:"center",style:{"margin-top":"0.4em"}},{default:t(()=>[n(ee,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:t(()=>{var le;return[n(te,{value:((le=U.input)==null?void 0:le.length)||0,offset:[-12,-5],color:"#99999966"},{default:t(()=>[n(e(Ce),{onClick:L,round:"",size:"medium"},{icon:t(()=>[n(J,{size:"1.2em",color:"#CCCCCC"},{default:t(()=>[n(e(Ia))]),_:1})]),default:t(()=>[I(" "+c(e(r)("convertAgain")),1)]),_:1})]),_:1},8,["value"])]}),default:t(()=>{var le;return[h("div",{innerHTML:e(r)("reconvertTip",(le=_.input)==null?void 0:le.length)},null,8,Fs)]}),_:1})]),_:1})):pe("",!0),n(Pe,{ref:"processingModal","display-directive":"show",show:e(F),"onUpdate:show":B[2]||(B[2]=le=>De(F)?F.value=le:null),closable:e(x),"close-on-esc":!1,preset:"dialog",onClick:B[3]||(B[3]=le=>{e(o).destroyAll()}),onMaskClick:B[4]||(B[4]=le=>{e(o).destroyAll()}),onClose:ue,onEsc:Oe,title:e(E),type:e(M),"mask-closable":!1,onAfterLeave:ie,onBeforeLeave:B[5]||(B[5]=le=>{e(H).cleanup()}),class:"processing-dialog"},{default:t(()=>[n(de,{vertical:"",style:{"flex-grow":"1"}},{default:t(()=>[e(T)?(O(),oe(Es,{ref_key:"stat",ref:H,key:e(j),processing:e(m),status:e(A),interval:b,onAllZipsClicked:B[0]||(B[0]=le=>De(P)?P.value=!0:P=!0),onDemandZipErrors:e(N),onDemandImage:ve,onDeleteImage:Ie},null,8,["processing","status","onDemandZipErrors"])):pe("",!0),n(de,{justify:"end",align:"center",wrap:!1},{default:t(()=>[n(de,{justify:"start",align:"center"},{default:t(()=>[fn(U.$slots,"lang-switch")]),_:3}),e(m)?(O(),oe(e(Ce),{key:0,disabled:e(d),ref:"cancelbutton",round:"",size:"large",onClick:B[1]||(B[1]=le=>d.value=!0)},{default:t(()=>[n(Se,{show:e(d)&&!e(x),size:"small"},{default:t(()=>[I(c(e(r)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):e(x)?(O(),oe(e(Ce),{key:1,onClick:ue,round:"",size:"large",style:{"font-size":"small","margin-top":"1em"}},{default:t(()=>[I(c(e(r)("close")),1)]),_:1})):pe("",!0)]),_:3})]),_:3})]),_:3},8,["show","closable","title","type"])],64)}}}),Ps="/avif2jpeg/dist/avif.png",Us={class:"container-1"},Ms={style:{position:"relative"}},Rs={style:{position:"absolute","font-size":"0.5em",right:"-3.5em",bottom:"-1.5em","white-space":"nowrap"}},Ns={style:{color:"#666666"}},js=["innerHTML"],Bs={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},Ds=xe({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(s,{emit:u}){Je(Ke);const r=s,f=u,o=Aa(),l=y(!1),g=y(0),p=y("");Re(()=>{b(r.dropTarget||document)});function b(w){document.ondragstart=k=>k.preventDefault(),document.ondragover=k=>k.preventDefault(),w.ondrop=async k=>{var d;if(k.preventDefault(),l.value||r.forbidden)return;l.value=!0,g.value=0,p.value="";let m;try{const x=[...k.dataTransfer.items].map(F=>F.webkitGetAsEntry());o.start(),m=await _(x),o.finish()}catch{m=[...((d=k.dataTransfer)==null?void 0:d.files)??[]],o.error()}l.value&&(l.value=!1,f("drop",m))}}async function _(w,k){k=k||[];for(const m of w)if(m.isFile){const d=await new Promise(x=>m.file(F=>x(F)));Object.defineProperty(d,"webkitRelativePath",{value:m.fullPath}),k.push(d),g.value++}else if(m.isDirectory){p.value=m.fullPath;const d=m.createReader();do{const x=await new Promise(F=>d.readEntries(T=>F(T)));if(!x.length)break;await _(x,k)}while(!0)}return k}return(w,k)=>{const m=_e,d=et,x=Fe,F=ke,T=Mt;return O(),ne("div",Us,[n(F,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"bottom-end"},{trigger:t(()=>[n(x,{vertical:"",class:"container-2"},{default:t(()=>[n(x,{align:"center",wrap:!1,class:"container-3"},{default:t(()=>[n(x,{vertical:"",align:"center",wrap:!1,style:{"font-weight":"bold","font-size":"1em","line-height":"90%","white-space":"nowrap"}},{default:t(()=>[k[5]||(k[5]=h("span",null,"Drag & Drop",-1)),h("span",Ms,[k[4]||(k[4]=I(" AVIF Images ")),h("span",Rs,[k[3]||(k[3]=I(" or ")),n(d,{placement:"bottom-end"},{trigger:t(()=>[h("span",Ns,[n(m,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Dt))]),_:1}),k[1]||(k[1]=I(" Folders "))])]),default:t(()=>[k[2]||(k[2]=I(" You can drag and drop your local folders "))]),_:1})])])]),_:1}),n(x,null,{default:t(()=>k[6]||(k[6]=[h("img",{src:Ps,class:"avif"},null,-1)])),_:1})]),_:1})]),_:1})]),default:t(()=>[h("h3",{innerHTML:w.$t("droptarget"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,js)]),_:1}),n(T,{show:e(l),"onUpdate:show":k[0]||(k[0]=E=>De(l)?l.value=E:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":w.$t("cancel")},{default:t(()=>[n(x,{vertical:"",align:"center"},{default:t(()=>[h("div",Bs,c(e(p)),1),h("div",null,"found "+c(e(g))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])])}}}),Zs=He(Ds,[["__scopeId","data-v-963c44a5"]]),Vs={class:"container-1"},Hs={class:"container-2"},Ws=["innerHTML"],qs=["innerHTML"],Gs={style:{"white-space":"nowrap"}},Ks={style:{"padding-left":"1em"}},Ys=["innerHTML"],Qs=["accept"],Xs=xe({__name:"file-selector",props:at({target:{},userExtensions:{},forbidden:{type:Boolean}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:at(["input","click","cancel","on-change-accept","update:target","update:userExtensions"],["update:expanded","update:disableNotifyingFolderSelect"]),setup(s,{emit:u}){const r=Tt(),{t:f}=Ve(),o=Je(Ke),l=["avif_only","all_images","all_files","edit_type"],g=[];for(const L of l)g.push({label:()=>f("fileTypeRadioOptions."+L),value:L});const p=({node:L,option:N})=>Y(ke,{placement:"right"},{trigger:()=>L,default:()=>P(N.value).replace(/,/g,", ")}),b=s,_=u,w=y(0),k=y(!1),m=y(!1),d=ze(()=>P(T.value)),x=ze(()=>E.value.split(",").every(N=>/^\s*(\.[\w\-]+)*\s*$/.test(N))?"success":"error"),F=ze(()=>!b.forbidden&&!m.value);$e(s,"expanded");const T=ze({get:()=>l.indexOf(b.target)>=0?b.target:l[0],set:L=>{_("update:target",L)}}),E=ze({get:()=>b.userExtensions,set:L=>{_("update:userExtensions",L)}}),M=$e(s,"disableNotifyingFolderSelect"),A=y(null),H=y(null),j=y(fe());we(T,L=>{_("on-change-accept",d.value)}),Re(()=>{});async function v(L){if(_("click"),L===H.value&&!M.value){let N=!1;if(await new Promise(K=>{r.info({title:f("loadfolderNotifyingTitle"),positiveText:f("Continue"),negativeText:f("Cancel"),onAfterLeave:()=>K(N),onPositiveClick:()=>N=!0,content:()=>Y("div",[Y("p",{},f("loadfolderNotifyingMessageTerm1")),Y("div",[Y(vn,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/dist//notification-folder.png"})]),Y("p",{},f("loadfolderNotifyingMessageTerm2")),Y("p",[Y(wn,{onUpdateChecked:ie=>M.value=ie,checked:M.value},()=>f("checkboxTextDontShowThis"))])])})}),!N){M.value=!1,_("cancel");return}}L.click()}function Q(){_("cancel")}function G(L){const K=[...L.target.files];A.value.value="",H.value.value="",ve(K)}function fe(){return"webkitdirectory"in document.createElement("input")}function P(L){switch(L){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico";case"edit_type":return E.value;case"all_files":default:return".*"}}async function ue(L){const N=String(d.value).toLowerCase().replace(/\s+/g,"");if(N&&d.value!==".*"){const K=N.split(",");L=L.filter(ie=>K.includes(ie.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),L.length||(await new Promise(ie=>{r.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:ie,content:()=>Y("div",[Y(Rt,{description:"NO IMAGES"}),`${f("noimage")}`,Y("br"),d.value])})}),Q())}return L}async function ve(L){m.value=!0,L=await ue(L),w.value=L.length,L.length>0&&_("input",Oe(L)),m.value=!1}let Ie=0;function Oe(L){const N=[];for(const K of L)K.hasOwnProperty("_id")||Object.defineProperty(K,"_id",{value:Ie++}),N.push(K);return N}return(L,N)=>{const K=_e,ie=Ce,ae=Fe,ce=Lt,re=Sa,ye=Ta,q=et;return O(),ne(Ee,null,[h("div",Vs,[h("div",Hs,[n(ae,{vertical:"",align:"center",justify:"center",inline:"",size:"large"},{default:t(()=>[n(ae,{align:"center",justify:"space-around",class:"main-buttons"},{default:t(()=>[n(ae,{vertical:"",align:"stretch",justify:"center"},{default:t(()=>[n(e(ke),{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(o).LANDSCAPE.value?"right":"top",duration:0,delay:0,"z-index":10},{trigger:t(()=>[n(ie,{disabled:!e(F),size:"large",onClick:N[0]||(N[0]=U=>v(e(A))),round:"",style:{width:"100%","background-color":"white","font-size":"large"}},{icon:t(()=>[n(K,{size:"large",color:"gray"},{default:t(()=>[n(e(zn))]),_:1})]),default:t(()=>[I(" "+c(L.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[h("div",{innerHTML:L.$t("loadbuttontooltip")},null,8,Ws)]),_:1},8,["show","placement"]),!e(o).IS_SP&&e(j)||e(o).SSR?(O(),ne(Ee,{key:0},[n(ae,{align:"center",justify:"center",style:{color:"gray",margin:"0em"}},{default:t(()=>[I(c(L.$t("or")),1)]),_:1}),n(e(ke),{to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:e(o).showTooltipsBeforeMounted.value},{trigger:t(()=>[n(ie,{disabled:!e(F),size:"large",onClick:N[1]||(N[1]=U=>v(e(H))),round:"",style:{width:"100%","background-color":"white","font-size":"large"}},{icon:t(()=>[n(K,{size:"large",color:"gray"},{default:t(()=>[n(e(Dt))]),_:1})]),default:t(()=>[I(" "+c(L.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[h("div",{innerHTML:L.$t("loadfoldertooltip")},null,8,qs)]),_:1},8,["show"])],64)):pe("",!0)]),_:1}),e(o).IS_SP?pe("",!0):(O(),oe(Zs,{key:0,onDrop:ve,forbidden:!e(F),class:"drop-target"},null,8,["forbidden"]))]),_:1}),n(ae,{vertical:""},{default:t(()=>[n(ae,{wrap:e(o).IS_SP,align:"center",justify:"stretch"},{default:t(()=>[h("span",Gs,c(L.$t("TargetFileTypeExt"))+": ",1),n(e(ke),{"keep-alive-on-hover":!1,placement:"right",style:{"max-width":"200px"},duration:0,delay:0},{trigger:t(()=>[n(ce,{trigger:"click",width:"trigger",size:"small",value:e(T),"onUpdate:value":N[2]||(N[2]=U=>De(T)?T.value=U:null),options:g,"render-option":p,"consistent-menu-width":!1},null,8,["value"])]),default:t(()=>[I(" "+c(P(e(T)).replace(/,/g,", ")),1)]),_:1})]),_:1},8,["wrap"]),e(T)==="edit_type"?(O(),oe(e(ke),{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:e(k),duration:0,delay:0},{trigger:t(()=>[h("div",Ks,[n(q,{trigger:"manual",placement:"right-end",show:e(T)==="edit_type"&&e(x)!=="success"&&!!e(k)},{trigger:t(()=>[n(re,{value:e(E),"onUpdate:value":N[3]||(N[3]=U=>De(E)?E.value=U:null),status:e(x),disabled:e(T)!=="edit_type",onFocus:N[4]||(N[4]=U=>k.value=!0),onBlur:N[5]||(N[5]=U=>k.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:t(()=>[n(ye,{type:"error","show-icon":!0,title:"Validation error"},{default:t(()=>N[6]||(N[6]=[I(" Please correct the extension list."),h("br",null,null,-1),h("ul",null,[h("li",null,"Each extension must begin with a period. "),h("li",null,"Separate each extension with a comma. "),h("li",null,"Use alphameric characters.")],-1)])),_:1})]),_:1},8,["show"])])]),default:t(()=>[h("span",{innerHTML:L.$t("editAcceptTypes")},null,8,Ys)]),_:1},8,["show"])):pe("",!0)]),_:1})]),_:1})])]),h("input",{ref_key:"fileinput",ref:A,onInput:G,onCancel:Q,type:"file",multiple:"",accept:e(d),style:{display:"none"}},null,40,Qs),h("input",{ref_key:"folderinput",ref:H,webkitdirectory:"",directory:"",onInput:G,onCancel:Q,type:"file",style:{display:"none"}},null,544)],64)}}}),Js=He(Xs,[["__scopeId","data-v-946de019"]]),ei={style:{"white-space":"nowrap"}},ti=xe({__name:"settings-output",props:{quality:{},format:{}},emits:["update:format","update:quality"],setup(s,{emit:u}){const r=s,f=u,{t:o}=Ve(),l=Je(Ke),g=y([]),p=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],b=ze({get:()=>r.format,set:x=>{x=m(x),f("update:format",x)}}),_=ze({get:()=>r.quality,set:x=>{f("update:quality",x)}}),w=ze(()=>/png|bmp/i.test(b.value)),k=y(null);Re(()=>{d()});function m(x){return g.value.indexOf(x)<0&&(x=g.value[0]),x}function d(){for(const x of p)k.value.toDataURL(x).indexOf(x)>=0&&g.value.push(x);g.value.length===0&&g.value.push(p[0])}return(x,F)=>{const T=_e,E=Lt,M=Fe,A=ke,H=St,j=xn;return O(),ne(Ee,null,[n(M,{justify:"center",class:"body"},{default:t(()=>[n(M,{vertical:""},{default:t(()=>[n(A,{to:!1,"display-directive":"show",show:e(l).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(l).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(M,{align:"center",wrap:!1},{default:t(()=>[n(T,null,{default:t(()=>[n(e(zn))]),_:1}),I(c(e(o)("settings.imageType"))+": ",1),n(E,{value:b.value,"onUpdate:value":F[0]||(F[0]=v=>b.value=v),options:g.value.map(v=>({value:v,label:v})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:t(()=>[I(" "+c(e(o)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(A,{to:!1,"display-directive":"show",show:e(l).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(l).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(M,{align:"center"},{default:t(()=>[n(M,{align:"start",wrap:!1},{default:t(()=>[n(T,null,{default:t(()=>[n(e(kn))]),_:1}),h("span",ei,c(e(o)("settings.quality"))+":",1),n(M,{align:"center",justify:"space-between"},{default:t(()=>[n(H,{tooltip:!1,value:_.value,"onUpdate:value":F[1]||(F[1]=v=>_.value=v),step:1,style:{width:"120px"},disabled:w.value},null,8,["value","disabled"]),n(j,{onBlur:F[2]||(F[2]=v=>_.value??(_.value=0)),value:_.value,"onUpdate:value":F[3]||(F[3]=v=>_.value=v),step:"1",min:"0",max:"100",disabled:w.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:t(()=>[I(" "+c(e(o)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1})]),_:1}),h("canvas",{ref_key:"canvas",ref:k,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),ni=He(ti,[["__scopeId","data-v-060333f5"]]),oi={style:{width:"4em","text-align":"left"}},ai={style:{width:"4em","text-align":"left"}},Ft=100,sn=2e3,rn=4096,un=4096,li=100,si=100,ii=xe({__name:"settings-adv",props:{expanded:{type:Boolean,required:!1},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}},emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(s){const u={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},r=$e(s,"expanded"),f=$e(s,"multithread"),o=$e(s,"threadCount"),l=$e(s,"maxZipSize"),g=$e(s,"retainExt"),p=$e(s,"useFolderNameForZip"),b=$e(s,"shrinkImage"),_=$e(s,"maxWidth"),w=$e(s,"maxHeight");we(Ue,m=>{m>1||(f.value=!1),o.value>m&&(o.value=m)},{immediate:!0});const k=ze(()=>f.value&&Ue.value>1);return Re(()=>{Ue.value>1&&typeof o.value>"u"&&(o.value=Math.max(Ue.value,2))}),(m,d)=>{const x=_e,F=Ce,T=$a,E=Fe,M=St,A=xn,H=Bt,j=bn;return O(),oe(E,{justify:"center"},{default:t(()=>[n(j,{"display-directive":"show","default-expanded-names":r.value?["collapitem"]:"","on-update:expanded-names":v=>r.value=!!String(v),"trigger-areas":["arrow","main"],class:ot(["settings-body",r.value?"expand-adv-settings":""])},La({arrow:t(()=>[n(x,{style:se(r.value&&{top:"8px"})},{default:t(()=>[n(e(Oa))]),_:1},8,["style"]),n(x,null,{default:t(()=>[n(e(Pa))]),_:1})]),default:t(()=>[n(H,{title:m.$t("settings.advancedSettings"),name:"collapitem"},{default:t(()=>[n(E,{vertical:"",style:{"padding-left":"2em"}},{default:t(()=>[n(e(ke),it(rt(u)),{trigger:t(()=>[n(E,{vertical:""},{default:t(()=>[n(E,{wrap:!1,align:"center"},{default:t(()=>[n(F,{text:"",disabled:!e(Ue),style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:d[0]||(d[0]=v=>f.value=!f.value)},{icon:t(()=>[n(x,null,{default:t(()=>[n(e(Ca))]),_:1})]),default:t(()=>[I(" "+c(m.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(T,{value:f.value,"onUpdate:value":d[1]||(d[1]=v=>f.value=v),disabled:!e(Ue),size:"small"},null,8,["value","disabled"])]),_:1}),n(E,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(M,{value:o.value,"onUpdate:value":d[2]||(d[2]=v=>o.value=v),disabled:!e(Ue)||!f.value,step:1,min:2,max:e(Ue),style:{width:"120px"}},null,8,["value","disabled","max"]),n(A,{onBlur:d[3]||(d[3]=v=>o.value??(o.value=2)),size:"tiny",value:o.value,"onUpdate:value":d[4]||(d[4]=v=>o.value=v),disabled:!e(Ue)||!f.value,step:1,min:2,max:e(Ue),style:{width:"10em"}},{suffix:t(()=>[I(c(m.$t("threads",o.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[I(" "+c(m.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(e(ke),it(rt(u)),{trigger:t(()=>[n(E,{vertical:""},{default:t(()=>[n(E,{wrap:!1,align:"center"},{default:t(()=>[n(F,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:t(()=>[n(x,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Ea))]),_:1})]),default:t(()=>[I(" "+c(m.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(E,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(M,{tooltip:!1,value:l.value,"onUpdate:value":d[5]||(d[5]=v=>l.value=v),step:1,min:Ft,max:sn,style:{width:"120px"}},null,8,["value"]),n(A,{onBlur:d[6]||(d[6]=v=>l.value??(l.value=Ft)),size:"tiny",value:l.value,"onUpdate:value":d[7]||(d[7]=v=>l.value=v),step:"1",min:Ft,max:sn,style:{width:"10em"}},{suffix:t(()=>d[20]||(d[20]=[I("(MB)")])),_:1},8,["value"])]),_:1})]),_:1})]),default:t(()=>[I(" "+c(m.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(e(ke),it(rt(u)),{trigger:t(()=>[n(E,{wrap:!1,align:"center"},{default:t(()=>[n(F,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:d[8]||(d[8]=v=>p.value=!p.value)},{icon:t(()=>[n(x,null,{default:t(()=>[n(e(Dt))]),_:1})]),default:t(()=>[I(" "+c(m.$t("settings.useFolderNameForZip")),1)]),_:1}),n(T,{value:p.value,"onUpdate:value":d[9]||(d[9]=v=>p.value=v),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[I(" "+c(m.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(e(ke),it(rt(u)),{trigger:t(()=>[n(E,{wrap:!1,align:"center"},{default:t(()=>[n(F,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:d[10]||(d[10]=v=>g.value=!g.value)},{icon:t(()=>[n(x,null,{default:t(()=>[n(e(yn))]),_:1})]),default:t(()=>[I(" "+c(m.$t("settings.retainOriginalExtension")),1)]),_:1}),n(T,{value:g.value,"onUpdate:value":d[11]||(d[11]=v=>g.value=v),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[I(" "+c(m.$t("settings.retainExtTooltip")),1)]),_:1},16),n(e(ke),it(rt(u)),{trigger:t(()=>[n(E,{vertical:""},{default:t(()=>[n(E,{wrap:!1,align:"center"},{default:t(()=>[n(F,{disabled:!k.value,text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:d[12]||(d[12]=v=>b.value=!b.value)},{icon:t(()=>[n(x,null,{default:t(()=>[n(e(Fa))]),_:1})]),default:t(()=>[I(" "+c(m.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(T,{disabled:!k.value,value:b.value,"onUpdate:value":d[13]||(d[13]=v=>b.value=v),size:"small"},null,8,["disabled","value"])]),_:1}),n(E,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(M,{value:_.value,"onUpdate:value":d[14]||(d[14]=v=>_.value=v),disabled:!b.value||!k.value,step:1,min:li,max:rn,style:{width:"120px"}},null,8,["value","disabled"]),n(A,{size:"tiny",onBlur:d[15]||(d[15]=v=>_.value??(_.value=8)),value:_.value,"onUpdate:value":d[16]||(d[16]=v=>_.value=v),disabled:!b.value||!k.value,step:1,min:8,max:rn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[h("span",oi,c(m.$t("width")),1)]),suffix:t(()=>d[21]||(d[21]=[I("px")])),_:1},8,["value","disabled","max"])]),_:1}),n(E,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(M,{value:w.value,"onUpdate:value":d[17]||(d[17]=v=>w.value=v),disabled:!b.value||!k.value,step:1,min:si,max:un,style:{width:"120px"}},null,8,["value","disabled"]),n(A,{size:"tiny",onBlur:d[18]||(d[18]=v=>w.value??(w.value=8)),value:w.value,"onUpdate:value":d[19]||(d[19]=v=>w.value=v),disabled:!b.value||!k.value,step:1,min:8,max:un*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[h("span",ai,c(m.$t("height")),1)]),suffix:t(()=>d[22]||(d[22]=[I("px")])),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[I(" "+c(m.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1},8,["title"])]),_:2},[r.value?{name:"header-extra",fn:t(()=>[n(e(ke),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(F,{onClick:e(Ka),size:"tiny",style:{"font-size":"xx-small"}},{default:t(()=>[I(c(m.$t("reset")),1)]),_:1},8,["onClick"])]),default:t(()=>[I(" "+c(m.$t("settings.resetButtonTooltip")),1)]),_:1})]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1})}}}),ri=He(ii,[["__scopeId","data-v-661ec94b"]]),ui={},di={style:{color:"gray","padding-left":"20px"}},ci=["innerHTML"];function pi(s,u){const r=gn,f=Fe;return O(),oe(f,{vertical:"",justify:"end"},{default:t(()=>[n(r,{style:{margin:"0px"}}),n(f,{justify:"center"},{default:t(()=>[h("ul",di,[(O(!0),ne(Ee,null,ct(s.$tm("descriptions"),o=>(O(),ne("li",{key:o,style:{"text-align":"left"},innerHTML:o},null,8,ci))),128))])]),_:1})]),_:1})}const fi=He(ui,[["render",pi]]),gi="modulepreload",mi=function(s){return"/avif2jpeg/dist/"+s},dn={},he=function(u,r,f){let o=Promise.resolve();if(r&&r.length>0){let g=function(_){return Promise.all(_.map(w=>Promise.resolve(w).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),b=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));o=g(r.map(_=>{if(_=mi(_),_ in dn)return;dn[_]=!0;const w=_.endsWith(".css"),k=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${k}`))return;const m=document.createElement("link");if(m.rel=w?"stylesheet":gi,w||(m.as="script"),m.crossOrigin="",m.href=_,b&&m.setAttribute("nonce",b),document.head.appendChild(m),w)return new Promise((d,x)=>{m.addEventListener("load",d),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return o.then(g=>{for(const p of g||[])p.status==="rejected"&&l(p.reason);return u().catch(l)})},On="English",Pn="🇬🇧",Un='AVIF to JPEG "Offline" Batch Converter',Mn="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",Rn="Drag & Drop AVIF Images to Convert",Nn=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.'],jn="Select your language",Bn="Choose Target File Extentions",Dn={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},Zn="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",Vn="Load Images",Hn="Select your images from a dialog window.<br>*Multiple selection allowed.",Wn="Load a Whole Folder",qn=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,Gn="Converting images",Kn="Aborted",Yn="Some files failed to convert",Qn="Completed",Xn="Currently Busy",Jn="No files with the extentions were found.",eo="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",to="Cancel",no="Save",oo="Close",ao="Open",lo="Re-convert",so="Convert previous selected {n} @:files again",io="File | Files",ro="thread | threads",uo="You have not saved the converted images yet.",co="Data have not been saved",po="Open Source",fo="Open the converted image",go="Copied to clipboard",mo="The converted image was copied to your clipboard as DataURL.",vo="Copy the converted image as DataURL",ho="Convert Again",_o={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",showOnlyErrors:"Show only errors",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files",Shrinked:"Shrinked",Shrinking:"Shrinking",saveAll:"Save All",progressRetries:"Retrying files",success:"success",started:"started",total:"total",files:"files",failure:"failure",all:"all",filterLogSelect:"filter",showOnlySuccess:"Only successes",showOnlyError:"Only errors",showAll:"Show all",Progress:"Progress",PreviewImage:"Preview Images",Log:"Log",log:"Log",Output:"Output Results",expandLog:"expand log size",autoScroll:"auto-scroll",sortByStatus:"status",sort:"Sort list by",sortByName:"name",sortBySize:"size",sortByOutputSize:"size(output)",sortByStart:"starting order",sortByCompletion:"output order"},wo={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file"},yo="Disabled",bo="Download",ko="Reset",zo="Back",xo="Failed",Io="Success",Ao="Previous version",To=`
Height`,So="Width",Lo="Don't show this message again",Co="About the warning when selecting a folder",$o="OK",Eo={},Fo="You must press the “Upload” button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",Oo="Continue",Po="Cancel",Uo="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",Mo="This page may be an outdated version. Please reload the page.",Ro="Reload",No='If the conversion process frequently fails and an “Out of Memory” message appears, try reducing or disabling the number of "multi-threads" in the "Advanced Settings".',jo="Next",Bo="Previous",Do="or",Zo="Target File Extensions",Vo={lang:On,flags:Pn,title:Un,metaDescription:Mn,droptarget:Rn,descriptions:Nn,selectLanguage:jn,fileTypeRadioTitle:Bn,fileTypeRadioOptions:Dn,editAcceptTypes:Zn,loadbutton:Vn,loadbuttontooltip:Hn,loadfolderbutton:Wn,loadfoldertooltip:qn,processing:Gn,aborted:Kn,incomplete:Yn,completed:Qn,interfered:Xn,noimage:Jn,avifUnsupported:eo,cancel:to,save:no,close:oo,open:ao,reconvert:lo,reconvertTip:so,files:io,threads:ro,confirmCloseDialog:uo,confirmCloseDialogTitle:co,githubOpenSource:po,convertedImageUrlTooltip:fo,copiedDataURLDialogTitle:go,copiedDataURLMessage:mo,convertedImageDataUrlTooltip:vo,convertAgain:ho,status:_o,settings:wo,disabled:yo,Download:bo,reset:ko,back:zo,failed:xo,success:Io,previousVersion:Ao,height:To,width:So,checkboxTextDontShowThis:Lo,loadfolderNotifyingTitle:Co,OK:$o,loadfolderNotifyingMessage:Eo,loadfolderNotifyingMessageTerm2:Fo,Continue:Oo,Cancel:Po,loadfolderNotifyingMessageTerm1:Uo,errMsgWorkerLoadError:Mo,Reload:Ro,annotationOutOfMemory:No,Next:jo,Prev:Bo,or:Do,TargetFileTypeExt:Zo},vi=Object.freeze(Object.defineProperty({__proto__:null,Cancel:Po,Continue:Oo,Download:bo,Next:jo,OK:$o,Prev:Bo,Reload:Ro,TargetFileTypeExt:Zo,aborted:Kn,annotationOutOfMemory:No,avifUnsupported:eo,back:zo,cancel:to,checkboxTextDontShowThis:Lo,close:oo,completed:Qn,confirmCloseDialog:uo,confirmCloseDialogTitle:co,convertAgain:ho,convertedImageDataUrlTooltip:vo,convertedImageUrlTooltip:fo,copiedDataURLDialogTitle:go,copiedDataURLMessage:mo,default:Vo,descriptions:Nn,disabled:yo,droptarget:Rn,editAcceptTypes:Zn,errMsgWorkerLoadError:Mo,failed:xo,fileTypeRadioOptions:Dn,fileTypeRadioTitle:Bn,files:io,flags:Pn,githubOpenSource:po,height:To,incomplete:Yn,interfered:Xn,lang:On,loadbutton:Vn,loadbuttontooltip:Hn,loadfolderNotifyingMessage:Eo,loadfolderNotifyingMessageTerm1:Uo,loadfolderNotifyingMessageTerm2:Fo,loadfolderNotifyingTitle:Co,loadfolderbutton:Wn,loadfoldertooltip:qn,metaDescription:Mn,noimage:Jn,open:ao,or:Do,previousVersion:Ao,processing:Gn,reconvert:lo,reconvertTip:so,reset:ko,save:no,selectLanguage:jn,settings:wo,status:_o,success:Io,threads:ro,title:Un,width:So},Symbol.toStringTag,{value:"Module"})),hi="Arabic",_i="German",wi="English",yi="Spanish",bi="Finnish",ki="French",zi="Hindi",xi="Indonesian",Ii="Italian",Ai="Japanese",Ti="Korean",Si="Dutch",Li="Polish",Ci="Portuguese",$i="Russian",Ei="Turkish",Fi="Ukrainian",Oi="Chinese",Pi={ar:hi,de:_i,en:wi,es:yi,fi:bi,fr:ki,hi:zi,id:xi,it:Ii,ja:Ai,ko:Ti,nl:Si,pl:Li,pt:Ci,ru:$i,tr:Ei,uk:Fi,"zh-hant":"Chinese(hant)",zh:Oi},zt=[],Ho={en:Vo},Ht={},cn=Object.assign({"./locales/ar.json":()=>he(()=>import("./ar-BgngyIMi.js"),[]),"./locales/de.json":()=>he(()=>import("./de-v3ueBOSV.js"),[]),"./locales/en.json":()=>he(()=>Promise.resolve().then(()=>vi),void 0),"./locales/es.json":()=>he(()=>import("./es-C2cGdukK.js"),[]),"./locales/fi.json":()=>he(()=>import("./fi-5ZrKH-Ih.js"),[]),"./locales/fr.json":()=>he(()=>import("./fr-B1KRO7gm.js"),[]),"./locales/hi.json":()=>he(()=>import("./hi-BYS3b9Xc.js"),[]),"./locales/id.json":()=>he(()=>import("./id-Bh86-Owa.js"),[]),"./locales/it.json":()=>he(()=>import("./it-3HgfLRdM.js"),[]),"./locales/ja.json":()=>he(()=>import("./ja-CUyuZYIl.js"),[]),"./locales/ko.json":()=>he(()=>import("./ko-DEvhJkq-.js"),[]),"./locales/nl.json":()=>he(()=>import("./nl-BVb671a3.js"),[]),"./locales/pl.json":()=>he(()=>import("./pl-CUezuRiL.js"),[]),"./locales/pt.json":()=>he(()=>import("./pt-Cuc_8V_q.js"),[]),"./locales/ru.json":()=>he(()=>import("./ru-CTFfZQm7.js"),[]),"./locales/tr.json":()=>he(()=>import("./tr-DsQozz3L.js"),[]),"./locales/uk.json":()=>he(()=>import("./uk-x1nsBL4Z.js"),[]),"./locales/zh-hant.json":()=>he(()=>import("./zh-hant-COM0_YJO.js"),[]),"./locales/zh.json":()=>he(()=>import("./zh-Dxq2FLYG.js"),[])});var pn;for(const s in cn){const u=(pn=s.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:pn[1];u&&(zt.push(u),!(u in Ho)&&(Ht[u]=cn[s]))}let Ut=Mi();Ut in Ht||(Ut="en");const xt=Ua({legacy:!1,globalInjection:!0,locale:Ut,fallbackLocale:"en",messages:Ho,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Ui(s){if(xt.global.availableLocales.indexOf(s)>=0)return;const u=await Ht[s]();xt.global.setLocaleMessage(s,u),await Te()}function Mi(){const s=location.pathname;return String(s.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Ri=["innerHTML"],Ni=xe({__name:"switch-lang",props:{delay:{}},emits:["lang-ready","lang-change"],async setup(s,{emit:u}){let r,f;const o=Je(Ke),l=mn(),{locale:g,t:p}=Ve(),b=s,_=u,w=Object.entries(Pi).map(([T,E])=>({label:E,value:T}));w.sort((T,E)=>{const M=T.label,A=E.label;return M>A?1:M<A?-1:0}),Re(()=>{l.afterEach((T,E,M)=>{m(),o.switchToolTipVisibility()})}),[r,f]=Ma(()=>m()),await r,f();async function k(T){(T!==g.value||xt.global.availableLocales.indexOf(T)===-1)&&(_("lang-change",T),await Sl(b.delay),await Ui(T),g.value=T,document.title=p("title"),await Te()),_("lang-ready",T)}async function m(){const T=l.currentRoute.value.path||"",E=String(T.match(new RegExp("(?<=^\\/)[^/]+"))||"");E&&zt.includes(E)?(await k(E),g.value=E):await d()}async function d(){const T=x().toLowerCase(),E=T.split(/[-_]/)[0];if(zt.includes(E)){let M=E;if(E==="zh")switch(T){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":M="zh-hant"}await k(M)}}function x(){const T=window.navigator;return T.language||T.userLanguage||T.browserLanguage}function F(T){console.log(`changeRoute: ${l.currentRoute.value.fullPath} => ${T}`),l.push("/"+T+"/")}return(T,E)=>{const M=_e,A=Lt,H=ke;return O(),oe(H,{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(o).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:t(()=>[n(A,{ref:"langselect",size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,options:e(w),"_v-model:value":"locale",value:e(g),"onUpdate:value":F},{arrow:t(()=>[n(M,null,{default:t(()=>[n(e(Ra))]),_:1})]),_:1},8,["options","value"])]),default:t(()=>[h("div",{innerHTML:T.$t("selectLanguage")},null,8,Ri)]),_:1},8,["show","placement"])}}}),Ke=Symbol("global variables"),ji=xe({__name:"Avif2Jpeg",emits:["ready"],setup(s,{emit:u}){const{t:r,locale:f}=Ve(),o=200,l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),g=y(null);y(0);let p=y(void 0);const b=y(!0),_=y(!1),w=y(!1),k=y(!1),m=y(!0),d=y(!1);Ba(Ke,{showTooltipsBeforeMounted:p,LANDSCAPE:b,IS_SP:l,switchToolTipVisibility:E,SSR:!1}),Re(()=>{M(),window.addEventListener("resize",M),E(),setTimeout(()=>w.value=!0,3e3)}),_t(()=>{window.removeEventListener("resize",M)});let x=0;function F(){k.value=!1,x=Date.now()}function T(){const j=m.value?0:Math.max(0,o-(Date.now()-x));m.value=!1,Te(()=>{setTimeout(()=>k.value=!0,j)})}async function E(){}function M(){const j=document.body.clientWidth,v=document.body.clientHeight;b.value=j*.75>v||j>900}function A(j){g.value=j}function H(j){d.value=j}return(j,v)=>{const Q=Fe,G=_e,fe=et;return O(),oe(Q,{vertical:"",align:"stretch",class:"avif2jpeg"},{default:t(()=>[n(sl,null,{"lang-switch":t(()=>[(O(),oe(Na,null,{default:t(()=>[n(Ni,{onLangChange:F,onLangReady:T,delay:e(m)?0:o},null,8,["delay"])]),_:1}))]),_:1}),n(Xe,{name:"fade"},{default:t(()=>[je(n(Q,{vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:t(()=>[n(Q,{justify:"space-around",vertical:"",style:{height:"100%"}},{default:t(()=>[n(rl),n(Q,{justify:"center"},{default:t(()=>[n(Js,{"_v-model:expanded":"UserSettings.expandExtButtons",target:e(W).acceptTypeValue,"onUpdate:target":v[0]||(v[0]=P=>e(W).acceptTypeValue=P),userExtensions:e(W).editedAcceptTypes,"onUpdate:userExtensions":v[1]||(v[1]=P=>e(W).editedAcceptTypes=P),"disable-notifying-folder-select":e(W).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":v[2]||(v[2]=P=>e(W).disableNotifyingFolderSelect=P),forbidden:e(_),onInput:A,onClick:v[3]||(v[3]=P=>H(!0)),onCancel:v[4]||(v[4]=P=>H(!1))},null,8,["target","userExtensions","disable-notifying-folder-select","forbidden"])]),_:1}),n(Os,{input:e(g),format:e(W).imageFormat,quality:e(W).imageQuality,"retain-extension":e(W).retainExtension,maxZipSizeMB:e(W).maxZipSizeMB,threads:e(W).multithread?e(W).threadCount:0,"show-note":e(d),"onUpdate:showNote":v[5]||(v[5]=P=>De(d)?d.value=P:null),onStart:v[6]||(v[6]=P=>_.value=!0),onEnd:v[7]||(v[7]=P=>_.value=!1),"_:multi-thread-count":"val => availableThreadCount = val"},{"lang-switch":t(()=>v[18]||(v[18]=[])),_:1},8,["input","format","quality","retain-extension","maxZipSizeMB","threads","show-note"]),n(Q,{vertical:"",align:"center"},{default:t(()=>[n(fe,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(G,{size:"5vh",color:"#DADADA",style:{margin:"0px"}},{default:t(()=>[n(e(ja))]),_:1})]),default:t(()=>[v[19]||(v[19]=h("span",null,"CONVERT TO👇",-1))]),_:1})]),_:1}),n(Q,{vertical:"",align:"center"},{default:t(()=>[n(ni,{format:e(W).imageFormat,"onUpdate:format":v[8]||(v[8]=P=>e(W).imageFormat=P),quality:e(W).imageQuality,"onUpdate:quality":v[9]||(v[9]=P=>e(W).imageQuality=P)},null,8,["format","quality"]),n(ri,{"retain-ext":e(W).retainExtension,"onUpdate:retainExt":v[10]||(v[10]=P=>e(W).retainExtension=P),"use-folder-name-for-zip":e(W).useFolderNameForZip,"onUpdate:useFolderNameForZip":v[11]||(v[11]=P=>e(W).useFolderNameForZip=P),"max-zip-size":e(W).maxZipSizeMB,"onUpdate:maxZipSize":v[12]||(v[12]=P=>e(W).maxZipSizeMB=P),"_v-model:expanded":"UserSettings.expandAdvSettings",multithread:e(W).multithread,"onUpdate:multithread":v[13]||(v[13]=P=>e(W).multithread=P),"thread-count":e(W).threadCount,"onUpdate:threadCount":v[14]||(v[14]=P=>e(W).threadCount=P),"_:thread-max":"availableThreadCount","shrink-image":e(W).shrinkImage,"onUpdate:shrinkImage":v[15]||(v[15]=P=>e(W).shrinkImage=P),"max-width":e(W).maxWidth,"onUpdate:maxWidth":v[16]||(v[16]=P=>e(W).maxWidth=P),"max-height":e(W).maxHeight,"onUpdate:maxHeight":v[17]||(v[17]=P=>e(W).maxHeight=P)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","multithread","thread-count","shrink-image","max-width","max-height"])]),_:1}),n(fi)]),_:1})]),_:1},512),[[Be,e(k)]])]),_:1})]),_:1})}}}),Wt=xe({__name:"App",setup(s){const u={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{},Image:{toolbarColor:"#00000099"}},r=y(!0);return Re(()=>{r.value=!1}),(f,o)=>{const l=Ha,g=Va,p=Za,b=Da,_=Wa;return O(),oe(_,{"theme-overrides":u,style:{width:"100%",height:"100%"}},{default:t(()=>[n(b,null,{default:t(()=>[n(p,{placement:"top-left",closable:!0,max:50},{default:t(()=>[n(g,null,{default:t(()=>[n(l,null,{default:t(()=>[n(ji,{class:ot({hide:e(r)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),Wo=[{path:"/",name:"Home",component:Wt}];for(const s of zt)Wo.push({path:"/"+s+"/",strict:!0,name:s,component:Wt});qa(Wt,{routes:Wo,base:"/avif2jpeg/dist/"},({app:s,router:u,routes:r,isClient:f,initialState:o})=>{s.use(xt)});
