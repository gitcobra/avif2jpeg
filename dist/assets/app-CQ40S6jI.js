var na=Object.defineProperty;var oa=(i,s,r)=>s in i?na(i,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[s]=r;var nt=(i,s,r)=>oa(i,typeof s!="symbol"?s+"":s,r);import{r as b,a as It,d as ye,i as Qe,c as J,o as E,_ as ze,u as e,w as t,b as T,t as c,e as y,f as n,g as Ae,N as he,L as aa,h as la,j as Q,k as Re,l as Xe,m as ee,n as sa,p as ia,q as ra,s as ce,v as fn,x as gn,y as mn,z as xe,A as we,B as Ce,C as Ut,D as Mt,E as We,F as Ke,G as ua,H as ca,I as Ze,J as Tt,K as ue,M as Je,T as et,O as vn,P as He,Q as Dt,R as At,S as Nt,U as ot,V as ht,W as da,X as Pe,Y as at,Z as pa,$ as Xt,a0 as Jt,a1 as hn,a2 as fa,a3 as St,a4 as ga,a5 as ma,a6 as jt,a7 as va,a8 as en,a9 as Lt,aa as ha,ab as Me,ac as _n,ad as _a,ae as wa,af as lt,ag as Ee,ah as ya,ai as _t,aj as Ct,ak as ba,al as Ve,am as ka,an as wn,ao as yn,ap as za,aq as bn,ar as tn,as as kn,at as xa,au as Ia,av as Ta,aw as Aa,ax as Sa,ay as zn,az as La,aA as Bt,aB as xn,aC as Ca,aD as $a,aE as In,aF as Ea,aG as it,aH as rt,aI as Pa,aJ as Fa,aK as Oa,aL as Ua,aM as Ma,aN as Ra,aO as Da,aP as Na,aQ as ja,aR as Ba,aS as Za,aT as Ha,aU as Va,aV as Wa,aW as qa,aX as Ga,aY as Ka,aZ as Ya}from"./vendor-BgheHLCn.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))u(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const p of l.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&u(p)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function u(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();const Ue=b(navigator.hardwareConcurrency?Math.min(navigator.hardwareConcurrency,12):0),ut={threadCount:{min:2,max:Math.max(2,Ue.value)}},Qa={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:Ue.value,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1,changeLogCheckedDate:0},W=It(Tn({}));function Xa(){Tn(W)}function Tn(i){return Object.assign(i,Qa)}const An="avif2jpeg",Et=JSON.parse(localStorage.getItem(An)||"{}");for(const i in W)if(Et.hasOwnProperty(i)&&Et[i]!==void 0){let s=Et[i];ut.hasOwnProperty(i)&&(ut[i].min>s&&(s=ut[i].min),ut[i].max<s&&(s=ut[i].max)),W[i]=s}const Sn=()=>{const i={};for(const s in W)i[s]=W[s];localStorage.setItem(An,JSON.stringify(i))};window.addEventListener("beforeunload",Sn);function Ja(){localStorage.clear(),window.removeEventListener("beforeunload",Sn)}const el={href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-weight":"bolder"}},tl=ye({__name:"github",setup(i){const s=Qe(qe);return(r,u)=>{const o=he,l=Ae,p=ze;return E(),J(p,{to:!1,"display-directive":"show",show:e(s).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",el,[n(l,{align:"center",size:0},{default:t(()=>[n(o,{size:"1.2em"},{default:t(()=>[n(e(aa))]),_:1}),u[0]||(u[0]=T("GitHub "))]),_:1})])]),default:t(()=>[T(" "+c(r.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),nl=1,ol=10,al=17,ll="",gt={major:nl,minor:ol,build:al,tag:ll},sl={style:{"font-size":"x-small","user-select":"none"}},il=ye({__name:"version",setup(i){const s=["0.0.118"],r=`${gt.major}.${gt.minor}.${gt.build}${gt.tag}`,u=s.map(d=>({label:`v${d}`,key:d,value:d}));function o(d){const{key:z,label:m}=d,w=p(z),k=Q("a",{href:w},m),h=Q("div",null,k);return Q("div",null,h)}function l(d){location.href=p(d)}function p(d){return`/avif2jpeg/old/${d}/`}return(d,z)=>{const m=la;return E(),J(m,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:e(u),"render-label":o,"onUpdate:value":l},{header:t(()=>[y("span",sl,c(d.$t("previousVersion")),1)]),default:t(()=>[y("span",{style:{cursor:"pointer"}},"v"+c(r))]),_:1},8,["options"])}}}),rl={key:0,style:{color:"red"}},ul=["innerHTML"],cl=ye({__name:"changelog",props:{url:{}},setup(i){const s=i,r=b("fetching..."),u=b(!1);Re(()=>l(s.url));let o=0;async function l(d){const z=await fetch(d,{headers:{Accept:"application/vnd.github.v3+json"}}).then(m=>m.ok?m.text():null);r.value="",z&&(console.log(z),r.value=z.replace(/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2}) \+\d+$/mg,(m,w)=>{const k=new Date(m),h=k.getTime(),v=k.toLocaleString();let f="";return h>W.changeLogCheckedDate&&(u.value=!0,h>o&&(o=h),f="update"),`<span class="date ${f}">${v}</span>`}))}function p(){W.changeLogCheckedDate=o,u.value=!1}return(d,z)=>{const m=he,w=Ae,k=Xe;return E(),J(k,{trigger:"click",placement:"bottom","arrow-point-to-center":"","onUpdate:show":p,style:{"margin-left":"-1em","max-width":"80%","white-space":"initial"}},{trigger:t(()=>[n(w,{align:"center",size:1,style:{cursor:"pointer"}},{default:t(()=>[n(m,{component:e(sa),size:"1.5em",color:e(u)?"blue":"silver",style:{transition:"color 0.5s"}},null,8,["component","color"]),T(" "+c(d.$t("changelog")),1)]),_:1})]),default:t(()=>[e(r)?(E(),ee("pre",{key:1,innerHTML:e(r),class:"commits"},null,8,ul)):(E(),ee("div",rl," connection error "))]),_:1})}}}),dl=ye({__name:"header",setup(i){const s=ia();return(r,u)=>{const o=ra("router-link"),l=Ae,p=gn;return E(),J(l,{vertical:"",justify:"start"},{default:t(()=>[n(l,{justify:"space-between",align:"center",wrap:!1},{default:t(()=>[n(l,{align:"center"},{default:t(()=>[n(tl),n(cl,{url:"/avif2jpeg/dist/commits.txt"}),n(il),n(l,{style:{"font-size":"1em"}},{default:t(()=>[e(s).path!=="/"?(E(),J(o,{key:0,to:"/",style:{color:"black"}},{default:t(()=>u[0]||(u[0]=[T("HOME")])),_:1})):ce("",!0)]),_:1})]),_:1}),n(l,{align:"end"},{default:t(()=>[fn(r.$slots,"lang-switch")]),_:3})]),_:3}),n(p,{style:{margin:"0px"}})]),_:3})}}}),pl={style:{padding:"0px",margin:"0px","text-align":"center"}},fl=ye({__name:"title",setup(i){const s=mn();return xe(()=>{const r=s.currentRoute.value.path||"";return!String(r.match(new RegExp("(?<=^\\/)[^/]+"))||"")}),(r,u)=>{const o=Ae;return E(),J(o,{align:"center",justify:"center",style:{margin:"0px"}},{default:t(()=>[y("h1",pl,c(r.$t("title")),1)]),_:1})}}}),nn=new Set,gl=new Set,ml=new Set,wt=new Map;function vl(i){const s=wt.get(i);if(!s){console.warn("the worker was already released.",i.id);return}wt.delete(i),s(),mt==null||mt(),mt=null}function hl(){for(const i of wt.keys())vl(i)}let mt=null;function Ln(){hl();for(const i of nn)i.onmessage=null,i.terminate();nn.clear(),gl.clear(),ml.clear(),wt.clear()}function _l(i){return new Worker("/avif2jpeg/dist/assets/worker.zip-BpG-kYFu.js",{name:i==null?void 0:i.name})}function wl(i){return new Worker("/avif2jpeg/dist/assets/worker.loader-hdSA9Vyi.js",{name:i==null?void 0:i.name})}const yl=1e3*10;let Ye;const De=new Map,yt=new Map,bt=new Map;let Zt,X,Ht,kt,vt,Cn,$n,En,Pn,dt;function Pt(i){if({files:vt,completedFileIdSet:Zt,ConvStats:X,canceled:Ht,props:kt,format:Cn,quality:$n,outputExt:En,imageType:Pn,message:dt}=i||{},Ye=null,De.clear(),yt.clear(),bt.clear(),yt.clear(),bt.clear(),i)for(const r in i)delete i[r]}async function bl(i){Pt(i),Zt.clear();let s;try{s=await kl()}catch{return Pt(),{exception:new Error("worker-load-error"),callbackToClearConverter:new Function,callbackToGenerateFailedZips:new Function}}const[r,u]=s;Ye=u;const o=new Promise(h=>{u.onmessage=v=>{const f=v.data,{action:P}=f;switch(P){case"squeeze-zip":case"zip-squeeze-error":h(void 0);break}}}),l=new Promise(h=>{r.onmessage=v=>{const{data:{action:f}}=v;f==="close-loader"&&h()}}),p=vt.map(h=>h._id);vt.forEach(h=>yt.set(h._id,h));const d=we(Ht,h=>{if(!h)return;d();const v={action:"cancel-convert"};r.postMessage(v)}),z={action:"start-convert",list:vt,fileIdList:p,outputQuality:$n,outputType:Cn,threads:kt.threads,maxSize:W.shrinkImage?{width:W.maxWidth,height:W.maxHeight}:null};r.postMessage(z),await l,console.log("end loader worker"),u.postMessage({action:"squeeze"}),await o,console.log("end zip worker"),d();const m=()=>{Ln(),u.onmessage=null,u.terminate(),r.onmessage=null,r.terminate(),Pt()};let w=!1;return{callbackToClearConverter:m,callbackToGenerateFailedZips:async h=>{w||(w=!0,await $l(h,u,{},X))}}}async function kl(){Ln();const i=new wl,s=new _l,r=new Promise((p,d)=>{const z=v=>{s.removeEventListener("message",k),i.removeEventListener("message",k),clearTimeout(h),v?(console.log("workers are avialble"),p(v)):(console.error("couldn't get responses from workers"),d(v))};let m=!1,w=!1;const k=v=>{v.target===s&&(console.log("got a message from zip worker"),m=!0),v.target===i&&(console.log("got a message from loader worker"),w=!0),m&&w&&z(!0)};let h=0;s.addEventListener("message",k),i.addEventListener("message",k),h=window.setTimeout(()=>z(!1),yl)}),{port1:u,port2:o}=new MessageChannel,l={action:"set-zip-port"};return s.postMessage({action:"set-port-loader"},[u]),i.postMessage(l,[o]),console.log("test workers' availability"),await r,s.postMessage({action:"set-config",zipSize:kt.maxZipSizeMB*1024*1024,keepExt:kt.retainExtension,outputExt:En,imageType:Pn}),i.addEventListener("message",xl),s.addEventListener("message",zl),[i,s]}const zl=i=>{const s=i.data,{action:r}=s;switch(r){case"add-zip-completed":{const{fileId:p,entireIndex:d,storedPath:z}=s;return}case"respond-image":{const{url:p,index:d,path:z,size:m,fileId:w}=s;X.convertedImageUrl=p,X.convertedImageSize=m,X.convertedImageIndex=d,X.convertedImageName=z;let k="",h=0,v="";const f=De.get(w);if(w>=0){const P=yt.get(w);k=URL.createObjectURL(P),h=P.size,v=P.webkitRelativePath||P.name}X.convertedImageOrgUrl=k,X.convertedImageOrgSize=h,X.convertedImageOrgName=v,X.convertedImageShrinked=f==null?void 0:f.shrinked;return}case"respond-delete":{const{index:p,success:d,fileId:z}=s;De.get(z).command="âŒdeleted",De.get(z).completed=!1;return}}switch(r){case"error-push-filelist-zip":const{path:p}=s;X.failedZipDone=!0,dt.error(`an error occurred "${p}"`,{duration:3e3});return}const{size:u,count:o}=s,l="url"in i.data?i.data.url:"";switch(r){case"push-zip":X.zips.push({url:l,size:u,count:o}),X.zippedTotalCount+=o,X.zippedTotalSize+=u;break;case"squeeze-zip":o>0&&(X.zips.push({url:l,size:u,count:o}),X.zippedTotalCount+=o,X.zippedTotalSize+=u);break;case"push-filelist":X.failedFileZippedCount++;break;case"squeeze-filelist-zip":X.failedZipDone=!0;case"push-filelist-zip":console.log("push-filelist-zip",o),X.failedZips.push({url:l,size:u,count:o}),console.log(o);break;case"zip-error":case"zip-squeeze-error":X.zippingErrorCount+=o;break}},xl=i=>{i.target;const{data:s}=i,{action:r}=s;switch(r){case"list-start":break;case"list-end":break;case"file-start":{const{index:u,path:o,fileId:l}=s;Tl(u,o,l);break}case"file-load":{const{thumbnail:u,width:o,height:l,fileId:p,workerId:d,inputsize:z}=s,m=De.get(p);m.core=d,m.command="ðŸ–¼ï¸loaded",m.width=o,m.height=l,m.size=z,u&&(X.thumbnail=u);break}case"file-converted":{const{index:u,path:o,fileId:l,shrinked:p,outputWidth:d,outputHeight:z,outputsize:m}=s,w=De.get(l);w.command="ðŸ”ƒconverted",w.shrinked??(w.shrinked=p),w.outputWidth=d,w.outputHeight=z,w.outputSize=m,X.converted++;break}case"file-completed":{const{inputsize:u,outputsize:o,fileId:l,entireIndex:p,storedPath:d}=s,z=De.get(l);z&&(z.command="âœ…completed",z.completed=!0,z.fileId=l),X.inputTotalSize+=u,X.outputTotalSize+=o,X.done++,X.success++,Zt.add(l),z.zippedIndex=p,X.ziplogs[p]={fileId:l,storedPath:d};break}case"file-retry":{const{index:u,path:o,fileId:l}=s;Al(u,o,l);break}case"file-error":{const{index:u,path:o,fileId:l}=s;Sl(u,o,l);break}case"file-canceled":{const{fileId:u,path:o}=s;Ll(u);break}}};let Il=0;function Tl(i,s,r){const u={key:Il++,core:-1,index:i,path:s,command:"âž¡ï¸started"};De.set(r,u),X.logs.push(u),bt.has(r)?console.warn(`retry "${s}".`):Ht.value||X.startedCount++}function Al(i,s,r){const u=De.get(r);u.command="âš ï¸retrying",u.error=!0,dt.warning(`retrying "${s}"`,{duration:3e3}),X.retried++,bt.set(r,1)}function Sl(i,s,r){console.error(`failed to load "${s}". the image may be corrupted or cannot be read by some reason.`);const u=De.get(r);X.done++,X.failure++,u.command="â—failed",u.error=!0,dt.error(`failed to load "${s}"`,{duration:5e3})}function Ll(i){const s=De.get(i);X.done++,X.failure++,s.command="â—canceled",s.error=!0}function Cl(i){Ye==null||Ye.postMessage({action:"request-image",index:i})}function Ft(i){Ye==null||Ye.postMessage({action:"delete-image",index:i})}async function $l(i,s,r,u){let o=0;for(const l of i){const p=(l.webkitRelativePath||l.name).replace(/^\//,"");if(u.failedZipDone)break;if(r.value)return;o-u.failedFileZippedCount>20&&await new Promise(d=>setTimeout(d,10)),s.postMessage({action:"add-filelist",file:l,path:p}),o++}if(u.failedZipDone){dt.error("Zipping error files was aborted",{duration:5e3});return}s.postMessage({action:"squeeze-filelist"})}function Ne(i,s=2){const r=Math.sign(i);i=Math.abs(i);const u=["Bytes","KB","MB","GB"],o=i?Math.floor(Math.log(i)/Math.log(1024)):0;return`${(i/Math.pow(1024,o)*r).toFixed(s)}${u[o]}`}function Fn(i,s=100,r=!1){s=typeof s=="number"?{width:s,height:s}:s;const{width:u,height:o}=s;let{width:l,height:p}=i;const d=l/p,z=u/o;return d>=z?(l=r?Math.min(u,l):u,p=l/d|0):(p=r?Math.min(o,p):o,l=p*d|0),{width:l,height:p}}class El{constructor(){nt(this,"_currentFileCount",0);nt(this,"_currentZipIndex",0);nt(this,"_totalFileCount",0);nt(this,"_zipLengthSumList",[]);nt(this,"_pathBank",{})}increase(s){return s&&(this._pathBank[s]=[this._zipLengthSumList.length,this._currentFileCount]),this._currentFileCount++,this._totalFileCount++}split(){this._zipLengthSumList.push(this._totalFileCount),this._currentZipIndex++,this._currentFileCount=0}get(s){if(typeof s=="number"){let r=this._zipLengthSumList.findIndex((l,p)=>s<l);r===-1&&(r=this._zipLengthSumList.length);const u=this._zipLengthSumList[r-1]||0,o=s-u;return[r,o]}else{const r=this._pathBank[String(s)];if(r)return r}return null}getZipIndex(){return this._currentZipIndex}getIndex(){return this._totalFileCount}}function Pl(i){return new Promise(s=>setTimeout(s,i))}function Fl(i,s=0){const r=b(i);return we(r,u=>{u!==void 0&&Ce(()=>{setTimeout(()=>r.value=void 0,s)})},{immediate:!0}),r}let ct;async function Ol(i,s,r,u,o){let l="";const p=document.createElement("canvas"),d=p.getContext("2d");let z=new Ut;const m=[z],w=new El,k=r.format,h=r.quality/100,v=[...k.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),f=i.length,P=r.maxZipSizeMB*1024*1024;let L=0,M=null,O="",I="",Z=0,q=0,j=0,_=0,H=0,ve=!1;ct=A=>{const[V,G]=w.get(A),se=m[V],pe=se.get(G,k);o.convertedImageIndex=A,o.convertedImageName=se.getPathByIndex(G),o.convertedImageUrl=URL.createObjectURL(pe),o.convertedImageSize=pe.size;let ae="",ie=0,Ie="";const ge=de[A];ae=URL.createObjectURL(ge),ie=ge.size,Ie=ge.webkitRelativePath||ge.name,o.convertedImageOrgUrl=ae,o.convertedImageOrgSize=ie,o.convertedImageOrgName=Ie};const de=[];for(const A of i){if(u.value)break;const V=A.name;let G="";const se=A.size,pe=(A.webkitRelativePath||A.relativePath||V).replace(/^\//,""),ae=document.createElement("img"),ie={key:j++,core:-1,index:L++,path:pe,command:"âž¡ï¸start"};o.startedCount=L,o.logs.push(ie),o.logs.length-1,l&&(URL.revokeObjectURL(l),l=""),l=URL.createObjectURL(A),I=l,Z=A.size,ae.src=l;const Ie=await On(ae).then(()=>!0).catch(()=>!1);if(!ae.complete||!Ie||u.value){o.done++,o.failure++,ie.command="â—failed";continue}const ge=ae.width,U=ae.height;p.width=ge,p.height=U,d.drawImage(ae,0,0,ge,U,0,0,ge,U),ie.command="ðŸ–¼ï¸imgload",ie.width=ge,ie.height=U,ie.size=A.size,o.thumbnail=ae;const F=await new Promise(ne=>{const re=ke=>{M=ke,ne(ke)};p.toBlob(re,k,h)});if(u.value)break;if(!F){console.log("failed to toBlob",V),o.failure++;continue}q=F.size,o.converted++,ie.outputSize=q;let K="";if(H+q>=P){try{await z.wait(),K=await z.url()}catch(ne){ve=!0,console.warn(ne.message,H),alert("memory problem occurred");break}o.zips.push({url:K,size:H,count:_}),o.zippedTotalCount+=_,o.zippedTotalSize+=H,H=0,_=0,w.split(),z=new Ut,m.push(z)}H+=q;const te=pe||V;for(let ne=1;ne<255&&(G=te.replace(r.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(ne>1?`(${ne})`:"")+"."+v,!!z.has(G));ne++);o.done++;try{_++,z.add(G,F)}catch(ne){console.error(ne.message);continue}w.increase(),de.push(A),o.inputTotalSize+=se,o.outputTotalSize+=q,o.ziplogs.push({fileId:A._id,storedPath:G}),O=G,ie.zippedIndex=o.success,o.success++,ie.command="âœ…completed",ie.completed=!0,ie.fileId=A._id,s.add(A._id)}if(o.success>0)if(f===1)M&&(o.convertedImageIndex=0,o.convertedImageName=O.replace(/^.*\/(?=[^/]+$)/,"").replace(r.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+v,o.convertedImageUrl=URL.createObjectURL(M),o.convertedImageOrgUrl=I,o.convertedImageOrgSize=Z);else try{if(ve)throw new Error("terminated zipping process for memory problems");await z.wait();const A=await z.url();o.zips.push({url:A,count:_,size:H}),o.zippedTotalCount+=_,o.zippedTotalSize+=H}catch(A){console.error(A.message)}const N={value:!1},be=()=>{N.value=!0,m.forEach(A=>A.clear()),m.length=0,de.length=0,ct=null};let Se=!1;return{callbackToClearConverter:be,callbackToGenerateFailedZips:async A=>{Se||(Se=!0,Ml(A,P,o,N))}}}function Ul(i){ct==null||ct(i)}async function Ml(i,s,r,u){let o=0,l=0,p=new Ut;for(let d=0;d<i.length;d++){const z=i[d],m=(z.webkitRelativePath||z.name).replace(/^\//,"");if(u.value)return;try{await p.add(m,z)}catch{alert(`an error occurred during access to "${m}"`);break}if(l+=z.size,o++,r.failedFileZippedCount++,l>=s||d===i.length-1){await p.zip();const w=await p.url();r.failedZips.push({url:w,size:l,count:o}),p.clear(),l=0,o=0}}r.failedZipDone=!0}function On(i){if(typeof i.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((s,r)=>{i.onload=s,i.onerror=r})}const je=(i,s)=>{const r=i.__vccOpts||i;for(const[u,o]of s)r[u]=o;return r},Rl={class:"container"},Dl={__name:"zipicon",setup(i){return(s,r)=>(E(),ee("span",Rl,[n(e(he),null,{default:t(()=>[n(e(Mt))]),_:1}),r[0]||(r[0]=y("span",{class:"text"},"ZIP",-1))]))}},Nl=je(Dl,[["__scopeId","data-v-8b8df2f0"]]),jl=["href","download","title"],Bl='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"/>',Zl=ye({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean},hidden:{type:Boolean}},emits:["load","error","next","prev"],setup(i,{expose:s,emit:r}){const{t:u}=We(),o=i,l=r,p=b();b();const d=b(!0),z=b(""),m=b(o.width||100),w=b(o.height||100),k=b(!1),h=It({width:m.value+"px",height:w.value+"px",minWidth:"50px",minHeight:"50px"});Ke(()=>{var I,Z,q;(Z=(I=p.value)==null?void 0:I.previewInstRef)==null||Z.setPreviewSrc(Bl),URL.revokeObjectURL((((q=p.value)==null?void 0:q.imageRef)||{}).src),p.value=null});const v=b(!0);ua(()=>{v.value=!1}),ca(()=>{v.value=!0}),we(o,(I,Z)=>{h.width=(o.width||100)+"px",h.height=(o.height||100)+"px"}),we(()=>o.src,(I,Z)=>{v.value&&L(I)},{immediate:!0}),s({download:M,openPreview:O,active:v});async function f(I){const Z=I.target,q=Z.naturalWidth,j=Z.naturalHeight,{width:_,height:H}=Fn({width:q,height:j},{width:o.maxWidth||100,height:o.maxHeight||100},o.expand);m.value=_,w.value=H,l("load",{src:Z.src,width:q,height:j}),d.value=!1,await new Promise(ve=>setTimeout(ve,100)),!d.value&&(k.value=!0)}function P(I){const Z=I.target;l("error",Z.src)}async function L(I){d.value=!0,k.value=!1,z.value=I,console.log("changeSrc:",z.value)}function M(){const I=document.createElement("a");I.href=z.value,I.download=o.fileName,I.click()}function O(){var I;(I=p.value)==null||I.click()}return(I,Z)=>{const q=vn,j=Dt,_=Ae,H=Tt;return Ze((E(),ee("div",null,[n(e(ze),null,{trigger:t(()=>[n(H,{show:e(d)||o.loading},{default:t(()=>[n(_,{justify:"center",align:"center",style:ue([e(h),{"line-height":"0px"}])},{default:t(()=>[y("a",{href:e(z),onClick:Z[0]||(Z[0]=Je(()=>{},["left","prevent"])),target:"_blank",download:o.fileName,title:o.fileName},[n(et,{mode:"in-out"},{default:t(()=>[Ze(n(q,{ref_key:"nImageRef",ref:p,"show-toolbar-tooltip":"",onLoad:f,onError:P,src:e(z),width:e(m),height:e(w),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[He,e(k)]])]),_:1})],8,jl),e(d)||o.loading?(E(),J(j,{key:0})):ce("",!0)]),_:1},8,["style"])]),_:1},8,["show"])]),default:t(()=>[T(" "+c(o.fileName),1)]),_:1})],512)),[[He,!I.hidden]])}}}),on=je(Zl,[["__scopeId","data-v-f1ec09c6"]]),Hl=["href","download","title"],Vl={class:"left-num"},Wl={class:"right-num"},ql=["href","download","title"],Gl={class:"left-num"},Kl={class:"right-num"},Yl=["href","download"],Ql=ye({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean},variousInfo:{}},emits:["demand-image","delete-image","close"],setup(i,{expose:s,emit:r}){const u=Qe(qe),o=i,l=r;s({download:U,cleanup:me,openPreview:Fe,isPreviewing(){return _.value},changeIndex($){v.value=$}});const p=At(),{t:d}=We();Nt();const z=b(),m=b(),w=b(),k=ot("viewerItemContainer"),h=b(!0),v=b(Math.max(o.index,0)+1),f=b(1),P=b(1),L=b(""),M=b(""),O=b(1),I=b(1),Z=b(!1),q=b(!1),j=b(!1),_=xe(()=>{var $,C;return(C=($=w.value)==null?void 0:$.previewInstRef)==null?void 0:C.displayed}),H=xe(()=>{var $,C;return((C=($=w==null?void 0:w.value)==null?void 0:$.previewInstRef)==null?void 0:C.previewSrc)===L.value}),ve=xe(()=>v.value<o.length),de=xe(()=>v.value>1),N=b("viewer-item-init"),be=b(0),Se=b(!0);b({width:"auto",height:"auto"});const $e=b(!1);Re(()=>{document.body.addEventListener("keydown",ie),document.body.addEventListener("keydown",ae),se(v.value-1),pe()}),Ke(()=>{clearTimeout(A),document.body.removeEventListener("keydown",ie),document.body.removeEventListener("keydown",ae),$e.value=!0}),ht(()=>{URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl)});let A=-1;we(v,($,C)=>{v.value<1||v.value>o.length||$===C||(clearTimeout(A),$>C?N.value="viewer-item-next":N.value="viewer-item-prev",A=setTimeout(()=>{o.index!==v.value-1&&(be.value=h.value?be.value:~be.value,Se.value=!1,se(v.value-1))},50))});let V="",G="";we(()=>o.url,()=>{var g,a;let $="";o.index===0&&h.value?(h.value=!1,v.value=1,$=o.url):o.index===v.value-1?(h.value=!1,Z.value=!1,$=o.url):(URL.revokeObjectURL(o.url),URL.revokeObjectURL(o.originalUrl));const C=V,Y=G;if(URL.revokeObjectURL(C),URL.revokeObjectURL(Y),V=o.url,G=o.originalUrl,$){try{if((a=(g=w.value)==null?void 0:g.previewInstRef)!=null&&a.displayed){H.value?w.value.previewInstRef.setPreviewSrc($):w.value.previewInstRef.setPreviewSrc(o.originalUrl);try{const S=w.value.previewInstRef.displayed;w.value.previewInstRef.handleAfterLeave(),w.value.previewInstRef.displayed=S}catch(S){console.error(S)}}}catch{}L.value=$,M.value=o.originalUrl}},{immediate:!0});function se($){Z.value=!0,q.value=!1,j.value=!1,Ce(()=>l("demand-image",$))}function pe(){if(!u.IS_SP)return;let $=k.value.$el,C=0,Y=0,g=0,a=0,S=0;const R=le=>{C=le.touches[0].pageX,Y=le.touches[0].pageY,S=Date.now()};$.addEventListener("touchstart",R);const D=le=>{g=le.touches[0].pageX,a=le.touches[0].pageY,oe()};window.addEventListener("touchmove",D);const x=()=>{oe();const le=g-C,Oe=Math.abs(le),tt=a-Y,st=Math.abs(tt);Oe<st||Oe<30||K(le>0?-1:1)};window.addEventListener("touchend",x);const oe=()=>{const le=Date.now();le-S>500&&(C=g,Y=a),S=le};Ke(()=>{$.removeEventListener("touchstart",R),window.removeEventListener("touchmove",D),window.removeEventListener("touchend",x),$=null})}function ae($){var C,Y,g,a;if($.key==="Escape")try{(Y=(C=w.value)==null?void 0:C.previewInstRef)!=null&&Y.displayed&&($.stopPropagation(),(a=(g=w.value)==null?void 0:g.previewInstRef)==null||a.toggleShow(!1))}catch{}}function ie($){switch($.code){case"ArrowRight":K(1);break;case"ArrowLeft":K(-1);break;case"Home":v.value=1;break;case"End":v.value=o.length;break;case"Space":case"Enter":case"NumpadEnter":if(!_.value)return;ne();break;case"ArrowUp":case"ArrowDown":default:return}$.stopPropagation(),$.preventDefault()}function Ie({width:$,height:C}){f.value=$,P.value=C,q.value=!0}function ge({width:$,height:C}){O.value=$,I.value=C,j.value=!0}function U(){H.value?z.value.download():m.value.download()}async function F($){try{const C=await fetch($).then(Y=>Y.blob()).then(Y=>new Promise(g=>{const a=new FileReader;a.onload=g,a.readAsDataURL(Y)})).then(Y=>Y.target.result);navigator.clipboard.writeText(C),p.info({title:d("copiedDataURLDialogTitle"),content:()=>Q("div",[Q("div",d("copiedDataURLMessage"))]),positiveText:"OK"})}catch(C){console.error(C),p.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function K($){$>0?v.value=Math.min(o.length,v.value+$)|0:$<0&&(v.value=Math.max(1,v.value+$)|0)}let te="";const ne=()=>{var C,Y,g,a;te=(g=window.getComputedStyle((Y=(C=w==null?void 0:w.value)==null?void 0:C.previewInstRef)==null?void 0:Y.previewRef))==null?void 0:g.transform;const $=H.value;(a=w==null?void 0:w.value)==null||a.next(),Ce(()=>{var S;H.value===$&&((S=w==null?void 0:w.value)==null||S.next())})};function re(){try{Ce(()=>w.value.previewInstRef.previewRef.style.transform=te)}catch{}}function ke({nodes:$}){const C=Q(jt,{color:H.value?"green":"gray",offset:[-20,-12],value:H.value?d("status.Converted"):d("status.Original")},()=>Q(Pe,{round:!0,onClick(){ne()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>Q(H.value?ga:ma)}));$.next=Q(Pe,{onClick(){K(1)},disabled:!ve.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>Q(Jt)}),$.prev=Q(Pe,{onClick(){K(-1)},disabled:!de.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>Q(va)});try{const Y=$.download.children;Y.default=()=>d("save");const g=Y.trigger();g.props.onClick=U,Y.trigger=()=>g}catch{}return fe(),[C,...Object.values($)]}const Le="#pathbox-"+String(Math.random()).substring(2);let Te;function fe(){var $,C,Y;try{if(Te=(Y=(C=($=w.value)==null?void 0:$.previewInstRef)==null?void 0:C.previewWrapperRef)==null?void 0:Y.parentNode,!Te||Te.querySelector(Le))return;let g=Q("div",{id:Le,onMousedown:a=>{a.stopPropagation()},className:"__preview-injected-pathbox"+(H.value?" converted":"")},[Q("div",`${String(v.value).padStart(String(o.length).length,"0")}/${String(o.length).padStart(String(o.length).length,"0")}`),Q("div",Ne(H.value?o.size:o.originalSize,0)),Q("div",H.value?o.name:o.originalName)]);en(g,Te),g=null}catch(g){console.error(g)}}Ke(()=>{Te&&(en(null,Te),Te=null)});function Fe(){z.value.openPreview()}function me(){}return($,C)=>{const Y=he,g=Ae,a=hn,S=Xe,R=St,D=da;return E(),J(g,{justify:"center",align:"stretch",vertical:"",style:ue([{visibility:h.value?"hidden":"visible"},{overflow:"visible"}]),class:"body",ref:"body"},{default:t(()=>[n(D,{ref_key:"nImageGroupRef",ref:w,"show-toolbar-tooltip":"","render-toolbar":ke,onPreviewNext:re},{default:t(()=>[n(g,{wrap:!1,align:"center",justify:"space-between",style:{overflow:"visible"}},{default:t(()=>[n(e(Pe),{onClick:C[0]||(C[0]=x=>K(-1)),bordered:!1,disabled:!e(de),class:at({"thumb-arrow":!0,pale:!e(de)}),title:$.$t("Prev")},{icon:t(()=>[n(Y,{size:"30"},{default:t(()=>[n(e(pa))]),_:1})]),_:1},8,["disabled","class","title"]),n(g,{justify:"center",ref_key:"viewerItemContainer",ref:k,class:"viewer-item-container",style:{width:"100%"}},{default:t(()=>[n(et,{name:N.value},{default:t(()=>[(E(),J(g,{vertical:"",key:be.value},{default:t(()=>[n(g,{align:"center",wrap:!1},{default:t(()=>[n(g,{vertical:""},{default:t(()=>[n(g,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(g,{align:"center",justify:"center",vertical:"",class:"original-thumb"},{default:t(()=>[y("a",{href:$.originalUrl,onClick:C[4]||(C[4]=Je(x=>{m.value.openPreview()},["prevent"])),download:$.originalName,title:$.originalName,class:"imglink"},[n(g,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(on,{ref:x=>{x!=null&&x.active&&(m.value=x)},src:M.value,width:1,"max-width":1,"max-height":1,loading:Z.value,"file-name":$.originalName,"allow-next":v.value<o.length,"allow-prev":v.value>1,onLoad:ge,onNext:C[1]||(C[1]=x=>K(1)),onPrev:C[2]||(C[2]=x=>K(-1)),hidden:!0},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(g,{vertical:"",align:"center"},{default:t(()=>[n(g,{class:"imglink-label"},{default:t(()=>[T(c(e(d)("status.Original")),1)]),_:1}),n(g,{justify:"center",class:"img-size",wrap:!1,size:2},{default:t(()=>[y("span",Vl,c(j.value?O.value:"?"),1),C[11]||(C[11]=T(" Ã— ")),y("span",Wl,c(j.value?I.value:"?"),1)]),_:1}),n(g,{justify:"center"},{default:t(()=>[C[3]||(Xt(-1,!0),(C[3]=n(g,null,{default:t(()=>[T(c(j.value?e(Ne)(o.originalSize,0):"?"),1)]),_:1})).cacheIndex=3,Xt(1),C[3])]),_:1})]),_:1})]),_:1})],8,Hl)]),_:1}),n(g,{vertical:"",align:"center",class:"original-thumb"},{default:t(()=>[n(Y,{size:"20",color:"silver",component:e(Jt)},null,8,["component"])]),_:1}),y("a",{href:L.value,onClick:C[5]||(C[5]=Je(x=>Fe(),["prevent"])),download:o.name,title:o.name,class:"imglink"},[n(g,{vertical:"",align:"center",justify:"center"},{default:t(()=>[n(g,{class:"imglink-label"},{default:t(()=>[T(c(e(d)("status.Converted")),1)]),_:1}),n(g,{vertical:"",align:"center",justify:"center",size:0},{default:t(()=>[n(g,{justify:"center"},{default:t(()=>{var x;return[n(g,{wrap:!1,style:ue((x=o.variousInfo)!=null&&x.shrinked?{color:"blue"}:{}),class:"img-size",size:2},{default:t(()=>[y("span",Gl,c(q.value?f.value:"?"),1),C[12]||(C[12]=T(" Ã— ")),y("span",Kl,c(q.value?P.value:"?"),1)]),_:1},8,["style"])]}),_:1})]),_:1}),n(g,{justify:"center"},{default:t(()=>[T(c(q.value?e(Ne)(o.size,0):"?"),1)]),_:1})]),_:1})],8,ql)]),_:1}),n(g,{ref:"fileNameContainer",justify:"center",align:"center",class:"pathbox",title:o.name,style:{overflow:"hidden"}},{default:t(()=>[n(a,{"x-scrollable":!0,trigger:"hover",style:{"text-align":"center","font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:t(()=>[T(c(q.value?o.name:"?"),1)]),_:1})]),_:1},8,["title"])]),_:1}),n(g,{vertical:"",style:{overflow:"visible"}},{default:t(()=>[n(on,{ref:x=>{x!=null&&x.active&&(z.value=x)},src:L.value,width:142,"max-width":140,"max-height":100,loading:Z.value,"file-name":o.name,"allow-next":v.value<o.length,"allow-prev":v.value>1,onLoad:Ie,onNext:C[6]||(C[6]=x=>K(1)),onPrev:C[7]||(C[7]=x=>K(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(g,{justify:"center",align:"center",wrap:!1},{default:t(()=>[n(S,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",{href:o.url,ref:"saveImg",target:"_blank",download:o.name,style:{"line-height":"1em"}},[n(e(Pe),{disabled:!q.value,round:"",size:"tiny"},{default:t(()=>[T(c($.$t("save")),1)]),_:1},8,["disabled"])],8,Yl)]),default:t(()=>[T(" "+c($.$t("save")),1)]),_:1}),n(S,{"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(e(Pe),{disabled:!q.value,onClick:C[8]||(C[8]=x=>F(o.url)),round:"",size:"tiny"},{default:t(()=>C[13]||(C[13]=[T("DataURL")])),_:1},8,["disabled"])]),default:t(()=>[T(" "+c($.$t("convertedImageDataUrlTooltip")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["name"])]),_:1},512),n(e(Pe),{bordered:!1,onClick:C[9]||(C[9]=x=>K(1)),disabled:!e(ve),class:at({"thumb-arrow":!0,next:!0,pale:!e(ve)}),title:$.$t("Next")},{icon:t(()=>[n(Y,{size:"30"},{default:t(()=>[n(e(fa))]),_:1})]),_:1},8,["disabled","class","title"])]),_:1}),$.isSingle?ce("",!0):(E(),J(g,{key:0,justify:"center",align:"center",wrap:!1,size:4},{default:t(()=>[n(R,{value:v.value,"onUpdate:value":C[10]||(C[10]=x=>v.value=x),tooltip:!1,step:1,min:1,max:o.length,keyboard:!1,class:"index-slider"},null,8,["value","max"]),n(g,{class:"index",align:"center",justify:"center",wrap:!1,size:3},{default:t(()=>[n(g,null,{default:t(()=>[T(c(e(d)("status.index"))+":",1)]),_:1}),n(g,{justify:"end",align:"center",class:"counter"},{default:t(()=>[T(c(v.value),1)]),_:1}),n(g,null,{default:t(()=>C[14]||(C[14]=[T("/")])),_:1}),n(g,{justify:"start",align:"center",class:"counter"},{default:t(()=>[T(c(o.length),1)]),_:1})]),_:1})]),_:1}))]),_:1},512)]),_:1},8,["style"])}}}),Xl=je(Ql,[["__scopeId","data-v-1394ec38"]]),Jl={key:0},es={style:{}},ts=ye({__name:"status.progress",props:{successPerc:{},elapsedTime:{},threads:{},fileType:{},shrink:{},zipSize:{},inputTotalSize:{},outputTotalSize:{},rateColor:{},difColor:{},totalSizeDifStr:{}},setup(i){return(s,r)=>{const u=Ae,o=ha,l=Lt;return E(),J(l,{name:"progress",style:{"white-space":"nowrap"}},{header:t(({collapsed:p})=>[n(u,null,{default:t(()=>[T(c(s.$t("status.Progress"))+" ",1),p?(E(),ee(Me,{key:0},[T(" ("+c(s.successPerc|0)+"%) ",1)],64)):ce("",!0)]),_:2},1024)]),default:t(()=>[n(u,{justify:"center",align:"center",wrap:!1,style:{"white-space":"nowrap","margin-top":"-2em","padding-bottom":"5px"}},{default:t(()=>[n(u,{vertical:"",justify:"center",class:"left-column"},{default:t(()=>[n(o,{"tabular-nums":"",label:s.$t("status.elapsedTime")},{default:t(()=>[n(u,null,{default:t(()=>[T(c(s.elapsedTime),1)]),_:1})]),_:1},8,["label"]),n(o,{"tabular-nums":"",label:s.$t("status.multiThreading")},{default:t(()=>[n(u,{style:ue({color:s.threads?"":"red",fontSize:"0.7rem"})},{default:t(()=>[T(c(s.threads?s.$rt("{n} @:threads",s.threads):s.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(o,{"tabular-nums":"",label:s.$t("status.outputSettings")},{default:t(()=>[n(u,{vertical:"",justify:"end",style:{"font-size":"0.6rem","line-height":"0.6rem"}},{default:t(()=>[y("div",null,c(s.$t("settings.imageType"))+": "+c(s.fileType),1),s.shrink?(E(),ee("div",Jl,[T(c(s.$t("status.Shrinking"))+": ",1),y("span",es,c(s.shrink[0])+"Ã—"+c(s.shrink[1]),1)])):ce("",!0),y("div",null,"Zip: "+c(s.zipSize)+"MB",1)]),_:1})]),_:1},8,["label"])]),_:1}),fn(s.$slots,"center",{},void 0,!0),n(u,{vertical:"",style:{height:"100%"},justify:"center",class:"right-column"},{default:t(()=>[n(o,{"tabular-nums":"",label:s.$t("status.inputSize")},{default:t(()=>[n(u,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[T(c((s.inputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(o,{"tabular-nums":"",label:s.$t("status.outputSize")},{default:t(()=>[n(u,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[T(c((s.outputTotalSize/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(o,{"tabular-nums":"",label:s.$t("status.outInRate")},{default:t(()=>[n(u,{vertical:"",align:"end",justify:"start",style:{"font-size":"0.8em","font-family":"v-mono","line-height":"50%"}},{default:t(()=>[y("span",{style:ue({color:s.rateColor,fontSize:"larger"})},"Ã— "+c((s.outputTotalSize/s.inputTotalSize||1).toFixed(2)),5),y("span",{style:ue({color:s.difColor})},"("+c(s.totalSizeDifStr)+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:3})]),_:3})}}}),ns=je(ts,[["__scopeId","data-v-fd007c07"]]),os={class:"status-table"},as={class:"started"},ls={class:"mini-counter"},ss={class:"failure"},is={class:"mini-counter"},rs={colspan:"2"},us={class:"completed"},cs={class:"main-counter"},ds={class:"total"},ps={class:"main-counter"},fs=ye({__name:"status.progress-center",props:{processing:{type:Boolean},interval:{},statusColor:{},success:{},successTo:{},successFrom:{},index:{},length:{},failure:{},retried:{},successPercTo:{},successPercFrom:{}},setup(i){const s=i,r=Nt(),u=b(r.value.successColor),o=b(!1);return we(()=>s.processing,l=>{l||(s.success===s.length?o.value=!0:u.value=r.value.errorColor)}),(l,p)=>{const d=Xe,z=he,m=wa,w=Ae,k=_n;return E(),J(k,{type:"multiple-circle","stroke-width":2,percentage:[l.successTo/l.length*100|0,l.index/l.length*100|0],color:[e(r).successColor,l.statusColor],"rail-style":[{stroke:e(u),opacity:.3}],style:{width:"12em"}},{default:t(()=>[n(w,{vertical:"",align:"center",justify:"center",size:0,style:{"white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:t(()=>[y("table",os,[y("tbody",null,[y("tr",as,[y("td",null,c(l.$t("status.started"))+":",1),y("td",ls,[n(d,{trigger:"hover",style:ue({color:e(r).infoColor}),placement:"left"},{trigger:t(()=>[y("span",{style:ue({color:e(r).infoColor})},c(l.index.toLocaleString("en-us")),5)]),default:t(()=>[T(" "+c(l.$t("status.progressStarted"))+" ("+c(l.index.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),y("tr",ss,[y("td",null,c(l.$t("status.failure"))+":",1),y("td",is,[n(d,{trigger:"hover",style:ue({color:e(r).errorColor}),placement:"left"},{trigger:t(()=>[y("span",{style:ue({color:e(r).errorColor})},c(l.failure.toLocaleString("en-us")),5)]),default:t(()=>[T(" "+c(l.$t("status.progressErrors"))+" ("+c(l.failure.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"]),l.retried>0?(E(),J(d,{key:0,trigger:"hover",style:ue({color:e(r).warningColor}),placement:"left"},{trigger:t(()=>[y("span",{style:ue({color:e(r).warningColor})}," ("+c(l.retried.toLocaleString("en-us"))+") ",5)]),default:t(()=>[T(" "+c(l.$t("status.progressRetries"))+" ("+c(l.retried.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):ce("",!0)])]),y("tr",null,[y("td",rs,[n(w,{size:0,align:"center",justify:"center",style:ue({color:l.processing?l.statusColor:e(u)}),wrap:!1,class:"percent"},{default:t(()=>[e(o)?(E(),J(z,{key:0,component:e(_a)},null,8,["component"])):ce("",!0),n(m,{duration:l.interval*3|0,from:l.successPercFrom|0,to:l.successPercTo|0,active:!0},null,8,["duration","from","to"]),p[0]||(p[0]=T("% "))]),_:1},8,["style"])])]),y("tr",us,[y("td",null,c(l.$t("status.success"))+":",1),y("td",cs,[n(d,{trigger:"hover",duration:0,delay:0,style:ue({color:e(r).successColor}),placement:"bottom"},{trigger:t(()=>[y("span",{style:ue({color:e(r).successColor})},[n(m,{duration:l.interval*3|0,from:l.successFrom,to:l.successTo,active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:t(()=>[T(" "+c(l.$t("status.progressSuccess"))+" ("+c(l.successTo.toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])])]),y("tr",ds,[y("td",null,c(l.$t("status.all"))+":",1),y("td",ps,[n(d,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:t(()=>[T(c(l.length.toLocaleString("en-us")),1)]),default:t(()=>[T(" "+c(l.$t("status.progressTotal"))+" ("+c(l.length.toLocaleString("en-us"))+") ",1)]),_:1})])])])])]),_:1})]),_:1},8,["percentage","color","rail-style"])}}}),gs={key:0,class:"log-table",ref:"table"},ms={class:"log-tr label"},vs=["title"],hs={style:{"min-width":"7em"},class:"log-th"},_s={style:{"padding-left":"2em"},class:"log-th"},ws={ref:"tbody"},ys=["onClick","onDblclick"],bs={class:"log-td"},ks={class:"log-td"},zs={class:"log-td"},xs={class:"log-td"},Is={key:0,class:"log-td log-extra",style:{"padding-left":"0.5em"}},Ts={key:0},As={key:1,style:{color:"blue"}},Ss={key:1},an=3,ln=3e3,Ls=100,Cs=ye({__name:"status.log",props:lt({processing:{type:Boolean},opened:{type:Boolean},previewCollapsed:{type:Boolean},logs:{},imageIndex:{},thumbnail:{}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},"auto-scroll":{type:Boolean,required:!1},"auto-scrollModifiers":{},order:{required:!1,default:"processed"},orderModifiers:{}}),emits:lt(["open-preview","change-index"],["update:expanded","update:auto-scroll","update:order"]),setup(i,{emit:s}){const{t:r}=We(),u={W:160,H:80},o=i,l=Ee(i,"expanded"),p=Ee(i,"auto-scroll"),d=s;ot("table");const z=ot("tbody"),m=b(),w=b(null),k=b(null),h=b(80),v=b(200),f=xe(()=>{let g=o.logs;switch(Z.value){case"success":g=g.filter(a=>a.completed);break;case"error":g=g.filter(a=>!a.completed);break}return g}),P=Fl(!1),M=b([{type:"group",label:()=>r("status.sort"),key:"sort",children:[{label:()=>r("status.sortByStart"),value:"processed"},{label:()=>r("status.sortByCompletion"),value:"zipped"},{label:()=>r("status.sortByName"),value:"name"},{label:()=>r("status.sortBySize"),value:"size"},{label:()=>r("status.sortByOutputSize"),value:"outputsize"},{label:()=>r("status.sortByStatus"),value:"status"}]}]),O=Ee(i,"order");we(O,Le);const I=[{label:()=>r("status.showAll"),value:""},{label:()=>r("status.showOnlySuccess"),value:"success"},{label:()=>r("status.showOnlyError"),value:"error"}],Z=b(I[0].value);Re(()=>{H=ya(),N(),window.addEventListener("resize",()=>N());const g=new ResizeObserver(()=>N());g.observe(H.parent.parent.vnode.el),Ke(()=>{window.removeEventListener("resize",()=>N()),g.disconnect()})}),Ke(()=>{q==null||q.close(),clearTimeout(_),clearTimeout(Ie),clearTimeout(Se)});let q;we(()=>[o.thumbnail,o.opened],()=>{if(!o.thumbnail||!o.opened||o.thumbnail===q)return;const{width:g,height:a}=Fn(o.thumbnail,{width:u.W,height:u.H});k.value.width=g,k.value.height=a,k.value.style.width=g+"px",k.value.style.height=a+"px",o.thumbnail instanceof HTMLImageElement?k.value.getContext("2d").drawImage(o.thumbnail,0,0,g,a):(k.value.getContext("bitmaprenderer").transferFromImageBitmap(o.thumbnail),q=o.thumbnail,o.thumbnail.close())});let j=0;we(()=>o.imageIndex,async()=>{var D;const g=o.imageIndex;let a=f.value.findIndex(x=>x.zippedIndex===g);a===-1&&(a=g);const S=a<se.value,R=a>se.value+pe.value;if(S||R){const x=a*ae-(R?h.value:0);(D=m.value)==null||D.scrollTo({behavior:"instant",top:x,left:me}),await Ce(),K(!0),await Ce()}Ce(()=>{var oe,le;let x=w.value;x&&(j>a&&(x=x.previousSibling||x,x instanceof HTMLElement||((oe=m.value)==null||oe.scrollTo(me,0),x=null)),(le=x==null?void 0:x.scrollIntoView)==null||le.call(x,{behavior:"instant",block:"nearest"}),j=a)})});let _,H;const ve=b(document.documentElement.clientHeight),de=b(100),N=g=>{clearTimeout(_),_=setTimeout(()=>{const a=m.value.$parent.$el.offsetHeight,S=window.innerHeight-H.parent.parent.parent.parent.vnode.el.offsetHeight-8,R=Math.max(200,a+S);ve.value=document.documentElement.clientHeight,de.value=Math.max(100,R),!(!o.opened||!l.value)&&(h.value=Math.max(R,v.value))},100)};function be(g){g&&(A(!0),N(),P.value=!0)}let Se=0,$e=!1;function A(g=!1){if(!$e){if(Se){$e=!0;return}Ce(()=>{!g&&!p.value||(m.value.scrollTo({behavior:"instant",top:o.logs.length*50,left:me}),Se=window.setTimeout(()=>{Se=0,$e&&($e=!1,A())},Ls))})}}const V=b({height:"0px"}),G=b({height:"0px"}),se=b(0),pe=xe(()=>h.value/ae+an*2|0);let ae=15,ie=0,Ie=0,ge=0,U=-999,F=-1;function K(g){const a=Date.now();if(g!==!0){if(Ie)return;if(a-ge<30){Ie=window.setTimeout(()=>{Ie=0,K()},30-(a-ge));return}}ge=a,ie||(ie=z.value.rows[1].offsetHeight,ae=ie);const S=f.value.length,D=m.value.scrollbarInstRef.containerRef.scrollTop;if(!g&&S===F&&Math.abs(D-U)<ae*.5)return;U=D,F=S;const x=Math.max(0,(D/ae|0)-an);se.value=x,V.value.height=x*ae+"px",G.value.height=Math.max(0,S-(x+pe.value))*ae+"px"}function te(){var g;(g=m.value)==null||g.scrollTo(0,0),K()}we(()=>o.logs,()=>{o.opened&&(Ce(K),p.value&&A(),ke())}),we(()=>o.opened,g=>{g&&K()});let ne=0,re=0;function ke(){if(O.value==="processed"||!O.value)return;const g=Date.now();if(g-re<ln){if(ne)return;ne=window.setTimeout(ke,ln-(g-re));return}ne=0,re=g,Le()}function Le(){switch(console.log("sortList",O.value),O.value){case"zipped":o.logs.sort((g,a)=>g.zippedIndex-a.zippedIndex);break;case"status":o.logs.sort((g,a)=>g.command>a.command?1:-1);break;case"name":o.logs.sort((g,a)=>g.path>a.path?1:-1);break;case"size":o.logs.sort((g,a)=>g.size-a.size);break;case"outputsize":o.logs.sort((g,a)=>g.outputSize-a.outputSize);break;case"processed":default:o.logs.sort((g,a)=>g.index-a.index);break}}function Te(g){const a=o.logs,S=a.findIndex(Oe=>Oe.zippedIndex===o.imageIndex);let R=0,D=1;switch(g.code){case"ArrowUp":R=-1;break;case"ArrowDown":R=1;break;case"PageUp":R=-1,D=h.value/ae|0;break;case"PageDown":R=1,D=h.value/ae|0;break;case"Enter":case"NumpadEnter":if(S>=0&&o.previewCollapsed){Ce(()=>d("open-preview")),g.stopPropagation(),g.preventDefault();return}break;default:return}let x=S,oe=-1;const le=a.length;do{if(x+=R,x<0||x>le-1||x===S)break;if(a[x].completed){if(oe=x,--D>0)continue;break}}while(!0);if(oe>=0){const Oe=a[oe];d("change-index",!0,Oe.path,Oe.fileId,Oe.zippedIndex),g.preventDefault()}}let fe=-1,Fe=-1,me=0,$=!1;function C(g){var R,D;if(K(),$){$=!1;return}const{scrollLeft:a=0,scrollTop:S=0}=(D=(R=m.value)==null?void 0:R.scrollbarInstRef)==null?void 0:D.containerRef;(a!==fe||fe<0)&&(S===Fe||Fe<0)&&(me=a,console.log(me,"storedLogTableScrollLeft")),fe=a,Fe=S,Ce(()=>{var oe,le;$=!0;const x=(le=(oe=m.value)==null?void 0:oe.scrollbarInstRef)==null?void 0:le.containerRef;x&&(x.scrollLeft=me)})}function Y(g){p.value=!1}return(g,a)=>{const S=Tt,R=Ae,D=he,x=Ct,oe=wn,le=ze,Oe=St,tt=Xe,st=Dt,$t=Lt;return E(),J($t,{name:"log",style:{"white-space":"nowrap"}},{header:t(()=>[n(R,{align:"center",wrap:!1},{default:t(()=>[T(c(g.$t("status.Log")),1),Ze(n(S,{size:16},null,512),[[He,g.processing&&!o.opened]])]),_:1})]),"header-extra":t(()=>[Ze(n(R,{align:"center",justify:"end",wrap:!0,style:{"margin-top":"0.2em","margin-left":"0.5em"}},{default:t(()=>[n(x,{value:O.value,"onUpdate:value":[a[0]||(a[0]=B=>O.value=B),Le],options:e(M),style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1,size:"tiny"},{arrow:t(()=>[n(D,{component:e(ba)},null,8,["component"])]),_:1},8,["value","options"]),n(x,{value:e(Z),"onUpdate:value":[a[1]||(a[1]=B=>Ve(Z)?Z.value=B:null),a[2]||(a[2]=B=>te())],options:I,placeholder:g.$t("status.filterLogSelect"),size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,"show-on-focus":!1},{arrow:t(()=>[n(D,{component:e(ka)},null,8,["component"])]),_:1},8,["value","placeholder"]),n(oe,{key:"b",checked:p.value,"onUpdate:checked":[a[3]||(a[3]=B=>p.value=B),a[4]||(a[4]=B=>B&&A(!0))],size:"small",style:{"font-size":"0.9em"}},{default:t(()=>[T(c(g.$t("status.autoScroll")),1)]),_:1},8,["checked"]),n(tt,{trigger:"hover",show:e(P),disabled:!l.value,placement:"top",delay:0,duration:1e3},{trigger:t(()=>[n(le,{style:{"max-width":"30em"},disabled:!0},{trigger:t(()=>[n(oe,{size:"small",checked:l.value,"onUpdate:checked":[a[5]||(a[5]=B=>l.value=B),be],style:{"font-size":"0.9em"}},{default:t(()=>[T(c(g.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:t(()=>[T(c(g.$t("status.expandLog")),1)]),_:1})]),default:t(()=>[n(R,{wrap:!1,align:"center",style:{"font-size":"0.8em"}},{default:t(()=>[n(Oe,{value:e(v),"onUpdate:value":a[6]||(a[6]=B=>Ve(v)?v.value=B:null),onUpdateValue:a[7]||(a[7]=B=>N()),disabled:!l.value,"format-tooltip":B=>`Log size: ${B}`,tooltip:!0,step:1,min:e(de),max:e(ve),style:{"z-index":"3",width:"100px"}},null,8,["value","disabled","format-tooltip","min","max"])]),_:1})]),_:1},8,["show","disabled"])]),_:1},512),[[He,o.opened]])]),default:t(()=>[n(R,{wrap:!1,align:"stretch",class:at({"log-container":1,"expand-log":l.value}),style:ue(l.value?{height:e(h)+"px"}:{height:"110px"}),onKeydown:Te,tabindex:"-1"},{default:t(()=>[n(e(hn),{ref_key:"scrollref",ref:m,distance:10,"x-scrollable":!0,onMousedownCapture:Y,onWheel:a[8]||(a[8]=B=>p.value=!1),onScroll:C,load:"handleLogLoad",trigger:"none",style:ue([{"z-index":"2","padding-right":"10px",height:"100%"},l.value?{height:e(h)+"px"}:{}]),size:50},{default:t(()=>[o.opened?(E(),ee("table",gs,[y("thead",null,[y("tr",ms,[y("th",{class:"log-th",title:g.$t("status.table.core")},"th",8,vs),a[9]||(a[9]=y("th",{class:"log-th"},"no.",-1)),y("th",hs,c(g.$t("status.table.status")),1),y("th",_s,c(g.$t("status.table.details")),1),a[10]||(a[10]=y("th",{class:"log-th"},"size",-1))])]),y("tbody",ws,[y("tr",{style:ue(e(V))},null,4),(E(!0),ee(Me,null,_t(e(f).slice(e(se),e(se)+e(pe)),({index:B,key:Be,command:Ge,path:pt,core:qt,zippedIndex:ft,completed:Gt,fileId:Yo,shrinked:Qo,width:Kt,height:Xo,outputWidth:Jo,outputHeight:ea,size:ta,outputSize:Yt},Ki)=>(E(),ee("tr",{key:Be,class:at({"log-tr":1,completed:Gt,selected:g.imageIndex===ft}),ref_for:!0,ref:Qt=>{g.imageIndex===ft&&(w.value=Qt)},onClick:Qt=>d("change-index",Gt,pt,Yo,ft),onDblclick:()=>{g.imageIndex===ft&&d("open-preview")}},[y("td",bs,c(qt>=0?qt+1:"-"),1),y("td",ks,c(B+1),1),y("td",zs,c(Ge),1),y("td",xs,c(pt),1),Kt?(E(),ee("td",Is,[T(c(`[${Kt}Ã—${Xo}] (${e(Ne)(ta,0)})`)+" ",1),Yt?(E(),ee("span",Ts,[a[11]||(a[11]=T(" â†’ ")),y("span",null," ("+c(e(Ne)(Yt,0))+") ",1)])):ce("",!0),Qo?(E(),ee("span",As,c(` [${Jo}Ã—${ea}]`),1)):ce("",!0)])):(E(),ee("td",Ss))],42,ys))),128)),y("tr",{style:ue(e(G))},null,4)],512)],512)):ce("",!0),a[12]||(a[12]=y("div",{style:{height:"1em"}},null,-1))]),_:1},8,["style"]),n(R,{style:ue([{"align-self":"center",position:"absolute","z-index":"0","margin-top":"10px",right:"0.1em","line-height":"0px"},{width:u.W+"px",height:u.H+"px"}]),justify:"center",align:"center"},{default:t(()=>[n(S,{size:"small",show:g.processing},{default:t(()=>[o.thumbnail===void 0?(E(),J(st,{key:0,description:"EMPTY"})):ce("",!0),Ze(y("canvas",{ref_key:"thumbcanvas",ref:k,width:"106",height:"80",style:ue({border:"1px solid gray",filter:g.processing?"":"opacity(0.35)"})},null,4),[[He,o.thumbnail!==void 0]])]),_:1},8,["show"])]),_:1},8,["style"])]),_:1},8,["class","style"])]),_:1})}}}),$s=["innerHTML"],Es={style:{margin:"1px"}},Ps=["href","download","onClick"],Fs={key:0,style:{position:"relative"}},Os=["href","download"],Us=["href","download"],Ms={key:0,style:{margin:"1px"}},Rs=["href","download","onClick"],Ds=ye({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image","delete-image"],setup(i,{expose:s,emit:r}){const u={itemMargin:"1px",titlePadding:"2px",titleFontSize:"0.8rem"},o=At(),{t:l}=We(),p=Nt(),d=i,z=r;s({cleanup:g});const m=b(!1),w=b([]),k=b(!1),h=b([]),v=b([]),f=b(!1),P=b([0,0]),L=b([0,0]),M=b([0,0]),O=b([0,0]),I=b([0,0]),Z=b([0,0]),q=b(0),j=b(0),_=b([0,0]),H=b(p.value.infoColor),ve=b("#000000"),de=b("#000000"),N=b(0),be=b(0),Se=b(""),$e=b("00:00:00"),A=b(void 0),V=b(null),G=b(["progress","log","output"]),se=a=>G.value.includes(a),pe=a=>G.value.push(a),ae=a=>{const S=G.value.findIndex(R=>R===a);S>=0&&G.value.splice(S,1)},ie=xe(()=>G.value.includes("log")),Ie=b(!1),ge=b(!0),U=b("processed"),F=It({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:0,various:{shrinked:!1}}),K=ot("body"),te=ot("imageViewer");Re(()=>{we(d.status,()=>Le(),{deep:!1});let a=0;const S=()=>{if(a)return;const R=Date.now();$e.value="00:00:00",a=window.setInterval(()=>{const D=(Date.now()-R)/1e3;$e.value=`${String(D/3600|0).padStart(2,"0")}:${String(D/60%60|0).padStart(2,"0")}:${String(D%60|0).padStart(2,"0")}`},300)};S(),f.value=!0,we(()=>d.processing,(R,D)=>{R||Te(),R?(S(),w.value.length=0,m.value=!1,k.value=!1,h.value=[],v.value=[]):(clearInterval(a),a=0)}),Ke(()=>{clearInterval(a),clearTimeout(ke)}),ht(()=>clearInterval(a))}),Ke(()=>{g()}),ht(()=>{clearTimeout(ke)}),we([()=>d.status.zips.length,()=>d.status.failedZips.length],()=>{const a=d.status;{h.value.length>a.zips.length&&(h.value.length=0);let S=0;const R=a.zips.length===1&&a.zippedTotalCount===a.length;for(let D=h.value.length;D<a.zips.length;D++){const x=a.zips[D],oe=a.baseZipName+(R?"":"-"+String(D+1).padStart(2,"0"))+".zip";S+=x.size,h.value[D]={url:x.url,size:x.size,number:R?0:D+1,sizeByUnit:Ne(x.size),name:oe,count:x.count,clicked:!1}}}{v.value.length>a.failedZips.length&&(v.value.length=0);let S=0;const R=a.failedZipDone&&a.failedZips.length===1;for(let D=v.value.length;D<a.failedZips.length;D++){const x=a.failedZips[D],oe=a.baseZipName+"-error"+(R?"":"-"+String(D+1).padStart(2,"0"))+".zip";S+=x.size,v.value[D]={url:x.url,size:x.size,number:R?0:D+1,sizeByUnit:Ne(x.size),name:oe,count:x.count,clicked:!1}}}});const ne=d.interval||100;let re=!1,ke=0;function Le(){if(re)return;if(ke){re=!0;return}ke=window.setTimeout(()=>{ke=0,re&&(re=!1,Le())},ne);const a=d.status;m.value=a.length>=2,L.value[1]=L.value[0],L.value[0]=a.startedCount,M.value[1]=M.value[0],M.value[0]=a.success,O.value[1]=O.value[0],O.value[0]=a.failure,I.value[1]=I.value[0],I.value[0]=a.done,Z.value[1]=Z.value[0],Z.value[0]=a.converted,q.value=a.retried,j.value=a.length,_.value[1]=_.value[0],_.value[0]=a.zippedTotalCount,N.value=a.inputTotalSize,be.value=a.outputTotalSize;const S=be.value-N.value;Se.value=(S>=0?"+ ":"")+Ne(S);const R=be.value/N.value,D=(256|Math.min(255,Math.max(0,R-1.5)*255|0)).toString(16).substring(1);ve.value="#"+D+"0000";const x=1024*1024,oe=(256|Math.min(255,Math.max(0,S/1024/x)*255|0)).toString(16).substring(1);de.value="#"+oe+"0000",P.value[1]=P.value[0],P.value[0]=M.value[0]/j.value*100,(ie.value||!d.processing)&&(w.value=w.value.concat(a.logs),a.logs.length=0),V.value=a.thumbnail,d.processing?H.value=O.value[0]?p.value.errorColor:q.value?p.value.warningColor:p.value.infoColor:f.value=!1,a.convertedImageUrl!==F.url&&(F.url=a.convertedImageUrl,F.name=a.convertedImageName,F.dataUrl=a.convertedImageDataUrl,F.size=a.convertedImageSize||a.outputTotalSize,F.originalSize=a.convertedImageOrgSize,F.originalName=a.convertedImageOrgName,F.index=a.convertedImageIndex,F.originalUrl=a.convertedImageOrgUrl,F.various={shrinked:a.convertedImageShrinked})}function Te(){const a=d.status;H.value=d.status.success===d.status.length?p.value.successColor:p.value.errorColor,U.value==="processed"&&(U.value="zipped"),a.success>0&&(ge.value&&ae("log"),pe("preview"))}async function fe(a,S,R,D){var oe;if(!a)return;const x=D;console.log(a,S,R,D,"completed, path, fileId, zippedIndex"),console.log(x,d.status.ziplogs[x]),se("preview")||(pe("preview"),await Ce()),(oe=te.value)==null||oe.changeIndex(x+1),await Ce(()=>{var le;try{(le=te.value)==null||le.$el.scrollIntoView({behavior:"instant",block:"nearest"})}catch{}})}const Fe=xe(()=>[{key:"open",label:l("status.openFailedList"),icon:()=>Q(he,()=>Q(yn)),onSelect(){C()}},{key:"download",label:l("status.saveFailedList"),icon:()=>Q(he,()=>Q(za)),onSelect(){C(!0)}},{key:"zip",label:`${l("status.zipFailedList")}`+(d.status.failedZipDone?`(âœ”${l("status.done")})`:""),icon:()=>Q(Tt,{show:k.value&&!d.status.failedZipDone,size:"small"},()=>Q(he,()=>Q(Mt))),disabled:k.value,onSelect(a){return k.value=!0,z("demand-zip-errors"),!1}}]);function me(a,S=!1){const{url:R,name:D}=a;if(S){const x=document.createElement("a");x.href=R,x.download=D,x.click()}a.clicked||(a.clicked=!0,f.value||h.value.every(x=>x.clicked)&&z("all-zips-clicked"))}async function $(){if(m.value){if(h.value.length>=2&&!await new Promise((R,D)=>o.warning({title:l("Download"),content:l("status.confirmDownloadMessage",[h.value.length]),positiveText:"OK",negativeText:l("cancel"),onPositiveClick:()=>R(!0),onNegativeClick:()=>D()})))return;const a=h.value;for(const S of a)me(S,!0)}else te.value.download()}function C(a=!1){const S=new Blob([d.status.unconvertedListText],{type:"text/plain;charset=utf8"}),R=URL.createObjectURL(S),D=document.createElement("a");D.href=R,D.target="_blank",a&&(D.download=d.status.baseZipName+"-error.txt"),D.click()}const Y=b(!1);function g(){Y.value=!0,URL.revokeObjectURL(F.url),URL.revokeObjectURL(F.originalName),F.originalUrl="",F.url="",F.index=0,d.status.logs.length=0,w.value.length=0,v.value.length=0,h.value.length=0}return(a,S)=>{const R=Ae,D=Lt,x=_n,oe=Xe,le=Pe,Oe=Nl,tt=jt,st=xa,$t=bn;return E(),J(R,{ref_key:"body",ref:K,vertical:"",justify:"center"},{default:t(()=>[n($t,{"display-directive":"show","trigger-areas":["arrow","main"],"expanded-names":e(G),"onUpdate:expandedNames":S[6]||(S[6]=B=>Ve(G)?G.value=B:null),"theme-overrides":u},{default:t(()=>[n(ns,{"elapsed-time":e($e),"success-perc":e(P)[0],"input-total-size":e(N),"output-total-size":e(be),"file-type":d.status.type,shrink:d.status.shrink,threads:d.status.threads,"zip-size":d.status.zipSize,"rate-color":e(ve),"dif-color":e(de),"total-size-dif-str":e(Se)},{center:t(()=>[e(Y)?ce("",!0):(E(),J(fs,{key:0,index:e(L)[0],success:e(M)[0],length:a.status.length,"success-to":e(M)[0],"success-from":e(M)[1],failure:e(O)[0],"success-perc-to":e(P)[0],"success-perc-from":e(P)[1],retried:e(q),processing:e(f),interval:e(ne),"status-color":e(H),class:"center-column"},null,8,["index","success","length","success-to","success-from","failure","success-perc-to","success-perc-from","retried","processing","interval","status-color"]))]),_:1},8,["elapsed-time","success-perc","input-total-size","output-total-size","file-type","shrink","threads","zip-size","rate-color","dif-color","total-size-dif-str"]),n(Cs,{processing:e(f),"image-index":e(F).index,thumbnail:e(V),opened:e(ie),"preview-collapsed":se("preview"),logs:e(w),expanded:e(Ie),"auto-scroll":e(ge),order:e(U),onChangeIndex:fe,onOpenPreview:S[0]||(S[0]=B=>{var Be;return(Be=e(te))==null?void 0:Be.openPreview()}),name:"log",style:{"white-space":"nowrap"}},null,8,["processing","image-index","thumbnail","opened","preview-collapsed","logs","expanded","auto-scroll","order"]),n(D,{title:a.$t("status.PreviewImage"),name:"preview",style:{"white-space":"nowrap"},disabled:!(e(M)[0]>0)},{default:t(()=>[n(R,{justify:"center",align:"center",vertical:"",style:{"margin-top":"-1em"}},{default:t(()=>[n(Xl,{"_v-else-if":"imageViewerStarted && status.success > 0 /*&& (props.status.threads || !zippingFlag)*/ && !cleaningUp",ref_key:"imageViewer",ref:te,url:e(F).url,size:e(F).size,"original-url":e(F).originalUrl,"original-size":e(F).originalSize,name:e(F).name,originalName:e(F).originalName,length:e(M)[0],index:e(F).index,"various-info":e(F).various,"is-single":!e(m),onDemandImage:S[1]||(S[1]=B=>z("demand-image",B)),on_deleteImage:S[2]||(S[2]=B=>z("delete-image",B)),_close:"imageViewerStarted=false"},null,8,["url","size","original-url","original-size","name","originalName","length","index","various-info","is-single"])]),_:1})]),_:1},8,["title","disabled"]),n(D,{name:"output",style:{"white-space":"nowrap"},disabled:""},{header:t(()=>[y("span",{style:{color:"black"},innerHTML:a.$t("status.Output")},null,8,$s)]),default:t(()=>[n(R,{wrap:!1,vertical:"",style:{"margin-top":"-1.3em"}},{default:t(()=>[e(Y)?ce("",!0):(E(),J(R,{key:0,justify:"center"},{default:t(()=>[Ze(n(R,{vertical:"",align:"center"},{default:t(()=>[n(oe,{placement:"left"},{trigger:t(()=>[n(x,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":e(_)[0]===e(j)?"white":"green",processing:e(f),percentage:e(_)[0]/e(j)*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[y("span",Es,c(e(_)[0]/e(j)*100|0)+"% "+c(a.$t("status.zipped"))+" ("+c(e(_)[0])+"/"+c(e(Z)[0])+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[T(" "+c(a.$t("status.zippingProgress"))+" ("+c(e(_)[0]/e(j)*100|0)+"%) ",1)]),_:1}),n(et,{name:"zipcontainer"},{default:t(()=>[e(h).length>=1||e(f)?(E(),J(tn,{key:0,name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(E(!0),ee(Me,null,_t(e(h),(B,Be)=>(E(),ee("span",{key:Be},[n(oe,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",{href:B.url,download:B.name,class:"in-button-anchor",onClick:Ge=>me(B)},[n(le,{class:"zip-button",size:"tiny",color:B.clicked?"#050":"lime","text-color":B.clicked?"gray":"white",onClick:Je(Ge=>me(B),["stop"]),round:""},{default:t(()=>[n(e(he),{size:"tiny"},{default:t(()=>[n(e(Mt))]),_:1}),T("ZIP"+c(B.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Ps)]),default:t(()=>[y("div",{style:ue({color:e(p).successColor})},[y("div",null,"ZIP "+c(B.number||"")+" ("+c(a.$t("success"))+")",1),y("div",null,c(B.name),1),y("div",null,c(B.sizeByUnit),1),y("div",null,c(a.$rt("{n} @:files",B.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):ce("",!0)]),_:1})]),_:1},512),[[He,e(m)]])]),_:1})),n(et,null,{default:t(()=>[e(Y)?ce("",!0):Ze((E(),J(R,{key:0,justify:"center",align:"center"},{default:t(()=>[n(oe,{trigger:"hover",duration:0,delay:0,placement:"left",style:ue({color:"white",backgroundColor:e(p).successColor}),"arrow-style":{backgroundColor:e(p).successColor}},{trigger:t(()=>[n(et,{name:"save"},{default:t(()=>[e(M)[0]>0?(E(),ee("span",Fs,[n(tt,{value:e(m)?e(_)[0].toLocaleString("en-us"):d.status.type.replace(/\(.+\)/,""),color:e(p).successColorHover,offset:[-20,-3]},{default:t(()=>[n(le,{size:"medium",onClick:$,color:e(p).successColor,round:""},{default:t(()=>[e(m)?(E(),ee(Me,{key:0},[e(h).length?(E(),ee("a",{key:0,href:e(h)[0].url,download:e(h)[0].name,class:"in-button-anchor",onClick:S[3]||(S[3]=Je(()=>{},["prevent"]))},[n(Oe),T(" Ã— "+c(e(h).length)+" "+c(a.$t("status.saveAll")),1)],8,Os)):ce("",!0)],64)):(E(),ee("a",{key:1,href:e(F).url,download:e(F).name,class:"in-button-anchor",onClick:S[4]||(S[4]=Je(()=>{},["prevent"]))},[n(e(he),{size:"tiny"},{default:t(()=>[n(e(kn))]),_:1}),T(" "+c(a.$t("save")),1)],8,Us))]),_:1},8,["color"])]),_:1},8,["value","color"])])):ce("",!0)]),_:1})]),default:t(()=>[a.status.length>=2?(E(),ee(Me,{key:0},[y("div",null,c(e(l)("success"))+": "+c(e(_)[0].toLocaleString()),1),y("div",null,c(e(l)("status.totalSize"))+": "+c(e(Ne)(a.status.zippedTotalSize)),1),y("div",null,"ZIP Ã— "+c(e(h).length),1),y("div",null,c(e(l)("status.saveAllZipsTooltip")),1)],64)):(E(),ee(Me,{key:1},[T(c(a.$t("status.downloadConvertedImage",e(h).length)),1)],64))]),_:1},8,["style","arrow-style"]),!e(f)&&a.status.success!==e(j)?(E(),J(st,{key:0,options:e(Fe),onSelect:S[5]||(S[5]=(B,Be)=>{var Ge;return(Ge=e(Fe).find(({key:pt})=>B===pt))==null?void 0:Ge.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:t(()=>[n(oe,{show:e(A),duration:0,delay:0,placement:"right",style:ue({color:"white",backgroundColor:e(p).errorColor}),"arrow-style":{backgroundColor:e(p).errorColor}},{trigger:t(()=>[n(tt,{value:a.status.unconvertedFileCount.toLocaleString(),color:e(p).errorColorHover,offset:[-0,-3]},{default:t(()=>[n(le,{size:"small",color:e(p).errorColor},{default:t(()=>[n(e(he),{size:"medium",style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Ia))]),_:1})]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:t(()=>[y("div",null,[y("div",null,c(e(l)("failed"))+": "+c(a.status.unconvertedFileCount.toLocaleString()),1),y("div",null,c(e(l)("status.totalSize"))+": "+c(e(Ne)(a.status.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])):ce("",!0)]),_:1},512)),[[He,!e(f)]])]),_:1}),n(et,{name:"zipcontainer"},{default:t(()=>[e(Y)?ce("",!0):Ze((E(),J(R,{key:0,vertical:"",align:"center"},{default:t(()=>[n(oe,{placement:"left"},{trigger:t(()=>[n(x,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":a.status.failedFileZippedCount===a.status.unconvertedFileCount?"white":"#500",processing:e(k)&&!a.status.failedZipDone&&!a.status.failedToCreateFailedZip,percentage:a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[a.status.failedToCreateFailedZip?(E(),ee("div",{key:1,style:ue({color:e(p).errorColor})},c(a.$t("status.failureZippingFailedFiles")),5)):(E(),ee("span",Ms,c(a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0)+"% "+c(a.$t("status.zipped"))+" ("+c(a.status.failedFileZippedCount)+"/"+c(a.status.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[T(" "+c(a.$t("status.zippingProgress"))+" ("+c(a.status.failedFileZippedCount/a.status.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(tn,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(E(!0),ee(Me,null,_t(e(v),(B,Be)=>(E(),ee("span",{key:Be},[n(oe,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",{href:B.url,download:B.name,class:"in-button-anchor",onClick:Ge=>me(B)},[n(le,{class:"zip-button",size:"tiny",color:B.clicked?"#551122":"#F00","text-color":B.clicked?"gray":"white",onClick:Je(Ge=>me(B),["stop"]),round:""},{default:t(()=>[n(e(he),{size:"tiny"},{default:t(()=>[n(e(Ta))]),_:1}),T("ZIP"+c(B.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Rs)]),default:t(()=>[y("div",{style:ue({color:e(p).errorColor})},[y("div",null,"ZIP "+c(B.number||"")+" ("+c(a.$t("failed"))+")",1),y("div",null,c(B.name),1),y("div",null,c(B.sizeByUnit),1),y("div",null,c(a.$rt("{n} @:files",B.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1},512)),[[He,e(k)]])]),_:1})]),_:1})]),_:1})]),_:1},8,["expanded-names"])]),_:1},512)}}}),Ns=je(Ds,[["__scopeId","data-v-48d08b57"]]),js=["innerHTML"],Bs=ye({__name:"converter",props:lt({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},threads:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:lt(["start","end"],["update:showNote"]),setup(i,{emit:s}){Qe(qe);const{t:r}=We(),u=At(),o=Aa(),l=10,p=navigator.hardwareConcurrency,d=typeof OffscreenCanvas=="function",z=100,m=i,w=Ee(i,"showNote"),k=s,h=b(!1),v=b(!1),f=b(!1),P=b(!1),L=b(!1),M=b(()=>"initializing"),O=b("info"),I=It(G()),Z=ot("stat"),q=b(0);let j=!1,_=()=>{},H,ve=0,de=!1;we(()=>m.input,U=>{U!=null&&U.length&&pe(U)}),we(P,U=>{document.body.style.overflowY=U?"hidden":"auto"}),Re(async()=>{await Ie(),ge()});async function N(){let U=!0;if(ve>l*1e3&&!de&&I.success>0&&(U=!1,await new Promise(F=>{u.warning({title:r("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:r("close"),negativeText:r("back"),onPositiveClick:()=>U=!0,onAfterLeave:F,content:r("confirmCloseDialog")})})),!U)return!1;o.destroyAll(),P.value=!1,w.value=!1}function be(U){H==null||H(U),console.log(U,"demanded")}function Se(U){Ft==null||Ft(U),console.log(U,"delete")}function $e(){!v.value&&h.value?v.value=!0:N()}function A(){pe(m.input)}let V=b(()=>{});function G(U){const F={logs:[],ziplogs:[],startedCount:0,converted:0,success:0,failure:0,retried:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",convertedImageOrgUrl:"",convertedImageIndex:-1,convertedImageShrinked:!1,zipSize:m.maxZipSizeMB,shrink:W.multithread&&W.shrinkImage?[W.maxWidth,W.maxHeight]:void 0,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1};return Object.assign(U||{},F)}function se(){L.value=!1,URL.revokeObjectURL(I.convertedImageUrl),URL.revokeObjectURL(I.convertedImageOrgUrl);for(const U of I.zips)URL.revokeObjectURL(U.url);I.zips.length=0;for(const U of I.failedZips)URL.revokeObjectURL(U.url);I.failedZips.length=0,G(I),_(),_=()=>{},H=null,de=!1,f.value=!1,v.value=!1}async function pe(U){if(h.value){u.error({title:"Busy",positiveText:"OK",content:r("interfered")});return}P.value&&(q.value^=1);let F=U.concat();G(I),se(),P.value=!0,L.value=!0,h.value=!0,I.processing=!0,O.value="info",M.value=()=>r("processing");const K=new Set,te=m.format,ne=m.quality,re=[...te.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),ke=ie(te,ne,F[0].webkitRelativePath);I.length=F.length,I.baseZipName=ke,I.type=te.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(te)?" ("+ne+")":""),I.threads=j?0:m.threads;const Le=Date.now();k("start");let Te,fe,Fe;if(!j&&m.threads>=2?(H=Cl,Fe=await bl({files:F,completedFileIdSet:K,ConvStats:I,canceled:v,props:m,imageType:te,quality:ne,outputExt:re,format:te,message:o})):(H=Ul,Fe=await Ol(F,K,m,v,I)),{exception:fe,callbackToGenerateFailedZips:Te,callbackToClearConverter:_}=Fe,fe){let me;switch(fe.message){case"worker-load-error":me=r("errMsgWorkerLoadError");break;default:me="unexpected error"}u.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:()=>Q("div",[Q("p",me),Q(Pe,{onClick(){location.reload()}},r("Reload"))])})}if(I.success===I.length?(O.value="success",M.value=()=>r("completed")):(O.value="error",M.value=()=>v.value?r("aborted"):r("incomplete")),K.size!==F.length){const me=ae(U,K);V.value=()=>{!me||!me.length||Te(me)}}h.value=!1,I.processing=!1,f.value=!0,F.length=0,ve=Date.now()-Le,k("end")}function ae(U,F){const K=[],te=[];let ne=0;for(const re of U)F.has(re._id)||(K.push(re),te.push(re.webkitRelativePath||re.relativePath||re.name),ne+=re.size);return te.length&&(I.unconvertedListText=te.join(`
`),I.unconvertedFileCount=K.length,I.unconvertedTotalSize=ne),K}function ie(U,F,K){var Le;const te=new Date;U=U.replace(/^image\//,"").toLowerCase();const ne=W.useFolderNameForZip&&((Le=String(K).match(/^\/?([^/]+)\//))==null?void 0:Le[1])||"avif2jpg",re=`
    ${te.getFullYear().toString().substring(2)}
    ${String((te.getMonth()+1)*100+te.getDate()).padStart(4,"0")}
    ${String(te.getHours()*1e4+te.getMinutes()*100+te.getSeconds()).padStart(6,"0")}
    -
    ${U+(/jpe?g|webp/i.test(U)?F:"")}
  `.replace(/\s/g,"");return`${ne}-${re}`.replace(/\s+/g," ")}async function Ie(){const U="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",F=document.createElement("img"),K=On(F).then(()=>!0,()=>!1);F.src=U,await K||u.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:r("avifUnsupported")})}function ge(){(!d||p<2||!Promise.any)&&(j=!0),j&&(Ue.value=0)}return(U,F)=>{var Te;const K=he,te=jt,ne=ze,re=Ae,ke=Tt,Le=zn;return E(),ee(Me,null,[!e(h)&&((Te=m.input)!=null&&Te.length)?(E(),J(re,{key:0,justify:"center",align:"center",style:{"margin-top":"0.4em"}},{default:t(()=>[n(ne,{trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:t(()=>{var fe;return[n(te,{value:((fe=U.input)==null?void 0:fe.length)||0,offset:[-12,-5],color:"#99999966"},{default:t(()=>[n(e(Pe),{onClick:A,round:"",size:"medium"},{icon:t(()=>[n(K,{size:"1.2em",color:"#CCCCCC"},{default:t(()=>[n(e(Sa))]),_:1})]),default:t(()=>[T(" "+c(e(r)("convertAgain")),1)]),_:1})]),_:1},8,["value"])]}),default:t(()=>{var fe;return[y("div",{innerHTML:e(r)("reconvertTip",(fe=m.input)==null?void 0:fe.length)},null,8,js)]}),_:1})]),_:1})):ce("",!0),n(Le,{ref:"processingModal","display-directive":"show",show:e(P),"onUpdate:show":F[2]||(F[2]=fe=>Ve(P)?P.value=fe:null),closable:e(f),"close-on-esc":!1,preset:"dialog",onClick:F[3]||(F[3]=fe=>{e(o).destroyAll()}),onMaskClick:F[4]||(F[4]=fe=>{e(o).destroyAll()}),onClose:N,onEsc:$e,title:e(M),type:e(O),"mask-closable":!1,onAfterLeave:se,onBeforeLeave:F[5]||(F[5]=fe=>{e(Z).cleanup()}),class:"processing-dialog"},{default:t(()=>[n(re,{vertical:"",style:{"flex-grow":"1"}},{default:t(()=>[e(L)?(E(),J(Ns,{ref_key:"stat",ref:Z,key:e(q),processing:e(h),status:e(I),interval:z,onAllZipsClicked:F[0]||(F[0]=fe=>Ve(de)?de.value=!0:de=!0),onDemandZipErrors:e(V),onDemandImage:be,onDeleteImage:Se},null,8,["processing","status","onDemandZipErrors"])):ce("",!0),n(re,{justify:"end",align:"center",wrap:!1},{default:t(()=>[e(h)?(E(),J(e(Pe),{key:0,disabled:e(v),ref:"cancelbutton",round:"",size:"large",onClick:F[1]||(F[1]=fe=>v.value=!0)},{default:t(()=>[n(ke,{show:e(v)&&!e(f),size:"small"},{default:t(()=>[T(c(e(r)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):e(f)?(E(),J(e(Pe),{key:1,onClick:N,round:"",size:"large"},{default:t(()=>[T(c(e(r)("close")),1)]),_:1})):ce("",!0)]),_:1})]),_:1})]),_:1},8,["show","closable","title","type"])],64)}}}),Zs="/avif2jpeg/dist/avif.png",Hs={class:"container-1"},Vs={style:{position:"relative"}},Ws={style:{position:"absolute","font-size":"0.5em",right:"-3.5em",bottom:"-1.5em","white-space":"nowrap"}},qs={style:{color:"#666666"}},Gs=["innerHTML"],Ks={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},Ys=ye({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(i,{emit:s}){Qe(qe);const r=i,u=s,o=La(),l=b(!1),p=b(0),d=b("");Re(()=>{z(r.dropTarget||document)});function z(w){document.ondragstart=k=>k.preventDefault(),document.ondragover=k=>k.preventDefault(),w.ondrop=async k=>{var v;if(k.preventDefault(),l.value||r.forbidden)return;l.value=!0,p.value=0,d.value="";let h;try{const f=[...k.dataTransfer.items].map(P=>P.webkitGetAsEntry());o.start(),h=await m(f),o.finish()}catch{h=[...((v=k.dataTransfer)==null?void 0:v.files)??[]],o.error()}l.value&&(l.value=!1,u("drop",h))}}async function m(w,k){k=k||[];for(const h of w)if(h.isFile){const v=await new Promise(f=>h.file(P=>f(P)));Object.defineProperty(v,"webkitRelativePath",{value:h.fullPath}),k.push(v),p.value++}else if(h.isDirectory){d.value=h.fullPath;const v=h.createReader();do{const f=await new Promise(P=>v.readEntries(L=>P(L)));if(!f.length)break;await m(f,k)}while(!0)}return k}return(w,k)=>{const h=he,v=Xe,f=Ae,P=ze,L=zn;return E(),ee("div",Hs,[n(P,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"bottom-end"},{trigger:t(()=>[n(f,{vertical:"",class:"container-2"},{default:t(()=>[n(f,{align:"center",wrap:!1,class:"container-3"},{default:t(()=>[n(f,{vertical:"",align:"center",wrap:!1,style:{"font-weight":"bold","font-size":"1em","line-height":"90%","white-space":"nowrap"}},{default:t(()=>[k[5]||(k[5]=y("span",null,"Drag & Drop",-1)),y("span",Vs,[k[4]||(k[4]=T(" AVIF Images ")),y("span",Ws,[k[3]||(k[3]=T(" or ")),n(v,{placement:"bottom-end"},{trigger:t(()=>[y("span",qs,[n(h,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Bt))]),_:1}),k[1]||(k[1]=T(" Folders "))])]),default:t(()=>[k[2]||(k[2]=T(" You can drag and drop your local folders "))]),_:1})])])]),_:1}),n(f,null,{default:t(()=>k[6]||(k[6]=[y("img",{src:Zs,class:"avif"},null,-1)])),_:1})]),_:1})]),_:1})]),default:t(()=>[y("h3",{innerHTML:w.$t("droptarget"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,Gs)]),_:1}),n(L,{show:e(l),"onUpdate:show":k[0]||(k[0]=M=>Ve(l)?l.value=M:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":w.$t("cancel")},{default:t(()=>[n(f,{vertical:"",align:"center"},{default:t(()=>[y("div",Ks,c(e(d)),1),y("div",null,"found "+c(e(p))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])])}}}),Qs=je(Ys,[["__scopeId","data-v-963c44a5"]]),Xs={class:"container-1"},Js={class:"container-2"},ei=["innerHTML"],ti=["innerHTML"],ni={style:{"white-space":"nowrap"}},oi={style:{"padding-left":"1em"}},ai=["innerHTML"],li=["accept"],si=ye({__name:"file-selector",props:lt({target:{},userExtensions:{},forbidden:{type:Boolean}},{expanded:{type:Boolean,required:!1},expandedModifiers:{},disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:lt(["input","click","cancel","on-change-accept","update:target","update:userExtensions"],["update:expanded","update:disableNotifyingFolderSelect"]),setup(i,{emit:s}){const r=At(),{t:u}=We(),o=Qe(qe),l=["avif_only","all_images","all_files","edit_type"],p=[];for(const A of l)p.push({label:()=>u("fileTypeRadioOptions."+A),value:A});const d=({node:A,option:V})=>Q(ze,{placement:"right"},{trigger:()=>A,default:()=>de(V.value).replace(/,/g,", ")}),z=i,m=s,w=b(0),k=b(!1),h=b(!1),v=xe(()=>de(L.value)),f=xe(()=>M.value.split(",").every(V=>/^\s*(\.[\w\-]+)*\s*$/.test(V))?"success":"error"),P=xe(()=>!z.forbidden&&!h.value);Ee(i,"expanded");const L=xe({get:()=>l.indexOf(z.target)>=0?z.target:l[0],set:A=>{m("update:target",A)}}),M=xe({get:()=>z.userExtensions,set:A=>{m("update:userExtensions",A)}}),O=Ee(i,"disableNotifyingFolderSelect"),I=b(null),Z=b(null),q=b(ve());we(L,A=>{m("on-change-accept",v.value)}),Re(()=>{});async function j(A){if(m("click"),A===Z.value&&!O.value){let V=!1;if(await new Promise(G=>{r.info({title:u("loadfolderNotifyingTitle"),positiveText:u("Continue"),negativeText:u("Cancel"),onAfterLeave:()=>G(V),onPositiveClick:()=>V=!0,content:()=>Q("div",[Q("p",{},u("loadfolderNotifyingMessageTerm1")),Q("div",[Q(vn,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/dist//notification-folder.png"})]),Q("p",{},u("loadfolderNotifyingMessageTerm2")),Q("p",[Q(wn,{onUpdateChecked:se=>O.value=se,checked:O.value},()=>u("checkboxTextDontShowThis"))])])})}),!V){O.value=!1,m("cancel");return}}A.click()}function _(){m("cancel")}function H(A){const G=[...A.target.files];I.value.value="",Z.value.value="",be(G)}function ve(){return"webkitdirectory"in document.createElement("input")}function de(A){switch(A){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico";case"edit_type":return M.value;case"all_files":default:return".*"}}async function N(A){const V=String(v.value).toLowerCase().replace(/\s+/g,"");if(V&&v.value!==".*"){const G=V.split(",");A=A.filter(se=>G.includes(se.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),A.length||(await new Promise(se=>{r.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:se,content:()=>Q("div",[Q(Dt,{description:"NO IMAGES"}),`${u("noimage")}`,Q("br"),v.value])})}),_())}return A}async function be(A){h.value=!0,A=await N(A),w.value=A.length,A.length>0&&m("input",$e(A)),h.value=!1}let Se=0;function $e(A){const V=[];for(const G of A)G.hasOwnProperty("_id")||Object.defineProperty(G,"_id",{value:Se++}),V.push(G);return V}return(A,V)=>{const G=he,se=Pe,pe=Ae,ae=Ct,ie=$a,Ie=Ca,ge=Xe;return E(),ee(Me,null,[y("div",Xs,[y("div",Js,[n(pe,{vertical:"",align:"center",justify:"center",inline:"",size:"large"},{default:t(()=>[n(pe,{align:"center",justify:"space-around",class:"main-buttons"},{default:t(()=>[n(pe,{vertical:"",align:"stretch",justify:"center"},{default:t(()=>[n(e(ze),{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(o).LANDSCAPE.value?"right":"top",duration:0,delay:0,"z-index":10},{trigger:t(()=>[n(se,{disabled:!e(P),size:"large",onClick:V[0]||(V[0]=U=>j(e(I))),round:"",style:{width:"100%","background-color":"white","font-size":"1.5em"}},{icon:t(()=>[n(G,{size:"large",color:"gray"},{default:t(()=>[n(e(xn))]),_:1})]),default:t(()=>[T(" "+c(A.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[y("div",{innerHTML:A.$t("loadbuttontooltip")},null,8,ei)]),_:1},8,["show","placement"]),!e(o).IS_SP&&e(q)||e(o).SSR?(E(),ee(Me,{key:0},[n(pe,{align:"center",justify:"center",style:{color:"gray",margin:"0em"}},{default:t(()=>[T(c(A.$t("or")),1)]),_:1}),n(e(ze),{to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:e(o).showTooltipsBeforeMounted.value},{trigger:t(()=>[n(se,{disabled:!e(P),size:"large",onClick:V[1]||(V[1]=U=>j(e(Z))),round:"",style:{width:"100%","background-color":"white","font-size":"1.5em"}},{icon:t(()=>[n(G,{size:"large",color:"gray"},{default:t(()=>[n(e(Bt))]),_:1})]),default:t(()=>[T(" "+c(A.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[y("div",{innerHTML:A.$t("loadfoldertooltip")},null,8,ti)]),_:1},8,["show"])],64)):ce("",!0)]),_:1}),e(o).IS_SP?ce("",!0):(E(),J(Qs,{key:0,onDrop:be,forbidden:!e(P),class:"drop-target"},null,8,["forbidden"]))]),_:1}),n(pe,{vertical:""},{default:t(()=>[n(pe,{wrap:e(o).IS_SP,align:"center",justify:"stretch"},{default:t(()=>[y("span",ni,c(A.$t("TargetFileTypeExt"))+": ",1),n(e(ze),{"keep-alive-on-hover":!1,placement:"right",style:{"max-width":"200px"},duration:0,delay:0},{trigger:t(()=>[n(ae,{trigger:"click",width:"trigger",size:"small",value:e(L),"onUpdate:value":V[2]||(V[2]=U=>Ve(L)?L.value=U:null),options:p,"render-option":d,"consistent-menu-width":!1},null,8,["value"])]),default:t(()=>[T(" "+c(de(e(L)).replace(/,/g,", ")),1)]),_:1})]),_:1},8,["wrap"]),e(L)==="edit_type"?(E(),J(e(ze),{key:0,trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:e(k),duration:0,delay:0},{trigger:t(()=>[y("div",oi,[n(ge,{trigger:"manual",placement:"right-end",show:e(L)==="edit_type"&&e(f)!=="success"&&!!e(k)},{trigger:t(()=>[n(ie,{value:e(M),"onUpdate:value":V[3]||(V[3]=U=>Ve(M)?M.value=U:null),status:e(f),disabled:e(L)!=="edit_type",onFocus:V[4]||(V[4]=U=>k.value=!0),onBlur:V[5]||(V[5]=U=>k.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:t(()=>[n(Ie,{type:"error","show-icon":!0,title:"Validation error"},{default:t(()=>V[6]||(V[6]=[T(" Please correct the extension list."),y("br",null,null,-1),y("ul",null,[y("li",null,"Each extension must begin with a period. "),y("li",null,"Separate each extension with a comma. "),y("li",null,"Use alphameric characters.")],-1)])),_:1})]),_:1},8,["show"])])]),default:t(()=>[y("span",{innerHTML:A.$t("editAcceptTypes")},null,8,ai)]),_:1},8,["show"])):ce("",!0)]),_:1})]),_:1})])]),y("input",{ref_key:"fileinput",ref:I,onInput:H,onCancel:_,type:"file",multiple:"",accept:e(v),style:{display:"none"}},null,40,li),y("input",{ref_key:"folderinput",ref:Z,webkitdirectory:"",directory:"",onInput:H,onCancel:_,type:"file",style:{display:"none"}},null,544)],64)}}}),ii=je(si,[["__scopeId","data-v-e613e1ac"]]),ri={style:{"white-space":"nowrap"}},ui=ye({__name:"settings-output",props:{quality:{},format:{}},emits:["update:format","update:quality"],setup(i,{emit:s}){const r=i,u=s,{t:o}=We(),l=Qe(qe),p=b([]),d=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],z=xe({get:()=>r.format,set:f=>{f=h(f),u("update:format",f)}}),m=xe({get:()=>r.quality,set:f=>{u("update:quality",f)}}),w=xe(()=>/png|bmp/i.test(z.value)),k=b(null);Re(()=>{v()});function h(f){return p.value.indexOf(f)<0&&(f=p.value[0]),f}function v(){for(const f of d)k.value.toDataURL(f).indexOf(f)>=0&&p.value.push(f);p.value.length===0&&p.value.push(d[0])}return(f,P)=>{const L=he,M=Ct,O=Ae,I=ze,Z=St,q=In;return E(),ee(Me,null,[n(O,{justify:"center",class:"body"},{default:t(()=>[n(O,{vertical:""},{default:t(()=>[n(I,{to:!1,"display-directive":"show",show:e(l).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(l).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(O,{align:"center",wrap:!1},{default:t(()=>[n(L,null,{default:t(()=>[n(e(xn))]),_:1}),T(c(e(o)("settings.imageType"))+": ",1),n(M,{value:z.value,"onUpdate:value":P[0]||(P[0]=j=>z.value=j),options:p.value.map(j=>({value:j,label:j})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:t(()=>[T(" "+c(e(o)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(I,{to:!1,"display-directive":"show",show:e(l).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(l).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(O,{align:"center"},{default:t(()=>[n(O,{align:"start",wrap:!1},{default:t(()=>[n(L,null,{default:t(()=>[n(e(kn))]),_:1}),y("span",ri,c(e(o)("settings.quality"))+":",1),n(O,{align:"center",justify:"space-between"},{default:t(()=>[n(Z,{tooltip:!1,value:m.value,"onUpdate:value":P[1]||(P[1]=j=>m.value=j),step:1,style:{width:"120px"},disabled:w.value},null,8,["value","disabled"]),n(q,{onBlur:P[2]||(P[2]=j=>m.value??(m.value=0)),value:m.value,"onUpdate:value":P[3]||(P[3]=j=>m.value=j),step:"1",min:"0",max:"100",disabled:w.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:t(()=>[T(" "+c(e(o)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1})]),_:1}),y("canvas",{ref_key:"canvas",ref:k,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),ci=je(ui,[["__scopeId","data-v-060333f5"]]),di={style:{width:"4em","text-align":"left"}},pi={style:{width:"4em","text-align":"left"}},Ot=100,sn=2e3,rn=4096,un=4096,fi=100,gi=100,mi=ye({__name:"settings-adv",props:{expanded:{type:Boolean,required:!1},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}},emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(i){const s=Qe(qe),r={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},u=Ee(i,"expanded"),o=Ee(i,"multithread"),l=Ee(i,"threadCount"),p=Ee(i,"maxZipSize"),d=Ee(i,"retainExt"),z=Ee(i,"useFolderNameForZip"),m=Ee(i,"shrinkImage"),w=Ee(i,"maxWidth"),k=Ee(i,"maxHeight");we(Ue,v=>{v>1||(o.value=!1),l.value>v&&(l.value=v)},{immediate:!0});const h=xe(()=>o.value&&Ue.value>1);return Re(()=>{Ue.value>1&&typeof l.value>"u"&&(l.value=Math.max(Ue.value,2))}),(v,f)=>{const P=he,L=Pe,M=Fa,O=Ae,I=St,Z=In,q=Lt,j=bn;return E(),J(O,{justify:"center"},{default:t(()=>[n(j,{"display-directive":"show","default-expanded-names":u.value?["collapitem"]:"","on-update:expanded-names":_=>u.value=!!String(_),"trigger-areas":["arrow","main"],class:at(["settings-body",u.value?"expand-adv-settings":""])},Ea({arrow:t(()=>[n(P,{style:ue(u.value&&{top:"8px"})},{default:t(()=>[n(e(Ma))]),_:1},8,["style"]),n(P,null,{default:t(()=>[n(e(Ra))]),_:1})]),default:t(()=>[n(q,{title:v.$t("settings.advancedSettings"),name:"collapitem"},{default:t(()=>[n(O,{vertical:"",style:{"padding-left":"2em"}},{default:t(()=>[n(e(ze),it(rt(r)),{trigger:t(()=>[n(O,{vertical:""},{default:t(()=>[n(O,{wrap:!1,align:"center"},{default:t(()=>[n(L,{text:"",disabled:!e(Ue),style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[1]||(f[1]=_=>o.value=!o.value)},{icon:t(()=>[n(P,null,{default:t(()=>[n(e(Pa))]),_:1})]),default:t(()=>[T(" "+c(v.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(M,{value:o.value,"onUpdate:value":f[2]||(f[2]=_=>o.value=_),disabled:!e(Ue),size:"small"},null,8,["value","disabled"])]),_:1}),n(O,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(I,{value:l.value,"onUpdate:value":f[3]||(f[3]=_=>l.value=_),disabled:!e(Ue)||!o.value,step:1,min:2,max:e(Ue),style:{width:"120px"}},null,8,["value","disabled","max"]),n(Z,{onBlur:f[4]||(f[4]=_=>l.value??(l.value=2)),size:"tiny",value:l.value,"onUpdate:value":f[5]||(f[5]=_=>l.value=_),disabled:!e(Ue)||!o.value,step:1,min:2,max:e(Ue),style:{width:"10em"}},{suffix:t(()=>[T(c(v.$t("threads",l.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[T(" "+c(v.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(e(ze),it(rt(r)),{trigger:t(()=>[n(O,{vertical:""},{default:t(()=>[n(O,{wrap:!1,align:"center"},{default:t(()=>[n(L,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:t(()=>[n(P,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Oa))]),_:1})]),default:t(()=>[T(" "+c(v.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(O,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(I,{tooltip:!1,value:p.value,"onUpdate:value":f[6]||(f[6]=_=>p.value=_),step:1,min:Ot,max:sn,style:{width:"120px"}},null,8,["value"]),n(Z,{onBlur:f[7]||(f[7]=_=>p.value??(p.value=Ot)),size:"tiny",value:p.value,"onUpdate:value":f[8]||(f[8]=_=>p.value=_),step:"1",min:Ot,max:sn,style:{width:"10em"}},{suffix:t(()=>f[21]||(f[21]=[T("(MB)")])),_:1},8,["value"])]),_:1})]),_:1})]),default:t(()=>[T(" "+c(v.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(e(ze),it(rt(r)),{trigger:t(()=>[n(O,{wrap:!1,align:"center"},{default:t(()=>[n(L,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[9]||(f[9]=_=>z.value=!z.value)},{icon:t(()=>[n(P,null,{default:t(()=>[n(e(Bt))]),_:1})]),default:t(()=>[T(" "+c(v.$t("settings.useFolderNameForZip")),1)]),_:1}),n(M,{value:z.value,"onUpdate:value":f[10]||(f[10]=_=>z.value=_),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[T(" "+c(v.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(e(ze),it(rt(r)),{trigger:t(()=>[n(O,{wrap:!1,align:"center"},{default:t(()=>[n(L,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[11]||(f[11]=_=>d.value=!d.value)},{icon:t(()=>[n(P,null,{default:t(()=>[n(e(yn))]),_:1})]),default:t(()=>[T(" "+c(v.$t("settings.retainOriginalExtension")),1)]),_:1}),n(M,{value:d.value,"onUpdate:value":f[12]||(f[12]=_=>d.value=_),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[T(" "+c(v.$t("settings.retainExtTooltip")),1)]),_:1},16),n(e(ze),it(rt(r)),{trigger:t(()=>[n(O,{vertical:""},{default:t(()=>[n(O,{wrap:!1,align:"center"},{default:t(()=>[n(L,{disabled:!h.value,text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[13]||(f[13]=_=>m.value=!m.value)},{icon:t(()=>[n(P,null,{default:t(()=>[n(e(Ua))]),_:1})]),default:t(()=>[T(" "+c(v.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(M,{disabled:!h.value,value:m.value,"onUpdate:value":f[14]||(f[14]=_=>m.value=_),size:"small"},null,8,["disabled","value"])]),_:1}),n(O,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(I,{value:w.value,"onUpdate:value":f[15]||(f[15]=_=>w.value=_),disabled:!m.value||!h.value,step:1,min:fi,max:rn,style:{width:"120px"}},null,8,["value","disabled"]),n(Z,{size:"tiny",onBlur:f[16]||(f[16]=_=>w.value??(w.value=8)),value:w.value,"onUpdate:value":f[17]||(f[17]=_=>w.value=_),disabled:!m.value||!h.value,step:1,min:8,max:rn*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[y("span",di,c(v.$t("width")),1)]),suffix:t(()=>f[22]||(f[22]=[T("px")])),_:1},8,["value","disabled","max"])]),_:1}),n(O,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(I,{value:k.value,"onUpdate:value":f[18]||(f[18]=_=>k.value=_),disabled:!m.value||!h.value,step:1,min:gi,max:un,style:{width:"120px"}},null,8,["value","disabled"]),n(Z,{size:"tiny",onBlur:f[19]||(f[19]=_=>k.value??(k.value=8)),value:k.value,"onUpdate:value":f[20]||(f[20]=_=>k.value=_),disabled:!m.value||!h.value,step:1,min:8,max:un*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[y("span",pi,c(v.$t("height")),1)]),suffix:t(()=>f[23]||(f[23]=[T("px")])),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[T(" "+c(v.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1},8,["title"])]),_:2},[u.value?{name:"header-extra",fn:t(()=>[n(e(ze),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(L,{onClick:e(Xa),size:"tiny",style:{"font-size":"xx-small"}},{default:t(()=>[T(c(v.$t("reset")),1)]),_:1},8,["onClick"])]),default:t(()=>[T(" "+c(v.$t("settings.resetButtonTooltip")),1)]),_:1}),e(s).IS_DEV?(E(),ee("button",{key:0,onClick:f[0]||(f[0]=_=>e(Ja)())},"delcfg")):ce("",!0)]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1})}}}),vi=je(mi,[["__scopeId","data-v-31f045db"]]),hi={},_i={style:{color:"gray","padding-left":"20px"}},wi=["innerHTML"];function yi(i,s){const r=gn,u=Ae;return E(),J(u,{vertical:"",justify:"end"},{default:t(()=>[n(r,{style:{margin:"0px"}}),n(u,{justify:"center"},{default:t(()=>[y("ul",_i,[(E(!0),ee(Me,null,_t(i.$tm("descriptions"),o=>(E(),ee("li",{key:o,style:{"text-align":"left"},innerHTML:o},null,8,wi))),128))])]),_:1})]),_:1})}const bi=je(hi,[["render",yi]]),ki="modulepreload",zi=function(i){return"/avif2jpeg/dist/"+i},cn={},_e=function(s,r,u){let o=Promise.resolve();if(r&&r.length>0){let p=function(m){return Promise.all(m.map(w=>Promise.resolve(w).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),z=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));o=p(r.map(m=>{if(m=zi(m),m in cn)return;cn[m]=!0;const w=m.endsWith(".css"),k=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${k}`))return;const h=document.createElement("link");if(h.rel=w?"stylesheet":ki,w||(h.as="script"),h.crossOrigin="",h.href=m,z&&h.setAttribute("nonce",z),document.head.appendChild(h),w)return new Promise((v,f)=>{h.addEventListener("load",v),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(p){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=p,window.dispatchEvent(d),!d.defaultPrevented)throw p}return o.then(p=>{for(const d of p||[])d.status==="rejected"&&l(d.reason);return s().catch(l)})},Un="English",Mn="ðŸ‡¬ðŸ‡§",Rn='AVIF to JPEG "Offline" Batch Converter',Dn="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",Nn="Drag & Drop AVIF Images to Convert",jn=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.'],Bn="Select your language",Zn="Choose Target File Extentions",Hn={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},Vn="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",Wn="Load Images",qn="Select your images from a dialog window.<br>*Multiple selection allowed.",Gn="Load a Whole Folder",Kn=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,Yn="Converting images",Qn="Aborted",Xn="Some files failed to convert",Jn="Completed",eo="Currently Busy",to="No files with the extentions were found.",no="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",oo="Cancel",ao="Save",lo="Close",so="Open",io="Re-convert",ro="Convert previous selected {n} @:files again",uo="File | Files",co="thread | threads",po="You have not saved the converted images yet.",fo="Data have not been saved",go="Open Source",mo="Open the converted image",vo="Copied to clipboard",ho="The converted image was copied to your clipboard as DataURL.",_o="Copy the converted image as DataURL",wo="Convert Again",yo={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",showOnlyErrors:"Show only errors",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files",Shrinked:"Shrinked",Shrinking:"Shrinking",saveAll:"Save All",progressRetries:"Retrying files",success:"success",started:"started",total:"total",files:"files",failure:"failure",all:"all",filterLogSelect:"filter",showOnlySuccess:"Only successes",showOnlyError:"Only errors",showAll:"Show all",Progress:"Progress",PreviewImage:"Preview Images",Log:"Log",log:"Log",Output:"Output Results",expandLog:"expand log size",autoScroll:"auto-scroll",sortByStatus:"status",sort:"Sort list by",sortByName:"name",sortBySize:"size",sortByOutputSize:"size(output)",sortByStart:"starting order",sortByCompletion:"output order"},bo={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file"},ko="Disabled",zo="Download",xo="Reset",Io="Back",To="Failed",Ao="Success",So="Previous version",Lo=`
Height`,Co="Width",$o="Don't show this message again",Eo="About the warning when selecting a folder",Po="OK",Fo={},Oo="You must press the â€œUploadâ€ button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",Uo="Continue",Mo="Cancel",Ro="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",Do="This page may be an outdated version. Please reload the page.",No="Reload",jo='If the conversion process frequently fails and an â€œOut of Memoryâ€ message appears, try reducing or disabling the number of "multi-threads" in the "Advanced Settings".',Bo="Next",Zo="Previous",Ho="or",Vo="Target File Extensions",Wo="Changelog",qo={lang:Un,flags:Mn,title:Rn,metaDescription:Dn,droptarget:Nn,descriptions:jn,selectLanguage:Bn,fileTypeRadioTitle:Zn,fileTypeRadioOptions:Hn,editAcceptTypes:Vn,loadbutton:Wn,loadbuttontooltip:qn,loadfolderbutton:Gn,loadfoldertooltip:Kn,processing:Yn,aborted:Qn,incomplete:Xn,completed:Jn,interfered:eo,noimage:to,avifUnsupported:no,cancel:oo,save:ao,close:lo,open:so,reconvert:io,reconvertTip:ro,files:uo,threads:co,confirmCloseDialog:po,confirmCloseDialogTitle:fo,githubOpenSource:go,convertedImageUrlTooltip:mo,copiedDataURLDialogTitle:vo,copiedDataURLMessage:ho,convertedImageDataUrlTooltip:_o,convertAgain:wo,status:yo,settings:bo,disabled:ko,Download:zo,reset:xo,back:Io,failed:To,success:Ao,previousVersion:So,height:Lo,width:Co,checkboxTextDontShowThis:$o,loadfolderNotifyingTitle:Eo,OK:Po,loadfolderNotifyingMessage:Fo,loadfolderNotifyingMessageTerm2:Oo,Continue:Uo,Cancel:Mo,loadfolderNotifyingMessageTerm1:Ro,errMsgWorkerLoadError:Do,Reload:No,annotationOutOfMemory:jo,Next:Bo,Prev:Zo,or:Ho,TargetFileTypeExt:Vo,changelog:Wo},xi=Object.freeze(Object.defineProperty({__proto__:null,Cancel:Mo,Continue:Uo,Download:zo,Next:Bo,OK:Po,Prev:Zo,Reload:No,TargetFileTypeExt:Vo,aborted:Qn,annotationOutOfMemory:jo,avifUnsupported:no,back:Io,cancel:oo,changelog:Wo,checkboxTextDontShowThis:$o,close:lo,completed:Jn,confirmCloseDialog:po,confirmCloseDialogTitle:fo,convertAgain:wo,convertedImageDataUrlTooltip:_o,convertedImageUrlTooltip:mo,copiedDataURLDialogTitle:vo,copiedDataURLMessage:ho,default:qo,descriptions:jn,disabled:ko,droptarget:Nn,editAcceptTypes:Vn,errMsgWorkerLoadError:Do,failed:To,fileTypeRadioOptions:Hn,fileTypeRadioTitle:Zn,files:uo,flags:Mn,githubOpenSource:go,height:Lo,incomplete:Xn,interfered:eo,lang:Un,loadbutton:Wn,loadbuttontooltip:qn,loadfolderNotifyingMessage:Fo,loadfolderNotifyingMessageTerm1:Ro,loadfolderNotifyingMessageTerm2:Oo,loadfolderNotifyingTitle:Eo,loadfolderbutton:Gn,loadfoldertooltip:Kn,metaDescription:Dn,noimage:to,open:so,or:Ho,previousVersion:So,processing:Yn,reconvert:io,reconvertTip:ro,reset:xo,save:ao,selectLanguage:Bn,settings:bo,status:yo,success:Ao,threads:co,title:Rn,width:Co},Symbol.toStringTag,{value:"Module"})),Ii="Arabic",Ti="German",Ai="English",Si="Spanish",Li="Finnish",Ci="French",$i="Hindi",Ei="Indonesian",Pi="Italian",Fi="Japanese",Oi="Korean",Ui="Dutch",Mi="Polish",Ri="Portuguese",Di="Russian",Ni="Turkish",ji="Ukrainian",Bi="Chinese",Zi={ar:Ii,de:Ti,en:Ai,es:Si,fi:Li,fr:Ci,hi:$i,id:Ei,it:Pi,ja:Fi,ko:Oi,nl:Ui,pl:Mi,pt:Ri,ru:Di,tr:Ni,uk:ji,"zh-hant":"Chinese(hant)",zh:Bi},zt=[],Go={en:qo},Vt={},dn=Object.assign({"./locales/ar.json":()=>_e(()=>import("./ar-Bs-dVZYB.js"),[]),"./locales/de.json":()=>_e(()=>import("./de-BQPc6VLI.js"),[]),"./locales/en.json":()=>_e(()=>Promise.resolve().then(()=>xi),void 0),"./locales/es.json":()=>_e(()=>import("./es-CqBg_y9a.js"),[]),"./locales/fi.json":()=>_e(()=>import("./fi-Ds7g1iCb.js"),[]),"./locales/fr.json":()=>_e(()=>import("./fr-D8EtgegO.js"),[]),"./locales/hi.json":()=>_e(()=>import("./hi-Ezqk50Rr.js"),[]),"./locales/id.json":()=>_e(()=>import("./id-BsMMe9nO.js"),[]),"./locales/it.json":()=>_e(()=>import("./it-BdKCrqWM.js"),[]),"./locales/ja.json":()=>_e(()=>import("./ja-C5lmyrcu.js"),[]),"./locales/ko.json":()=>_e(()=>import("./ko-CNwBvC5L.js"),[]),"./locales/nl.json":()=>_e(()=>import("./nl-C-Lgg7BA.js"),[]),"./locales/pl.json":()=>_e(()=>import("./pl-OSkpSBPS.js"),[]),"./locales/pt.json":()=>_e(()=>import("./pt-BO4nYfyj.js"),[]),"./locales/ru.json":()=>_e(()=>import("./ru-DEYnX-lF.js"),[]),"./locales/tr.json":()=>_e(()=>import("./tr-XAfWKbVj.js"),[]),"./locales/uk.json":()=>_e(()=>import("./uk-f9rkog-K.js"),[]),"./locales/zh-hant.json":()=>_e(()=>import("./zh-hant-eBVV34fF.js"),[]),"./locales/zh.json":()=>_e(()=>import("./zh-k4YjZC5w.js"),[])});var pn;for(const i in dn){const s=(pn=i.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:pn[1];s&&(zt.push(s),!(s in Go)&&(Vt[s]=dn[i]))}let Rt=Vi();Rt in Vt||(Rt="en");const xt=Da({legacy:!1,globalInjection:!0,locale:Rt,fallbackLocale:"en",messages:Go,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Hi(i){if(xt.global.availableLocales.indexOf(i)>=0)return;const s=await Vt[i]();xt.global.setLocaleMessage(i,s),await Ce()}function Vi(){const i=location.pathname;return String(i.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Wi=["innerHTML"],qi=ye({__name:"switch-lang",props:{delay:{}},emits:["lang-ready","lang-change"],async setup(i,{emit:s}){let r,u;const o=Qe(qe),l=mn(),{locale:p,t:d}=We(),z=i,m=s,w=Object.entries(Zi).map(([L,M])=>({label:M,value:L}));w.sort((L,M)=>{const O=L.label,I=M.label;return O>I?1:O<I?-1:0}),Re(()=>{l.afterEach((L,M,O)=>{h(),o.switchToolTipVisibility()})}),[r,u]=Na(()=>h()),await r,u();async function k(L){(L!==p.value||xt.global.availableLocales.indexOf(L)===-1)&&(m("lang-change",L),await Pl(z.delay),await Hi(L),p.value=L,document.title=d("title"),await Ce()),m("lang-ready",L)}async function h(){const L=l.currentRoute.value.path||"",M=String(L.match(new RegExp("(?<=^\\/)[^/]+"))||"");M&&zt.includes(M)?(await k(M),p.value=M):await v()}async function v(){const L=f().toLowerCase(),M=L.split(/[-_]/)[0];if(zt.includes(M)){let O=M;if(M==="zh")switch(L){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":O="zh-hant"}await k(O)}}function f(){const L=window.navigator;return L.language||L.userLanguage||L.browserLanguage}function P(L){console.log(`changeRoute: ${l.currentRoute.value.fullPath} => ${L}`),l.push("/"+L+"/")}return(L,M)=>{const O=he,I=Ct,Z=ze;return E(),J(Z,{to:!1,"display-directive":"show",show:e(o).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(o).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:t(()=>[n(I,{ref:"langselect",size:"tiny",style:{width:"auto"},"consistent-menu-width":!1,options:e(w),"_v-model:value":"locale",value:e(p),"onUpdate:value":P},{arrow:t(()=>[n(O,null,{default:t(()=>[n(e(ja))]),_:1})]),_:1},8,["options","value"])]),default:t(()=>[y("div",{innerHTML:L.$t("selectLanguage")},null,8,Wi)]),_:1},8,["show","placement"])}}}),qe=Symbol("global variables"),Gi=ye({__name:"Avif2Jpeg",emits:["ready"],setup(i,{emit:s}){const{t:r,locale:u}=We(),o=200,l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),p=!1,d=b(null);b(0);let z=b(void 0);const m=b(!0),w=b(!1),k=b(!1),h=b(!1),v=b(!0),f=b(!1);Ha(qe,{showTooltipsBeforeMounted:z,LANDSCAPE:m,IS_SP:l,IS_DEV:p,switchToolTipVisibility:O,SSR:!1}),Re(()=>{I(),window.addEventListener("resize",I),O(),setTimeout(()=>k.value=!0,3e3)}),ht(()=>{window.removeEventListener("resize",I)});let P=0;function L(){h.value=!1,P=Date.now()}function M(){const j=v.value?0:Math.max(0,o-(Date.now()-P));v.value=!1,Ce(()=>{setTimeout(()=>h.value=!0,j)})}async function O(){}function I(){const j=document.body.clientWidth,_=document.body.clientHeight;m.value=j*.75>_||j>900}function Z(j){d.value=j}function q(j){f.value=j}return(j,_)=>{const H=Ae,ve=he,de=Xe;return E(),J(H,{vertical:"",align:"stretch",class:"avif2jpeg"},{default:t(()=>[n(dl,null,{"lang-switch":t(()=>[(E(),J(Ba,null,{default:t(()=>[n(qi,{onLangChange:L,onLangReady:M,delay:e(v)?0:o},null,8,["delay"])]),_:1}))]),_:1}),n(et,{name:"fade"},{default:t(()=>[Ze(n(H,{vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:t(()=>[n(H,{justify:"space-around",vertical:"",style:{height:"100%"}},{default:t(()=>[n(fl),n(H,{justify:"center"},{default:t(()=>[n(ii,{"_v-model_expanded":"UserSettings.expandExtButtons",target:e(W).acceptTypeValue,"onUpdate:target":_[0]||(_[0]=N=>e(W).acceptTypeValue=N),userExtensions:e(W).editedAcceptTypes,"onUpdate:userExtensions":_[1]||(_[1]=N=>e(W).editedAcceptTypes=N),"disable-notifying-folder-select":e(W).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":_[2]||(_[2]=N=>e(W).disableNotifyingFolderSelect=N),forbidden:e(w),onInput:Z,onClick:_[3]||(_[3]=N=>q(!0)),onCancel:_[4]||(_[4]=N=>q(!1))},null,8,["target","userExtensions","disable-notifying-folder-select","forbidden"])]),_:1}),n(Bs,{input:e(d),format:e(W).imageFormat,quality:e(W).imageQuality,"retain-extension":e(W).retainExtension,maxZipSizeMB:e(W).maxZipSizeMB,threads:e(W).multithread?e(W).threadCount:0,"show-note":e(f),"onUpdate:showNote":_[5]||(_[5]=N=>Ve(f)?f.value=N:null),onStart:_[6]||(_[6]=N=>w.value=!0),onEnd:_[7]||(_[7]=N=>w.value=!1)},{"lang-switch":t(()=>_[18]||(_[18]=[])),_:1},8,["input","format","quality","retain-extension","maxZipSizeMB","threads","show-note"]),n(H,{vertical:"",align:"center"},{default:t(()=>[n(de,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(ve,{size:"5vh",color:"#DADADA",style:{margin:"0px"}},{default:t(()=>[n(e(Za))]),_:1})]),default:t(()=>[_[19]||(_[19]=y("span",null,"CONVERT TOðŸ‘‡",-1))]),_:1})]),_:1}),n(H,{vertical:"",align:"center"},{default:t(()=>[n(ci,{format:e(W).imageFormat,"onUpdate:format":_[8]||(_[8]=N=>e(W).imageFormat=N),quality:e(W).imageQuality,"onUpdate:quality":_[9]||(_[9]=N=>e(W).imageQuality=N)},null,8,["format","quality"]),n(vi,{"retain-ext":e(W).retainExtension,"onUpdate:retainExt":_[10]||(_[10]=N=>e(W).retainExtension=N),"use-folder-name-for-zip":e(W).useFolderNameForZip,"onUpdate:useFolderNameForZip":_[11]||(_[11]=N=>e(W).useFolderNameForZip=N),"max-zip-size":e(W).maxZipSizeMB,"onUpdate:maxZipSize":_[12]||(_[12]=N=>e(W).maxZipSizeMB=N),"_v-model:expanded":"UserSettings.expandAdvSettings",multithread:e(W).multithread,"onUpdate:multithread":_[13]||(_[13]=N=>e(W).multithread=N),"thread-count":e(W).threadCount,"onUpdate:threadCount":_[14]||(_[14]=N=>e(W).threadCount=N),"_:thread-max":"availableThreadCount","shrink-image":e(W).shrinkImage,"onUpdate:shrinkImage":_[15]||(_[15]=N=>e(W).shrinkImage=N),"max-width":e(W).maxWidth,"onUpdate:maxWidth":_[16]||(_[16]=N=>e(W).maxWidth=N),"max-height":e(W).maxHeight,"onUpdate:maxHeight":_[17]||(_[17]=N=>e(W).maxHeight=N)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","multithread","thread-count","shrink-image","max-width","max-height"])]),_:1}),n(bi)]),_:1})]),_:1},512),[[He,e(h)]])]),_:1})]),_:1})}}}),Wt=ye({__name:"App",setup(i){const s={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{},Image:{toolbarColor:"#00000099"}},r=b(!0);return Re(()=>{r.value=!1}),(u,o)=>{const l=Ga,p=qa,d=Wa,z=Va,m=Ka;return E(),J(m,{"theme-overrides":s,style:{width:"100%",height:"100%"}},{default:t(()=>[n(z,null,{default:t(()=>[n(d,{placement:"top-left",closable:!0,max:50},{default:t(()=>[n(p,null,{default:t(()=>[n(l,null,{default:t(()=>[n(Gi,{class:at({hide:e(r)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),Ko=[{path:"/",name:"Home",component:Wt}];for(const i of zt)Ko.push({path:"/"+i+"/",strict:!0,name:i,component:Wt});Ya(Wt,{routes:Ko,base:"/avif2jpeg/dist/"},({app:i,router:s,routes:r,isClient:u,initialState:o})=>{i.use(xt)});
