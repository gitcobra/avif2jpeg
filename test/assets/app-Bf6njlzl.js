var ya=Object.defineProperty;var wa=(a,i,g)=>i in a?ya(a,i,{enumerable:!0,configurable:!0,writable:!0,value:g}):a[i]=g;var Ft=(a,i,g)=>wa(a,typeof i!="symbol"?i+"":i,g);import{r as lt,d as he,i as Ne,o as E,c as q,w as t,a as n,u as e,b as S,t as c,N as me,_ as qt,e as Ae,L as ba,f as h,g as te,h as y,F as xe,j as Re,B as ze,k as yt,l as ie,m as xa,n as Aa,p as Ie,q as wt,s as Gt,v as ve,x as ka,y as ye,z as mt,A as vt,C as bt,D as xt,E as Fe,T as De,G as Kt,H as Qt,I as je,J as oe,K as za,M as He,O as Be,P as st,Q as Yt,R as Se,S as Jt,U as it,V as se,W as Ia,X as Ta,Y as At,Z as pt,$ as Mt,a0 as Je,a1 as Sa,a2 as Xt,a3 as kt,a4 as $a,a5 as en,a6 as La,a7 as tn,a8 as ft,a9 as Ee,aa as Ke,ab as Ca,ac as Ea,ad as Fa,ae as Ma,af as Pa,ag as nn,ah as zt,ai as It,aj as Oa,ak as an,al as Ua,am as Da,an as ja,ao as Ra,ap as Ba,aq as Za,ar as Tt,as as Na,at as Ha,au as Wa,av as Va,aw as on,ax as qa,ay as Ga,az as ln,aA as sn,aB as Ka,aC as Te,aD as qe,aE as Ge,aF as Qa,aG as Ya,aH as Ja,aI as Xa,aJ as eo,aK as to,aL as no,aM as ao,aN as oo,aO as lo,aP as so,aQ as io,aR as ro,aS as uo,aT as co,aU as po,aV as fo,aW as go,aX as mo}from"./vendor-DXBuSSCY.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function g(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=g(s);fetch(s.href,r)}})();const vo={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:void 0,shrinkImage:!1,maxWidth:4096,maxHeight:4096},N=lt(rn({}));function ho(){rn(N)}function rn(a){return Object.assign(a,vo)}const un="avif2jpeg",gt=JSON.parse(localStorage.getItem(un)||"{}");for(const a in N)gt.hasOwnProperty(a)&&gt[a]!==void 0&&(N[a]=gt[a]);window.addEventListener("unload",()=>{const a={};for(const i in N)a[i]=N[i];localStorage.setItem(un,JSON.stringify(a))});const _o=he({__name:"github",setup(a){const i=Ne(Oe);return(g,o)=>{const s=me,r=qt,l=Ae;return E(),q(l,{to:!1,"display-directive":"show",show:e(i).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(r,{href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-size":"small","font-weight":"bolder"}},{default:t(()=>[n(s,null,{default:t(()=>[n(e(ba))]),_:1}),S("GitHub")]),_:1})]),default:t(()=>[S(" "+c(g.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),yo=y("h3",null,"Used Framework and Libraries",-1),wo=["href"],bo=he({__name:"licenses",setup(a){const i=h(!1),g={Vue:"https://github.com/vuejs/core/blob/main/LICENSE",Vite:"https://github.com/vitejs/vite/blob/main/LICENSE","Vite SSG":"https://github.com/antfu/vite-ssg/blob/main/LICENSE","Naive UI":"https://github.com/TuSimple/naive-ui/blob/main/LICENSE",Ionicons:"https://github.com/ionic-team/ionicons/blob/main/LICENSE"};return(o,s)=>{const r=ze;return E(),te(xe,null,[n(r,{text:"",onClick:s[0]||(s[0]=l=>i.value=!0),style:{color:"black","font-size":"small"}},{default:t(()=>[S("Licenses")]),_:1}),n(e(yt),{preset:"dialog",ref:"dialog",show:i.value,"onUpdate:show":s[1]||(s[1]=l=>i.value=l),"positive-text":"OK",title:"Licenses"},{default:t(()=>[yo,y("ul",null,[(E(),te(xe,null,Re(g,(l,f)=>y("li",null,[y("a",{href:l},c(f),9,wo)])),64))])]),_:1},8,["show"])],64)}}}),xo=1,Ao=7,ko=1,zo="",nt={major:xo,minor:Ao,build:ko,tag:zo},Io={style:{"font-size":"x-small","user-select":"none"}},To=he({__name:"version",setup(a){const i=["0.0.118"],g=`${nt.major}.${nt.minor}.${nt.build}${nt.tag}`,o=i.map(f=>({label:`v${f}`,key:f,value:f}));function s(f){const{key:b,label:x}=f,A=l(b),p=ie("a",{href:A},x),T=ie("div",null,p);return ie("div",null,T)}function r(f){location.href=l(f)}function l(f){return`/avif2jpeg/old/${f}/`}return(f,b)=>{const x=xa;return E(),q(x,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:e(o),"render-label":s,"onUpdate:value":r},{header:t(()=>[y("span",Io,c(f.$t("previousVersion")),1)]),default:t(()=>[y("span",{style:{cursor:"pointer"}},"v"+c(g))]),_:1},8,["options"])}}}),So=he({__name:"header",setup(a){return(i,g)=>{const o=Ie,s=wt;return E(),q(o,{vertical:"",justify:"start"},{default:t(()=>[n(o,{justify:"space-between",style:{"box-sizing":"border-box",padding:"4px",margin:"0px"}},{default:t(()=>[n(o,{align:"start"},{default:t(()=>[n(_o),n(To),n(o,{align:"center"},{default:t(()=>[n(bo)]),_:1})]),_:1}),n(o,{align:"end",style:{"font-size":"x-small"}},{default:t(()=>[Aa(i.$slots,"lang-switch")]),_:3})]),_:3}),n(s,{style:{margin:"0px"}})]),_:3})}}}),$o={style:{padding:"0px",margin:"0px","text-align":"center"}},Lo={key:0},Co=he({__name:"title",setup(a){const i=Gt(),g=ve(()=>{const o=i.currentRoute.value.path||"";return!String(o.match(new RegExp("(?<=^\\/)[^/]+"))||"")});return(o,s)=>{const r=qt,l=ka("router-link"),f=Ie;return E(),q(f,{align:"center",justify:"center",style:{margin:"0px"}},{default:t(()=>[y("h1",$o,[e(g)?(E(),te("span",Lo,c(o.$t("title")),1)):(E(),q(l,{key:1,to:"../",custom:""},{default:t(({navigate:b,href:x})=>[n(r,{href:x,onClick:b,style:{color:"black","word-break":"keep-all","overflow-wrap":"break-word"}},{default:t(()=>[S(c(o.$t("title")),1)]),_:2},1032,["href","onClick"])]),_:1}))])]),_:1})}}});function Eo(a){return new Worker("/avif2jpeg/test/assets/worker.canvas-BATBYKKf.js",{name:a==null?void 0:a.name})}let dn=0;class Fo extends Eo{constructor(){super(...arguments);Ft(this,"id",dn++)}release(){ut(this)}}const ht=[],Ze=new Set,Qe=new Map,Ye=new Map,rt=new Set;function Mo(a,i){const g=new Fo;ht.push(g);{const o=Promise.resolve(g);Ze.add(o),Qe.set(g,o)}return g}function Po(a){const i=new Promise(g=>{Ye.set(a,g)});Ze.add(i),Qe.set(a,i),rt.add(a)}async function Oo(){let a,i;do a=await Promise.any(Ze);while(rt.has(a));return i=Qe.get(a),Qe.delete(a),Ze.delete(i),Po(a),a}function ut(a){const i=Ye.get(a);i&&(Ye.delete(a),rt.delete(a),i(a))}function cn(){for(const a of Ye.keys())ut(a)}async function Pt(){return await Promise.all(Ze)}function Ot(){cn();for(const a of ht)a.terminate();ht.length=0,Ze.clear(),Qe.clear(),Ye.clear(),rt.clear(),dn=0}function Uo(a){return new Worker("/avif2jpeg/test/assets/worker.zip-BsftfVr4.js",{name:a==null?void 0:a.name})}const Ut=1,Do=10,jo=1024*1024*4,Ro=100;async function Bo(a,i,g,o,s,r,l,f,b,x,A,p){const T=new Map,_=new Map,m=Math.min(g.threads-1,l.length);Ot();const v=new Uo,k=Zo(v,a,i,f,T);v.postMessage({action:"set-config",zipSize:g.maxZipSizeMB*1024*1024,keepExt:g.retainExtension,outputExt:A,imageType:p});const z=No(a,i,o,s,r,l,f,_,T);for(let D=0;D<m;D++){const K=Mo();K.onmessage=z;const{port1:ne,port2:X}=new MessageChannel;v.postMessage({action:"set-port"},[ne]),K.postMessage({},[X])}const w=ye(i,D=>{D&&(w(),cn())});a.demandImage=D=>{v.postMessage({action:"request-image",index:D})};const u=l.length===1;let O=0,j=0,I="",V=0;for(;V<l.length;){const D=await Oo();if(i.value){ut(D);break}const K=[];let ne=!1;const X=l.length-V,re=Math.min(V+Math.max(Math.min(Do,X/g.threads|0),1),l.length);let ue=0,de=!1;const L=Date.now();for(L-j>Ro&&(j=L,de=!0);V<re&&!(ue>jo);V++){const C=l[V],U=C._id;ue+=C.size,ne=V===l.length-1,T.has(U)||T.set(U,C),K.push({index:V,file:C,fileId:U,outputPath:I,type:b,quality:x/100,demandThumbnail:de||ne,isSingleImage:u,maxSize:N.shrinkImage?{width:N.maxWidth,height:N.maxHeight}:null,webkitRelativePath:C.webkitRelativePath});const $=C.webkitRelativePath||C.name;_.has(C)?console.warn(`retry "${$}".`):(O++,a.index=O),de=!1}if(D.postMessage(K),ne&&(await Pt(),i.value))break}if(console.log("end file loop"),await Pt(),console.log("resolved all workers"),!i.value){let D;await new Promise(K=>{D=ye([()=>a.done,i],()=>{(a.done>=O||i.value)&&K(void 0)},{immediate:!0})}),D(),console.log("processed all files")}v.postMessage({action:"squeeze"}),await k,w();const M={value:!1},we=()=>{M.value=!0,Ot(),v.terminate()};let R=!1;return{callbackToClearConverter:we,callbackToGenerateFailedZips:async D=>{R||(R=!0,await Ho(D,v,M,a))}}}function Zo(a,i,g,o,s){return new Promise(l=>{a.onmessage=f=>{const b=f.data,{action:x}=b;if(x==="add-zip-completed"){const{fileId:_}=b;i.done++,i.success++,o.add(_);return}if(x==="respond-image"){const{url:_,index:m,path:v,size:k,fileId:z}=b;i.convertedImageUrl=_,i.convertedImageSize=k,i.convertedImageIndex=m,i.convertedImageName=v,i.convertedImageFileId=z;let w="",F=0,u="";if(z>=0){const O=s.get(z);w=URL.createObjectURL(O),F=O.size,u=O.name}i.convertedImageOrgUrl=w,i.convertedImageOrgSize=F,i.convertedImageOrgName=u;return}const{size:A,count:p}=b,T="url"in f.data?f.data.url:"";switch(x){case"push-zip":i.zips.push({url:T,size:A,count:p}),i.zippedTotalCount+=p,i.zippedTotalSize+=A;break;case"squeeze-zip":p>0&&(i.zips.push({url:T,size:A,count:p}),i.zippedTotalCount+=p,i.zippedTotalSize+=A),l(void 0);break;case"push-filelist":i.failedFileZippedCount++;break;case"squeeze-filelist-zip":i.failedZipDone=!0;case"push-filelist-zip":console.log("push-filelist-zip",p),i.failedZips.push({url:T,size:A,count:p});break;case"zip-error":case"zip-squeeze-error":i.zippingErrorCount+=p,x==="zip-squeeze-error"&&l(void 0);break}}})}function No(a,i,g,o,s,r,l,f,b,x,A,p){let T=0;const _=h(new Map),m=h(new Map);return k=>{const z=k.target,{data:w}=k,{action:F}=w;if(i.value)switch(F){case"file-canceled":console.log("file-canceled"),a.done++;return}switch(F){case"list-start":console.log(`list started on worker ${z.id}`);break;case"file-start":{const{index:u,path:O,fileId:j}=w,I={key:T++,core:z.id,index:u,path:O,command:"➡️started"};_.value.set(z.id,I),a.logs.push(I);break}case"file-load":{const{thumbnail:u,width:O,height:j}=w;_.value.get(z.id).command="🖼️loaded",u&&(a.thumbnail=u);break}case"file-converted":{const{index:u,path:O,fileId:j}=w,I=_.value.get(z.id);I.command="🔃converted",m.value.set(j,I),a.converted++;break}case"file-completed":{const{inputsize:u,outputsize:O,fileId:j}=w;a.inputTotalSize+=u,a.outputTotalSize+=O;const I=m.value.get(j);I&&(I.command="✅completed",I.completed=!0);break}case"file-error":{const{index:u,path:O,fileId:j}=w,I=b.get(j);if(!I)throw new Error(`the file doesn't exist in the Map. "${j}":"${O}"`);const V=f.get(I)||0,M=_.value.get(z.id);V<Ut?(f.set(I,V+1),r.push(I),console.error(`worker ${z.id} threw an error when loading "${O}". retrying the file.`),M.command="⚠️retrying",M.error=!0,o.warning(`retrying "${O}"`,{duration:3e3})):(console.error(`failed to load "${O}" after ${Ut} retries. the image may be corrupted or cannot be read by some reason.`),a.done++,a.failure++,M.command="❗failed",M.error=!0,s.error({content:`failed to load "${O}"`,duration:5e3}));break}case"file-canceled":{const{fileId:u,path:O}=w,j=m.value.get(u);a.done++,a.failure++,j.command="❗zip-aborted",j.error=!0;break}case"list-end":{ut(z);break}}}}async function Ho(a,i,g,o){let s=0;for(const r of a){const l=(r.webkitRelativePath||r.name).replace(/^\//,"");if(g.value)return;s-o.failedFileZippedCount>20&&await new Promise(f=>setTimeout(f,10)),i.postMessage({action:"add-filelist",file:r,path:l}),s++}i.postMessage({action:"squeeze-filelist"})}async function Wo(a,i,g,o,s,r){let l="";const f=document.createElement("canvas"),b=f.getContext("2d");let x=new mt;const A=o.format,p=o.quality/100,T=[...A.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),_=a.length,m=o.maxZipSizeMB*1024*1024;let v=0,k=null,z="",w="",F=0,u=0,O=0,j=0,I=0,V=!1;for(const D of a){if(s.value)break;const K=D.name;let ne="";const X=D.size,re=(D.webkitRelativePath||D.relativePath||K).replace(/^\//,""),ue=document.createElement("img");v++;const de={key:O++,core:-1,index:v,path:re,command:"➡️start"};r.index=v,r.logs.push(de),r.logs.length-1;let L;l&&(URL.revokeObjectURL(l),l=""),l=URL.createObjectURL(D),w=l,F=D.size,ue.src=l;const C=await pn(ue).then(()=>!0).catch(()=>!1);if(!ue.complete||!C||s.value){r.done++,r.failure++,de.command="❗failed";continue}const U=ue.width,$=ue.height;if(f.width=U,f.height=$,b.drawImage(ue,0,0,U,$,0,0,U,$),de.command="🖼️imgload",r.thumbnail=ue,L=await new Promise(W=>{const ae=ee=>{k=ee,W(ee==null?void 0:ee.arrayBuffer())};f.toBlob(ae,A,p)}),s.value)break;if(!L){console.log("failed to toBlob",K),r.failure++;continue}u=L.byteLength,r.converted++;let P="";if(I+u>=m){try{P=x.url()}catch(W){V=!0,console.warn(W.message,I),alert("memory problem occurred");break}r.zips.push({url:P,size:I,count:j}),r.zippedTotalCount+=j,r.zippedTotalSize+=I,I=0,j=0,x.clear(),x=new mt}I+=u;const B=re||K;for(let W=1;W<255&&(ne=B.replace(o.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(W>1?`(${W})`:"")+"."+T,!!x.has(ne));W++);r.done++;try{j++,x.add(ne,L),r.inputTotalSize+=X,r.outputTotalSize+=u}catch(W){console.error(W.message);continue}z=ne,r.success++,de.command="✅completed",de.completed=!0,i.add(D._id)}if(r.success>0)if(_===1)k&&(r.convertedImageIndex=0,r.convertedImageName=z.replace(/^.*\/(?=[^/]+$)/,"").replace(o.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+T,r.convertedImageUrl=URL.createObjectURL(k),r.convertedImageOrgUrl=w,r.convertedImageOrgSize=F);else try{if(V)throw new Error("terminated zipping process for memory problems");const D=x.url();r.zips.push({url:D,count:j,size:I}),r.zippedTotalCount+=j,r.zippedTotalSize+=I}catch(D){console.error(D.message)}const M={value:!1},we=()=>{M.value=!0};let R=!1;return{callbackToClearConverter:we,callbackToGenerateFailedZips:async D=>{R||(R=!0,Vo(D,m,r,M))}}}async function Vo(a,i,g,o){let s=0,r=0,l=new mt;for(let f=0;f<a.length;f++){const b=a[f],x=(b.webkitRelativePath||b.name).replace(/^\//,"");let A;try{A=await b.arrayBuffer()}catch{console.warn(x),g.failedToCreateFailedZip=!0;return}if(o.value)return;if(l.add(x,A),r+=b.size,s++,g.failedFileZippedCount++,r>=i||f===a.length-1){const p=l.url();g.failedZips.push({url:p,size:r,count:s}),l.clear(),r=0,s=0}}g.failedZipDone=!0}function pn(a){if(typeof a.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((i,g)=>{a.onload=i,a.onerror=g})}const Me=(a,i)=>{const g=a.__vccOpts||a;for(const[o,s]of i)g[o]=s;return g},qo=a=>(bt("data-v-5dab19ad"),a=a(),xt(),a),Go={class:"container"},Ko=qo(()=>y("span",{class:"text"},"ZIP",-1)),Qo={__name:"zipicon",setup(a){return(i,g)=>(E(),te("span",Go,[n(e(me),null,{default:t(()=>[n(e(vt))]),_:1}),Ko]))}},Yo=Me(Qo,[["__scopeId","data-v-5dab19ad"]]);function Pe(a,i=2){const g=Math.sign(a);a=Math.abs(a);const o=["Bytes","KB","MB","GB"],s=a?Math.floor(Math.log(a)/Math.log(1024)):0;return`${(a/Math.pow(1024,s)*g).toFixed(i)}${o[s]}`}function fn(a,i=100,g=!1){i=typeof i=="number"?{width:i,height:i}:i;const{width:o,height:s}=i;let{width:r,height:l}=a;const f=r/l,b=o/s;return f>=b?(r=g?Math.min(o,r):o,l=r/f|0):(l=g?Math.min(s,l):s,r=l*f|0),{width:r,height:l}}const Jo=["href","download","title"],Xo=he({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean}},emits:["load","error","next","prev"],setup(a,{expose:i,emit:g}){Fe();const o=a,s=g;i({download:v,openPreview:k});const r=h(),l=h(!0),f=h(""),b=h(100),x=h(100),A=h(!1),p=lt({width:"100px",height:"100px",minWidth:"50px",minHeight:"50px"});ye(o,(z,w)=>{p.width=(o.width||100)+"px",p.height=(o.height||100)+"px"}),ye(()=>o.src,()=>{m(o.src)},{immediate:!0});async function T(z){const w=z.target,F=w.naturalWidth,u=w.naturalHeight,{width:O,height:j}=fn({width:F,height:u},{width:o.maxWidth||100,height:o.maxHeight||100},o.expand);b.value=O,x.value=j,s("load",{src:w.src,width:F,height:u}),l.value=!1,await new Promise(I=>setTimeout(I,100)),!l.value&&(A.value=!0)}function _(z){const w=z.target;s("error",w.src)}async function m(z){l.value=!0,A.value=!1,await new Promise(w=>setTimeout(w,150)),f.value=z}function v(){const z=document.createElement("a");z.href=f.value,z.download=o.fileName,z.click()}function k(){var z,w,F,u;try{(w=(z=r.value)==null?void 0:z.previewInstRef)==null||w.setPreviewSrc(o.src),(u=(F=r.value)==null?void 0:F.previewInstRef)==null||u.toggleShow(!0)}catch{}}return(z,w)=>{const F=za,u=He,O=Be;return E(),q(O,{show:e(l)||o.loading},{default:t(()=>[n(u,{justify:"center",align:"center",style:oe(e(p))},{default:t(()=>[y("a",{href:e(f),onClick:w[0]||(w[0]=je(()=>{},["left","prevent"])),target:"_blank",download:o.fileName,title:o.fileName,style:{"line-height":"0px"}},[n(De,{mode:"in-out"},{default:t(()=>[Kt(n(F,{ref_key:"nImageRef",ref:r,"show-toolbar-tooltip":"","_:render-toolbar":"renderToolbar",onLoad:T,onError:_,src:e(f),width:e(b),height:e(x),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[Qt,e(A)]])]),_:1})],8,Jo)]),_:1},8,["style"])]),_:1},8,["show"])}}}),Dt=Me(Xo,[["__scopeId","data-v-5fc1a130"]]),el={style:{"font-weight":"bold",color:"gray"}},tl={style:{"font-weight":"bold",color:"gray"}},nl=["href","download"],al=["href"],ol={style:{"font-size":"0.8em"}},ll=he({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean}},emits:["demand-image"],setup(a,{expose:i,emit:g}){const o=a,s=g;i({download:K});const r=h(),l=h(),f=h(),b=st(),{t:x}=Fe();Yt();const A=h(!0),p=h(1),T=h(1),_=h(1);h(0);const m=h(""),v=h(1),k=h(1),z=h(!1),w=h(!1),F=h(!1),u=ve(()=>{var L,C;return((C=(L=f==null?void 0:f.value)==null?void 0:L.previewInstRef)==null?void 0:C.previewSrc)===m.value}),O=ve(()=>p.value<o.length),j=ve(()=>p.value>1);let I=-1;ye(p,()=>{p.value<1||p.value>o.length||(clearTimeout(I),I=setTimeout(()=>{o.index!==p.value-1&&(s("demand-image",p.value-1),z.value=!0,w.value=!1,F.value=!1)},100))}),ye(()=>o.index,()=>{var C,U;let L="";if(o.index===0&&A.value?(A.value=!1,p.value=1,L=o.url):o.index===p.value-1&&(z.value=!1,L=o.url),L){try{(U=(C=f.value)==null?void 0:C.previewInstRef)!=null&&U.displayed&&(u.value?f.value.previewInstRef.setPreviewSrc(L):f.value.previewInstRef.setPreviewSrc(o.originalUrl))}catch{}m.value=L}},{immediate:!0});let V="",M="";ye(()=>o.url,()=>{if(o.url!==V){const L=V,C=M;setTimeout(()=>{URL.revokeObjectURL(L),URL.revokeObjectURL(C)},1e3),V=o.url,M=o.originalUrl}o.isSingle&&(A.value=!1,m.value=o.url)}),Se(()=>{o.isSingle,s("demand-image",0),document.body.addEventListener("keydown",R),document.body.addEventListener("keydown",we)}),Jt(()=>{document.body.removeEventListener("keydown",R),document.body.removeEventListener("keydown",we)});function we(L){var C,U,$,P;if(L.code==="Escape")try{(U=(C=f.value)==null?void 0:C.previewInstRef)!=null&&U.displayed&&(L.stopPropagation(),(P=($=f.value)==null?void 0:$.previewInstRef)==null||P.toggleShow(!1))}catch{}}function R(L){var C,U;switch(L.code){case"ArrowRight":case"PageDown":X(1);break;case"ArrowLeft":case"PageUp":X(-1);break;case"ArrowUp":case"Home":p.value=1;break;case"ArrowDown":case"End":p.value=o.length;break;case"Space":case"Enter":ue();break;default:return}L.stopPropagation(),(U=(C=f.value)==null?void 0:C.previewInstRef)!=null&&U.displayed&&L.preventDefault()}function J({width:L,height:C}){T.value=L,_.value=C,w.value=!0}function D({width:L,height:C}){v.value=L,k.value=C,F.value=!0}function K(){u.value?r.value.download():l.value.download()}async function ne(L){try{const C=await fetch(L).then(U=>U.blob()).then(U=>new Promise($=>{const P=new FileReader;P.onload=$,P.readAsDataURL(U)})).then(U=>U.target.result);navigator.clipboard.writeText(C),b.info({title:x("copiedDataURLDialogTitle"),content:()=>ie("div",[ie("div",x("copiedDataURLMessage"))]),positiveText:"OK"})}catch(C){console.error(C),b.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function X(L){L>0&&p.value<o.length&&p.value++,L<0&&p.value>1&&p.value--}let re=()=>{};const ue=L=>{const C=u.value;re(),it(()=>{u.value===C&&re()})};function de({nodes:L}){var U,$,P,B;re=((B=(P=($=(U=L.next.children)==null?void 0:U.trigger)==null?void 0:$.call(U))==null?void 0:P.props)==null?void 0:B.onClick)||(()=>{});const C=ie(At,{color:u.value?"green":"gray",offset:[-20,-12],value:(u.value?x("status.Converted"):x("status.Original"))+" "+p.value},ie(ze,{round:!0,onClick(){ue()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>ie(u.value?Ia:Ta)}));L.next=ie(ze,{onClick(){X(1)},disabled:!O.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>ie(pt)}),L.prev=ie(ze,{onClick(){X(-1)},disabled:!j.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>ie(Mt)});try{const W=L.download.children;W.default=()=>x("save");const ae=W.trigger();ae.props.onClick=K,W.trigger=()=>ae}catch{}return[C,...Object.values(L)]}return(L,C)=>{const U=Ie,$=He,P=me,B=Je,W=Sa,ae=Xt,ee=kt,be=Be;return E(),q(be,{size:"large",show:A.value},{default:t(()=>[n($,{justify:"center",align:"center",vertical:"",style:oe({visibility:A.value?"hidden":"visible"})},{default:t(()=>[n($,{align:"center",wrap:!1},{default:t(()=>[n(W,{ref_key:"nImageGroupRef",ref:f,"show-toolbar-tooltip":"","render-toolbar":de},{default:t(()=>[n($,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n($,{align:"center",justify:"center",vertical:""},{default:t(()=>[n($,{align:"center",justify:"center",wrap:!1,style:{"font-size":"smaller"},class:"original-thumb"},{default:t(()=>[n(Dt,{ref_key:"thumbOrgRef",ref:l,src:L.originalUrl,width:100,"max-width":100,"max-height":80,loading:z.value,"file-name":L.originalName,"allow-next":p.value<o.length,"allow-prev":p.value>1,onLoad:D,onNext:C[0]||(C[0]=ge=>X(1)),onPrev:C[1]||(C[1]=ge=>X(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(U,{vertical:"",align:"center"},{default:t(()=>[y("span",el,c(e(x)("status.Original")),1),n(U,{justify:"center",style:{"white-space":"nowrap","font-family":"v-mono"}},{default:t(()=>[S(c(String(v.value).padStart(4," "))+" × "+c(String(k.value).padStart(4," ")),1)]),_:1}),n(U,{justify:"center"},{default:t(()=>[S(c(e(Pe)(o.originalSize,0)),1)]),_:1})]),_:1})]),_:1})]),_:1}),n($,{style:{margin:"1em"},class:"original-thumb"},{default:t(()=>[n(P,{size:"48",color:"silver"},{default:t(()=>[n(e(pt))]),_:1})]),_:1}),n($,{vertical:"",align:"center",justify:"center"},{default:t(()=>[n($,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(Dt,{ref_key:"thumbConvRef",ref:r,src:m.value,width:140,"max-width":140,"max-height":100,loading:z.value,"file-name":o.name,"allow-next":p.value<o.length,"allow-prev":p.value>1,onLoad:J,onNext:C[2]||(C[2]=ge=>X(1)),onPrev:C[3]||(C[3]=ge=>X(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n($,{vertical:"",align:"center"},{default:t(()=>[y("span",tl,c(e(x)("status.Converted")),1),n($,{justify:"center",wrap:!0},{default:t(()=>[o.url?(E(),q(B,{key:0,"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",{href:o.url,ref:"saveImg",target:"_blank",download:o.name},[n(e(ze),{round:"",size:"tiny"},{default:t(()=>[S(c(L.$t("save")),1)]),_:1})],8,nl)]),default:t(()=>[S(" "+c(L.$t("save")),1)]),_:1})):se("",!0),o.url?(E(),q(B,{key:1,"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",{href:o.url,target:"_self"},[n(e(ze),{onClick:C[4]||(C[4]=je(ge=>ne(o.url),["left","prevent","stop"])),round:"",size:"tiny"},{default:t(()=>[S("DataURL")]),_:1})],8,al)]),default:t(()=>[S(" "+c(L.$t("convertedImageDataUrlTooltip")),1)]),_:1})):se("",!0)]),_:1}),n($,{justify:"center",style:{"white-space":"nowrap","font-family":"v-mono"}},{default:t(()=>[S(c(String(T.value).padStart(4," "))+" × "+c(String(_.value).padStart(4," ")),1)]),_:1}),n($,{justify:"center"},{default:t(()=>[S(c(e(Pe)(o.size,0)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),n($,{ref:"fileNameContainer",justify:"center",style:{"max-width":"320px"},title:o.name},{default:t(()=>[n(ae,{"x-scrollable":!0,trigger:"hover",style:{"font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:t(()=>[S(c(o.name),1)]),_:1})]),_:1},8,["title"]),L.isSingle?se("",!0):(E(),q($,{key:0,style:{"font-family":"v-mono"},align:"center"},{default:t(()=>[y("span",ol,c(e(x)("status.index"))+":",1),S(" "+c(p.value)+" / "+c(o.length),1)]),_:1})),L.isSingle?se("",!0):(E(),q($,{key:1,align:"center",justify:"center"},{default:t(()=>[n(e(ze),{onClick:C[5]||(C[5]=ge=>X(-1)),disabled:!e(j),circle:!0,size:"small"},{icon:t(()=>[n(P,null,{default:t(()=>[n(e(Mt))]),_:1})]),_:1},8,["disabled"]),n(ee,{value:p.value,"onUpdate:value":C[6]||(C[6]=ge=>p.value=ge),tooltip:!1,step:1,min:1,max:o.length,style:{width:"180px"}},null,8,["value","max"]),n(e(ze),{onClick:C[7]||(C[7]=ge=>X(1)),disabled:!e(O),circle:!0,size:"small"},{icon:t(()=>[n(P,null,{default:t(()=>[n(e(pt))]),_:1})]),_:1},8,["disabled"])]),_:1}))]),_:1},8,["style"])]),_:1},8,["show"])}}}),sl=Me(ll,[["__scopeId","data-v-fdcd7403"]]),il={class:"log-table"},rl={class:"log-tr"},ul={class:"log-th"},dl={class:"log-th"},cl={style:{"min-width":"7em"},class:"log-th"},pl={style:{"padding-left":"2em"},class:"log-th"},fl={class:"log-td"},gl={class:"log-td"},ml={class:"log-td"},vl={class:"log-td"},hl={style:{margin:"1px"}},_l=["href","download","onClick"],yl={key:0,style:{position:"relative"}},wl=["href","download"],bl=["href","download"],xl={key:0,style:{margin:"1px"}},Al=["href","download","onClick"],jt=99999,kl=100,zl=he({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image"],setup(a,{emit:i}){const g=st(),{t:o}=Fe(),s=Yt(),r={W:160,H:80},l=a,f=i,b=h(!1),x=h([]),A=h(!1),p=h([]),T=h([]),_=h([0,0]),m=h([0,0]),v=h([0,0]),k=h([0,0]),z=h([0,0]),w=h([0,0]),F=h(0),u=h([0,0]),O=h(s.value.infoColor),j=h("#000000"),I=h("#000000"),V=h(0),M=h(0),we=h(""),R=h("00:00:00");h(""),h("");const J=h(void 0),D=h(!1),K=h(!0),ne=h(!1),X=ve(()=>D.value?de.value:ue.value),re=h("16em"),ue=h(5),de=h(1e3),L=h(!0),C=h(!1),U=lt({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:-1}),$=h(null),P=h(null),B=h(),W=h();Se(()=>{ye(l.status,()=>ge(),{deep:!1}),ye([P,L],()=>{if(!P.value||!L.value)return;const{width:fe,height:_e}=fn(P.value,{width:r.W,height:r.H});$.value.width=fe,$.value.height=_e,$.value.style.width=fe+"px",$.value.style.height=_e+"px",P.value instanceof HTMLImageElement?$.value.getContext("2d").drawImage(P.value,0,0,fe,_e):($.value.getContext("bitmaprenderer").transferFromImageBitmap(P.value),P.value=null,l.status.thumbnail=null)});let d=0;const H=()=>{if(d)return;const fe=Date.now();R.value="00:00:00",d=window.setInterval(()=>{const _e=(Date.now()-fe)/1e3;R.value=`${String(_e/3600|0).padStart(2,"0")}:${String(_e/60%60|0).padStart(2,"0")}:${String(_e%60|0).padStart(2,"0")}`},300)};H(),ye(()=>l.processing,(fe,_e)=>{fe?(H(),x.value=[],b.value=!1,A.value=!1,p.value=[],T.value=[]):(clearInterval(d),ge(),d=0),L.value=!1,C.value=!0,l.processing||ke()});const Q=Ca();let G;const Y=()=>{clearTimeout(G),G=setTimeout(()=>{if(!L.value||le)return;const fe=B.value.$parent.$el.offsetHeight,_e=window.innerHeight-Q.parent.parent.vnode.el.offsetHeight-8;re.value=Math.max(fe+_e,50)+"px",console.log(fe,_e,re.value)},100)};Y(),window.addEventListener("resize",Y);const ce=new ResizeObserver(Y);ce.observe(Q.parent.parent.vnode.el);let le=!1;$a(()=>{le=!0,ce.disconnect(),clearInterval(d),clearTimeout(G),clearTimeout(be),clearTimeout(Xe),window.removeEventListener("resize",Y)})}),ye([()=>l.status.zips.length,()=>l.status.failedZips.length],()=>{const d=l.status;{p.value.length>d.zips.length&&(p.value.length=0);let H=0;const Q=d.zips.length===1&&d.zippedTotalCount===d.length;for(let G=p.value.length;G<d.zips.length;G++){const Y=d.zips[G],ce=d.baseZipName+(Q?"":"-"+String(G+1).padStart(2,"0"))+".zip";H+=Y.size,p.value[G]={url:Y.url,size:Y.size,number:Q?0:G+1,sizeByUnit:Pe(Y.size),name:ce,count:Y.count,clicked:!1}}}{T.value.length>d.failedZips.length&&(T.value.length=0);let H=0;const Q=d.failedZipDone&&d.failedZips.length===1;for(let G=T.value.length;G<d.failedZips.length;G++){const Y=d.failedZips[G],ce=d.baseZipName+"-error"+(Q?"":"-"+String(G+1).padStart(2,"0"))+".zip";H+=Y.size,T.value[G]={url:Y.url,size:Y.size,number:Q?0:G+1,sizeByUnit:Pe(Y.size),name:ce,count:Y.count,clicked:!1}}}});const ae=l.interval||100;let ee=!1,be=0;function ge(){if(ee)return;if(be){ee=!0;return}be=window.setTimeout(()=>{be=0,ee&&(ee=!1,ge())},ae);const d=l.status;b.value=d.length>=2,m.value[1]=m.value[0],m.value[0]=d.index,v.value[1]=v.value[0],v.value[0]=d.success,k.value[1]=k.value[0],k.value[0]=d.failure,z.value[1]=z.value[0],z.value[0]=d.done,w.value[1]=w.value[0],w.value[0]=d.converted,F.value=d.length,u.value[1]=u.value[0],u.value[0]=d.zippedTotalCount,V.value=d.inputTotalSize,M.value=d.outputTotalSize;const H=M.value-V.value;we.value=(H>=0?"+ ":"")+Pe(H);const Q=M.value/V.value,G=(256|Math.min(255,Math.max(0,Q-1.5)*255|0)).toString(16).substring(1);j.value="#"+G+"0000";const Y=1024*1024,ce=(256|Math.min(255,Math.max(0,H/1024/Y)*255|0)).toString(16).substring(1);if(I.value="#"+ce+"0000",_.value[1]=_.value[0],_.value[0]=v.value[0]/F.value*100,L.value||!l.processing){const le=d.logs.slice(-jt);x.value.push(...le);const fe=x.value.length-jt;fe>0&&x.value.splice(0,fe),K.value&&le.length&&tt(),x.value.length>de.value&&(de.value*=2)}d.logs.length=0,P.value=d.thumbnail,l.processing&&(O.value=k.value[0]?s.value.warningColor:s.value.infoColor),d.convertedImageUrl!==U.url&&(U.url=d.convertedImageUrl,U.name=d.convertedImageName,U.dataUrl=d.convertedImageDataUrl,U.size=d.convertedImageSize||d.outputTotalSize,U.originalSize=d.convertedImageOrgSize,U.originalName=d.convertedImageOrgName,U.index=d.convertedImageIndex,U.originalUrl=d.convertedImageOrgUrl)}function ke(){const d=l.status;O.value=l.status.success===l.status.length?s.value.successColor:s.value.errorColor,d.unconvertedFileCount>0,k.value[0]>0||(v.value[0],F.value)}const $e=ve(()=>[{key:"open",label:o("status.openFailedList"),icon:()=>ie(me,()=>ie(en)),onSelect(){Lt()}},{key:"download",label:o("status.saveFailedList"),icon:()=>ie(me,()=>ie(La)),onSelect(){Lt(!0)}},{key:"zip",label:`${o("status.zipFailedList")}`+(l.status.failedZipDone?`(✔${o("status.done")})`:""),icon:()=>ie(Be,{show:A.value&&!l.status.failedZipDone,size:"small"},()=>ie(me,()=>ie(vt))),disabled:A.value,onSelect(d){return A.value=!0,f("demand-zip-errors"),!1}}]);function Le(d,H=!1){const{url:Q,name:G}=d;if(H){const Y=document.createElement("a");Y.href=Q,Y.download=G,Y.click()}d.clicked||(d.clicked=!0,l.processing||p.value.every(Y=>Y.clicked)&&f("all-zips-clicked"))}async function We(){if(b.value){if(p.value.length>=2&&!await new Promise((Q,G)=>g.warning({title:o("Download"),content:o("status.confirmDownloadMessage",[p.value.length]),positiveText:"OK",negativeText:o("cancel"),onPositiveClick:()=>Q(!0),onNegativeClick:()=>G()})))return;const d=p.value;for(const H of d)Le(H,!0)}else W.value.download()}function Lt(d=!1){const H=new Blob([l.status.unconvertedListText],{type:"text/plain;charset=utf8"}),Q=URL.createObjectURL(H),G=document.createElement("a");G.href=Q,G.target="_blank",d&&(G.download=l.status.baseZipName+"-error.txt"),G.click()}let Xe=0,et=!1;function tt(d=!1){if(!et){if(Xe){et=!0;return}it(()=>{!d&&(!D.value||!K.value)||(B.value.scrollTo({behavior:d?"instant":"smooth",top:x.value.length*50}),Xe=window.setTimeout(()=>{Xe=0,et&&(et=!1,tt())},kl))})}}return(d,H)=>{const Q=Ie,G=Ea,Y=Fa,ce=Je,le=He,fe=Ma,_e=Pa,dt=Ae,fa=nn,ga=zt,ma=It,va=wt,Ve=ze,ha=Yo,Ct=At,_a=Oa;return E(),q(le,{vertical:"",justify:"center"},{default:t(()=>[n(Q,{justify:"center",align:"center",wrap:!1,style:{"white-space":"nowrap"}},{default:t(()=>[n(Q,{vertical:"",justify:"center",class:"left-column"},{default:t(()=>[n(G,{"tabular-nums":"",label:d.$t("status.elapsedTime")},{default:t(()=>[n(Q,null,{default:t(()=>[S(c(e(R)),1)]),_:1})]),_:1},8,["label"]),n(G,{"tabular-nums":"",label:d.$t("status.multiThreading")},{default:t(()=>[n(Q,{style:oe({color:l.status.threads?"":"red"})},{default:t(()=>[S(c(l.status.threads?d.$rt("{n} @:threads",l.status.threads):d.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(G,{"tabular-nums":"",label:d.$t("status.outputSettings")},{default:t(()=>[n(Q,{vertical:"",justify:"end",style:{"font-size":"smaller","line-height":"1em"}},{default:t(()=>[y("div",null,"Type: "+c(l.status.type),1),y("div",null,"Zip: "+c(l.status.zipSize)+"MB",1)]),_:1})]),_:1},8,["label"])]),_:1}),n(fe,{type:"multiple-circle","stroke-width":1,percentage:[e(v)[0]/e(F)*100|0,e(m)[0]/e(F)*100|0],color:[e(s).successColor,e(O)],"rail-style":[{stroke:d.processing?e(s).successColor:e(O),opacity:.3},{stroke:e(O),opacity:.3}],class:"center-column"},{default:t(()=>[n(Q,{vertical:"",align:"center",style:{"font-family":"v-mono","font-size":"xx-large","white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:t(()=>[y("span",{style:oe({color:e(k)[0]?e(O):d.processing?e(s).successColor:e(O)})},[n(Y,{duration:e(ae)*3|0,from:e(_)[1]|0,to:e(_)[0]|0,active:!0},null,8,["duration","from","to"]),S("% ")],4),n(le,{wrap:!1,style:{border:"0px solid"}},{default:t(()=>[n(le,{vertical:"",size:"small",justify:"end"},{default:t(()=>[n(le,{justify:"end",wrap:!1},{default:t(()=>[e(k)[0]>0?(E(),q(ce,{key:0,trigger:"hover",duration:0,delay:0,style:oe({color:e(s).errorColor}),placement:"left"},{trigger:t(()=>[y("span",{style:oe({fontSize:"xx-small",color:e(s).errorColor,lineHeight:"0"})}," ("+c(e(k)[0].toLocaleString("en-us"))+") ",5)]),default:t(()=>[S(" "+c(d.$t("status.progressErrors"))+" ("+c(e(k)[0].toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):se("",!0),n(ce,{trigger:"hover",duration:0,delay:0,style:oe({color:e(s).infoColor}),placement:"left"},{trigger:t(()=>[y("span",{style:oe({fontSize:"xx-small",color:e(s).infoColor,lineHeight:"0"})},c(e(m)[0].toLocaleString("en-us")),5)]),default:t(()=>[S(" "+c(d.$t("status.progressStarted"))+" ("+c(e(m)[0].toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])]),_:1}),n(le,{justify:"end"},{default:t(()=>[n(ce,{trigger:"hover",duration:0,delay:0,style:oe({color:e(s).successColor}),placement:"bottom"},{trigger:t(()=>[y("span",{style:oe({fontSize:"medium",color:e(s).successColor})},[n(Y,{duration:e(ae)*3|0,from:e(v)[1],to:e(v)[0],active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:t(()=>[S(" "+c(d.$t("status.progressSuccess"))+" ("+c(e(v)[0].toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])]),_:1})]),_:1}),n(le,{align:"end",style:{"font-size":"medium",border:"0px solid"}},{default:t(()=>[n(ce,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:t(()=>[S(" / "+c(e(F).toLocaleString("en-us")),1)]),default:t(()=>[S(" "+c(d.$t("status.progressTotal"))+" ("+c(e(F).toLocaleString("en-us"))+") ",1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["percentage","color","rail-style"]),n(Q,{vertical:"",style:{height:"100%"},justify:"center"},{default:t(()=>[n(G,{"tabular-nums":"",label:d.$t("status.inputSize")},{default:t(()=>[n(Q,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[S(c((e(V)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(G,{"tabular-nums":"",label:d.$t("status.outputSize")},{default:t(()=>[n(Q,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[S(c((e(M)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(G,{"tabular-nums":"",label:d.$t("status.outInRate")},{default:t(()=>[n(Q,{vertical:"",align:"end",justify:"start",style:{"font-size":"xx-small","font-family":"v-mono","line-height":"50%"}},{default:t(()=>[y("span",{style:oe({color:e(j),fontSize:"larger"})},"× "+c((e(M)/e(V)||1).toFixed(2)),5),y("span",{style:oe({color:e(I)})},"("+c(e(we))+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:1}),n(ma,{"display-directive":"show","trigger-areas":["arrow","main"],"default-expanded-names":"log-collapse","expanded-names":e(L)?["log-collapse"]:[],"on-update:expanded-names":Z=>{L.value=!!String(Z)}},{default:t(()=>[n(ga,{title:"Log",name:"log-collapse",style:{"white-space":"nowrap"}},tn({header:t(()=>[n(le,{align:"center",wrap:!1},{default:t(()=>[S(c(d.$t("status.log")),1),d.processing&&!e(L)?(E(),q(e(Be),{key:0,size:16})):se("",!0)]),_:1})]),default:t(()=>[n(le,{wrap:!1,class:Ke({"log-container":1,"expand-log":e(D)}),align:"stretch",style:oe(e(D)?{height:e(re),maxHeight:e(re)}:{})},{default:t(()=>[n(e(Xt),{ref_key:"scrollref",ref:B,"x-scrollable":!0,onMouseup:H[5]||(H[5]=Z=>K.value=!1),onWheel:H[6]||(H[6]=Z=>K.value=!1),trigger:"none",style:oe([{"z-index":"2","padding-right":"10px","min-height":"7em"},{maxHeight:e(re)}]),size:50},{default:t(()=>[y("table",il,[y("tr",rl,[y("th",ul,c(d.$t("status.table.core")),1),y("th",dl,c(d.$t("status.table.index")),1),y("th",cl,c(d.$t("status.table.status")),1),y("th",pl,c(d.$t("status.table.details")),1)]),(E(!0),te(xe,null,Re((e(ne)?e(x).filter(Z=>!Z.completed):e(x)).slice(-e(X)),({index:Z,key:Ue,command:Ce,path:ct,core:Et})=>(E(),te("tr",{key:Ue,class:"log-tr"},[y("td",fl,c(Et>=0?Et+1:"-"),1),y("td",gl,c(Z+1),1),y("td",ml,c(Ce),1),y("td",vl,c(ct),1)]))),128))])]),_:1},8,["style"]),n(le,{style:oe([{"align-self":"center",position:"absolute","z-index":"0","margin-top":"0.5em",right:"0.1em","line-height":"0px"},{width:r.W+"px",height:r.H+"px"}]),justify:"center",align:"center"},{default:t(()=>[n(e(Be),{size:"small",show:d.processing},{default:t(()=>[l.status.thumbnail===void 0?(E(),q(fa,{key:0,description:"EMPTY"})):se("",!0),Kt(y("canvas",{ref_key:"thumbcanvas",ref:$,width:"106",height:"80",style:oe({border:"1px solid gray",filter:d.processing?"":"opacity(0.35)"})},null,4),[[Qt,l.status.thumbnail!==void 0]])]),_:1},8,["show"])]),_:1},8,["style"])]),_:1},8,["class","style"])]),_:2},[e(L)?{name:"header-extra",fn:t(()=>[n(le,{align:"center",wrap:!1},{default:t(()=>[n(ft,null,{default:t(()=>[n(_e,{key:"a",checked:e(ne),"onUpdate:checked":H[0]||(H[0]=Z=>Ee(ne)?ne.value=Z:null),size:"small",style:{"font-size":"smaller"},class:"hide-mobile"},{default:t(()=>[S(c(d.$t("status.filterSuccess")),1)]),_:1},8,["checked"]),e(D)?(E(),q(_e,{key:"b",checked:e(K),"onUpdate:checked":[H[1]||(H[1]=Z=>Ee(K)?K.value=Z:null),H[2]||(H[2]=Z=>Z&&tt(!0))],size:"small",style:{"font-size":"smaller"}},{default:t(()=>[S(c(d.$t("status.autoScroll")),1)]),_:1},8,["checked"])):se("",!0)]),_:1}),n(dt,{style:{"max-width":"30em"}},{trigger:t(()=>[n(_e,{size:"small",checked:e(D),"onUpdate:checked":[H[3]||(H[3]=Z=>Ee(D)?D.value=Z:null),H[4]||(H[4]=Z=>{K.value=Z,tt(!0)})],style:{"font-size":"smaller"}},{default:t(()=>[S(c(d.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:t(()=>[S(c(d.$t("status.expandLogTooltip")),1)]),_:1})]),_:1})]),key:"0"}:void 0]),1024)]),_:1},8,["expanded-names","on-update:expanded-names"]),n(va,{style:{margin:"0.2em"}}),n(le,{wrap:!1,vertical:""},{default:t(()=>[n(le,{justify:"center",align:"center",vertical:""},{default:t(()=>[y("div",{class:"singleimage",style:oe({maxHeight:e(C)?"2000px":"100px"})},[!e(C)&&e(b)&&l.status.threads?(E(),q(Ve,{key:0,tertiary:"",type:"success",size:"small",disabled:!(d.status.success>0),onClick:H[7]||(H[7]=Z=>C.value=!0)},{default:t(()=>[S(c(d.$t("status.browseConvertedImages")),1)]),_:1},8,["disabled"])):d.status.success>0&&(l.status.threads||!e(b))?(E(),q(sl,{key:1,ref_key:"imageViewer",ref:W,url:e(U).url,size:e(U).size,"original-url":e(U).originalUrl,"original-size":e(U).originalSize,name:e(U).name,originalName:e(U).originalName,length:l.status.success,index:e(U).index,"is-single":!e(b),onDemandImage:H[8]||(H[8]=Z=>f("demand-image",Z))},null,8,["url","size","original-url","original-size","name","originalName","length","index","is-single"])):se("",!0)],4)]),_:1}),n(le,{justify:"center"},{default:t(()=>[e(b)?(E(),q(le,{key:0,vertical:"",align:"center"},{default:t(()=>[n(ce,{placement:"left"},{trigger:t(()=>[n(fe,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":e(u)[0]===e(F)?"white":"green",processing:d.processing,percentage:e(u)[0]/e(F)*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[y("span",hl,c(e(u)[0]/e(F)*100|0)+"% "+c(d.$t("status.zipped"))+" ("+c(e(u)[0])+"/"+c(e(w)[0])+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[S(" "+c(d.$t("status.zippingProgress"))+" ("+c(e(u)[0]/e(F)*100|0)+"%) ",1)]),_:1}),n(De,{name:"zipcontainer"},{default:t(()=>[e(p).length>=1||l.processing?(E(),q(ft,{key:0,name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(E(!0),te(xe,null,Re(e(p),(Z,Ue)=>(E(),te("span",{key:Ue},[n(ce,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",{href:Z.url,download:Z.name,class:"in-button-anchor",onClick:Ce=>Le(Z)},[n(Ve,{class:"zip-button",size:"tiny",color:Z.clicked?"#050":"lime","text-color":Z.clicked?"gray":"white",onClick:je(Ce=>Le(Z),["stop"]),round:""},{default:t(()=>[n(e(me),{size:"tiny"},{default:t(()=>[n(e(vt))]),_:1}),S("ZIP"+c(Z.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,_l)]),default:t(()=>[y("div",{style:oe({color:e(s).successColor})},[y("div",null,"ZIP "+c(Z.number||"")+" ("+c(d.$t("success"))+")",1),y("div",null,c(Z.name),1),y("div",null,c(Z.sizeByUnit),1),y("div",null,c(d.$rt("{n} @:files",Z.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):se("",!0)]),_:1})]),_:1})):se("",!0)]),_:1}),n(De,null,{default:t(()=>[l.processing?se("",!0):(E(),q(le,{key:0,justify:"center",align:"center"},{default:t(()=>[n(ce,{trigger:"hover",duration:0,delay:0,placement:"left",style:oe({color:"white",backgroundColor:e(s).successColor}),"arrow-style":{backgroundColor:e(s).successColor}},{trigger:t(()=>[n(De,{name:"save"},{default:t(()=>[e(v)[0]>0?(E(),te("span",yl,[n(Ct,{value:e(b)?e(u)[0].toLocaleString("en-us"):l.status.type.replace(/\(.+\)/,""),color:e(s).successColorHover,offset:[-20,-3]},{default:t(()=>[n(Ve,{size:"medium",onClick:We,color:e(s).successColor,round:""},{default:t(()=>[e(b)?(E(),te(xe,{key:0},[e(p).length?(E(),te("a",{key:0,href:e(p)[0].url,download:e(p)[0].name,class:"in-button-anchor",onClick:H[9]||(H[9]=je(()=>{},["prevent"]))},[n(ha),S(" × "+c(e(p).length)+" "+c(d.$t("save")),1)],8,wl)):se("",!0)],64)):(E(),te("a",{key:1,href:e(U).url,download:e(U).name,class:"in-button-anchor",onClick:H[10]||(H[10]=je(()=>{},["prevent"]))},[n(e(me),{size:"tiny"},{default:t(()=>[n(e(an))]),_:1}),S(" "+c(d.$t("save")),1)],8,bl))]),_:1},8,["color"])]),_:1},8,["value","color"])])):se("",!0)]),_:1})]),default:t(()=>[d.status.length>=2?(E(),te(xe,{key:0},[y("div",null,c(e(o)("success"))+": "+c(e(u)[0].toLocaleString()),1),y("div",null,c(e(o)("status.totalSize"))+": "+c(e(Pe)(d.status.zippedTotalSize)),1),y("div",null,"ZIP × "+c(e(p).length),1)],64)):(E(),te(xe,{key:1},[S(c(d.$t("status.downloadConvertedImage")),1)],64))]),_:1},8,["style","arrow-style"]),!d.processing&&d.status.success!==e(F)?(E(),q(_a,{key:0,options:e($e),onSelect:H[11]||(H[11]=(Z,Ue)=>{var Ce;return(Ce=e($e).find(({key:ct})=>Z===ct))==null?void 0:Ce.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:t(()=>[n(ce,{show:e(J),duration:0,delay:0,placement:"right",style:oe({color:"white",backgroundColor:e(s).errorColor}),"arrow-style":{backgroundColor:e(s).errorColor}},{trigger:t(()=>[n(Ct,{value:d.status.unconvertedFileCount.toLocaleString(),color:e(s).errorColorHover,offset:[-0,-3]},{default:t(()=>[n(Ve,{size:"small",color:e(s).errorColor},{default:t(()=>[n(e(me),{size:"medium",style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Ua))]),_:1})]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:t(()=>[y("div",null,[y("div",null,c(e(o)("failed"))+": "+c(d.status.unconvertedFileCount.toLocaleString()),1),y("div",null,c(e(o)("status.totalSize"))+": "+c(e(Pe)(d.status.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])):se("",!0)]),_:1}))]),_:1}),n(De,{name:"zipcontainer"},{default:t(()=>[e(A)?(E(),q(le,{key:0,vertical:"",align:"center"},{default:t(()=>[n(ce,{placement:"left"},{trigger:t(()=>[n(fe,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":d.status.failedFileZippedCount===d.status.unconvertedFileCount?"white":"#500",processing:e(A)&&!d.status.failedZipDone&&!d.status.failedToCreateFailedZip,percentage:d.status.failedFileZippedCount/d.status.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[d.status.failedToCreateFailedZip?(E(),te("div",{key:1,style:oe({color:e(s).errorColor})},c(d.$t("status.failureZippingFailedFiles")),5)):(E(),te("span",xl,c(d.status.failedFileZippedCount/d.status.unconvertedFileCount*100|0)+"% "+c(d.$t("status.zipped"))+" ("+c(d.status.failedFileZippedCount)+"/"+c(d.status.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[S(" "+c(d.$t("status.zippingProgress"))+" ("+c(d.status.failedFileZippedCount/d.status.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(ft,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(E(!0),te(xe,null,Re(e(T),(Z,Ue)=>(E(),te("span",{key:Ue},[n(ce,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[y("a",{href:Z.url,download:Z.name,class:"in-button-anchor",onClick:Ce=>Le(Z)},[n(Ve,{class:"zip-button",size:"tiny",color:Z.clicked?"#551122":"#F00","text-color":Z.clicked?"gray":"white",onClick:je(Ce=>Le(Z),["stop"]),round:""},{default:t(()=>[n(e(me),{size:"tiny"},{default:t(()=>[n(e(Da))]),_:1}),S("ZIP"+c(Z.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Al)]),default:t(()=>[y("div",{style:oe({color:e(s).errorColor})},[y("div",null,"ZIP "+c(Z.number||"")+" ("+c(d.$t("failed"))+")",1),y("div",null,c(Z.name),1),y("div",null,c(Z.sizeByUnit),1),y("div",null,c(d.$rt("{n} @:files",Z.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1})):se("",!0)]),_:1})]),_:1})]),_:1})}}}),Il=Me(zl,[["__scopeId","data-v-f0841c0b"]]),Tl=["innerHTML"],Sl={style:{"flex-grow":"1"}},$l=he({__name:"converter",props:{input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},threads:{}},emits:["start","end","multi-thread-count"],setup(a,{emit:i}){Ne(Oe);const{t:g}=Fe(),o=st(),s=ja(),r=Ra(),l=10,f=navigator.hardwareConcurrency,b=typeof OffscreenCanvas=="function",x=300,A=a,p=i,T=h(!1),_=h(!1),m=h(!1),v=h(0),k=h(!1),z=h(!1),w=h("initializing"),F=h("info"),u=lt(K());let O=!1,j=()=>{},I=0,V=!1;ye(()=>A.input,$=>{$!=null&&$.length&&X($)}),Se(async()=>{await C(),U()});function M(){if(I>l*1e3&&!V&&u.success>0)return o.warning({title:g("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:g("close"),negativeText:g("back"),onPositiveClick(){k.value=!1,r.destroyAll(),s.destroyAll()},onNegativeClick(){},content:g("confirmCloseDialog")}),!1;r.destroyAll(),s.destroyAll(),k.value=!1}function we($){u.demandImage($)}function R(){!_.value&&T.value?_.value=!0:M()}function J(){X(A.input)}let D=h(()=>{});function K($){const P={logs:[],index:0,converted:0,success:0,failure:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",zipSize:A.maxZipSizeMB,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1,demandImage:()=>{}};return Object.assign($||{},P)}function ne(){z.value=!1,URL.revokeObjectURL(u.convertedImageUrl),URL.revokeObjectURL(u.convertedImageOrgUrl);for(const $ of u.zips)URL.revokeObjectURL($.url);u.zips.length=0;for(const $ of u.failedZips)URL.revokeObjectURL($.url);u.failedZips.length=0,K(u),j(),j=()=>{},V=!1,m.value=!1,_.value=!1}async function X($){if(T.value){o.error({title:"Busy",positiveText:"OK",content:g("interfered")});return}let P=de($);K(u),ne();const B={convertedImageBlob:null,convertedImageWidth:0,convertedImageHeight:0,convertedImageName:""};v.value++,k.value=!0,z.value=!0,T.value=!0,u.processing=!0,F.value="info",w.value=g("processing");const W=new Set,ae=A.format,ee=A.quality,be=[...ae.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),ge=L(ae,ee,P[0].webkitRelativePath);u.length=P.length,u.baseZipName=ge,u.type=ae.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(ae)?" ("+ee+")":""),u.threads=O?0:A.threads;const ke=Date.now();p("start");const $e=P.concat();let Le;if({callbackToGenerateFailedZips:Le,callbackToClearConverter:j}=!O&&A.threads>=2?await Bo(u,_,A,B,s,r,$e,W,ae,ee,be,ae):await Wo($e,W,B,A,_,u),u.length,u.success===u.length?(F.value="success",w.value=g("completed")):(F.value="error",w.value=_.value?g("aborted"):g("incomplete")),W.size!==P.length){const We=re(P,W);D.value=()=>{!We||!We.length||Le(We)}}T.value=!1,u.processing=!1,m.value=!0,I=Date.now()-ke,p("end")}function re($,P){const B=[],W=[];let ae=0;for(const ee of $)P.has(ee._id)||(B.push(ee),W.push(ee.webkitRelativePath||ee.relativePath||ee.name),ae+=ee.size);return W.length&&(u.unconvertedListText=W.join(`
`),u.unconvertedFileCount=B.length,u.unconvertedTotalSize=ae),B}let ue=0;function de($){const P=[];for(const B of $)B.hasOwnProperty("_id")||Object.defineProperty(B,"_id",{value:ue++}),P.push(B);return P}function L($,P,B){var be;const W=new Date;return $=$.replace(/^image\//,"").toLowerCase(),`${N.useFolderNameForZip&&((be=String(B).match(/^\/?([^/]+)\//))==null?void 0:be[1])||"avif2jpg"}-
    ${W.getFullYear().toString().substring(2)}
    ${String((W.getMonth()+1)*100+W.getDate()).padStart(4,"0")}
    ${String(W.getHours()*1e4+W.getMinutes()*100+W.getSeconds()).padStart(6,"0")}
    -
    ${$+(/jpe?g|webp/i.test($)?P:"")}
  `.replace(/\s/g,"")}async function C(){const $="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",P=document.createElement("img"),B=pn(P).then(()=>!0,()=>!1);P.src=$,await B||o.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:g("avifUnsupported")})}function U(){(!b||f<2||!Promise.any)&&(O=!0),p("multi-thread-count",O?0:f)}return($,P)=>{const B=ze,W=Ae,ae=Ie,ee=Be,be=He,ge=yt;return E(),te(xe,null,[n(ae,{justify:"center",align:"center"},{default:t(()=>{var ke;return[!e(T)&&((ke=A.input)!=null&&ke.length)?(E(),q(W,{key:0,trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:t(()=>[n(B,{onClick:J,round:""},{default:t(()=>[S(c(e(g)("convertAgain")),1)]),_:1})]),default:t(()=>{var $e;return[y("div",{innerHTML:e(g)("reconvertTip",($e=A.input)==null?void 0:$e.length)},null,8,Tl)]}),_:1})):se("",!0)]}),_:1}),n(ge,{ref:"processingModal",show:e(k),"onUpdate:show":P[2]||(P[2]=ke=>Ee(k)?k.value=ke:null),closable:e(m),"close-on-esc":!1,preset:"dialog","display-directive":"show",onClick:P[3]||(P[3]=ke=>{e(r).destroyAll(),e(s).destroyAll()}),onMaskClick:P[4]||(P[4]=ke=>{e(r).destroyAll(),e(s).destroyAll()}),onClose:M,onEsc:R,title:e(w),type:e(F),"mask-closable":!1,"on-after-leave":ne,class:"processing-dialog"},{default:t(()=>[n(be,{vertical:"",style:{"flex-grow":"1"}},{default:t(()=>[y("div",Sl,[e(z)?(E(),q(Il,{key:e(v),processing:e(T),status:e(u),interval:x,onAllZipsClicked:P[0]||(P[0]=ke=>Ee(V)?V.value=!0:V=!0),onDemandZipErrors:e(D),onDemandImage:we},null,8,["processing","status","onDemandZipErrors"])):se("",!0)]),n(be,{justify:"end"},{default:t(()=>[e(T)?(E(),q(B,{key:0,disabled:e(_),ref:"cancelbutton",round:"",size:"large",onClick:P[1]||(P[1]=ke=>_.value=!0)},{default:t(()=>[n(ee,{show:e(_)&&!e(m),size:"small"},{default:t(()=>[S(c(e(g)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):e(m)?(E(),q(B,{key:1,onClick:M,round:"",size:"large",style:{"font-size":"small","margin-top":"1em"}},{default:t(()=>[S(c(e(g)("close")),1)]),_:1})):se("",!0)]),_:1})]),_:1})]),_:1},8,["show","closable","title","type"])],64)}}}),Ll="/avif2jpeg/test/avif.png",gn=a=>(bt("data-v-892702c9"),a=a(),xt(),a),Cl={class:"container-1"},El=gn(()=>y("span",null,"Drag & Drop",-1)),Fl={style:{position:"relative"}},Ml={style:{position:"absolute","font-size":"0.5em",right:"-3.5em",bottom:"-1.5em","white-space":"nowrap"}},Pl={style:{color:"#666666"}},Ol=gn(()=>y("img",{src:Ll,class:"avif"},null,-1)),Ul=["innerHTML"],Dl={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},jl=he({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(a,{emit:i}){Ne(Oe);const g=a,o=i,s=Ba(),r=h(!1),l=h(0),f=h("");Se(()=>{b(g.dropTarget||document)});function b(A){document.ondragstart=p=>p.preventDefault(),document.ondragover=p=>p.preventDefault(),A.ondrop=async p=>{var _;if(p.preventDefault(),r.value||g.forbidden)return;r.value=!0,l.value=0,f.value="";let T;try{const m=[...p.dataTransfer.items].map(v=>v.webkitGetAsEntry());s.start(),T=await x(m),s.finish()}catch{T=[...((_=p.dataTransfer)==null?void 0:_.files)??[]],s.error()}r.value&&(r.value=!1,o("drop",T))}}async function x(A,p){p=p||[];for(const T of A)if(T.isFile){const _=await new Promise(m=>T.file(v=>m(v)));Object.defineProperty(_,"webkitRelativePath",{value:T.fullPath}),p.push(_),l.value++}else if(T.isDirectory){f.value=T.fullPath;const _=T.createReader();do{const m=await new Promise(v=>_.readEntries(k=>v(k)));if(!m.length)break;await x(m,p)}while(!0)}return p}return(A,p)=>{const T=me,_=Ie,m=Je,v=Ae,k=yt;return E(),te(xe,null,[y("div",Cl,[n(v,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"left"},{trigger:t(()=>[n(_,{vertical:"",class:"container-2"},{default:t(()=>[n(_,{align:"center",wrap:!1,class:"container-3"},{default:t(()=>[n(_,{align:"center"},{default:t(()=>[n(T,{size:"64",color:"white"},{default:t(()=>[n(e(Za))]),_:1})]),_:1}),n(_,{vertical:"",align:"center",wrap:!1,style:{"font-weight":"bold","font-size":"1em","line-height":"90%","white-space":"nowrap"}},{default:t(()=>[El,y("span",Fl,[S(" AVIF Images "),y("span",Ml,[S(" or "),n(m,{placement:"bottom-end"},{trigger:t(()=>[y("span",Pl,[n(T,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Tt))]),_:1}),S(" Folders ")])]),default:t(()=>[S(" You can drag and drop your local folders ")]),_:1})])])]),_:1}),n(_,null,{default:t(()=>[Ol]),_:1})]),_:1})]),_:1})]),default:t(()=>[y("h3",{innerHTML:A.$t("droptarget"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,Ul)]),_:1})]),n(k,{show:e(r),"onUpdate:show":p[0]||(p[0]=z=>Ee(r)?r.value=z:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":A.$t("cancel")},{default:t(()=>[n(_,{vertical:"",align:"center"},{default:t(()=>[y("div",Dl,c(e(f)),1),y("div",null,"found "+c(e(l))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])],64)}}}),Rl=Me(jl,[["__scopeId","data-v-892702c9"]]),mn=a=>(bt("data-v-990f98b3"),a=a(),xt(),a),Bl={class:"container-1"},Zl={class:"container-2"},Nl=["innerHTML"],Hl=["innerHTML"],Wl={style:{"padding-left":"1em"}},Vl=mn(()=>y("br",null,null,-1)),ql=mn(()=>y("ul",null,[y("li",null,"Each extension must begin with a period. "),y("li",null,"Separate each extension with a comma. "),y("li",null,"Use alphameric characters.")],-1)),Gl=["innerHTML"],Kl=["accept"],Ql=he({__name:"file-selector",props:{expanded:{type:Boolean},target:{},userExtensions:{},forbidden:{type:Boolean}},emits:["input","on-change-accept","update:target","update:userExtensions","update:expanded"],setup(a,{emit:i}){const g=st(),{t:o}=Fe(),s=Ne(Oe),r=["avif_only","all_images","all_files","edit_type"],l=a,f=i,b=h(0),x=h(!1),A=h(!1),p=ve(()=>V(v.value)),T=ve(()=>k.value.split(",").every(J=>/^\s*(\.[\w\-]+)*\s*$/.test(J))?"success":"error"),_=ve(()=>!l.forbidden&&!A.value),m=ve({get:()=>l.expanded,set:R=>{f("update:expanded",R)}}),v=ve({get:()=>r.indexOf(l.target)>=0?l.target:r[0],set:R=>{f("update:target",R)}}),k=ve({get:()=>l.userExtensions,set:R=>{f("update:userExtensions",R)}}),z=h(null),w=h(null),F=h(I());ye(v,R=>{f("on-change-accept",p.value)}),Se(()=>{});function u(R){R.click()}function O(){}function j(R){const D=[...R.target.files];z.value.value="",w.value.value="",we(D)}function I(){return"webkitdirectory"in document.createElement("input")}function V(R){switch(R){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico";case"edit_type":return k.value;case"all_files":default:return".*"}}async function M(R){const J=String(p.value).toLowerCase().replace(/\s+/g,"");if(J&&p.value!==".*"){const D=J.split(",");R=R.filter(K=>D.includes(K.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),R.length||await new Promise(K=>{g.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:K,content:()=>ie("div",[ie(nn,{description:"NO IMAGES"}),`${o("noimage")}`,ie("br"),p.value])})})}return R}async function we(R){A.value=!0,R=await M(R),b.value=R.length,R.length>0&&f("input",R),A.value=!1}return(R,J)=>{const D=me,K=At,ne=ze,X=Ae,re=Ie,ue=Ga,de=Na,L=Ha,C=Je,U=Wa,$=zt,P=It;return E(),te(xe,null,[y("div",Bl,[y("div",Zl,[n(re,{vertical:"",align:"center",justify:"center",inline:""},{default:t(()=>[n(re,{align:"center",justify:"space-around"},{default:t(()=>[n(K,{value:e(b),max:999,offset:[-8,0],color:"#999999",style:{"margin-right":"1em"}},{default:t(()=>[n(D,{size:"4em",color:"#CCCCCC"},{default:t(()=>[n(e(Va))]),_:1})]),_:1},8,["value"]),n(re,{vertical:"",align:"stretch",justify:"center"},{default:t(()=>[n(X,{to:!1,"display-directive":"show",show:e(s).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(s).LANDSCAPE.value?"right":"top",duration:0,delay:0,"z-index":10},{trigger:t(()=>[n(ne,{disabled:!e(_),onClick:J[0]||(J[0]=B=>u(e(z))),round:"",style:{width:"100%","background-color":"white"}},{icon:t(()=>[n(D,{size:"large",color:"gray"},{default:t(()=>[n(e(on))]),_:1})]),default:t(()=>[S(" "+c(R.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[y("div",{innerHTML:R.$t("loadbuttontooltip")},null,8,Nl)]),_:1},8,["show","placement"]),!e(s).IS_SP&&e(F)||e(s).SSR?(E(),q(X,{key:0,to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:e(s).showTooltipsBeforeMounted.value},{trigger:t(()=>[n(ne,{disabled:!e(_),onClick:J[1]||(J[1]=B=>u(e(w))),round:"",style:{width:"100%","background-color":"white"}},{icon:t(()=>[n(D,{size:"large",color:"gray"},{default:t(()=>[n(e(Tt))]),_:1})]),default:t(()=>[S(" "+c(R.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[y("div",{innerHTML:R.$t("loadfoldertooltip")},null,8,Hl)]),_:1},8,["show"])):se("",!0)]),_:1})]),_:1}),y("div",{class:Ke({"expand-ext-list-container":e(m)})},[n(P,{"display-directive":"show","expanded-names":e(m)?["extItem"]:"","on-update:expanded-names":B=>{m.value=!!(""+B)},class:Ke({"expand-ext-list":e(m)})},{"header-extra":t(()=>[n(D,{size:"large"},{default:t(()=>[n(e(qa))]),_:1})]),default:t(()=>[n($,{title:R.$t("fileTypeRadioTitle"),name:"extItem"},{default:t(()=>[n(U,{value:e(v),"onUpdate:value":J[5]||(J[5]=B=>Ee(v)?v.value=B:null),name:"filetyperadios",size:"small"},{default:t(()=>[n(re,{vertical:"",style:{"padding-left":"1em"}},{default:t(()=>[(E(),te(xe,null,Re(r,B=>n(X,{key:B,trigger:"hover","keep-alive-on-hover":!1,"z-index":5,placement:"left",style:{"max-width":"200px"},duration:0,delay:0},{trigger:t(()=>[n(ue,{value:B},{default:t(()=>[S(c(R.$t("fileTypeRadioOptions."+B)),1)]),_:2},1032,["value"])]),default:t(()=>[S(" "+c(V(B).replace(/,/g,", ")),1)]),_:2},1024)),64)),n(X,{trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:e(x),duration:0,delay:0},{trigger:t(()=>[y("div",Wl,[n(C,{trigger:"manual",placement:"right-end",show:e(v)==="edit_type"&&e(T)!=="success"&&!!e(x)},{trigger:t(()=>[n(de,{value:e(k),"onUpdate:value":J[2]||(J[2]=B=>Ee(k)?k.value=B:null),status:e(T),disabled:e(v)!=="edit_type",onFocus:J[3]||(J[3]=B=>x.value=!0),onBlur:J[4]||(J[4]=B=>x.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:t(()=>[n(L,{type:"error","show-icon":!0,title:"Validation error"},{default:t(()=>[S(" Please correct the extension list."),Vl,ql]),_:1})]),_:1},8,["show"])])]),default:t(()=>[y("span",{innerHTML:R.$t("editAcceptTypes")},null,8,Gl)]),_:1},8,["show"])]),_:1})]),_:1},8,["value"])]),_:1},8,["title"])]),_:1},8,["expanded-names","on-update:expanded-names","class"])],2),e(s).IS_SP?se("",!0):(E(),q(Rl,{key:0,onDrop:we,forbidden:!e(_)},null,8,["forbidden"]))]),_:1})])]),y("input",{ref_key:"fileinput",ref:z,onInput:j,onCancel:O,type:"file",multiple:"",accept:e(p),style:{display:"none"}},null,40,Kl),y("input",{ref_key:"folderinput",ref:w,webkitdirectory:"",directory:"",onInput:j,onCancel:O,type:"file",style:{display:"none"}},null,544)],64)}}}),Yl=Me(Ql,[["__scopeId","data-v-990f98b3"]]),Jl={style:{"white-space":"nowrap"}},Xl=he({__name:"settings-output",props:{quality:{},format:{}},emits:["update:format","update:quality"],setup(a,{emit:i}){const g=a,o=i,{t:s}=Fe(),r=Ne(Oe),l=h([]),f=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],b=ve({get:()=>g.format,set:m=>{m=T(m),o("update:format",m)}}),x=ve({get:()=>g.quality,set:m=>{o("update:quality",m)}}),A=ve(()=>/png|bmp/i.test(b.value)),p=h(null);Se(()=>{_()});function T(m){return l.value.indexOf(m)<0&&(m=l.value[0]),m}function _(){for(const m of f)p.value.toDataURL(m).indexOf(m)>=0&&l.value.push(m);l.value.length===0&&l.value.push(f[0])}return(m,v)=>{const k=me,z=ln,w=Ie,F=Ae,u=kt,O=sn;return E(),te(xe,null,[n(w,{justify:"center"},{default:t(()=>[n(w,{vertical:""},{default:t(()=>[n(F,{to:!1,"display-directive":"show",show:e(r).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(r).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(w,{align:"center"},{default:t(()=>[n(k,null,{default:t(()=>[n(e(on))]),_:1}),S(c(e(s)("settings.imageType"))+": ",1),n(z,{value:b.value,"onUpdate:value":v[0]||(v[0]=j=>b.value=j),options:l.value.map(j=>({value:j,label:j})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:t(()=>[S(" "+c(e(s)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(F,{to:!1,"display-directive":"show",show:e(r).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(r).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(w,{align:"center"},{default:t(()=>[n(w,{align:"start",wrap:!1},{default:t(()=>[n(k,null,{default:t(()=>[n(e(an))]),_:1}),y("span",Jl,c(e(s)("settings.quality"))+":",1),n(w,{align:"center",justify:"space-between"},{default:t(()=>[n(u,{tooltip:!1,value:x.value,"onUpdate:value":v[1]||(v[1]=j=>x.value=j),step:1,style:{width:"120px"},disabled:A.value},null,8,["value","disabled"]),n(O,{value:x.value,"onUpdate:value":v[2]||(v[2]=j=>x.value=j),step:"1",min:"0",max:"100",disabled:A.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:t(()=>[S(" "+c(e(s)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1})]),_:1}),y("canvas",{ref_key:"canvas",ref:p,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),es={style:{width:"4em","text-align":"left"}},ts={style:{width:"4em","text-align":"left"}},Rt=100,Bt=2e3,Zt=4096,Nt=4096,ns=100,as=100,os=he({__name:"settings-adv",props:Ka({threadMax:{}},{expanded:{type:Boolean,required:!0},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}}),emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(a){const i={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},g=Te(a,"expanded"),o=Te(a,"multithread"),s=Te(a,"threadCount"),r=Te(a,"maxZipSize"),l=Te(a,"retainExt"),f=Te(a,"useFolderNameForZip"),b=Te(a,"shrinkImage"),x=Te(a,"maxWidth"),A=Te(a,"maxHeight"),p=a;ye([s,()=>p.threadMax],()=>{p.threadMax>1&&typeof s.value>"u"&&(s.value=p.threadMax)}),ye(()=>p.threadMax,()=>{p.threadMax>1||(o.value=!1)},{immediate:!0});const T=ve(()=>o.value&&p.threadMax>1);return(_,m)=>{const v=me,k=ze,z=Qa,w=He,F=kt,u=sn,O=zt,j=It;return E(),q(w,{justify:"center"},{default:t(()=>[n(j,{"display-directive":"show","default-expanded-names":g.value?["collapitem"]:"","on-update:expanded-names":I=>g.value=!!String(I),"trigger-areas":["arrow","main"],class:Ke(["settings-body",g.value?"expand-adv-settings":""])},tn({arrow:t(()=>[n(v,{style:oe(g.value&&{top:"8px"})},{default:t(()=>[n(e(Ya))]),_:1},8,["style"]),n(v,null,{default:t(()=>[n(e(Ja))]),_:1})]),default:t(()=>[n(O,{title:_.$t("settings.advancedSettings"),name:"collapitem"},{default:t(()=>[n(w,{vertical:"",style:{"padding-left":"2em"}},{default:t(()=>[n(e(Ae),qe(Ge(i)),{trigger:t(()=>[n(w,{vertical:""},{default:t(()=>[n(w,{wrap:!1,align:"center"},{default:t(()=>[n(k,{text:"",disabled:!_.threadMax,style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:m[0]||(m[0]=I=>o.value=!o.value)},{icon:t(()=>[n(v,null,{default:t(()=>[n(e(Xa))]),_:1})]),default:t(()=>[S(" "+c(_.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(z,{value:o.value,"onUpdate:value":m[1]||(m[1]=I=>o.value=I),disabled:!_.threadMax,size:"small"},null,8,["value","disabled"])]),_:1}),n(w,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(F,{value:s.value,"onUpdate:value":m[2]||(m[2]=I=>s.value=I),disabled:!_.threadMax||!o.value,step:1,min:2,max:_.threadMax,style:{width:"120px"}},null,8,["value","disabled","max"]),n(u,{size:"tiny",value:s.value,"onUpdate:value":m[3]||(m[3]=I=>s.value=I),disabled:!_.threadMax||!o.value,step:1,min:2,max:_.threadMax,style:{width:"10em"}},{suffix:t(()=>[S(c(_.$t("threads",s.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[S(" "+c(_.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(e(Ae),qe(Ge(i)),{trigger:t(()=>[n(w,{vertical:""},{default:t(()=>[n(w,{wrap:!1,align:"center"},{default:t(()=>[n(k,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:t(()=>[n(v,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(eo))]),_:1})]),default:t(()=>[S(" "+c(_.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(w,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(F,{tooltip:!1,value:r.value,"onUpdate:value":m[4]||(m[4]=I=>r.value=I),step:1,min:Rt,max:Bt,style:{width:"120px"}},null,8,["value"]),n(u,{size:"tiny",value:r.value,"onUpdate:value":m[5]||(m[5]=I=>r.value=I),step:"1",min:Rt,max:Bt,style:{width:"10em"}},{suffix:t(()=>[S("(MB)")]),_:1},8,["value"])]),_:1})]),_:1})]),default:t(()=>[S(" "+c(_.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(e(Ae),qe(Ge(i)),{trigger:t(()=>[n(w,{wrap:!1,align:"center"},{default:t(()=>[n(k,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:m[6]||(m[6]=I=>f.value=!f.value)},{icon:t(()=>[n(v,null,{default:t(()=>[n(e(Tt))]),_:1})]),default:t(()=>[S(" "+c(_.$t("settings.useFolderNameForZip")),1)]),_:1}),n(z,{value:f.value,"onUpdate:value":m[7]||(m[7]=I=>f.value=I),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[S(" "+c(_.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(e(Ae),qe(Ge(i)),{trigger:t(()=>[n(w,{wrap:!1,align:"center"},{default:t(()=>[n(k,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:m[8]||(m[8]=I=>l.value=!l.value)},{icon:t(()=>[n(v,null,{default:t(()=>[n(e(en))]),_:1})]),default:t(()=>[S(" "+c(_.$t("settings.retainOriginalExtension")),1)]),_:1}),n(z,{value:l.value,"onUpdate:value":m[9]||(m[9]=I=>l.value=I),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[S(" "+c(_.$t("settings.retainExtTooltip")),1)]),_:1},16),n(e(Ae),qe(Ge(i)),{trigger:t(()=>[n(w,{vertical:""},{default:t(()=>[n(w,{wrap:!1,align:"center"},{default:t(()=>[n(k,{disabled:!e(T),text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:m[10]||(m[10]=I=>b.value=!b.value)},{icon:t(()=>[n(v,null,{default:t(()=>[n(e(to))]),_:1})]),default:t(()=>[S(" "+c(_.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(z,{disabled:!e(T),value:b.value,"onUpdate:value":m[11]||(m[11]=I=>b.value=I),size:"small"},null,8,["disabled","value"])]),_:1}),n(w,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(F,{value:x.value,"onUpdate:value":m[12]||(m[12]=I=>x.value=I),disabled:!b.value||!e(T),step:1,min:ns,max:Zt,style:{width:"120px"}},null,8,["value","disabled"]),n(u,{size:"tiny",value:x.value,"onUpdate:value":m[13]||(m[13]=I=>x.value=I),disabled:!b.value||!e(T),step:1,min:8,max:Zt*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[y("span",es,c(_.$t("width")),1)]),suffix:t(()=>[S("px")]),_:1},8,["value","disabled","max"])]),_:1}),n(w,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(F,{value:A.value,"onUpdate:value":m[14]||(m[14]=I=>A.value=I),disabled:!b.value||!e(T),step:1,min:as,max:Nt,style:{width:"120px"}},null,8,["value","disabled"]),n(u,{size:"tiny",value:A.value,"onUpdate:value":m[15]||(m[15]=I=>A.value=I),disabled:!b.value||!e(T),step:1,min:8,max:Nt*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[y("span",ts,c(_.$t("height")),1)]),suffix:t(()=>[S("px")]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[S(" "+c(_.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1},8,["title"])]),_:2},[g.value?{name:"header-extra",fn:t(()=>[n(e(Ae),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(k,{onClick:e(ho),size:"tiny",style:{"font-size":"xx-small"}},{default:t(()=>[S(c(_.$t("reset")),1)]),_:1},8,["onClick"])]),default:t(()=>[S(" "+c(_.$t("settings.resetButtonTooltip")),1)]),_:1})]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1})}}}),ls=Me(os,[["__scopeId","data-v-0da126eb"]]),ss={},is={style:{color:"gray","padding-left":"20px"}},rs=["innerHTML"];function us(a,i){const g=wt,o=Ie;return E(),q(o,{vertical:"",justify:"end"},{default:t(()=>[n(g,{style:{margin:"0px"}}),n(o,{justify:"center"},{default:t(()=>[y("ul",is,[(E(!0),te(xe,null,Re(a.$tm("descriptions"),s=>(E(),te("li",{key:s,style:{"text-align":"left"},innerHTML:s},null,8,rs))),128))])]),_:1})]),_:1})}const ds=Me(ss,[["render",us]]),cs="modulepreload",ps=function(a){return"/avif2jpeg/test/"+a},Ht={},pe=function(i,g,o){let s=Promise.resolve();if(g&&g.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),f=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(g.map(b=>{if(b=ps(b),b in Ht)return;Ht[b]=!0;const x=b.endsWith(".css"),A=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${b}"]${A}`))return;const p=document.createElement("link");if(p.rel=x?"stylesheet":cs,x||(p.as="script"),p.crossOrigin="",p.href=b,f&&p.setAttribute("nonce",f),document.head.appendChild(p),x)return new Promise((T,_)=>{p.addEventListener("load",T),p.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${b}`)))})}))}function r(l){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=l,window.dispatchEvent(f),!f.defaultPrevented)throw l}return s.then(l=>{for(const f of l||[])f.status==="rejected"&&r(f.reason);return i().catch(r)})},vn="English",hn="🇬🇧",_n='AVIF to JPEG "Offline" Batch Converter',yn="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",wn="Drag & Drop AVIF Images to Convert",bn=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.'],xn="Select your language",An="Choose Target File Extentions",kn={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},zn="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",In="Load Images",Tn="Select your images from a dialog window.<br>*Multiple selection allowed.",Sn="Load a Whole Folder",$n=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,Ln="Converting images",Cn="Aborted",En="Some files failed to convert",Fn="Completed",Mn="Currently Busy",Pn="No files with the extentions were found.",On="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",Un="Cancel",Dn="Save",jn="Close",Rn="Open",Bn="Re-convert",Zn="Convert previous selected {n} @:files again",Nn="File | Files",Hn="thread | threads",Wn="You have not saved the converted images yet.",Vn="Data have not been saved",qn="Open Source",Gn="Open the converted image",Kn="Copied to clipboard",Qn="The converted image was copied to your clipboard as DataURL.",Yn="Copy the converted image as DataURL",Jn="Convert Again",Xn={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",expandLog:"Show entire log",autoScroll:"Auto scroll",showOnlyErrors:"Show only errors",log:"Log",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted"},ea={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file"},ta="Disabled",na="Download",aa="Reset",oa="Back",la="Failed",sa="Success",ia="Previous version",ra=`
Height`,ua="Width",da={lang:vn,flags:hn,title:_n,metaDescription:yn,droptarget:wn,descriptions:bn,selectLanguage:xn,fileTypeRadioTitle:An,fileTypeRadioOptions:kn,editAcceptTypes:zn,loadbutton:In,loadbuttontooltip:Tn,loadfolderbutton:Sn,loadfoldertooltip:$n,processing:Ln,aborted:Cn,incomplete:En,completed:Fn,interfered:Mn,noimage:Pn,avifUnsupported:On,cancel:Un,save:Dn,close:jn,open:Rn,reconvert:Bn,reconvertTip:Zn,files:Nn,threads:Hn,confirmCloseDialog:Wn,confirmCloseDialogTitle:Vn,githubOpenSource:qn,convertedImageUrlTooltip:Gn,copiedDataURLDialogTitle:Kn,copiedDataURLMessage:Qn,convertedImageDataUrlTooltip:Yn,convertAgain:Jn,status:Xn,settings:ea,disabled:ta,Download:na,reset:aa,back:oa,failed:la,success:sa,previousVersion:ia,height:ra,width:ua},fs=Object.freeze(Object.defineProperty({__proto__:null,Download:na,aborted:Cn,avifUnsupported:On,back:oa,cancel:Un,close:jn,completed:Fn,confirmCloseDialog:Wn,confirmCloseDialogTitle:Vn,convertAgain:Jn,convertedImageDataUrlTooltip:Yn,convertedImageUrlTooltip:Gn,copiedDataURLDialogTitle:Kn,copiedDataURLMessage:Qn,default:da,descriptions:bn,disabled:ta,droptarget:wn,editAcceptTypes:zn,failed:la,fileTypeRadioOptions:kn,fileTypeRadioTitle:An,files:Nn,flags:hn,githubOpenSource:qn,height:ra,incomplete:En,interfered:Mn,lang:vn,loadbutton:In,loadbuttontooltip:Tn,loadfolderbutton:Sn,loadfoldertooltip:$n,metaDescription:yn,noimage:Pn,open:Rn,previousVersion:ia,processing:Ln,reconvert:Bn,reconvertTip:Zn,reset:aa,save:Dn,selectLanguage:xn,settings:ea,status:Xn,success:sa,threads:Hn,title:_n,width:ua},Symbol.toStringTag,{value:"Module"})),gs="Chinese",ms="Ukrainian",vs="Turkish",hs="Russian",_s="Portuguese",ys="Polish",ws="Dutch",bs="Korean",xs="Japanese",As="Italian",ks="Indonesian",zs="Hindi",Is="French",Ts="Spanish",Ss="English",$s="German",Ls="Arabic",Cs={zh:gs,"zh-hant":"Chinese(hant)",uk:ms,tr:vs,ru:hs,pt:_s,pl:ys,nl:ws,ko:bs,ja:xs,it:As,id:ks,hi:zs,fr:Is,es:Ts,en:Ss,de:$s,ar:Ls},at=[],ca={en:da},St={},Wt=Object.assign({"./locales/ar.json":()=>pe(()=>import("./ar-Hwk1laLf.js"),[]),"./locales/de.json":()=>pe(()=>import("./de-CBEXH4J0.js"),[]),"./locales/en.json":()=>pe(()=>Promise.resolve().then(()=>fs),void 0),"./locales/es.json":()=>pe(()=>import("./es-CH2UQWdM.js"),[]),"./locales/fr.json":()=>pe(()=>import("./fr-DdRBDW-S.js"),[]),"./locales/hi.json":()=>pe(()=>import("./hi-CTBklyzU.js"),[]),"./locales/id.json":()=>pe(()=>import("./id-CYVm6vga.js"),[]),"./locales/it.json":()=>pe(()=>import("./it-BbOXX5uD.js"),[]),"./locales/ja.json":()=>pe(()=>import("./ja-DYdEBqVk.js"),[]),"./locales/ko.json":()=>pe(()=>import("./ko-yG1tj8rD.js"),[]),"./locales/nl.json":()=>pe(()=>import("./nl-BdLDxMoE.js"),[]),"./locales/pl.json":()=>pe(()=>import("./pl-mqS4JseC.js"),[]),"./locales/pt.json":()=>pe(()=>import("./pt-UdNisX8V.js"),[]),"./locales/ru.json":()=>pe(()=>import("./ru-DQW92yzT.js"),[]),"./locales/tr.json":()=>pe(()=>import("./tr-Bbsg31WG.js"),[]),"./locales/uk.json":()=>pe(()=>import("./uk-Bu4FXkvA.js"),[]),"./locales/zh-hant.json":()=>pe(()=>import("./zh-hant-B6SZQzoN.js"),[]),"./locales/zh.json":()=>pe(()=>import("./zh-BPod0HbH.js"),[])});var Vt;for(const a in Wt){const i=(Vt=a.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:Vt[1];i&&(at.push(i),!(i in ca)&&(St[i]=Wt[a]))}let _t=Fs();_t in St||(_t="en");const ot=no({legacy:!1,globalInjection:!0,locale:_t,fallbackLocale:"en",messages:ca,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function Es(a){if(ot.global.availableLocales.indexOf(a)>=0)return;const i=await St[a]();ot.global.setLocaleMessage(a,i),await it()}function Fs(){const a=location.pathname;return String(a.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Ms=["innerHTML"],Ps=he({__name:"switch-lang",emits:["lang-ready","lang-change"],async setup(a,{emit:i}){let g,o;const s=Ne(Oe),r=Gt(),{locale:l,t:f}=Fe(),b=i,x=Object.entries(Cs).map(([v,k])=>({label:k,value:v}));x.sort((v,k)=>{const z=v.label,w=k.label;return z>w?1:z<w?-1:0}),Se(()=>{r.afterEach((v,k,z)=>{p(),s.switchToolTipVisibility()})}),Jt(async()=>{}),[g,o]=ao(()=>p()),await g,o();async function A(v){(v!==l.value||ot.global.availableLocales.indexOf(v)===-1)&&(b("lang-change",v),await Es(v),l.value=v,document.title=f("title"),await it()),b("lang-ready",v)}async function p(){const v=r.currentRoute.value.path||"",k=String(v.match(new RegExp("(?<=^\\/)[^/]+"))||"");k&&at.includes(k)?(await A(k),l.value=k):await T()}async function T(){const v=_().toLowerCase(),k=v.split(/[-_]/)[0];if(at.includes(k)){let z=k;if(k==="zh")switch(v){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":z="zh-hant"}await A(z)}}function _(){const v=window.navigator;return v.language||v.userLanguage||v.browserLanguage}function m(v){console.log(`changeRoute: ${r.currentRoute.value.fullPath} => ${v}`),r.push("/"+v+"/")}return(v,k)=>{const z=me,w=ln,F=Ae;return E(),q(F,{to:!1,"display-directive":"show",show:e(s).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(s).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:t(()=>[n(w,{ref:"langselect",size:"tiny",style:{width:"100%"},"consistent-menu-width":!1,options:e(x),"_v-model:value":"locale",value:e(l),"onUpdate:value":m},{arrow:t(()=>[n(z,null,{default:t(()=>[n(e(oo))]),_:1})]),_:1},8,["options","value"])]),default:t(()=>[y("div",{innerHTML:v.$t("selectLanguage")},null,8,Ms)]),_:1},8,["show","placement"])}}}),Os=y("span",null,"CONVERT TO👇",-1),Oe=Symbol("global variables"),Us=he({__name:"Avif2Jpeg",emits:["ready"],setup(a,{emit:i}){Fe();const g=i,o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),s=h(null),r=h(2);let l=h(void 0);const f=h(!0),b=h(!1),x=h(!1),A=h(!1);lo(Oe,{showTooltipsBeforeMounted:l,LANDSCAPE:f,IS_SP:o,switchToolTipVisibility:k,SSR:!1}),Se(()=>{z(),window.addEventListener("resize",z),k(),setTimeout(()=>x.value=!0,3e3)});const p=200;let T=0,_=!0;function m(){A.value=!1,T=Date.now()}function v(){const F=_?0:Math.max(0,p-(Date.now()-T));_=!1,setTimeout(()=>A.value=!0,F),g("ready")}async function k(){}function z(){const F=document.body.clientWidth,u=document.body.clientHeight;f.value=F*.75>u||F>900}function w(F){s.value=F}return(F,u)=>{const O=Ie,j=me,I=Je,V=He;return E(),q(V,{vertical:"",align:"stretch",justify:"start",style:{height:"100%",position:"relative"}},{default:t(()=>[n(So,null,{"lang-switch":t(()=>[(E(),q(so,null,{default:t(()=>[n(Ps,{onLangChange:m,onLangReady:v})]),_:1}))]),_:1}),n(De,{name:"fade"},{default:t(()=>[e(A)?(E(),q(V,{key:0,vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:t(()=>[n(Co),n(O,{justify:"center"},{default:t(()=>[n(Yl,{expanded:e(N).expandExtButtons,"onUpdate:expanded":u[0]||(u[0]=M=>e(N).expandExtButtons=M),target:e(N).acceptTypeValue,"onUpdate:target":u[1]||(u[1]=M=>e(N).acceptTypeValue=M),userExtensions:e(N).editedAcceptTypes,"onUpdate:userExtensions":u[2]||(u[2]=M=>e(N).editedAcceptTypes=M),forbidden:e(b),onInput:w},null,8,["expanded","target","userExtensions","forbidden"])]),_:1}),n($l,{input:e(s),format:e(N).imageFormat,quality:e(N).imageQuality,"retain-extension":e(N).retainExtension,maxZipSizeMB:e(N).maxZipSizeMB,threads:e(N).multithread?e(N).threadCount:0,onStart:u[3]||(u[3]=M=>b.value=!0),onEnd:u[4]||(u[4]=M=>b.value=!1),onMultiThreadCount:u[5]||(u[5]=M=>r.value=M)},null,8,["input","format","quality","retain-extension","maxZipSizeMB","threads"]),n(O,{vertical:"",align:"center"},{default:t(()=>[n(I,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(j,{size:"4vh",color:"#DADADA",style:{margin:"0px"}},{default:t(()=>[n(e(io))]),_:1})]),default:t(()=>[Os]),_:1})]),_:1}),n(O,{vertical:"",align:"center"},{default:t(()=>[n(Xl,{format:e(N).imageFormat,"onUpdate:format":u[6]||(u[6]=M=>e(N).imageFormat=M),quality:e(N).imageQuality,"onUpdate:quality":u[7]||(u[7]=M=>e(N).imageQuality=M)},null,8,["format","quality"]),n(ls,{"retain-ext":e(N).retainExtension,"onUpdate:retainExt":u[8]||(u[8]=M=>e(N).retainExtension=M),"use-folder-name-for-zip":e(N).useFolderNameForZip,"onUpdate:useFolderNameForZip":u[9]||(u[9]=M=>e(N).useFolderNameForZip=M),"max-zip-size":e(N).maxZipSizeMB,"onUpdate:maxZipSize":u[10]||(u[10]=M=>e(N).maxZipSizeMB=M),expanded:e(N).expandAdvSettings,"onUpdate:expanded":u[11]||(u[11]=M=>e(N).expandAdvSettings=M),multithread:e(N).multithread,"onUpdate:multithread":u[12]||(u[12]=M=>e(N).multithread=M),"thread-count":e(N).threadCount,"onUpdate:threadCount":u[13]||(u[13]=M=>e(N).threadCount=M),"thread-max":e(r)||0,"shrink-image":e(N).shrinkImage,"onUpdate:shrinkImage":u[14]||(u[14]=M=>e(N).shrinkImage=M),"max-width":e(N).maxWidth,"onUpdate:maxWidth":u[15]||(u[15]=M=>e(N).maxWidth=M),"max-height":e(N).maxHeight,"onUpdate:maxHeight":u[16]||(u[16]=M=>e(N).maxHeight=M)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","expanded","multithread","thread-count","thread-max","shrink-image","max-width","max-height"])]),_:1}),n(ds)]),_:1})):se("",!0)]),_:1})]),_:1})}}}),$t=he({__name:"App",setup(a){const i={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{color:"#000000AA"},Image:{toolbarColor:"#00000099"}},g=h(!0);return Se(()=>{g.value=!1}),(o,s)=>{const r=uo,l=co,f=po,b=fo,x=go,A=ro;return E(),q(A,{"theme-overrides":i,style:{width:"100%",height:"100%"}},{default:t(()=>[n(x,null,{default:t(()=>[n(b,{placement:"top-right",max:20},{default:t(()=>[n(f,{placement:"top-left",closable:!0,max:50},{default:t(()=>[n(l,null,{default:t(()=>[n(r,null,{default:t(()=>[n(Us,{class:Ke({hide:e(g)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),pa=[{path:"/",name:"Home",component:$t}];for(const a of at)pa.push({path:"/"+a+"/",strict:!0,name:a,component:$t});mo($t,{routes:pa,base:"/avif2jpeg/test/"},({app:a,router:i,routes:g,isClient:o,initialState:s})=>{a.use(ot)});
