var Mo=Object.defineProperty;var Fo=(o,i,g)=>i in o?Mo(o,i,{enumerable:!0,configurable:!0,writable:!0,value:g}):o[i]=g;var Ft=(o,i,g)=>Fo(o,typeof i!="symbol"?i+"":i,g);import{r as rt,d as _e,i as Ve,o as M,c as q,w as t,a as n,u as e,b as $,t as r,N as ve,_ as Gt,e as Ae,L as Oo,f as _,g as ae,h,F as ze,j as Be,B as Ie,k as bt,l as Q,m as Po,n as Uo,p as Ce,q as xt,s as Kt,v as he,x as No,y as we,z as ht,A as _t,C as kt,D as At,E as Oe,G as re,T as Re,H as Qt,I as Yt,J as Ze,K as Jt,M as qe,O as He,P as ut,Q as Xt,R as Me,S as en,U as Je,V as de,W as Do,X as jo,Y as zt,Z as gt,$ as Ot,a0 as ot,a1 as Ro,a2 as tn,a3 as Tt,a4 as Zo,a5 as nn,a6 as Bo,a7 as on,a8 as mt,a9 as Ee,aa as Xe,ab as Ho,ac as Wo,ad as Vo,ae as qo,af as an,ag as ln,ah as It,ai as St,aj as Go,ak as sn,al as Ko,am as Qo,an as et,ao as Yo,ap as Jo,aq as Se,ar as Xo,as as ea,at as ta,au as na,av as $t,aw as oa,ax as aa,ay as la,az as sa,aA as rn,aB as ia,aC as ra,aD as un,aE as dn,aF as Qe,aG as Ye,aH as ua,aI as da,aJ as ca,aK as pa,aL as fa,aM as ga,aN as ma,aO as va,aP as ha,aQ as _a,aR as ya,aS as wa,aT as ba,aU as xa,aV as ka,aW as Aa,aX as za,aY as Ta,aZ as Ia}from"./vendor-CeR1nWf6.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const d of s)if(d.type==="childList")for(const l of d.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function g(s){const d={};return s.integrity&&(d.integrity=s.integrity),s.referrerPolicy&&(d.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?d.credentials="include":s.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(s){if(s.ep)return;s.ep=!0;const d=g(s);fetch(s.href,d)}})();const Sa={imageFormat:"image/jpeg",imageQuality:90,expandExtButtons:!1,acceptTypeValue:void 0,editedAcceptTypes:"",expandAdvSettings:!1,retainExtension:!1,maxZipSizeMB:1e3,useFolderNameForZip:!1,multithread:!0,threadCount:void 0,shrinkImage:!1,maxWidth:4096,maxHeight:4096,disableNotifyingFolderSelect:!1},B=rt(cn({}));function $a(){cn(B)}function cn(o){return Object.assign(o,Sa)}const pn="avif2jpeg",vt=JSON.parse(localStorage.getItem(pn)||"{}");for(const o in B)vt.hasOwnProperty(o)&&vt[o]!==void 0&&(B[o]=vt[o]);window.addEventListener("unload",()=>{const o={};for(const i in B)o[i]=B[i];localStorage.setItem(pn,JSON.stringify(o))});const Ca=_e({__name:"github",setup(o){const i=Ve(De);return(g,a)=>{const s=ve,d=Gt,l=Ae;return M(),q(l,{to:!1,"display-directive":"show",show:e(i).showTooltipsBeforeMounted.value,trigger:"hover",duration:0,delay:0},{trigger:t(()=>[n(d,{href:"https://github.com/gitcobra/avif2jpeg",style:{color:"black","font-size":"small","font-weight":"bolder"}},{default:t(()=>[n(s,null,{default:t(()=>[n(e(Oo))]),_:1}),$("GitHub")]),_:1})]),default:t(()=>[$(" "+r(g.$t("githubOpenSource")),1)]),_:1},8,["show"])}}}),La=h("h3",null,"Used Framework and Libraries",-1),Ea=["href"],Ma=_e({__name:"licenses",setup(o){const i=_(!1),g={Vue:"https://github.com/vuejs/core/blob/main/LICENSE",Vite:"https://github.com/vitejs/vite/blob/main/LICENSE","Vite SSG":"https://github.com/antfu/vite-ssg/blob/main/LICENSE","Naive UI":"https://github.com/TuSimple/naive-ui/blob/main/LICENSE",Ionicons:"https://github.com/ionic-team/ionicons/blob/main/LICENSE"};return(a,s)=>{const d=Ie;return M(),ae(ze,null,[n(d,{text:"",onClick:s[0]||(s[0]=l=>i.value=!0),style:{color:"black","font-size":"small"}},{default:t(()=>[$("Licenses")]),_:1}),n(e(bt),{preset:"dialog",ref:"dialog",show:i.value,"onUpdate:show":s[1]||(s[1]=l=>i.value=l),"positive-text":"OK",title:"Licenses"},{default:t(()=>[La,h("ul",null,[(M(),ae(ze,null,Be(g,(l,p)=>h("li",null,[h("a",{href:l},r(p),9,Ea)])),64))])]),_:1},8,["show"])],64)}}}),Fa=1,Oa=7,Pa=13,Ua="",lt={major:Fa,minor:Oa,build:Pa,tag:Ua},Na={style:{"font-size":"x-small","user-select":"none"}},Da=_e({__name:"version",setup(o){const i=["0.0.118"],g=`${lt.major}.${lt.minor}.${lt.build}${lt.tag}`,a=i.map(p=>({label:`v${p}`,key:p,value:p}));function s(p){const{key:x,label:k}=p,z=l(x),c=Q("a",{href:z},k),L=Q("div",null,c);return Q("div",null,L)}function d(p){location.href=l(p)}function l(p){return`/avif2jpeg/old/${p}/`}return(p,x)=>{const k=Po;return M(),q(k,{"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start",options:e(a),"render-label":s,"onUpdate:value":d},{header:t(()=>[h("span",Na,r(p.$t("previousVersion")),1)]),default:t(()=>[h("span",{style:{cursor:"pointer"}},"v"+r(g))]),_:1},8,["options"])}}}),ja=_e({__name:"header",setup(o){return(i,g)=>{const a=Ce,s=xt;return M(),q(a,{vertical:"",justify:"start"},{default:t(()=>[n(a,{justify:"space-between",style:{"box-sizing":"border-box",padding:"4px",margin:"0px"}},{default:t(()=>[n(a,{align:"start"},{default:t(()=>[n(Ca),n(Da),n(a,{align:"center"},{default:t(()=>[n(Ma)]),_:1})]),_:1}),n(a,{align:"end",style:{"font-size":"x-small"}},{default:t(()=>[Uo(i.$slots,"lang-switch")]),_:3})]),_:3}),n(s,{style:{margin:"0px"}})]),_:3})}}}),Ra={style:{padding:"0px",margin:"0px","text-align":"center"}},Za={key:0},Ba=_e({__name:"title",setup(o){const i=Kt(),g=he(()=>{const a=i.currentRoute.value.path||"";return!String(a.match(new RegExp("(?<=^\\/)[^/]+"))||"")});return(a,s)=>{const d=Gt,l=No("router-link"),p=Ce;return M(),q(p,{align:"center",justify:"center",style:{margin:"0px"}},{default:t(()=>[h("h1",Ra,[e(g)?(M(),ae("span",Za,r(a.$t("title")),1)):(M(),q(l,{key:1,to:"../",custom:""},{default:t(({navigate:x,href:k})=>[n(d,{href:k,onClick:x,style:{color:"black","word-break":"keep-all","overflow-wrap":"break-word"}},{default:t(()=>[$(r(a.$t("title")),1)]),_:2},1032,["href","onClick"])]),_:1}))])]),_:1})}}}),Ha="/avif2jpeg/test/outofmemory.png";function Wa(o){return new Worker("/avif2jpeg/test/assets/worker.canvas-BhseTtik.js",{name:o==null?void 0:o.name})}let fn=0;class Va extends Wa{constructor(){super(...arguments);Ft(this,"id",fn++)}release(){ct(this)}}const yt=[],We=new Set,tt=new Map,nt=new Map,dt=new Set;function qa(o,i){const g=new Va;yt.push(g);{const a=Promise.resolve(g);We.add(a),tt.set(g,a)}return g}function Ga(o){const i=new Promise(g=>{nt.set(o,g)});We.add(i),tt.set(o,i),dt.add(o)}async function Ka(){let o,i;do o=await Promise.any(We);while(dt.has(o));return i=tt.get(o),tt.delete(o),We.delete(i),Ga(o),o}function ct(o){const i=nt.get(o);i&&(nt.delete(o),dt.delete(o),i(o))}function gn(){for(const o of nt.keys())ct(o)}async function Pt(){return await Promise.all(We)}function Ut(){gn();for(const o of yt)o.terminate();yt.length=0,We.clear(),tt.clear(),nt.clear(),dt.clear(),fn=0}function Qa(o){return new Worker("/avif2jpeg/test/assets/worker.zip-Cfi4T0DL.js",{name:o==null?void 0:o.name})}const Ya=1e3*10,Nt=1,Ja=10,Xa=1024*1024*4,el=100;async function tl(o,i,g,a,s,d,l,p,x,k,z,c){const L=new Map,y=new Map,f=Math.min(g.threads-1,l.length);Ut();const m=new Qa,C=nl(m,o,i,p,L);if(m.postMessage({action:"set-config",zipSize:g.maxZipSizeMB*1024*1024,keepExt:g.retainExtension,outputExt:z,imageType:c}),!await new Promise(j=>{const K=ie=>{m.removeEventListener("message",j),clearTimeout(ne),j(ie)},Y=()=>K(!0);let ne=0;m.addEventListener("message",Y),ne=window.setTimeout(()=>K(!1),Ya)}))return{exception:new Error("worker-load-error"),callbackToClearConverter:()=>{},callbackToGenerateFailedZips:()=>{}};const A=ol(o,i,a,s,d,l,p,y,L);for(let j=0;j<f;j++){const K=qa();K.onmessage=A;const{port1:Y,port2:ne}=new MessageChannel;m.postMessage({action:"set-port"},[Y]),K.postMessage({},[ne])}const F=we(i,j=>{j&&(F(),gn())});o.demandImage=j=>{m.postMessage({action:"request-image",index:j})};const w=l.length===1;let v=0,T=0,le="",V=0;for(;V<l.length;){const j=await Ka();if(i.value){ct(j);break}const K=[];let Y=!1;const ne=l.length-V,ie=Math.min(V+Math.max(Math.min(Ja,ne/g.threads|0),1),l.length);let fe=0,se=!1;const O=Date.now();for(O-T>el&&(T=O,se=!0);V<ie&&!(fe>Xa);V++){const b=l[V],R=b._id;fe+=b.size,Y=V===l.length-1,L.has(R)||L.set(R,b),K.push({index:V,file:b,fileId:R,outputPath:le,type:x,quality:k/100,demandThumbnail:se||Y,isSingleImage:w,maxSize:B.shrinkImage?{width:B.maxWidth,height:B.maxHeight}:null,webkitRelativePath:b.webkitRelativePath});const I=b.webkitRelativePath||b.name;y.has(b)?console.warn(`retry "${I}".`):(v++,o.index=v),se=!1}if(j.postMessage(K),Y&&(await Pt(),i.value))break}if(console.log("end file loop"),await Pt(),console.log("resolved all workers"),!i.value){let j;await new Promise(K=>{j=we([()=>o.done,i],()=>{(o.done>=v||i.value)&&K(void 0)},{immediate:!0})}),j(),console.log("processed all files")}m.postMessage({action:"squeeze"}),await C,F();const ce={value:!1},U=()=>{ce.value=!0,Ut(),m.terminate()};let H=!1;return{callbackToClearConverter:U,callbackToGenerateFailedZips:async j=>{H||(H=!0,await al(j,m,ce,o))}}}function nl(o,i,g,a,s){return new Promise(l=>{o.onmessage=p=>{const x=p.data,{action:k}=x;if(k==="add-zip-completed"){const{fileId:y}=x;i.done++,i.success++,a.add(y);return}if(k==="respond-image"){const{url:y,index:f,path:m,size:C,fileId:S}=x;i.convertedImageUrl=y,i.convertedImageSize=C,i.convertedImageIndex=f,i.convertedImageName=m,i.convertedImageFileId=S;let A="",F=0,E="";if(S>=0){const w=s.get(S);A=URL.createObjectURL(w),F=w.size,E=w.name}i.convertedImageOrgUrl=A,i.convertedImageOrgSize=F,i.convertedImageOrgName=E;return}const{size:z,count:c}=x,L="url"in p.data?p.data.url:"";switch(k){case"push-zip":i.zips.push({url:L,size:z,count:c}),i.zippedTotalCount+=c,i.zippedTotalSize+=z;break;case"squeeze-zip":c>0&&(i.zips.push({url:L,size:z,count:c}),i.zippedTotalCount+=c,i.zippedTotalSize+=z),l(void 0);break;case"push-filelist":i.failedFileZippedCount++;break;case"squeeze-filelist-zip":i.failedZipDone=!0;case"push-filelist-zip":console.log("push-filelist-zip",c),i.failedZips.push({url:L,size:z,count:c});break;case"zip-error":case"zip-squeeze-error":i.zippingErrorCount+=c,k==="zip-squeeze-error"&&l(void 0);break}}})}function ol(o,i,g,a,s,d,l,p,x,k,z,c){let L=0;const y=_(new Map),f=_(new Map);return C=>{const S=C.target,{data:A}=C,{action:F}=A;if(i.value)switch(F){case"file-canceled":console.log("file-canceled"),o.done++;return}switch(F){case"list-start":console.log(`list started on worker ${S.id}`);break;case"file-start":{const{index:E,path:w,fileId:v}=A,T={key:L++,core:S.id,index:E,path:w,command:"➡️started"};y.value.set(S.id,T),o.logs.push(T);break}case"file-load":{const{thumbnail:E,width:w,height:v}=A;y.value.get(S.id).command="🖼️loaded",E&&(o.thumbnail=E);break}case"file-converted":{const{index:E,path:w,fileId:v}=A,T=y.value.get(S.id);T.command="🔃converted",f.value.set(v,T),o.converted++;break}case"file-completed":{const{inputsize:E,outputsize:w,fileId:v}=A;o.inputTotalSize+=E,o.outputTotalSize+=w;const T=f.value.get(v);T&&(T.command="✅completed",T.completed=!0);break}case"file-error":{const{index:E,path:w,fileId:v}=A,T=x.get(v);if(!T)throw new Error(`the file doesn't exist in the Map. "${v}":"${w}"`);const le=p.get(T)||0,V=y.value.get(S.id);le<Nt?(p.set(T,le+1),d.push(T),console.error(`worker ${S.id} threw an error when loading "${w}". retrying the file.`),V.command="⚠️retrying",V.error=!0,a.warning(`retrying "${w}"`,{duration:3e3})):(console.error(`failed to load "${w}" after ${Nt} retries. the image may be corrupted or cannot be read by some reason.`),o.done++,o.failure++,V.command="❗failed",V.error=!0,s.error({content:`failed to load "${w}"`,duration:5e3}));break}case"file-canceled":{const{fileId:E,path:w}=A,v=f.value.get(E);o.done++,o.failure++,v.command="❗zip-aborted",v.error=!0;break}case"list-end":{ct(S);break}}}}async function al(o,i,g,a){let s=0;for(const d of o){const l=(d.webkitRelativePath||d.name).replace(/^\//,"");if(g.value)return;s-a.failedFileZippedCount>20&&await new Promise(p=>setTimeout(p,10)),i.postMessage({action:"add-filelist",file:d,path:l}),s++}i.postMessage({action:"squeeze-filelist"})}async function ll(o,i,g,a,s,d){let l="";const p=document.createElement("canvas"),x=p.getContext("2d");let k=new ht;const z=a.format,c=a.quality/100,L=[...z.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),y=o.length,f=a.maxZipSizeMB*1024*1024;let m=0,C=null,S="",A="",F=0,E=0,w=0,v=0,T=0,le=!1;for(const D of o){if(s.value)break;const j=D.name;let K="";const Y=D.size,ne=(D.webkitRelativePath||D.relativePath||j).replace(/^\//,""),ie=document.createElement("img");m++;const fe={key:w++,core:-1,index:m,path:ne,command:"➡️start"};d.index=m,d.logs.push(fe),d.logs.length-1;let se;l&&(URL.revokeObjectURL(l),l=""),l=URL.createObjectURL(D),A=l,F=D.size,ie.src=l;const O=await mn(ie).then(()=>!0).catch(()=>!1);if(!ie.complete||!O||s.value){d.done++,d.failure++,fe.command="❗failed";continue}const b=ie.width,R=ie.height;if(p.width=b,p.height=R,x.drawImage(ie,0,0,b,R,0,0,b,R),fe.command="🖼️imgload",d.thumbnail=ie,se=await new Promise(P=>{const J=X=>{C=X,P(X==null?void 0:X.arrayBuffer())};p.toBlob(J,z,c)}),s.value)break;if(!se){console.log("failed to toBlob",j),d.failure++;continue}E=se.byteLength,d.converted++;let I="";if(T+E>=f){try{I=k.url()}catch(P){le=!0,console.warn(P.message,T),alert("memory problem occurred");break}d.zips.push({url:I,size:T,count:v}),d.zippedTotalCount+=v,d.zippedTotalSize+=T,T=0,v=0,k.clear(),k=new ht}T+=E;const N=ne||j;for(let P=1;P<255&&(K=N.replace(a.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+(P>1?`(${P})`:"")+"."+L,!!k.has(K));P++);d.done++;try{v++,k.add(K,se),d.inputTotalSize+=Y,d.outputTotalSize+=E}catch(P){console.error(P.message);continue}S=K,d.success++,fe.command="✅completed",fe.completed=!0,i.add(D._id)}if(d.success>0)if(y===1)C&&(d.convertedImageIndex=0,d.convertedImageName=S.replace(/^.*\/(?=[^/]+$)/,"").replace(a.retainExtension?"":/\.(jpe?g|gif|png|avif|webp|bmp)$/i,"")+"."+L,d.convertedImageUrl=URL.createObjectURL(C),d.convertedImageOrgUrl=A,d.convertedImageOrgSize=F);else try{if(le)throw new Error("terminated zipping process for memory problems");const D=k.url();d.zips.push({url:D,count:v,size:T}),d.zippedTotalCount+=v,d.zippedTotalSize+=T}catch(D){console.error(D.message)}const V={value:!1},ce=()=>{V.value=!0};let U=!1;return{callbackToClearConverter:ce,callbackToGenerateFailedZips:async D=>{U||(U=!0,sl(D,f,d,V))}}}async function sl(o,i,g,a){let s=0,d=0,l=new ht;for(let p=0;p<o.length;p++){const x=o[p],k=(x.webkitRelativePath||x.name).replace(/^\//,"");let z;try{z=await x.arrayBuffer()}catch{console.warn(k),g.failedToCreateFailedZip=!0;return}if(a.value)return;if(l.add(k,z),d+=x.size,s++,g.failedFileZippedCount++,d>=i||p===o.length-1){const c=l.url();g.failedZips.push({url:c,size:d,count:s}),l.clear(),d=0,s=0}}g.failedZipDone=!0}function mn(o){if(typeof o.onload>"u")throw new Error(`it doesn't have "onload" property.`);return new Promise((i,g)=>{o.onload=i,o.onerror=g})}const Pe=(o,i)=>{const g=o.__vccOpts||o;for(const[a,s]of i)g[a]=s;return g},il=o=>(kt("data-v-5dab19ad"),o=o(),At(),o),rl={class:"container"},ul=il(()=>h("span",{class:"text"},"ZIP",-1)),dl={__name:"zipicon",setup(o){return(i,g)=>(M(),ae("span",rl,[n(e(ve),null,{default:t(()=>[n(e(_t))]),_:1}),ul]))}},cl=Pe(dl,[["__scopeId","data-v-5dab19ad"]]);function Ne(o,i=2){const g=Math.sign(o);o=Math.abs(o);const a=["Bytes","KB","MB","GB"],s=o?Math.floor(Math.log(o)/Math.log(1024)):0;return`${(o/Math.pow(1024,s)*g).toFixed(i)}${a[s]}`}function vn(o,i=100,g=!1){i=typeof i=="number"?{width:i,height:i}:i;const{width:a,height:s}=i;let{width:d,height:l}=o;const p=d/l,x=a/s;return p>=x?(d=g?Math.min(a,d):a,l=d/p|0):(l=g?Math.min(s,l):s,d=l*p|0),{width:d,height:l}}const pl=["href","download","title"],fl=_e({__name:"thumbnail",props:{src:{},width:{},height:{},maxWidth:{default:100},maxHeight:{default:100},expand:{type:Boolean,default:!1},loading:{type:Boolean},fileName:{},allowNext:{type:Boolean},allowPrev:{type:Boolean}},emits:["load","error","next","prev"],setup(o,{expose:i,emit:g}){Oe();const a=o,s=g;i({download:m,openPreview:C});const d=_(),l=_(!0),p=_(""),x=_(100),k=_(100),z=_(!1),c=rt({width:"100px",height:"100px",minWidth:"50px",minHeight:"50px"});we(a,(S,A)=>{c.width=(a.width||100)+"px",c.height=(a.height||100)+"px"}),we(()=>a.src,()=>{f(a.src)},{immediate:!0});async function L(S){const A=S.target,F=A.naturalWidth,E=A.naturalHeight,{width:w,height:v}=vn({width:F,height:E},{width:a.maxWidth||100,height:a.maxHeight||100},a.expand);x.value=w,k.value=v,s("load",{src:A.src,width:F,height:E}),l.value=!1,await new Promise(T=>setTimeout(T,100)),!l.value&&(z.value=!0)}function y(S){const A=S.target;s("error",A.src)}async function f(S){l.value=!0,z.value=!1,await new Promise(A=>setTimeout(A,150)),p.value=S}function m(){const S=document.createElement("a");S.href=p.value,S.download=a.fileName,S.click()}function C(){var S,A,F,E;try{(A=(S=d.value)==null?void 0:S.previewInstRef)==null||A.setPreviewSrc(a.src),(E=(F=d.value)==null?void 0:F.previewInstRef)==null||E.toggleShow(!0)}catch{}}return(S,A)=>{const F=Jt,E=qe,w=He;return M(),q(e(Ae),null,{trigger:t(()=>[n(w,{show:e(l)||a.loading},{default:t(()=>[n(E,{justify:"center",align:"center",style:re(e(c))},{default:t(()=>[h("a",{href:e(p),onClick:A[0]||(A[0]=Ze(()=>{},["left","prevent"])),target:"_blank",download:a.fileName,title:a.fileName,style:{"line-height":"0px"}},[n(Re,{mode:"in-out"},{default:t(()=>[Qt(n(F,{ref_key:"nImageRef",ref:d,"show-toolbar-tooltip":"","_:render-toolbar":"renderToolbar",onLoad:L,onError:y,src:e(p),width:e(x),height:e(k),style:{border:"1px solid silver"}},null,8,["src","width","height"]),[[Yt,e(z)]])]),_:1})],8,pl)]),_:1},8,["style"])]),_:1},8,["show"])]),default:t(()=>[$(" "+r(a.fileName),1)]),_:1})}}}),Dt=Pe(fl,[["__scopeId","data-v-fc8adbf9"]]),gl={style:{"font-weight":"bold",color:"gray"}},ml={style:{"font-weight":"bold",color:"gray"}},vl=["href","download"],hl=["href"],_l={style:{"font-size":"0.8em"}},yl=_e({__name:"image-viewer",props:{url:{},originalUrl:{},name:{},originalName:{},size:{},originalSize:{},length:{},index:{},isSingle:{type:Boolean}},emits:["demand-image"],setup(o,{expose:i,emit:g}){const a=o,s=g;i({download:j});const d=_(),l=_(),p=_(),x=ut(),{t:k}=Oe();Xt();const z=_(!0),c=_(1),L=_(1),y=_(1);_(0);const f=_(""),m=_(1),C=_(1),S=_(!1),A=_(!1),F=_(!1),E=he(()=>{var O,b;return((b=(O=p==null?void 0:p.value)==null?void 0:O.previewInstRef)==null?void 0:b.previewSrc)===f.value}),w=he(()=>c.value<a.length),v=he(()=>c.value>1);let T=-1;we(c,()=>{c.value<1||c.value>a.length||(clearTimeout(T),T=setTimeout(()=>{a.index!==c.value-1&&(s("demand-image",c.value-1),S.value=!0,A.value=!1,F.value=!1)},100))}),we(()=>a.index,()=>{var b,R;let O="";if(a.index===0&&z.value?(z.value=!1,c.value=1,O=a.url):a.index===c.value-1&&(S.value=!1,O=a.url),O){try{(R=(b=p.value)==null?void 0:b.previewInstRef)!=null&&R.displayed&&(E.value?p.value.previewInstRef.setPreviewSrc(O):p.value.previewInstRef.setPreviewSrc(a.originalUrl))}catch{}f.value=O}},{immediate:!0});let le="",V="";we(()=>a.url,()=>{if(a.url!==le){const O=le,b=V;setTimeout(()=>{URL.revokeObjectURL(O),URL.revokeObjectURL(b)},1e3),le=a.url,V=a.originalUrl}a.isSingle&&(z.value=!1,f.value=a.url)}),Me(()=>{a.isSingle,s("demand-image",0),document.body.addEventListener("keydown",U),document.body.addEventListener("keydown",ce)}),en(()=>{document.body.removeEventListener("keydown",U),document.body.removeEventListener("keydown",ce)});function ce(O){var b,R,I,N;if(O.key==="Escape")try{(R=(b=p.value)==null?void 0:b.previewInstRef)!=null&&R.displayed&&(O.stopPropagation(),(N=(I=p.value)==null?void 0:I.previewInstRef)==null||N.toggleShow(!1))}catch{}}function U(O){var b,R;switch(O.key){case"ArrowRight":case"PageDown":Y(1);break;case"ArrowLeft":case"PageUp":Y(-1);break;case"ArrowUp":case"Home":c.value=1;break;case"ArrowDown":case"End":c.value=a.length;break;case" ":case"Enter":ie();break;default:return}O.stopPropagation(),(R=(b=p.value)==null?void 0:b.previewInstRef)!=null&&R.displayed&&O.preventDefault()}function H({width:O,height:b}){L.value=O,y.value=b,A.value=!0}function D({width:O,height:b}){m.value=O,C.value=b,F.value=!0}function j(){E.value?d.value.download():l.value.download()}async function K(O){try{const b=await fetch(O).then(R=>R.blob()).then(R=>new Promise(I=>{const N=new FileReader;N.onload=I,N.readAsDataURL(R)})).then(R=>R.target.result);navigator.clipboard.writeText(b),x.info({title:k("copiedDataURLDialogTitle"),content:()=>Q("div",[Q("div",k("copiedDataURLMessage"))]),positiveText:"OK"})}catch(b){console.error(b),x.error({title:"failed to copy Data URL",content:"could not copy Data URL",positiveText:"OK"})}}function Y(O){O>0&&c.value<a.length&&c.value++,O<0&&c.value>1&&c.value--}let ne="";const ie=()=>{var b,R,I,N,P,J;ne=(I=window.getComputedStyle((R=(b=p==null?void 0:p.value)==null?void 0:b.previewInstRef)==null?void 0:R.previewRef))==null?void 0:I.transform;const O=E.value;(J=(P=(N=p==null?void 0:p.value)==null?void 0:N.previewInstRef)==null?void 0:P.handleSwitchNext)==null||J.call(P),Je(()=>{var X,oe,ye;E.value===O&&((ye=(oe=(X=p==null?void 0:p.value)==null?void 0:X.previewInstRef)==null?void 0:oe.handleSwitchNext)==null||ye.call(oe))})};function fe(){try{Je(()=>p.value.previewInstRef.previewRef.style.transform=ne)}catch{}}function se({nodes:O}){const b=Q(zt,{color:E.value?"green":"gray",offset:[-20,-12],value:(E.value?k("status.Converted"):k("status.Original"))+" "+c.value},()=>Q(Ie,{round:!0,onClick(){ie()},textColor:"white",size:"small",style:{marginLeft:"4px"}},{icon:()=>Q(E.value?Do:jo)}));O.next=Q(Ie,{onClick(){Y(1)},disabled:!w.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>Q(gt)}),O.prev=Q(Ie,{onClick(){Y(-1)},disabled:!v.value,circle:!0,textColor:"white",size:"tiny",style:{marginLeft:"4px"}},{icon:()=>Q(Ot)});try{const R=O.download.children;R.default=()=>k("save");const I=R.trigger();I.props.onClick=j,R.trigger=()=>I}catch{}return[b,...Object.values(O)]}return(O,b)=>{const R=Ce,I=qe,N=ve,P=ot,J=Ro,X=tn,oe=Tt,ye=He;return M(),q(ye,{size:"large",show:z.value},{default:t(()=>[n(I,{justify:"center",align:"center",vertical:"",style:re({visibility:z.value?"hidden":"visible"})},{default:t(()=>[n(I,{align:"center",wrap:!1},{default:t(()=>[n(J,{ref_key:"nImageGroupRef",ref:p,"show-toolbar-tooltip":"","render-toolbar":se,onPreviewNext:fe},{default:t(()=>[n(I,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(I,{align:"center",justify:"center",vertical:""},{default:t(()=>[n(I,{align:"center",justify:"center",wrap:!1,style:{"font-size":"smaller"},class:"original-thumb"},{default:t(()=>[n(Dt,{ref_key:"thumbOrgRef",ref:l,src:O.originalUrl,width:100,"max-width":100,"max-height":80,loading:S.value,"file-name":O.originalName,"allow-next":c.value<a.length,"allow-prev":c.value>1,onLoad:D,onNext:b[0]||(b[0]=be=>Y(1)),onPrev:b[1]||(b[1]=be=>Y(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(R,{vertical:"",align:"center"},{default:t(()=>[h("span",gl,r(e(k)("status.Original")),1),n(R,{justify:"center",style:{"white-space":"nowrap","font-family":"v-mono"}},{default:t(()=>[$(r(String(m.value).padStart(4," "))+" × "+r(String(C.value).padStart(4," ")),1)]),_:1}),n(R,{justify:"center"},{default:t(()=>[$(r(e(Ne)(a.originalSize,0)),1)]),_:1})]),_:1})]),_:1})]),_:1}),n(I,{style:{margin:"1em"},class:"original-thumb"},{default:t(()=>[n(N,{size:"48",color:"silver"},{default:t(()=>[n(e(gt))]),_:1})]),_:1}),n(I,{vertical:"",align:"center",justify:"center"},{default:t(()=>[n(I,{align:"center",justify:"center",wrap:!1},{default:t(()=>[n(Dt,{ref_key:"thumbConvRef",ref:d,src:f.value,width:140,"max-width":140,"max-height":100,loading:S.value,"file-name":a.name,"allow-next":c.value<a.length,"allow-prev":c.value>1,onLoad:H,onNext:b[2]||(b[2]=be=>Y(1)),onPrev:b[3]||(b[3]=be=>Y(-1))},null,8,["src","loading","file-name","allow-next","allow-prev"]),n(I,{vertical:"",align:"center"},{default:t(()=>[h("span",ml,r(e(k)("status.Converted")),1),n(I,{justify:"center",wrap:!0},{default:t(()=>[a.url?(M(),q(P,{key:0,"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:a.url,ref:"saveImg",target:"_blank",download:a.name},[n(e(Ie),{round:"",size:"tiny"},{default:t(()=>[$(r(O.$t("save")),1)]),_:1})],8,vl)]),default:t(()=>[$(" "+r(O.$t("save")),1)]),_:1})):de("",!0),a.url?(M(),q(P,{key:1,"display-directive":"show",trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:a.url,target:"_self"},[n(e(Ie),{onClick:b[4]||(b[4]=Ze(be=>K(a.url),["left","prevent","stop"])),round:"",size:"tiny"},{default:t(()=>[$("DataURL")]),_:1})],8,hl)]),default:t(()=>[$(" "+r(O.$t("convertedImageDataUrlTooltip")),1)]),_:1})):de("",!0)]),_:1}),n(I,{justify:"center",style:{"white-space":"nowrap","font-family":"v-mono"}},{default:t(()=>[$(r(String(L.value).padStart(4," "))+" × "+r(String(y.value).padStart(4," ")),1)]),_:1}),n(I,{justify:"center"},{default:t(()=>[$(r(e(Ne)(a.size,0)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),n(I,{ref:"fileNameContainer",justify:"center",style:{"max-width":"320px"},title:a.name},{default:t(()=>[n(X,{"x-scrollable":!0,trigger:"hover",style:{"font-size":"smaller",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:t(()=>[$(r(a.name),1)]),_:1})]),_:1},8,["title"]),O.isSingle?de("",!0):(M(),q(I,{key:0,style:{"font-family":"v-mono"},align:"center"},{default:t(()=>[h("span",_l,r(e(k)("status.index"))+":",1),$(" "+r(c.value)+" / "+r(a.length),1)]),_:1})),O.isSingle?de("",!0):(M(),q(I,{key:1,align:"center",justify:"center"},{default:t(()=>[n(e(Ie),{onClick:b[5]||(b[5]=be=>Y(-1)),disabled:!e(v),circle:!0,size:"small"},{icon:t(()=>[n(N,null,{default:t(()=>[n(e(Ot))]),_:1})]),_:1},8,["disabled"]),n(oe,{value:c.value,"onUpdate:value":b[6]||(b[6]=be=>c.value=be),tooltip:!1,step:1,min:1,max:a.length,style:{width:"180px"}},null,8,["value","max"]),n(e(Ie),{onClick:b[7]||(b[7]=be=>Y(1)),disabled:!e(w),circle:!0,size:"small"},{icon:t(()=>[n(N,null,{default:t(()=>[n(e(gt))]),_:1})]),_:1},8,["disabled"])]),_:1}))]),_:1},8,["style"])]),_:1},8,["show"])}}}),wl=Pe(yl,[["__scopeId","data-v-d568baaa"]]),bl={class:"log-table"},xl={class:"log-tr"},kl={class:"log-th"},Al={class:"log-th"},zl={style:{"min-width":"7em"},class:"log-th"},Tl={style:{"padding-left":"2em"},class:"log-th"},Il={class:"log-td"},Sl={class:"log-td"},$l={class:"log-td"},Cl={class:"log-td"},Ll={style:{margin:"1px"}},El=["href","download","onClick"],Ml={key:0,style:{position:"relative"}},Fl=["href","download"],Ol=["href","download"],Pl={key:0,style:{margin:"1px"}},Ul=["href","download","onClick"],jt=99999,Nl=100,Dl=_e({__name:"status",props:{processing:{type:Boolean},status:{},interval:{}},emits:["all-zips-clicked","demand-zip-errors","demand-image"],setup(o,{emit:i}){const g=ut(),{t:a}=Oe(),s=Xt(),d={W:160,H:80},l=o,p=i,x=_(!1),k=_([]),z=_(!1),c=_([]),L=_([]),y=_([0,0]),f=_([0,0]),m=_([0,0]),C=_([0,0]),S=_([0,0]),A=_([0,0]),F=_(0),E=_([0,0]),w=_(s.value.infoColor),v=_("#000000"),T=_("#000000"),le=_(0),V=_(0),ce=_(""),U=_("00:00:00");_(""),_("");const H=_(void 0),D=_(!1),j=_(!0),K=_(!1),Y=he(()=>D.value?fe.value:ie.value),ne=_("16em"),ie=_(5),fe=_(1e3),se=_(!0),O=_(!1),b=rt({name:"",originalName:"",size:0,url:"",originalUrl:"",originalSize:0,dataUrl:"",index:-1}),R=_(null),I=_(null),N=_(),P=_();Me(()=>{we(l.status,()=>ye(),{deep:!1}),we([I,se],()=>{if(!I.value||!se.value)return;const{width:me,height:ke}=vn(I.value,{width:d.W,height:d.H});R.value.width=me,R.value.height=ke,R.value.style.width=me+"px",R.value.style.height=ke+"px",I.value instanceof HTMLImageElement?R.value.getContext("2d").drawImage(I.value,0,0,me,ke):(R.value.getContext("bitmaprenderer").transferFromImageBitmap(I.value),I.value=null,l.status.thumbnail=null)});let u=0;const W=()=>{if(u)return;const me=Date.now();U.value="00:00:00",u=window.setInterval(()=>{const ke=(Date.now()-me)/1e3;U.value=`${String(ke/3600|0).padStart(2,"0")}:${String(ke/60%60|0).padStart(2,"0")}:${String(ke%60|0).padStart(2,"0")}`},300)};W(),we(()=>l.processing,(me,ke)=>{me?(W(),k.value=[],x.value=!1,z.value=!1,c.value=[],L.value=[]):(clearInterval(u),ye(),u=0),se.value=!1,O.value=!0,l.processing||be()});const ee=Ho();let G;const te=()=>{clearTimeout(G),G=setTimeout(()=>{if(!se.value||ue)return;const me=N.value.$parent.$el.offsetHeight,ke=window.innerHeight-ee.parent.parent.vnode.el.offsetHeight-8;ne.value=Math.max(me+ke,50)+"px"},100)};te(),window.addEventListener("resize",te);const pe=new ResizeObserver(te);pe.observe(ee.parent.parent.vnode.el);let ue=!1;Zo(()=>{ue=!0,pe.disconnect(),clearInterval(u),clearTimeout(G),clearTimeout(oe),clearTimeout(Ge),window.removeEventListener("resize",te)})}),we([()=>l.status.zips.length,()=>l.status.failedZips.length],()=>{const u=l.status;{c.value.length>u.zips.length&&(c.value.length=0);let W=0;const ee=u.zips.length===1&&u.zippedTotalCount===u.length;for(let G=c.value.length;G<u.zips.length;G++){const te=u.zips[G],pe=u.baseZipName+(ee?"":"-"+String(G+1).padStart(2,"0"))+".zip";W+=te.size,c.value[G]={url:te.url,size:te.size,number:ee?0:G+1,sizeByUnit:Ne(te.size),name:pe,count:te.count,clicked:!1}}}{L.value.length>u.failedZips.length&&(L.value.length=0);let W=0;const ee=u.failedZipDone&&u.failedZips.length===1;for(let G=L.value.length;G<u.failedZips.length;G++){const te=u.failedZips[G],pe=u.baseZipName+"-error"+(ee?"":"-"+String(G+1).padStart(2,"0"))+".zip";W+=te.size,L.value[G]={url:te.url,size:te.size,number:ee?0:G+1,sizeByUnit:Ne(te.size),name:pe,count:te.count,clicked:!1}}}});const J=l.interval||100;let X=!1,oe=0;function ye(){if(X)return;if(oe){X=!0;return}oe=window.setTimeout(()=>{oe=0,X&&(X=!1,ye())},J);const u=l.status;x.value=u.length>=2,f.value[1]=f.value[0],f.value[0]=u.index,m.value[1]=m.value[0],m.value[0]=u.success,C.value[1]=C.value[0],C.value[0]=u.failure,S.value[1]=S.value[0],S.value[0]=u.done,A.value[1]=A.value[0],A.value[0]=u.converted,F.value=u.length,E.value[1]=E.value[0],E.value[0]=u.zippedTotalCount,le.value=u.inputTotalSize,V.value=u.outputTotalSize;const W=V.value-le.value;ce.value=(W>=0?"+ ":"")+Ne(W);const ee=V.value/le.value,G=(256|Math.min(255,Math.max(0,ee-1.5)*255|0)).toString(16).substring(1);v.value="#"+G+"0000";const te=1024*1024,pe=(256|Math.min(255,Math.max(0,W/1024/te)*255|0)).toString(16).substring(1);if(T.value="#"+pe+"0000",y.value[1]=y.value[0],y.value[0]=m.value[0]/F.value*100,se.value||!l.processing){const ue=u.logs.slice(-jt);k.value.push(...ue);const me=k.value.length-jt;me>0&&k.value.splice(0,me),j.value&&ue.length&&at(),k.value.length>fe.value&&(fe.value*=2)}u.logs.length=0,I.value=u.thumbnail,l.processing&&(w.value=C.value[0]?s.value.warningColor:s.value.infoColor),u.convertedImageUrl!==b.url&&(b.url=u.convertedImageUrl,b.name=u.convertedImageName,b.dataUrl=u.convertedImageDataUrl,b.size=u.convertedImageSize||u.outputTotalSize,b.originalSize=u.convertedImageOrgSize,b.originalName=u.convertedImageOrgName,b.index=u.convertedImageIndex,b.originalUrl=u.convertedImageOrgUrl)}function be(){const u=l.status;w.value=l.status.success===l.status.length?s.value.successColor:s.value.errorColor,u.unconvertedFileCount>0,C.value[0]>0||(m.value[0],F.value)}const Ue=he(()=>[{key:"open",label:a("status.openFailedList"),icon:()=>Q(ve,()=>Q(nn)),onSelect(){Le()}},{key:"download",label:a("status.saveFailedList"),icon:()=>Q(ve,()=>Q(Bo)),onSelect(){Le(!0)}},{key:"zip",label:`${a("status.zipFailedList")}`+(l.status.failedZipDone?`(✔${a("status.done")})`:""),icon:()=>Q(He,{show:z.value&&!l.status.failedZipDone,size:"small"},()=>Q(ve,()=>Q(_t))),disabled:z.value,onSelect(u){return z.value=!0,p("demand-zip-errors"),!1}}]);function $e(u,W=!1){const{url:ee,name:G}=u;if(W){const te=document.createElement("a");te.href=ee,te.download=G,te.click()}u.clicked||(u.clicked=!0,l.processing||c.value.every(te=>te.clicked)&&p("all-zips-clicked"))}async function xe(){if(x.value){if(c.value.length>=2&&!await new Promise((ee,G)=>g.warning({title:a("Download"),content:a("status.confirmDownloadMessage",[c.value.length]),positiveText:"OK",negativeText:a("cancel"),onPositiveClick:()=>ee(!0),onNegativeClick:()=>G()})))return;const u=c.value;for(const W of u)$e(W,!0)}else P.value.download()}function Le(u=!1){const W=new Blob([l.status.unconvertedListText],{type:"text/plain;charset=utf8"}),ee=URL.createObjectURL(W),G=document.createElement("a");G.href=ee,G.target="_blank",u&&(G.download=l.status.baseZipName+"-error.txt"),G.click()}let Ge=0,Te=!1;function at(u=!1){if(!Te){if(Ge){Te=!0;return}Je(()=>{!u&&(!D.value||!j.value)||(N.value.scrollTo({behavior:u?"instant":"smooth",top:k.value.length*50}),Ge=window.setTimeout(()=>{Ge=0,Te&&(Te=!1,at())},Nl))})}}return(u,W)=>{const ee=Ce,G=Wo,te=Vo,pe=ot,ue=qe,me=qo,ke=an,pt=Ae,Io=ln,So=It,$o=St,Co=xt,Ke=Ie,Lo=cl,Et=zt,Eo=Go;return M(),q(ue,{vertical:"",justify:"center"},{default:t(()=>[n(ee,{justify:"center",align:"center",wrap:!1,style:{"white-space":"nowrap"}},{default:t(()=>[n(ee,{vertical:"",justify:"center",class:"left-column"},{default:t(()=>[n(G,{"tabular-nums":"",label:u.$t("status.elapsedTime")},{default:t(()=>[n(ee,null,{default:t(()=>[$(r(e(U)),1)]),_:1})]),_:1},8,["label"]),n(G,{"tabular-nums":"",label:u.$t("status.multiThreading")},{default:t(()=>[n(ee,{style:re({color:l.status.threads?"":"red"})},{default:t(()=>[$(r(l.status.threads?u.$rt("{n} @:threads",l.status.threads):u.$t("disabled")),1)]),_:1},8,["style"])]),_:1},8,["label"]),n(G,{"tabular-nums":"",label:u.$t("status.outputSettings")},{default:t(()=>[n(ee,{vertical:"",justify:"end",style:{"font-size":"smaller","line-height":"1em"}},{default:t(()=>[h("div",null,"Type: "+r(l.status.type),1),h("div",null,"Zip: "+r(l.status.zipSize)+"MB",1)]),_:1})]),_:1},8,["label"])]),_:1}),n(me,{type:"multiple-circle","stroke-width":1,percentage:[e(m)[0]/e(F)*100|0,e(f)[0]/e(F)*100|0],color:[e(s).successColor,e(w)],"rail-style":[{stroke:u.processing?e(s).successColor:e(w),opacity:.3},{stroke:e(w),opacity:.3}],class:"center-column"},{default:t(()=>[n(ee,{vertical:"",align:"center",style:{"font-family":"v-mono","font-size":"xx-large","white-space":"nowrap"},wrap:!1,"wrap-item":!1},{default:t(()=>[h("span",{style:re({color:e(C)[0]?e(w):u.processing?e(s).successColor:e(w)})},[n(te,{duration:e(J)*3|0,from:e(y)[1]|0,to:e(y)[0]|0,active:!0},null,8,["duration","from","to"]),$("% ")],4),n(ue,{wrap:!1,style:{border:"0px solid"}},{default:t(()=>[n(ue,{vertical:"",size:"small",justify:"end"},{default:t(()=>[n(ue,{justify:"end",wrap:!1},{default:t(()=>[e(C)[0]>0?(M(),q(pe,{key:0,trigger:"hover",duration:0,delay:0,style:re({color:e(s).errorColor}),placement:"left"},{trigger:t(()=>[h("span",{style:re({fontSize:"xx-small",color:e(s).errorColor,lineHeight:"0"})}," ("+r(e(C)[0].toLocaleString("en-us"))+") ",5)]),default:t(()=>[$(" "+r(u.$t("status.progressErrors"))+" ("+r(e(C)[0].toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])):de("",!0),n(pe,{trigger:"hover",duration:0,delay:0,style:re({color:e(s).infoColor}),placement:"left"},{trigger:t(()=>[h("span",{style:re({fontSize:"xx-small",color:e(s).infoColor,lineHeight:"0"})},r(e(f)[0].toLocaleString("en-us")),5)]),default:t(()=>[$(" "+r(u.$t("status.progressStarted"))+" ("+r(e(f)[0].toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])]),_:1}),n(ue,{justify:"end"},{default:t(()=>[n(pe,{trigger:"hover",duration:0,delay:0,style:re({color:e(s).successColor}),placement:"bottom"},{trigger:t(()=>[h("span",{style:re({fontSize:"medium",color:e(s).successColor})},[n(te,{duration:e(J)*3|0,from:e(m)[1],to:e(m)[0],active:!0,"show-separator":!0},null,8,["duration","from","to"])],4)]),default:t(()=>[$(" "+r(u.$t("status.progressSuccess"))+" ("+r(e(m)[0].toLocaleString("en-us"))+") ",1)]),_:1},8,["style"])]),_:1})]),_:1}),n(ue,{align:"end",style:{"font-size":"medium",border:"0px solid"}},{default:t(()=>[n(pe,{trigger:"hover",duration:0,delay:0,placement:"bottom"},{trigger:t(()=>[$(" / "+r(e(F).toLocaleString("en-us")),1)]),default:t(()=>[$(" "+r(u.$t("status.progressTotal"))+" ("+r(e(F).toLocaleString("en-us"))+") ",1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["percentage","color","rail-style"]),n(ee,{vertical:"",style:{height:"100%"},justify:"center"},{default:t(()=>[n(G,{"tabular-nums":"",label:u.$t("status.inputSize")},{default:t(()=>[n(ee,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[$(r((e(le)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(G,{"tabular-nums":"",label:u.$t("status.outputSize")},{default:t(()=>[n(ee,{justify:"end",wrap:!1,style:{"font-family":"v-mono"}},{default:t(()=>[$(r((e(V)/1024|0).toLocaleString("en-us"))+" KB",1)]),_:1})]),_:1},8,["label"]),n(G,{"tabular-nums":"",label:u.$t("status.outInRate")},{default:t(()=>[n(ee,{vertical:"",align:"end",justify:"start",style:{"font-size":"xx-small","font-family":"v-mono","line-height":"50%"}},{default:t(()=>[h("span",{style:re({color:e(v),fontSize:"larger"})},"× "+r((e(V)/e(le)||1).toFixed(2)),5),h("span",{style:re({color:e(T)})},"("+r(e(ce))+")",5)]),_:1})]),_:1},8,["label"])]),_:1})]),_:1}),n($o,{"display-directive":"show","trigger-areas":["arrow","main"],"default-expanded-names":"log-collapse","expanded-names":e(se)?["log-collapse"]:[],"on-update:expanded-names":Z=>{se.value=!!String(Z)}},{default:t(()=>[n(So,{title:"Log",name:"log-collapse",style:{"white-space":"nowrap"}},on({header:t(()=>[n(ue,{align:"center",wrap:!1},{default:t(()=>[$(r(u.$t("status.log")),1),u.processing&&!e(se)?(M(),q(e(He),{key:0,size:16})):de("",!0)]),_:1})]),default:t(()=>[n(ue,{wrap:!1,class:Xe({"log-container":1,"expand-log":e(D)}),align:"stretch",style:re(e(D)?{height:e(ne),maxHeight:e(ne)}:{})},{default:t(()=>[n(e(tn),{ref_key:"scrollref",ref:N,"x-scrollable":!0,onMouseup:W[5]||(W[5]=Z=>j.value=!1),onWheel:W[6]||(W[6]=Z=>j.value=!1),trigger:"none",style:re([{"z-index":"2","padding-right":"10px","min-height":"7em"},{maxHeight:e(ne)}]),size:50},{default:t(()=>[h("table",bl,[h("tr",xl,[h("th",kl,r(u.$t("status.table.core")),1),h("th",Al,r(u.$t("status.table.index")),1),h("th",zl,r(u.$t("status.table.status")),1),h("th",Tl,r(u.$t("status.table.details")),1)]),(M(!0),ae(ze,null,Be((e(K)?e(k).filter(Z=>!Z.completed):e(k)).slice(-e(Y)),({index:Z,key:je,command:Fe,path:ft,core:Mt})=>(M(),ae("tr",{key:je,class:"log-tr"},[h("td",Il,r(Mt>=0?Mt+1:"-"),1),h("td",Sl,r(Z+1),1),h("td",$l,r(Fe),1),h("td",Cl,r(ft),1)]))),128))])]),_:1},8,["style"]),n(ue,{style:re([{"align-self":"center",position:"absolute","z-index":"0","margin-top":"0.5em",right:"0.1em","line-height":"0px"},{width:d.W+"px",height:d.H+"px"}]),justify:"center",align:"center"},{default:t(()=>[n(e(He),{size:"small",show:u.processing},{default:t(()=>[l.status.thumbnail===void 0?(M(),q(Io,{key:0,description:"EMPTY"})):de("",!0),Qt(h("canvas",{ref_key:"thumbcanvas",ref:R,width:"106",height:"80",style:re({border:"1px solid gray",filter:u.processing?"":"opacity(0.35)"})},null,4),[[Yt,l.status.thumbnail!==void 0]])]),_:1},8,["show"])]),_:1},8,["style"])]),_:1},8,["class","style"])]),_:2},[e(se)?{name:"header-extra",fn:t(()=>[n(ue,{align:"center",wrap:!1},{default:t(()=>[n(mt,null,{default:t(()=>[n(ke,{key:"a",checked:e(K),"onUpdate:checked":W[0]||(W[0]=Z=>Ee(K)?K.value=Z:null),size:"small",style:{"font-size":"smaller"},class:"hide-mobile"},{default:t(()=>[$(r(u.$t("status.filterSuccess")),1)]),_:1},8,["checked"]),e(D)?(M(),q(ke,{key:"b",checked:e(j),"onUpdate:checked":[W[1]||(W[1]=Z=>Ee(j)?j.value=Z:null),W[2]||(W[2]=Z=>Z&&at(!0))],size:"small",style:{"font-size":"smaller"}},{default:t(()=>[$(r(u.$t("status.autoScroll")),1)]),_:1},8,["checked"])):de("",!0)]),_:1}),n(pt,{style:{"max-width":"30em"}},{trigger:t(()=>[n(ke,{size:"small",checked:e(D),"onUpdate:checked":[W[3]||(W[3]=Z=>Ee(D)?D.value=Z:null),W[4]||(W[4]=Z=>{j.value=Z,at(!0)})],style:{"font-size":"smaller"}},{default:t(()=>[$(r(u.$t("status.expandLog")),1)]),_:1},8,["checked"])]),default:t(()=>[$(r(u.$t("status.expandLogTooltip")),1)]),_:1})]),_:1})]),key:"0"}:void 0]),1024)]),_:1},8,["expanded-names","on-update:expanded-names"]),n(Co,{style:{margin:"0.2em"}}),n(ue,{wrap:!1,vertical:""},{default:t(()=>[n(ue,{justify:"center",align:"center",vertical:""},{default:t(()=>[h("div",{class:"singleimage",style:re({maxHeight:e(O)?"2000px":"100px"})},[!e(O)&&e(x)&&l.status.threads?(M(),q(Ke,{key:0,tertiary:"",type:"success",size:"small",disabled:!(u.status.success>0),onClick:W[7]||(W[7]=Z=>O.value=!0)},{default:t(()=>[$(r(u.$t("status.browseConvertedImages")),1)]),_:1},8,["disabled"])):u.status.success>0&&(l.status.threads||!e(x))?(M(),q(wl,{key:1,ref_key:"imageViewer",ref:P,url:e(b).url,size:e(b).size,"original-url":e(b).originalUrl,"original-size":e(b).originalSize,name:e(b).name,originalName:e(b).originalName,length:l.status.success,index:e(b).index,"is-single":!e(x),onDemandImage:W[8]||(W[8]=Z=>p("demand-image",Z))},null,8,["url","size","original-url","original-size","name","originalName","length","index","is-single"])):de("",!0)],4)]),_:1}),n(ue,{justify:"center"},{default:t(()=>[e(x)?(M(),q(ue,{key:0,vertical:"",align:"center"},{default:t(()=>[n(pe,{placement:"left"},{trigger:t(()=>[n(me,{type:"line","indicator-placement":"inside",color:"lime","rail-color":"rgba(99, 255, 99, 0.5)","indicator-text-color":e(E)[0]===e(F)?"white":"green",processing:u.processing,percentage:e(E)[0]/e(F)*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[h("span",Ll,r(e(E)[0]/e(F)*100|0)+"% "+r(u.$t("status.zipped"))+" ("+r(e(E)[0])+"/"+r(e(A)[0])+")",1)]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[$(" "+r(u.$t("status.zippingProgress"))+" ("+r(e(E)[0]/e(F)*100|0)+"%) ",1)]),_:1}),n(Re,{name:"zipcontainer"},{default:t(()=>[e(c).length>=1||l.processing?(M(),q(mt,{key:0,name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(M(!0),ae(ze,null,Be(e(c),(Z,je)=>(M(),ae("span",{key:je},[n(pe,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:Z.url,download:Z.name,class:"in-button-anchor",onClick:Fe=>$e(Z)},[n(Ke,{class:"zip-button",size:"tiny",color:Z.clicked?"#050":"lime","text-color":Z.clicked?"gray":"white",onClick:Ze(Fe=>$e(Z),["stop"]),round:""},{default:t(()=>[n(e(ve),{size:"tiny"},{default:t(()=>[n(e(_t))]),_:1}),$("ZIP"+r(Z.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,El)]),default:t(()=>[h("div",{style:re({color:e(s).successColor})},[h("div",null,"ZIP "+r(Z.number||"")+" ("+r(u.$t("success"))+")",1),h("div",null,r(Z.name),1),h("div",null,r(Z.sizeByUnit),1),h("div",null,r(u.$rt("{n} @:files",Z.count)),1)],4)]),_:2},1024)]))),128))]),_:1})):de("",!0)]),_:1})]),_:1})):de("",!0)]),_:1}),n(Re,null,{default:t(()=>[l.processing?de("",!0):(M(),q(ue,{key:0,justify:"center",align:"center"},{default:t(()=>[n(pe,{trigger:"hover",duration:0,delay:0,placement:"left",style:re({color:"white",backgroundColor:e(s).successColor}),"arrow-style":{backgroundColor:e(s).successColor}},{trigger:t(()=>[n(Re,{name:"save"},{default:t(()=>[e(m)[0]>0?(M(),ae("span",Ml,[n(Et,{value:e(x)?e(E)[0].toLocaleString("en-us"):l.status.type.replace(/\(.+\)/,""),color:e(s).successColorHover,offset:[-20,-3]},{default:t(()=>[n(Ke,{size:"medium",onClick:xe,color:e(s).successColor,round:""},{default:t(()=>[e(x)?(M(),ae(ze,{key:0},[e(c).length?(M(),ae("a",{key:0,href:e(c)[0].url,download:e(c)[0].name,class:"in-button-anchor",onClick:W[9]||(W[9]=Ze(()=>{},["prevent"]))},[n(Lo),$(" × "+r(e(c).length)+" "+r(u.$t("save")),1)],8,Fl)):de("",!0)],64)):(M(),ae("a",{key:1,href:e(b).url,download:e(b).name,class:"in-button-anchor",onClick:W[10]||(W[10]=Ze(()=>{},["prevent"]))},[n(e(ve),{size:"tiny"},{default:t(()=>[n(e(sn))]),_:1}),$(" "+r(u.$t("save")),1)],8,Ol))]),_:1},8,["color"])]),_:1},8,["value","color"])])):de("",!0)]),_:1})]),default:t(()=>[u.status.length>=2?(M(),ae(ze,{key:0},[h("div",null,r(e(a)("success"))+": "+r(e(E)[0].toLocaleString()),1),h("div",null,r(e(a)("status.totalSize"))+": "+r(e(Ne)(u.status.zippedTotalSize)),1),h("div",null,"ZIP × "+r(e(c).length),1),h("div",null,r(e(a)("status.saveAllZipsTooltip")),1)],64)):(M(),ae(ze,{key:1},[$(r(u.$t("status.downloadConvertedImage",e(c).length)),1)],64))]),_:1},8,["style","arrow-style"]),!u.processing&&u.status.success!==e(F)?(M(),q(Eo,{key:0,options:e(Ue),onSelect:W[11]||(W[11]=(Z,je)=>{var Fe;return(Fe=e(Ue).find(({key:ft})=>Z===ft))==null?void 0:Fe.onSelect()}),"show-arrow":!0,trigger:"click",size:"small",placement:"bottom-start"},{default:t(()=>[n(pe,{show:e(H),duration:0,delay:0,placement:"right",style:re({color:"white",backgroundColor:e(s).errorColor}),"arrow-style":{backgroundColor:e(s).errorColor}},{trigger:t(()=>[n(Et,{value:u.status.unconvertedFileCount.toLocaleString(),color:e(s).errorColorHover,offset:[-0,-3]},{default:t(()=>[n(Ke,{size:"small",color:e(s).errorColor},{default:t(()=>[n(e(ve),{size:"medium",style:{"vertical-align":"middle"}},{default:t(()=>[n(e(Ko))]),_:1})]),_:1},8,["color"])]),_:1},8,["value","color"])]),default:t(()=>[h("div",null,[h("div",null,r(e(a)("failed"))+": "+r(u.status.unconvertedFileCount.toLocaleString()),1),h("div",null,r(e(a)("status.totalSize"))+": "+r(e(Ne)(u.status.unconvertedTotalSize)),1)])]),_:1},8,["show","style","arrow-style"])]),_:1},8,["options"])):de("",!0)]),_:1}))]),_:1}),n(Re,{name:"zipcontainer"},{default:t(()=>[e(z)?(M(),q(ue,{key:0,vertical:"",align:"center"},{default:t(()=>[n(pe,{placement:"left"},{trigger:t(()=>[n(me,{type:"line","indicator-placement":"inside",color:"red","rail-color":"rgba(255, 0, 0, 0.5)","indicator-text-color":u.status.failedFileZippedCount===u.status.unconvertedFileCount?"white":"#500",processing:e(z)&&!u.status.failedZipDone&&!u.status.failedToCreateFailedZip,percentage:u.status.failedFileZippedCount/u.status.unconvertedFileCount*100|0,style:{width:"300px","font-weight":"bold","font-family":"v-mono"}},{default:t(()=>[u.status.failedToCreateFailedZip?(M(),ae("div",{key:1,style:re({color:e(s).errorColor})},r(u.$t("status.failureZippingFailedFiles")),5)):(M(),ae("span",Pl,r(u.status.failedFileZippedCount/u.status.unconvertedFileCount*100|0)+"% "+r(u.$t("status.zipped"))+" ("+r(u.status.failedFileZippedCount)+"/"+r(u.status.unconvertedFileCount)+")",1))]),_:1},8,["indicator-text-color","processing","percentage"])]),default:t(()=>[$(" "+r(u.$t("status.zippingProgress"))+" ("+r(u.status.failedFileZippedCount/u.status.unconvertedFileCount*100|0)+"%) ",1)]),_:1}),n(mt,{name:"zips",class:"zip-buttons-parent",tag:"n-flex"},{default:t(()=>[(M(!0),ae(ze,null,Be(e(L),(Z,je)=>(M(),ae("span",{key:je},[n(pe,{trigger:"hover",duration:0,delay:0},{trigger:t(()=>[h("a",{href:Z.url,download:Z.name,class:"in-button-anchor",onClick:Fe=>$e(Z)},[n(Ke,{class:"zip-button",size:"tiny",color:Z.clicked?"#551122":"#F00","text-color":Z.clicked?"gray":"white",onClick:Ze(Fe=>$e(Z),["stop"]),round:""},{default:t(()=>[n(e(ve),{size:"tiny"},{default:t(()=>[n(e(Qo))]),_:1}),$("ZIP"+r(Z.number||""),1)]),_:2},1032,["color","text-color","onClick"])],8,Ul)]),default:t(()=>[h("div",{style:re({color:e(s).errorColor})},[h("div",null,"ZIP "+r(Z.number||"")+" ("+r(u.$t("failed"))+")",1),h("div",null,r(Z.name),1),h("div",null,r(Z.sizeByUnit),1),h("div",null,r(u.$rt("{n} @:files",Z.count)),1)],4)]),_:2},1024)]))),128))]),_:1})]),_:1})):de("",!0)]),_:1})]),_:1})]),_:1})}}}),jl=Pe(Dl,[["__scopeId","data-v-6d046527"]]),Rl=["innerHTML"],Zl=h("p",null,[h("img",{width:"200",src:Ha})],-1),Bl={style:{"flex-grow":"1"}},Hl=_e({__name:"converter",props:et({input:{},format:{},quality:{},retainExtension:{type:Boolean},maxZipSizeMB:{},threads:{}},{showNote:{type:Boolean},showNoteModifiers:{}}),emits:et(["start","end","multi-thread-count"],["update:showNote"]),setup(o,{emit:i}){Ve(De);const{t:g}=Oe(),a=ut(),s=Yo(),d=Jo(),l=10,p=navigator.hardwareConcurrency,x=typeof OffscreenCanvas=="function",k=300,z=o,c=Se(o,"showNote"),L=i,y=_(!1),f=_(!1),m=_(!1),C=_(0),S=_(!1),A=_(!1),F=_("initializing"),E=_("info"),w=rt(K());let v=!1,T=()=>{},le=0,V=!1;we(()=>z.input,I=>{I!=null&&I.length&&ne(I)}),Me(async()=>{await b(),R()});async function ce(){let I=!0;le>l*1e3&&!V&&w.success>0&&(I=!1,await new Promise(N=>{a.warning({title:g("confirmCloseDialogTitle"),autoFocus:!0,maskClosable:!1,positiveText:g("close"),negativeText:g("back"),onPositiveClick:()=>I=!0,onAfterLeave:N,content:g("confirmCloseDialog")})})),I&&(d.destroyAll(),s.destroyAll(),S.value=!1,c.value=!1)}function U(I){w.demandImage(I)}function H(){!f.value&&y.value?f.value=!0:ce()}function D(){ne(z.input)}let j=_(()=>{});function K(I){const N={logs:[],index:0,converted:0,success:0,failure:0,done:0,length:0,zippedTotalCount:0,zippingErrorCount:0,zippedTotalSize:0,processing:!1,zips:[],inputTotalSize:0,outputTotalSize:0,thumbnail:null,baseZipName:"testzipname",type:"image/any",startedTime:Date.now(),convertedImageDataUrl:"",convertedImageName:"",convertedImageUrl:"",zipSize:z.maxZipSizeMB,unconvertedListText:"",failedZipDone:!1,failedZips:[],unconvertedFileCount:0,unconvertedTotalSize:0,failedFileZippedCount:0,failedToCreateFailedZip:!1,demandImage:()=>{}};return Object.assign(I||{},N)}function Y(){A.value=!1,URL.revokeObjectURL(w.convertedImageUrl),URL.revokeObjectURL(w.convertedImageOrgUrl);for(const I of w.zips)URL.revokeObjectURL(I.url);w.zips.length=0;for(const I of w.failedZips)URL.revokeObjectURL(I.url);w.failedZips.length=0,K(w),T(),T=()=>{},V=!1,m.value=!1,f.value=!1}async function ne(I){if(y.value){a.error({title:"Busy",positiveText:"OK",content:g("interfered")});return}let N=se(I);K(w),Y();const P={convertedImageBlob:null,convertedImageWidth:0,convertedImageHeight:0,convertedImageName:""};C.value++,S.value=!0,A.value=!0,y.value=!0,w.processing=!0,E.value="info",F.value=g("processing");const J=new Set,X=z.format,oe=z.quality,ye=[...X.matchAll(/.+\/(.+)/g)][0][1].replace(/jpeg/,"jpg"),be=O(X,oe,N[0].webkitRelativePath);w.length=N.length,w.baseZipName=be,w.type=X.replace(/image\//,"").toUpperCase()+(/jpe?g|webp/i.test(X)?" ("+oe+")":""),w.threads=v?0:z.threads;const Ue=Date.now();L("start");const $e=N.concat();let xe,Le;if({exception:Le,callbackToGenerateFailedZips:xe,callbackToClearConverter:T}=!v&&z.threads>=2?await tl(w,f,z,P,s,d,$e,J,X,oe,ye,X):await ll($e,J,P,z,f,w),Le){let Te;switch(Le.message){case"worker-load-error":Te=g("errMsgWorkerLoadError");break;default:Te="unexpected error"}a.error({title:"Error",autoFocus:!0,maskClosable:!1,closable:!1,content:Te})}if(w.length,w.success===w.length?(E.value="success",F.value=g("completed")):(E.value="error",F.value=f.value?g("aborted"):g("incomplete")),J.size!==N.length){const Te=ie(N,J);j.value=()=>{!Te||!Te.length||xe(Te)}}y.value=!1,w.processing=!1,m.value=!0,le=Date.now()-Ue,L("end")}function ie(I,N){const P=[],J=[];let X=0;for(const oe of I)N.has(oe._id)||(P.push(oe),J.push(oe.webkitRelativePath||oe.relativePath||oe.name),X+=oe.size);return J.length&&(w.unconvertedListText=J.join(`
`),w.unconvertedFileCount=P.length,w.unconvertedTotalSize=X),P}let fe=0;function se(I){const N=[];for(const P of I)P.hasOwnProperty("_id")||Object.defineProperty(P,"_id",{value:fe++}),N.push(P);return N}function O(I,N,P){var ye;const J=new Date;return I=I.replace(/^image\//,"").toLowerCase(),`${B.useFolderNameForZip&&((ye=String(P).match(/^\/?([^/]+)\//))==null?void 0:ye[1])||"avif2jpg"}-
    ${J.getFullYear().toString().substring(2)}
    ${String((J.getMonth()+1)*100+J.getDate()).padStart(4,"0")}
    ${String(J.getHours()*1e4+J.getMinutes()*100+J.getSeconds()).padStart(6,"0")}
    -
    ${I+(/jpe?g|webp/i.test(I)?N:"")}
  `.replace(/\s/g,"")}async function b(){const I="data:image/avif;base64,AAAAHGZ0eXBtaWYxAAAAAG1pZjFhdmlmbWlhZgAAAPJtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAABEAAAQABAAAAAAEWAAEAAAAgAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUltYWdlAAAAAHFpcHJwAAAAUmlwY28AAAAUaXNwZQAAAAAAAAAIAAAACAAAABBwYXNwAAAAAQAAAAEAAAAWYXYxQ4EgAAAKCDgIv2kBDQAgAAAAEHBpeGkAAAAAAwgICAAAABdpcG1hAAAAAAAAAAEAAQQBAoOEAAAAKG1kYXQKCDgIv2kBDQAgMhQWQAAASAAADAZuZXHwA9LzjNWygA==",N=document.createElement("img"),P=mn(N).then(()=>!0,()=>!1);N.src=I,await P||a.warning({title:"Unsupported",positiveText:"OK",maskClosable:!1,content:g("avifUnsupported")})}function R(){(!x||p<2||!Promise.any)&&(v=!0),L("multi-thread-count",v?0:p)}return(I,N)=>{const P=Ie,J=Ae,X=Ce,oe=Xo,ye=ea,be=He,Ue=qe,$e=bt;return M(),ae(ze,null,[n(X,{justify:"center",align:"center"},{default:t(()=>{var xe;return[!e(y)&&((xe=z.input)!=null&&xe.length)?(M(),q(J,{key:0,trigger:"hover",placement:"top","keep-alive-on-hover":!1,duration:0,delay:50},{trigger:t(()=>[n(P,{onClick:D,round:""},{default:t(()=>[$(r(e(g)("convertAgain")),1)]),_:1})]),default:t(()=>{var Le;return[h("div",{innerHTML:e(g)("reconvertTip",(Le=z.input)==null?void 0:Le.length)},null,8,Rl)]}),_:1})):de("",!0)]}),_:1}),n(ye,{show:e(S)||c.value,placement:"right","z-index":0,"mask-closable":"","on-mask-click":xe=>c.value=!1},{default:t(()=>[n(oe,{title:"Note"},{default:t(()=>[h("p",null,r(I.$t("annotationOutOfMemory")),1),Zl]),_:1})]),_:1},8,["show","on-mask-click"]),n($e,{ref:"processingModal",show:e(S),"onUpdate:show":N[2]||(N[2]=xe=>Ee(S)?S.value=xe:null),closable:e(m),"close-on-esc":!1,preset:"dialog","display-directive":"show",onClick:N[3]||(N[3]=xe=>{e(d).destroyAll(),e(s).destroyAll()}),onMaskClick:N[4]||(N[4]=xe=>{e(d).destroyAll(),e(s).destroyAll()}),onClose:ce,onEsc:H,title:e(F),type:e(E),"mask-closable":!1,"on-after-leave":Y,class:"processing-dialog"},{default:t(()=>[n(Ue,{vertical:"",style:{"flex-grow":"1"}},{default:t(()=>[h("div",Bl,[e(A)?(M(),q(jl,{key:e(C),processing:e(y),status:e(w),interval:k,onAllZipsClicked:N[0]||(N[0]=xe=>Ee(V)?V.value=!0:V=!0),onDemandZipErrors:e(j),onDemandImage:U},null,8,["processing","status","onDemandZipErrors"])):de("",!0)]),n(Ue,{justify:"end"},{default:t(()=>[e(y)?(M(),q(P,{key:0,disabled:e(f),ref:"cancelbutton",round:"",size:"large",onClick:N[1]||(N[1]=xe=>f.value=!0)},{default:t(()=>[n(be,{show:e(f)&&!e(m),size:"small"},{default:t(()=>[$(r(e(g)("cancel")),1)]),_:1},8,["show"])]),_:1},8,["disabled"])):e(m)?(M(),q(P,{key:1,onClick:ce,round:"",size:"large",style:{"font-size":"small","margin-top":"1em"}},{default:t(()=>[$(r(e(g)("close")),1)]),_:1})):de("",!0)]),_:1})]),_:1})]),_:1},8,["show","closable","title","type"])],64)}}}),Wl="/avif2jpeg/test/avif.png",hn=o=>(kt("data-v-892702c9"),o=o(),At(),o),Vl={class:"container-1"},ql=hn(()=>h("span",null,"Drag & Drop",-1)),Gl={style:{position:"relative"}},Kl={style:{position:"absolute","font-size":"0.5em",right:"-3.5em",bottom:"-1.5em","white-space":"nowrap"}},Ql={style:{color:"#666666"}},Yl=hn(()=>h("img",{src:Wl,class:"avif"},null,-1)),Jl=["innerHTML"],Xl={style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","font-size":"xx-small","white-space":"nowrap"}},es=_e({__name:"droptarget",props:{forbidden:{type:Boolean},dropTarget:{}},emits:["drop"],setup(o,{emit:i}){Ve(De);const g=o,a=i,s=ta(),d=_(!1),l=_(0),p=_("");Me(()=>{x(g.dropTarget||document)});function x(z){document.ondragstart=c=>c.preventDefault(),document.ondragover=c=>c.preventDefault(),z.ondrop=async c=>{var y;if(c.preventDefault(),d.value||g.forbidden)return;d.value=!0,l.value=0,p.value="";let L;try{const f=[...c.dataTransfer.items].map(m=>m.webkitGetAsEntry());s.start(),L=await k(f),s.finish()}catch{L=[...((y=c.dataTransfer)==null?void 0:y.files)??[]],s.error()}d.value&&(d.value=!1,a("drop",L))}}async function k(z,c){c=c||[];for(const L of z)if(L.isFile){const y=await new Promise(f=>L.file(m=>f(m)));Object.defineProperty(y,"webkitRelativePath",{value:L.fullPath}),c.push(y),l.value++}else if(L.isDirectory){p.value=L.fullPath;const y=L.createReader();do{const f=await new Promise(m=>y.readEntries(C=>m(C)));if(!f.length)break;await k(f,c)}while(!0)}return c}return(z,c)=>{const L=ve,y=Ce,f=ot,m=Ae,C=bt;return M(),ae(ze,null,[h("div",Vl,[n(m,{to:!1,"display-directive":"show",trigger:"hover",duration:0,delay:0,placement:"left"},{trigger:t(()=>[n(y,{vertical:"",class:"container-2"},{default:t(()=>[n(y,{align:"center",wrap:!1,class:"container-3"},{default:t(()=>[n(y,{align:"center"},{default:t(()=>[n(L,{size:"64",color:"white"},{default:t(()=>[n(e(na))]),_:1})]),_:1}),n(y,{vertical:"",align:"center",wrap:!1,style:{"font-weight":"bold","font-size":"1em","line-height":"90%","white-space":"nowrap"}},{default:t(()=>[ql,h("span",Gl,[$(" AVIF Images "),h("span",Kl,[$(" or "),n(f,{placement:"bottom-end"},{trigger:t(()=>[h("span",Ql,[n(L,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e($t))]),_:1}),$(" Folders ")])]),default:t(()=>[$(" You can drag and drop your local folders ")]),_:1})])])]),_:1}),n(y,null,{default:t(()=>[Yl]),_:1})]),_:1})]),_:1})]),default:t(()=>[h("h3",{innerHTML:z.$t("droptarget"),style:{"max-width":"200px","text-align":"center","word-break":"keep-all","overflow-wrap":"break-word"}},null,8,Jl)]),_:1})]),n(C,{show:e(d),"onUpdate:show":c[0]||(c[0]=S=>Ee(d)?d.value=S:null),closable:!0,preset:"dialog",title:"Parsing dropped items.",type:"info","mask-closable":!1,"negative-text":z.$t("cancel")},{default:t(()=>[n(y,{vertical:"",align:"center"},{default:t(()=>[h("div",Xl,r(e(p)),1),h("div",null,"found "+r(e(l))+" files",1)]),_:1})]),_:1},8,["show","negative-text"])],64)}}}),ts=Pe(es,[["__scopeId","data-v-892702c9"]]),_n=o=>(kt("data-v-cf5243e3"),o=o(),At(),o),ns={class:"container-1"},os={class:"container-2"},as=["innerHTML"],ls=["innerHTML"],ss={style:{"padding-left":"1em"}},is=_n(()=>h("br",null,null,-1)),rs=_n(()=>h("ul",null,[h("li",null,"Each extension must begin with a period. "),h("li",null,"Separate each extension with a comma. "),h("li",null,"Use alphameric characters.")],-1)),us=["innerHTML"],ds=["accept"],cs=_e({__name:"file-selector",props:et({expanded:{type:Boolean},target:{},userExtensions:{},forbidden:{type:Boolean}},{disableNotifyingFolderSelect:{type:Boolean},disableNotifyingFolderSelectModifiers:{}}),emits:et(["input","click","cancel","on-change-accept","update:target","update:userExtensions","update:expanded"],["update:disableNotifyingFolderSelect"]),setup(o,{emit:i}){const g=ut(),{t:a}=Oe(),s=Ve(De),d=["avif_only","all_images","all_files","edit_type"],l=o,p=i,x=_(0),k=_(!1),z=_(!1),c=he(()=>V(m.value)),L=he(()=>C.value.split(",").every(D=>/^\s*(\.[\w\-]+)*\s*$/.test(D))?"success":"error"),y=he(()=>!l.forbidden&&!z.value),f=he({get:()=>l.expanded,set:H=>{p("update:expanded",H)}}),m=he({get:()=>d.indexOf(l.target)>=0?l.target:d[0],set:H=>{p("update:target",H)}}),C=he({get:()=>l.userExtensions,set:H=>{p("update:userExtensions",H)}}),S=Se(o,"disableNotifyingFolderSelect"),A=_(null),F=_(null),E=_(le());we(m,H=>{p("on-change-accept",c.value)}),Me(()=>{});async function w(H){if(p("click"),H===F.value&&!S.value){let D=!1;if(await new Promise(j=>{g.info({title:a("loadfolderNotifyingTitle"),positiveText:a("Continue"),negativeText:a("Cancel"),onAfterLeave:()=>j(D),onPositiveClick:()=>D=!0,content:()=>Q("div",[Q("p",{},a("loadfolderNotifyingMessageTerm1")),Q("div",[Q(Jt,{width:250,style:{border:"3px solid gray"},src:"/avif2jpeg/test//notification-folder.png"})]),Q("p",{},a("loadfolderNotifyingMessageTerm2")),Q("p",[Q(an,{onUpdateChecked:K=>S.value=K,checked:S.value},()=>a("checkboxTextDontShowThis"))])])})}),!D){S.value=!1,p("cancel");return}}H.click()}function v(){p("cancel")}function T(H){const j=[...H.target.files];A.value.value="",F.value.value="",U(j)}function le(){return"webkitdirectory"in document.createElement("input")}function V(H){switch(H){case"avif_only":return".avif, .webp";case"all_images":return".jpg, .jpeg, .jfif, .pjpeg, .pjp, .gif, .png, .webp, .avif, .bmp, .apng, .ico";case"edit_type":return C.value;case"all_files":default:return".*"}}async function ce(H){const D=String(c.value).toLowerCase().replace(/\s+/g,"");if(D&&c.value!==".*"){const j=D.split(",");H=H.filter(K=>j.includes(K.name.replace(/^.+(\.[^.]+)$/,"$1").toLowerCase())),H.length||await new Promise(K=>{g.error({title:"Images Not Found",positiveText:"OK",onAfterLeave:K,content:()=>Q("div",[Q(ln,{description:"NO IMAGES"}),`${a("noimage")}`,Q("br"),c.value])})})}return H}async function U(H){z.value=!0,H=await ce(H),x.value=H.length,H.length>0&&p("input",H),z.value=!1}return(H,D)=>{const j=ve,K=zt,Y=Ie,ne=Ae,ie=Ce,fe=ra,se=oa,O=aa,b=ot,R=la,I=It,N=St;return M(),ae(ze,null,[h("div",ns,[h("div",os,[n(ie,{vertical:"",align:"center",justify:"center",inline:""},{default:t(()=>[n(ie,{align:"center",justify:"space-around"},{default:t(()=>[n(K,{value:e(x),max:999,offset:[-8,0],color:"#999999",style:{"margin-right":"1em"}},{default:t(()=>[n(j,{size:"4em",color:"#CCCCCC"},{default:t(()=>[n(e(sa))]),_:1})]),_:1},8,["value"]),n(ie,{vertical:"",align:"stretch",justify:"center"},{default:t(()=>[n(ne,{to:!1,"display-directive":"show",show:e(s).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(s).LANDSCAPE.value?"right":"top",duration:0,delay:0,"z-index":10},{trigger:t(()=>[n(Y,{disabled:!e(y),onClick:D[0]||(D[0]=P=>w(e(A))),round:"",style:{width:"100%","background-color":"white"}},{icon:t(()=>[n(j,{size:"large",color:"gray"},{default:t(()=>[n(e(rn))]),_:1})]),default:t(()=>[$(" "+r(H.$t("loadbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[h("div",{innerHTML:H.$t("loadbuttontooltip")},null,8,as)]),_:1},8,["show","placement"]),!e(s).IS_SP&&e(E)||e(s).SSR?(M(),q(ne,{key:0,to:!1,"display-directive":"show",trigger:"hover",placement:"left","keep-alive-on-hover":!1,style:{"max-width":"40vw"},duration:0,delay:0,"z-index":10,show:e(s).showTooltipsBeforeMounted.value},{trigger:t(()=>[n(Y,{disabled:!e(y),onClick:D[1]||(D[1]=P=>w(e(F))),round:"",style:{width:"100%","background-color":"white"}},{icon:t(()=>[n(j,{size:"large",color:"gray"},{default:t(()=>[n(e($t))]),_:1})]),default:t(()=>[$(" "+r(H.$t("loadfolderbutton")),1)]),_:1},8,["disabled"])]),default:t(()=>[h("div",{innerHTML:H.$t("loadfoldertooltip")},null,8,ls)]),_:1},8,["show"])):de("",!0)]),_:1})]),_:1}),h("div",{class:Xe({"expand-ext-list-container":e(f)})},[n(N,{"display-directive":"show","expanded-names":e(f)?["extItem"]:"","on-update:expanded-names":P=>{f.value=!!(""+P)},class:Xe({"expand-ext-list":e(f)})},{"header-extra":t(()=>[n(j,{size:"large"},{default:t(()=>[n(e(ia))]),_:1})]),default:t(()=>[n(I,{title:H.$t("fileTypeRadioTitle"),name:"extItem"},{default:t(()=>[n(R,{value:e(m),"onUpdate:value":D[5]||(D[5]=P=>Ee(m)?m.value=P:null),name:"filetyperadios",size:"small"},{default:t(()=>[n(ie,{vertical:"",style:{"padding-left":"1em"}},{default:t(()=>[(M(),ae(ze,null,Be(d,P=>n(ne,{key:P,trigger:"hover","keep-alive-on-hover":!1,"z-index":5,placement:"left",style:{"max-width":"200px"},duration:0,delay:0},{trigger:t(()=>[n(fe,{value:P},{default:t(()=>[$(r(H.$t("fileTypeRadioOptions."+P)),1)]),_:2},1032,["value"])]),default:t(()=>[$(" "+r(V(P).replace(/,/g,", ")),1)]),_:2},1024)),64)),n(ne,{trigger:"hover","keep-alive-on-hover":!1,placement:"bottom-start",show:e(k),duration:0,delay:0},{trigger:t(()=>[h("div",ss,[n(b,{trigger:"manual",placement:"right-end",show:e(m)==="edit_type"&&e(L)!=="success"&&!!e(k)},{trigger:t(()=>[n(se,{value:e(C),"onUpdate:value":D[2]||(D[2]=P=>Ee(C)?C.value=P:null),status:e(L),disabled:e(m)!=="edit_type",onFocus:D[3]||(D[3]=P=>k.value=!0),onBlur:D[4]||(D[4]=P=>k.value=void 0),clearable:!0,size:"small",placeholder:".jpg, .gif, .png",spellcheck:"false"},null,8,["value","status","disabled"])]),default:t(()=>[n(O,{type:"error","show-icon":!0,title:"Validation error"},{default:t(()=>[$(" Please correct the extension list."),is,rs]),_:1})]),_:1},8,["show"])])]),default:t(()=>[h("span",{innerHTML:H.$t("editAcceptTypes")},null,8,us)]),_:1},8,["show"])]),_:1})]),_:1},8,["value"])]),_:1},8,["title"])]),_:1},8,["expanded-names","on-update:expanded-names","class"])],2),e(s).IS_SP?de("",!0):(M(),q(ts,{key:0,onDrop:U,forbidden:!e(y)},null,8,["forbidden"]))]),_:1})])]),h("input",{ref_key:"fileinput",ref:A,onInput:T,onCancel:v,type:"file",multiple:"",accept:e(c),style:{display:"none"}},null,40,ds),h("input",{ref_key:"folderinput",ref:F,webkitdirectory:"",directory:"",onInput:T,onCancel:v,type:"file",style:{display:"none"}},null,544)],64)}}}),ps=Pe(cs,[["__scopeId","data-v-cf5243e3"]]),fs={style:{"white-space":"nowrap"}},gs=_e({__name:"settings-output",props:{quality:{},format:{}},emits:["update:format","update:quality"],setup(o,{emit:i}){const g=o,a=i,{t:s}=Oe(),d=Ve(De),l=_([]),p=["image/jpeg","image/png","image/gif","image/bmp","image/avif","image/webp"],x=he({get:()=>g.format,set:f=>{f=L(f),a("update:format",f)}}),k=he({get:()=>g.quality,set:f=>{a("update:quality",f)}}),z=he(()=>/png|bmp/i.test(x.value)),c=_(null);Me(()=>{y()});function L(f){return l.value.indexOf(f)<0&&(f=l.value[0]),f}function y(){for(const f of p)c.value.toDataURL(f).indexOf(f)>=0&&l.value.push(f);l.value.length===0&&l.value.push(p[0])}return(f,m)=>{const C=ve,S=un,A=Ce,F=Ae,E=Tt,w=dn;return M(),ae(ze,null,[n(A,{justify:"center"},{default:t(()=>[n(A,{vertical:""},{default:t(()=>[n(F,{to:!1,"display-directive":"show",show:e(d).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(d).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(A,{align:"center"},{default:t(()=>[n(C,null,{default:t(()=>[n(e(rn))]),_:1}),$(r(e(s)("settings.imageType"))+": ",1),n(S,{value:x.value,"onUpdate:value":m[0]||(m[0]=v=>x.value=v),options:l.value.map(v=>({value:v,label:v})),"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),_:1})]),default:t(()=>[$(" "+r(e(s)("settings.imageTypeTooltip")),1)]),_:1},8,["show","placement"]),n(F,{to:!1,"display-directive":"show",show:e(d).showTooltipsBeforeMounted.value,trigger:"hover",placement:e(d).LANDSCAPE.value?"left":"top-start","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(A,{align:"center"},{default:t(()=>[n(A,{align:"start",wrap:!1},{default:t(()=>[n(C,null,{default:t(()=>[n(e(sn))]),_:1}),h("span",fs,r(e(s)("settings.quality"))+":",1),n(A,{align:"center",justify:"space-between"},{default:t(()=>[n(E,{tooltip:!1,value:k.value,"onUpdate:value":m[1]||(m[1]=v=>k.value=v),step:1,style:{width:"120px"},disabled:z.value},null,8,["value","disabled"]),n(w,{value:k.value,"onUpdate:value":m[2]||(m[2]=v=>k.value=v),step:"1",min:"0",max:"100",disabled:z.value,style:{width:"90px"},size:"small"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),default:t(()=>[$(" "+r(e(s)("settings.qualitytooltip")),1)]),_:1},8,["show","placement"])]),_:1})]),_:1}),h("canvas",{ref_key:"canvas",ref:c,width:"1",height:"1",style:{display:"none"}},null,512)],64)}}}),ms={style:{width:"4em","text-align":"left"}},vs={style:{width:"4em","text-align":"left"}},Rt=100,Zt=2e3,Bt=4096,Ht=4096,hs=100,_s=100,ys=_e({__name:"settings-adv",props:et({threadMax:{}},{expanded:{type:Boolean,required:!0},expandedModifiers:{},multithread:{type:Boolean,required:!0},multithreadModifiers:{},threadCount:{required:!0},threadCountModifiers:{},maxZipSize:{required:!0},maxZipSizeModifiers:{},retainExt:{type:Boolean,required:!0},retainExtModifiers:{},useFolderNameForZip:{type:Boolean,required:!0},useFolderNameForZipModifiers:{},shrinkImage:{type:Boolean,required:!0},shrinkImageModifiers:{},maxWidth:{required:!0},maxWidthModifiers:{},maxHeight:{required:!0},maxHeightModifiers:{}}),emits:["update:expanded","update:multithread","update:threadCount","update:maxZipSize","update:retainExt","update:useFolderNameForZip","update:shrinkImage","update:maxWidth","update:maxHeight"],setup(o){const i={trigger:"hover",placement:"left",keepAliveOnHover:!1,duration:0,delay:0,style:"max-width: 20vw;"},g=Se(o,"expanded"),a=Se(o,"multithread"),s=Se(o,"threadCount"),d=Se(o,"maxZipSize"),l=Se(o,"retainExt"),p=Se(o,"useFolderNameForZip"),x=Se(o,"shrinkImage"),k=Se(o,"maxWidth"),z=Se(o,"maxHeight"),c=o;we([s,()=>c.threadMax],()=>{c.threadMax>1&&typeof s.value>"u"&&(s.value=c.threadMax)}),we(()=>c.threadMax,()=>{c.threadMax>1||(a.value=!1)},{immediate:!0});const L=he(()=>a.value&&c.threadMax>1);return(y,f)=>{const m=ve,C=Ie,S=ua,A=qe,F=Tt,E=dn,w=It,v=St;return M(),q(A,{justify:"center"},{default:t(()=>[n(v,{"display-directive":"show","default-expanded-names":g.value?["collapitem"]:"","on-update:expanded-names":T=>g.value=!!String(T),"trigger-areas":["arrow","main"],class:Xe(["settings-body",g.value?"expand-adv-settings":""])},on({arrow:t(()=>[n(m,{style:re(g.value&&{top:"8px"})},{default:t(()=>[n(e(da))]),_:1},8,["style"]),n(m,null,{default:t(()=>[n(e(ca))]),_:1})]),default:t(()=>[n(w,{title:y.$t("settings.advancedSettings"),name:"collapitem"},{default:t(()=>[n(A,{vertical:"",style:{"padding-left":"2em"}},{default:t(()=>[n(e(Ae),Qe(Ye(i)),{trigger:t(()=>[n(A,{vertical:""},{default:t(()=>[n(A,{wrap:!1,align:"center"},{default:t(()=>[n(C,{text:"",disabled:!y.threadMax,style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[0]||(f[0]=T=>a.value=!a.value)},{icon:t(()=>[n(m,null,{default:t(()=>[n(e(pa))]),_:1})]),default:t(()=>[$(" "+r(y.$t("settings.enableMultiThreads")),1)]),_:1},8,["disabled"]),n(S,{value:a.value,"onUpdate:value":f[1]||(f[1]=T=>a.value=T),disabled:!y.threadMax,size:"small"},null,8,["value","disabled"])]),_:1}),n(A,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(F,{value:s.value,"onUpdate:value":f[2]||(f[2]=T=>s.value=T),disabled:!y.threadMax||!a.value,step:1,min:2,max:y.threadMax,style:{width:"120px"}},null,8,["value","disabled","max"]),n(E,{size:"tiny",value:s.value,"onUpdate:value":f[3]||(f[3]=T=>s.value=T),disabled:!y.threadMax||!a.value,step:1,min:2,max:y.threadMax,style:{width:"10em"}},{suffix:t(()=>[$(r(y.$t("threads",s.value)),1)]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[$(" "+r(y.$t("settings.multiThreadsTooltip")),1)]),_:1},16),n(e(Ae),Qe(Ye(i)),{trigger:t(()=>[n(A,{vertical:""},{default:t(()=>[n(A,{wrap:!1,align:"center"},{default:t(()=>[n(C,{text:"",focusable:!1,style:{"white-space":"nowrap","font-size":"smaller"}},{icon:t(()=>[n(m,{style:{"vertical-align":"middle"}},{default:t(()=>[n(e(fa))]),_:1})]),default:t(()=>[$(" "+r(y.$t("settings.maxZipFileSize"))+": ",1)]),_:1})]),_:1}),n(A,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(F,{tooltip:!1,value:d.value,"onUpdate:value":f[4]||(f[4]=T=>d.value=T),step:1,min:Rt,max:Zt,style:{width:"120px"}},null,8,["value"]),n(E,{size:"tiny",value:d.value,"onUpdate:value":f[5]||(f[5]=T=>d.value=T),step:"1",min:Rt,max:Zt,style:{width:"10em"}},{suffix:t(()=>[$("(MB)")]),_:1},8,["value"])]),_:1})]),_:1})]),default:t(()=>[$(" "+r(y.$t("settings.maxZipFileSizeTooltip")),1)]),_:1},16),n(e(Ae),Qe(Ye(i)),{trigger:t(()=>[n(A,{wrap:!1,align:"center"},{default:t(()=>[n(C,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[6]||(f[6]=T=>p.value=!p.value)},{icon:t(()=>[n(m,null,{default:t(()=>[n(e($t))]),_:1})]),default:t(()=>[$(" "+r(y.$t("settings.useFolderNameForZip")),1)]),_:1}),n(S,{value:p.value,"onUpdate:value":f[7]||(f[7]=T=>p.value=T),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[$(" "+r(y.$t("settings.useFolderNameForZipTooltip")),1)]),_:1},16),n(e(Ae),Qe(Ye(i)),{trigger:t(()=>[n(A,{wrap:!1,align:"center"},{default:t(()=>[n(C,{text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[8]||(f[8]=T=>l.value=!l.value)},{icon:t(()=>[n(m,null,{default:t(()=>[n(e(nn))]),_:1})]),default:t(()=>[$(" "+r(y.$t("settings.retainOriginalExtension")),1)]),_:1}),n(S,{value:l.value,"onUpdate:value":f[9]||(f[9]=T=>l.value=T),size:"small"},null,8,["value"])]),_:1})]),default:t(()=>[$(" "+r(y.$t("settings.retainExtTooltip")),1)]),_:1},16),n(e(Ae),Qe(Ye(i)),{trigger:t(()=>[n(A,{vertical:""},{default:t(()=>[n(A,{wrap:!1,align:"center"},{default:t(()=>[n(C,{disabled:!e(L),text:"",style:{"font-size":"smaller"},bordered:!1,focusable:!1,onClick:f[10]||(f[10]=T=>x.value=!x.value)},{icon:t(()=>[n(m,null,{default:t(()=>[n(e(ga))]),_:1})]),default:t(()=>[$(" "+r(y.$t("settings.shrinkImage")),1)]),_:1},8,["disabled"]),n(S,{disabled:!e(L),value:x.value,"onUpdate:value":f[11]||(f[11]=T=>x.value=T),size:"small"},null,8,["disabled","value"])]),_:1}),n(A,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(F,{value:k.value,"onUpdate:value":f[12]||(f[12]=T=>k.value=T),disabled:!x.value||!e(L),step:1,min:hs,max:Bt,style:{width:"120px"}},null,8,["value","disabled"]),n(E,{size:"tiny",value:k.value,"onUpdate:value":f[13]||(f[13]=T=>k.value=T),disabled:!x.value||!e(L),step:1,min:8,max:Bt*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[h("span",ms,r(y.$t("width")),1)]),suffix:t(()=>[$("px")]),_:1},8,["value","disabled","max"])]),_:1}),n(A,{wrap:!1,align:"center",style:{"padding-left":"2em"}},{default:t(()=>[n(F,{value:z.value,"onUpdate:value":f[14]||(f[14]=T=>z.value=T),disabled:!x.value||!e(L),step:1,min:_s,max:Ht,style:{width:"120px"}},null,8,["value","disabled"]),n(E,{size:"tiny",value:z.value,"onUpdate:value":f[15]||(f[15]=T=>z.value=T),disabled:!x.value||!e(L),step:1,min:8,max:Ht*4,style:{"max-width":"15em","text-align":"right"}},{prefix:t(()=>[h("span",vs,r(y.$t("height")),1)]),suffix:t(()=>[$("px")]),_:1},8,["value","disabled","max"])]),_:1})]),_:1})]),default:t(()=>[$(" "+r(y.$t("settings.shrinkImageTooltip")),1)]),_:1},16)]),_:1})]),_:1},8,["title"])]),_:2},[g.value?{name:"header-extra",fn:t(()=>[n(e(Ae),{"keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(C,{onClick:e($a),size:"tiny",style:{"font-size":"xx-small"}},{default:t(()=>[$(r(y.$t("reset")),1)]),_:1},8,["onClick"])]),default:t(()=>[$(" "+r(y.$t("settings.resetButtonTooltip")),1)]),_:1})]),key:"0"}:void 0]),1032,["default-expanded-names","on-update:expanded-names","class"])]),_:1})}}}),ws=Pe(ys,[["__scopeId","data-v-0da126eb"]]),bs={},xs={style:{color:"gray","padding-left":"20px"}},ks=["innerHTML"];function As(o,i){const g=xt,a=Ce;return M(),q(a,{vertical:"",justify:"end"},{default:t(()=>[n(g,{style:{margin:"0px"}}),n(a,{justify:"center"},{default:t(()=>[h("ul",xs,[(M(!0),ae(ze,null,Be(o.$tm("descriptions"),s=>(M(),ae("li",{key:s,style:{"text-align":"left"},innerHTML:s},null,8,ks))),128))])]),_:1})]),_:1})}const zs=Pe(bs,[["render",As]]),Ts="modulepreload",Is=function(o){return"/avif2jpeg/test/"+o},Wt={},ge=function(i,g,a){let s=Promise.resolve();if(g&&g.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),p=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(g.map(x=>{if(x=Is(x),x in Wt)return;Wt[x]=!0;const k=x.endsWith(".css"),z=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${z}`))return;const c=document.createElement("link");if(c.rel=k?"stylesheet":Ts,k||(c.as="script"),c.crossOrigin="",c.href=x,p&&c.setAttribute("nonce",p),document.head.appendChild(c),k)return new Promise((L,y)=>{c.addEventListener("load",L),c.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${x}`)))})}))}function d(l){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=l,window.dispatchEvent(p),!p.defaultPrevented)throw l}return s.then(l=>{for(const p of l||[])p.status==="rejected"&&d(p.reason);return i().catch(d)})},yn="English",wn="🇬🇧",bn='AVIF to JPEG "Offline" Batch Converter',xn="It is a free web application to convert AVIF or WebP images to other common image formats such as JPEG or PNG without server communication.",kn="Drag & Drop AVIF Images to Convert",An=["This is a free web application to batch convert AVIF(or WebP, etc) images to common image formats such as JPEG, PNG.","It uses a browser's built-in function for the conversions, so <strong>no data is sent to any server</strong>.","The converted images will be output as <strong>a zip file</strong> when multiple images are loaded.",'Requires <a href="https://caniuse.com/avif" target="_self" style="color:red">latest</a> version of Firefox or Chrome to load AVIF images.'],zn="Select your language",Tn="Choose Target File Extentions",In={avif_only:'Only ".avif" or ".webp"',all_images:"All Image Types",all_files:"All Types",edit_type:"Edit File Extension List"},Sn="Input a list of comma separated file extentions to load.<br>e.g.) .jpg,.gif,.png",$n="Load Images",Cn="Select your images from a dialog window.<br>*Multiple selection allowed.",Ln="Load a Whole Folder",En=`Convert all images in the selected folder and its subfolders, and add the converted images to a ZIP archive with relative path.<br>*It will show "Upload" button, but it actually doesn't upload anything to any server.`,Mn="Converting images",Fn="Aborted",On="Some files failed to convert",Pn="Completed",Un="Currently Busy",Nn="No files with the extentions were found.",Dn="Your browser does not support AVIF format. Please use latest version of Firefox or Chrome to convert AVIF images.",jn="Cancel",Rn="Save",Zn="Close",Bn="Open",Hn="Re-convert",Wn="Convert previous selected {n} @:files again",Vn="File | Files",qn="thread | threads",Gn="You have not saved the converted images yet.",Kn="Data have not been saved",Qn="Open Source",Yn="Open the converted image",Jn="Copied to clipboard",Xn="The converted image was copied to your clipboard as DataURL.",eo="Copy the converted image as DataURL",to="Convert Again",no={expandLogTooltip:"Displaying the entire log may severely reduce conversion speed.",expandLog:"Show entire log",autoScroll:"Auto scroll",showOnlyErrors:"Show only errors",log:"Log",outInRate:"Out / In Ratio",elapsedTime:"Elapsed Time",multiThreading:"Multi-Threading",outputSettings:"Output Settings",totalSize:"Total Size",totalFiles:"Number of Files",confirmDownloadMessage:"It will start to download {0} zip files.",inputSize:"Input Size",outputSize:"Output Size",filterSuccess:"Hide completed item",progressErrors:"Failed items",progressStarted:"Started Items",progressTotal:"Total number of files",zippingProgress:"Zipping progress",zipped:"ZIPPED",openFailedList:"Open failed file list",zipFailedList:"Pack failed files into Zips",table:{index:"index",status:"status",core:"thread",details:"file"},saveFailedList:"Save failed file list",done:"done",convertedZips:"successfully completed ZIP",progressSuccess:"Completed Files",downloadConvertedImage:"Download Converted Image",failureZippingFailedFiles:"Failure while zipping the failed files.",browseConvertedImages:"Browse converted images",index:"Index",Original:"Original",Converted:"Converted",saveAllZipsTooltip:"Save all ZIP files"},oo={maxZipFileSize:"Max zip file size",retainExtTooltip:"New extension will be appended to original extension",retainOriginalExtension:"Keep Original File Extension",qualitytooltip:"Set image quality for output",quality:"Image Quality",maxZipFileSizeTooltip:"Set smaller value if memory problems occur.",ignoreExtTooltip:'Try to load files that don"t have image file extension',ignoreFileExtensions:"Load All File Types",imageTypeTooltip:"Choose image format for output",imageType:"Image Type",advancedSettings:"Advanced Settings",enableMultiThreads:"Enable multi-threading",resetButtonTooltip:"Restore all settings to default.",multiThreadsTooltip:"Convert images in multi-threaded",shrinkImageTooltip:"If the image dimensions are larger than the specified value, shrink the image to that value",shrinkImage:"Shrink images that exceed the following dimensions",useFolderNameForZip:"Use dropped folder name for the zip file",useFolderNameForZipTooltip:"If a folder is dropped or selected, its name is used as the name of the output ZIP file"},ao="Disabled",lo="Download",so="Reset",io="Back",ro="Failed",uo="Success",co="Previous version",po=`
Height`,fo="Width",go="Don't show this message again",mo="About the warning when selecting a folder",vo="OK",ho={},_o="You must press the “Upload” button here to load all the images in the folder, but the data loaded by this application is never actually uploaded to the server.",yo="Continue",wo="Cancel",bo="When you select a folder instead of a file as input on a website, major web browsers will display a warning like the image below.",xo="If “Out of Memory” is displayed during conversion and the process is interrupted, reduce or disable the number of multi-threads in the “Advanced Settings”.",ko="This page may be an outdated version. Please reload the page.",Ao={lang:yn,flags:wn,title:bn,metaDescription:xn,droptarget:kn,descriptions:An,selectLanguage:zn,fileTypeRadioTitle:Tn,fileTypeRadioOptions:In,editAcceptTypes:Sn,loadbutton:$n,loadbuttontooltip:Cn,loadfolderbutton:Ln,loadfoldertooltip:En,processing:Mn,aborted:Fn,incomplete:On,completed:Pn,interfered:Un,noimage:Nn,avifUnsupported:Dn,cancel:jn,save:Rn,close:Zn,open:Bn,reconvert:Hn,reconvertTip:Wn,files:Vn,threads:qn,confirmCloseDialog:Gn,confirmCloseDialogTitle:Kn,githubOpenSource:Qn,convertedImageUrlTooltip:Yn,copiedDataURLDialogTitle:Jn,copiedDataURLMessage:Xn,convertedImageDataUrlTooltip:eo,convertAgain:to,status:no,settings:oo,disabled:ao,Download:lo,reset:so,back:io,failed:ro,success:uo,previousVersion:co,height:po,width:fo,checkboxTextDontShowThis:go,loadfolderNotifyingTitle:mo,OK:vo,loadfolderNotifyingMessage:ho,loadfolderNotifyingMessageTerm2:_o,Continue:yo,Cancel:wo,loadfolderNotifyingMessageTerm1:bo,annotationOutOfMemory:xo,errMsgWorkerLoadError:ko},Ss=Object.freeze(Object.defineProperty({__proto__:null,Cancel:wo,Continue:yo,Download:lo,OK:vo,aborted:Fn,annotationOutOfMemory:xo,avifUnsupported:Dn,back:io,cancel:jn,checkboxTextDontShowThis:go,close:Zn,completed:Pn,confirmCloseDialog:Gn,confirmCloseDialogTitle:Kn,convertAgain:to,convertedImageDataUrlTooltip:eo,convertedImageUrlTooltip:Yn,copiedDataURLDialogTitle:Jn,copiedDataURLMessage:Xn,default:Ao,descriptions:An,disabled:ao,droptarget:kn,editAcceptTypes:Sn,errMsgWorkerLoadError:ko,failed:ro,fileTypeRadioOptions:In,fileTypeRadioTitle:Tn,files:Vn,flags:wn,githubOpenSource:Qn,height:po,incomplete:On,interfered:Un,lang:yn,loadbutton:$n,loadbuttontooltip:Cn,loadfolderNotifyingMessage:ho,loadfolderNotifyingMessageTerm1:bo,loadfolderNotifyingMessageTerm2:_o,loadfolderNotifyingTitle:mo,loadfolderbutton:Ln,loadfoldertooltip:En,metaDescription:xn,noimage:Nn,open:Bn,previousVersion:co,processing:Mn,reconvert:Hn,reconvertTip:Wn,reset:so,save:Rn,selectLanguage:zn,settings:oo,status:no,success:uo,threads:qn,title:bn,width:fo},Symbol.toStringTag,{value:"Module"})),$s="Chinese",Cs="Ukrainian",Ls="Turkish",Es="Russian",Ms="Portuguese",Fs="Polish",Os="Dutch",Ps="Korean",Us="Japanese",Ns="Italian",Ds="Indonesian",js="Hindi",Rs="French",Zs="Spanish",Bs="English",Hs="German",Ws="Arabic",Vs={zh:$s,"zh-hant":"Chinese(hant)",uk:Cs,tr:Ls,ru:Es,pt:Ms,pl:Fs,nl:Os,ko:Ps,ja:Us,it:Ns,id:Ds,hi:js,fr:Rs,es:Zs,en:Bs,de:Hs,ar:Ws},st=[],zo={en:Ao},Ct={},Vt=Object.assign({"./locales/ar.json":()=>ge(()=>import("./ar-B5XctmXR.js"),[]),"./locales/de.json":()=>ge(()=>import("./de-C4vA6Tmt.js"),[]),"./locales/en.json":()=>ge(()=>Promise.resolve().then(()=>Ss),void 0),"./locales/es.json":()=>ge(()=>import("./es-C4w79x1_.js"),[]),"./locales/fr.json":()=>ge(()=>import("./fr-DYK3Sydc.js"),[]),"./locales/hi.json":()=>ge(()=>import("./hi-CFXfTxip.js"),[]),"./locales/id.json":()=>ge(()=>import("./id-DrSHgcM4.js"),[]),"./locales/it.json":()=>ge(()=>import("./it-D-RJdX9U.js"),[]),"./locales/ja.json":()=>ge(()=>import("./ja-Bbw8qfhl.js"),[]),"./locales/ko.json":()=>ge(()=>import("./ko-Bdujg0HZ.js"),[]),"./locales/nl.json":()=>ge(()=>import("./nl-GqAtOJSv.js"),[]),"./locales/pl.json":()=>ge(()=>import("./pl-DjdLslrg.js"),[]),"./locales/pt.json":()=>ge(()=>import("./pt-CAm77poX.js"),[]),"./locales/ru.json":()=>ge(()=>import("./ru-Dol19Z0L.js"),[]),"./locales/tr.json":()=>ge(()=>import("./tr-DWGQOH8I.js"),[]),"./locales/uk.json":()=>ge(()=>import("./uk-DI6YuST3.js"),[]),"./locales/zh-hant.json":()=>ge(()=>import("./zh-hant-DcagsDie.js"),[]),"./locales/zh.json":()=>ge(()=>import("./zh-ZrI8GzGD.js"),[])});var qt;for(const o in Vt){const i=(qt=o.match(/\/([a-z]{2}(?:-[a-z]+)?)\.json$/i))==null?void 0:qt[1];i&&(st.push(i),!(i in zo)&&(Ct[i]=Vt[o]))}let wt=Gs();wt in Ct||(wt="en");const it=ma({legacy:!1,globalInjection:!0,locale:wt,fallbackLocale:"en",messages:zo,warnHtmlMessage:!1,missingWarn:!1,fallbackWarn:!1});async function qs(o){if(it.global.availableLocales.indexOf(o)>=0)return;const i=await Ct[o]();it.global.setLocaleMessage(o,i),await Je()}function Gs(){const o=location.pathname;return String(o.match(/[^/]+(?=\/?$)/)||"").toLowerCase()}const Ks=["innerHTML"],Qs=_e({__name:"switch-lang",emits:["lang-ready","lang-change"],async setup(o,{emit:i}){let g,a;const s=Ve(De),d=Kt(),{locale:l,t:p}=Oe(),x=i,k=Object.entries(Vs).map(([m,C])=>({label:C,value:m}));k.sort((m,C)=>{const S=m.label,A=C.label;return S>A?1:S<A?-1:0}),Me(()=>{d.afterEach((m,C,S)=>{c(),s.switchToolTipVisibility()})}),en(async()=>{}),[g,a]=va(()=>c()),await g,a();async function z(m){(m!==l.value||it.global.availableLocales.indexOf(m)===-1)&&(x("lang-change",m),await qs(m),l.value=m,document.title=p("title"),await Je()),x("lang-ready",m)}async function c(){const m=d.currentRoute.value.path||"",C=String(m.match(new RegExp("(?<=^\\/)[^/]+"))||"");C&&st.includes(C)?(await z(C),l.value=C):await L()}async function L(){const m=y().toLowerCase(),C=m.split(/[-_]/)[0];if(st.includes(C)){let S=C;if(C==="zh")switch(m){case"zh-hant":case"zh-mo":case"zh-hk":case"zh-tw":S="zh-hant"}await z(S)}}function y(){const m=window.navigator;return m.language||m.userLanguage||m.browserLanguage}function f(m){console.log(`changeRoute: ${d.currentRoute.value.fullPath} => ${m}`),d.push("/"+m+"/")}return(m,C)=>{const S=ve,A=un,F=Ae;return M(),q(F,{to:!1,"display-directive":"show",show:e(s).showTooltipsBeforeMounted.value,trigger:"hover","keep-alive-on-hover":!1,placement:e(s).LANDSCAPE.value?"left":"bottom",duration:0,delay:50},{trigger:t(()=>[n(A,{ref:"langselect",size:"tiny",style:{width:"100%"},"consistent-menu-width":!1,options:e(k),"_v-model:value":"locale",value:e(l),"onUpdate:value":f},{arrow:t(()=>[n(S,null,{default:t(()=>[n(e(ha))]),_:1})]),_:1},8,["options","value"])]),default:t(()=>[h("div",{innerHTML:m.$t("selectLanguage")},null,8,Ks)]),_:1},8,["show","placement"])}}}),Ys=h("span",null,"CONVERT TO👇",-1),De=Symbol("global variables"),Js=_e({__name:"Avif2Jpeg",emits:["ready"],setup(o,{emit:i}){Oe();const g=i,a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari/.test(navigator.userAgent),s=_(null),d=_(2);let l=_(void 0);const p=_(!0),x=_(!1),k=_(!1),z=_(!1),c=_(!1);_a(De,{showTooltipsBeforeMounted:l,LANDSCAPE:p,IS_SP:a,switchToolTipVisibility:S,SSR:!1}),Me(()=>{A(),window.addEventListener("resize",A),S(),setTimeout(()=>k.value=!0,3e3)});const L=200;let y=0,f=!0;function m(){z.value=!1,y=Date.now()}function C(){const w=f?0:Math.max(0,L-(Date.now()-y));f=!1,setTimeout(()=>z.value=!0,w),g("ready")}async function S(){}function A(){const w=document.body.clientWidth,v=document.body.clientHeight;p.value=w*.75>v||w>900}function F(w){s.value=w}function E(w){c.value=w}return(w,v)=>{const T=Ce,le=ve,V=ot,ce=qe;return M(),q(ce,{vertical:"",align:"stretch",justify:"start",style:{height:"100%",position:"relative"}},{default:t(()=>[n(ja,null,{"lang-switch":t(()=>[(M(),q(ya,null,{default:t(()=>[n(Qs,{onLangChange:m,onLangReady:C})]),_:1}))]),_:1}),n(Re,{name:"fade"},{default:t(()=>[e(z)?(M(),q(ce,{key:0,vertical:"",align:"stretch",justify:"space-between",style:{height:"100%"}},{default:t(()=>[n(Ba),n(T,{justify:"center"},{default:t(()=>[n(ps,{expanded:e(B).expandExtButtons,"onUpdate:expanded":v[0]||(v[0]=U=>e(B).expandExtButtons=U),target:e(B).acceptTypeValue,"onUpdate:target":v[1]||(v[1]=U=>e(B).acceptTypeValue=U),userExtensions:e(B).editedAcceptTypes,"onUpdate:userExtensions":v[2]||(v[2]=U=>e(B).editedAcceptTypes=U),"disable-notifying-folder-select":e(B).disableNotifyingFolderSelect,"onUpdate:disableNotifyingFolderSelect":v[3]||(v[3]=U=>e(B).disableNotifyingFolderSelect=U),forbidden:e(x),onInput:F,onClick:v[4]||(v[4]=U=>E(!0)),onCancel:v[5]||(v[5]=U=>E(!1))},null,8,["expanded","target","userExtensions","disable-notifying-folder-select","forbidden"])]),_:1}),n(Hl,{input:e(s),format:e(B).imageFormat,quality:e(B).imageQuality,"retain-extension":e(B).retainExtension,maxZipSizeMB:e(B).maxZipSizeMB,threads:e(B).multithread?e(B).threadCount:0,"show-note":e(c),"onUpdate:showNote":v[6]||(v[6]=U=>Ee(c)?c.value=U:null),onStart:v[7]||(v[7]=U=>x.value=!0),onEnd:v[8]||(v[8]=U=>x.value=!1),onMultiThreadCount:v[9]||(v[9]=U=>d.value=U)},null,8,["input","format","quality","retain-extension","maxZipSizeMB","threads","show-note"]),n(T,{vertical:"",align:"center"},{default:t(()=>[n(V,{trigger:"manual",placement:"top","keep-alive-on-hover":!1,duration:0,delay:0},{trigger:t(()=>[n(le,{size:"4vh",color:"#DADADA",style:{margin:"0px"}},{default:t(()=>[n(e(wa))]),_:1})]),default:t(()=>[Ys]),_:1})]),_:1}),n(T,{vertical:"",align:"center"},{default:t(()=>[n(gs,{format:e(B).imageFormat,"onUpdate:format":v[10]||(v[10]=U=>e(B).imageFormat=U),quality:e(B).imageQuality,"onUpdate:quality":v[11]||(v[11]=U=>e(B).imageQuality=U)},null,8,["format","quality"]),n(ws,{"retain-ext":e(B).retainExtension,"onUpdate:retainExt":v[12]||(v[12]=U=>e(B).retainExtension=U),"use-folder-name-for-zip":e(B).useFolderNameForZip,"onUpdate:useFolderNameForZip":v[13]||(v[13]=U=>e(B).useFolderNameForZip=U),"max-zip-size":e(B).maxZipSizeMB,"onUpdate:maxZipSize":v[14]||(v[14]=U=>e(B).maxZipSizeMB=U),expanded:e(B).expandAdvSettings,"onUpdate:expanded":v[15]||(v[15]=U=>e(B).expandAdvSettings=U),multithread:e(B).multithread,"onUpdate:multithread":v[16]||(v[16]=U=>e(B).multithread=U),"thread-count":e(B).threadCount,"onUpdate:threadCount":v[17]||(v[17]=U=>e(B).threadCount=U),"thread-max":e(d)||0,"shrink-image":e(B).shrinkImage,"onUpdate:shrinkImage":v[18]||(v[18]=U=>e(B).shrinkImage=U),"max-width":e(B).maxWidth,"onUpdate:maxWidth":v[19]||(v[19]=U=>e(B).maxWidth=U),"max-height":e(B).maxHeight,"onUpdate:maxHeight":v[20]||(v[20]=U=>e(B).maxHeight=U)},null,8,["retain-ext","use-folder-name-for-zip","max-zip-size","expanded","multithread","thread-count","thread-max","shrink-image","max-width","max-height"])]),_:1}),n(zs)]),_:1})):de("",!0)]),_:1})]),_:1})}}}),Lt=_e({__name:"App",setup(o){const i={Statistic:{valueFontSize:"1em"},Popover:{borderRadius:"0.4em",boxShadow:"2px 2px 5px 0px #555555"},Tooltip:{color:"#000000AA"},Image:{toolbarColor:"#00000099"}},g=_(!0);return Me(()=>{g.value=!1}),(a,s)=>{const d=xa,l=ka,p=Aa,x=za,k=Ta,z=ba;return M(),q(z,{"theme-overrides":i,style:{width:"100%",height:"100%"}},{default:t(()=>[n(k,null,{default:t(()=>[n(x,{placement:"top-right",max:20},{default:t(()=>[n(p,{placement:"top-left",closable:!0,max:50},{default:t(()=>[n(l,null,{default:t(()=>[n(d,null,{default:t(()=>[n(Js,{class:Xe({hide:e(g)})},null,8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),To=[{path:"/",name:"Home",component:Lt}];for(const o of st)To.push({path:"/"+o+"/",strict:!0,name:o,component:Lt});Ia(Lt,{routes:To,base:"/avif2jpeg/test/"},({app:o,router:i,routes:g,isClient:a,initialState:s})=>{o.use(it)});
